import{n as C,g as $,o as m,a2 as w,a as t,M as k,w as a,Q as D,I as v,J as e,$ as c,_ as s,a3 as I,a4 as N,bc as P,a1 as U,K as F,aI as j,ad as O,O as E,R as K,z as J,u as G,c as b,L as T,bb as H}from"./index.9c9d4c4e.js";import{Q as W}from"./QBadge.95890374.js";import{Q as X}from"./QScrollArea.4d8adee1.js";import{Q as Z}from"./QPage.4805e931.js";import{u as z}from"./baker-report.17988b34.js";import{q as B}from"./date.4640083c.js";import{C as ee}from"./ClosePopup.e8ca0b3e.js";import{u as te}from"./use-quasar.66fa6bb1.js";import{_ as ae}from"./plugin-vue_export-helper.21dcd24c.js";import"./QResizeObserver.d1181516.js";import"./QScrollObserver.009e9860.js";import"./TouchPan.0b002323.js";import"./touch.9135741d.js";import"./selection.18f52089.js";import"./axios.fd4410eb.js";const u=o=>(E("data-v-0e015710"),o=o(),K(),o),re=u(()=>e("div",{class:"report-title"},"Report Details",-1)),oe={class:"invoice-header"},se=u(()=>e("strong",null,"Date:",-1)),le=u(()=>e("strong",null,"Branch:",-1)),ne={class:"invoice-body"},ie=u(()=>e("strong",null,"Baker:",-1)),ce=u(()=>e("strong",null,"Recipe:",-1)),ue=u(()=>e("strong",null,"Status:",-1)),de=u(()=>e("strong",null,"Kilo:",-1)),pe=u(()=>e("strong",null,"Over:",-1)),me=u(()=>e("strong",null,"Short:",-1)),fe=u(()=>e("strong",null,"Actual Target:",-1)),_e={key:0,class:"invoice-section"},ve=u(()=>e("div",{class:"section-title"},"Breads",-1)),he={class:"bread-name"},ge={class:"bread-production"},ye=u(()=>e("div",{class:"text-h6"},"Decline Report",-1)),ke={__name:"BakersReportView",props:{report:{type:Object,required:!0}},setup(o){const _=o,y=C(!1),R=()=>{y.value=!0},d=te(),h=z(),g=C(!1),M=()=>{g.value=!0},x=i=>B.formatDate(i,"MMMM D, YYYY hh:mm A"),V=$(()=>_.report.bread_bakers_reports.filter(i=>i.bread_production>0)),Q=async()=>{try{const i=await h.confirmReport(_.report.id);console.log("Report confirmed:",i),d.notify({type:"positive",message:"Report confirmed successfully"}),g.value=!1}catch{d.notify({type:"negative",message:"Failed to confirm report"})}},S=async()=>{try{if(!remark.value.trim()){d.notify({type:"negative",message:"Remark cannot be empty"});return}await h.declineReport(_.report.id,remark.value),d.notify({type:"positive",message:"Report declined successfully"}),g.value=!1,y.value=!1}catch{d.notify({type:"negative",message:"Failed to decline report"})}};return(i,f)=>(m(),w(I,null,[t(k,{color:"accent",icon:"visibility",size:"md",flat:"",round:"",dense:"",onClick:M}),t(U,{modelValue:g.value,"onUpdate:modelValue":f[1]||(f[1]=l=>g.value=l),class:"report-dialog"},{default:a(()=>[t(D,{class:"report-card"},{default:a(()=>[t(v,{class:"report-header"},{default:a(()=>[re,t(k,{class:"close-btn",color:"grey-8",flat:"",round:"",dense:"",icon:"close",onClick:f[0]||(f[0]=l=>g.value=!1)})]),_:1}),t(v,{class:"report-info"},{default:a(()=>[e("div",oe,[e("div",null,[se,c(" "+s(x(o.report.created_at)),1)]),e("div",null,[le,c(" "+s(o.report.branch.name),1)])]),e("div",ne,[e("div",null,[ie,c(" "+s(o.report.user.name),1)]),e("div",null,[ce,c(" "+s(o.report.recipe.name),1)]),e("div",null,[ue,c(" "+s(o.report.status),1)]),e("div",null,[de,c(" "+s(o.report.kilo),1)]),e("div",null,[pe,c(" "+s(o.report.over),1)]),e("div",null,[me,c(" "+s(o.report.short),1)]),e("div",null,[fe,c(" "+s(o.report.actual_target),1)])]),V.value.length?(m(),w("div",_e,[ve,e("ul",null,[(m(!0),w(I,null,N(V.value,l=>(m(),w("li",{key:l.id},[e("span",he,s(l.bread.name)+" -",1),e("span",ge,s(l.bread_production)+" pcs",1)]))),128))])])):P("",!0)]),_:1}),t(v,{class:"report-actions q-gutter-sm",align:"right"},{default:a(()=>[t(k,{color:"negative",label:"Decline",onClick:R,class:"action-btn"}),t(k,{color:"positive",label:"Confirm",onClick:Q,class:"action-btn"})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(U,{modelValue:y.value,"onUpdate:modelValue":f[3]||(f[3]=l=>y.value=l)},{default:a(()=>[t(D,null,{default:a(()=>[t(v,null,{default:a(()=>[ye]),_:1}),t(v,null,{default:a(()=>[t(F,{modelValue:i.remark,"onUpdate:modelValue":f[2]||(f[2]=l=>i.remark=l),placeholder:"Enter your remark",label:"Remark",type:"textarea",filled:"","lazy-rules":"",rules:[l=>!!l||"Remark is required"]},null,8,["modelValue","rules"])]),_:1}),t(j,{align:"right"},{default:a(()=>[O(t(k,{flat:"",label:"Cancel",color:"primary"},null,512),[[ee]]),t(k,{flat:"",label:"Confirm",color:"negative",onClick:S})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};var be=ae(ke,[["__scopeId","data-v-0e015710"]]);const Re={class:"q-gutter-md"},we={class:"q-gutter-md q-ma-md"},Ce={class:"row justify-between"},De={class:"text-subtitle1"},xe={class:"text-subtitle1"},Ve={class:"text-h6"},Be={__name:"BakersReportCard",setup(o){var l,q,L;const _=z(),R=((L=(q=(l=$(()=>_.user).value)==null?void 0:l.data)==null?void 0:q.employee)==null?void 0:L.branch_employee.branch_id)||"",d=C(""),h=C(!1),g=C(!1);J(async()=>{console.log("props.userID in onMounted:",R),R&&await M(R)});const M=async r=>{h.value=!0,await _.fetchDoughReports(r),h.value=!1};G(d,async r=>{h.value=!0,await new Promise(n=>setTimeout(n,1e3)),h.value=!1});const x=$(()=>{if(!d.value)return _.reports;const r=d.value.toLowerCase();return _.reports.filter(n=>n.recipe.name&&n.recipe.name.toLowerCase().includes(r)||n.created_at&&B.formatDate(n.created_at,"MMMM D, YYYY").toLowerCase().includes(r)||n.recipe.category&&n.recipe.category.toLowerCase().includes(r))}),V=r=>B.formatDate(r,"MMMM D, YYYY"),Q=r=>B.formatDate(r,"hh:mm A"),S=r=>{if(!r)return"";const n=r.split(" ");return n.map((Y,A)=>A===0||A===n.length-1?Y.charAt(0).toUpperCase()+Y.slice(1).toLowerCase():Y.charAt(0).toUpperCase()+".").join(" ")},i=r=>{switch(r){case"pending":return"orange";case"declined":return"negative";case"confirmed":return"green";default:return"grey"}},f=r=>r.charAt(0).toUpperCase()+r.slice(1).toLowerCase();return(r,n)=>(m(),b(Z,{padding:""},{default:a(()=>[e("div",Re,[e("div",null,[t(F,{rounded:"",outlined:"",dense:"",debounce:"300",modelValue:d.value,"onUpdate:modelValue":n[0]||(n[0]=p=>d.value=p),placeholder:"Search",style:{width:"500px","max-width":"1500px","min-width":"100px"}},{append:a(()=>[h.value?(m(),b(H,{key:1})):(m(),b(T,{key:0,name:"search"}))]),_:1},8,["modelValue"])]),t(X,{style:{height:"450px","max-width":"1500px"}},{default:a(()=>[e("div",we,[(m(!0),w(I,null,N(x.value,p=>(m(),b(D,{key:p.id},{default:a(()=>[t(v,null,{default:a(()=>[e("div",Ce,[e("div",null,[e("div",De,s(V(p.created_at)),1),e("div",xe,s(Q(p.created_at)),1)]),e("div",Ve,s(S(p.user.name))+" - "+s(p.recipe.name),1),e("div",null,[t(W,{outlined:"",color:i(p.status)},{default:a(()=>[c(s(f(p.status)),1)]),_:2},1032,["color"])]),e("div",null,[t(be,{report:p},null,8,["report"])])])]),_:2},1024)]),_:2},1024))),128))])]),_:1}),g.value&&x.value.length===0?(m(),b(D,{key:0},{default:a(()=>[t(v,{class:"text-h6 text-center"},{default:a(()=>[c("No reports found.")]),_:1})]),_:1})):P("",!0)])]),_:1}))}},Me={class:"text-h6 text-white"},Oe={__name:"BakersReportPage",setup(o){return(_,y)=>(m(),b(D,{flat:""},{default:a(()=>[t(v,{style:{"background-color":"#ef4444"}},{default:a(()=>[e("div",Me,[t(T,{name:"fa-solid fa-layer-group"}),c(" Bakers Report ")])]),_:1}),t(v,null,{default:a(()=>[e("div",null,[t(Be)])]),_:1})]),_:1}))}};export{Oe as default};
