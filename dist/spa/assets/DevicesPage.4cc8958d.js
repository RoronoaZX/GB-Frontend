import{d as ve,r as g,N as S,P as Q,c as M,t as Z,u as ee,o as d,a3 as b,f as e,M as V,w as t,Q as N,I as k,ae as T,J as n,K as q,b6 as K,e as x,L as O,bc as J,a0 as I,bd as C,a4 as F,a5 as G,$ as H,aJ as te,a2 as R,O as W,R as j,a1 as me,z as pe}from"./index.7640e4cf.js";import{Q as _e}from"./QPage.88a071ab.js";import{Q as ae}from"./QSpace.0007135a.js";import{Q as X,a as P,b as Y}from"./QList.23e25756.js";import{C as B}from"./ClosePopup.7ab7b337.js";import{api as E}from"./axios.eaed252d.js";import{u as ge}from"./branch.cc74c894.js";import{u as fe}from"./warehouse.d8e53a13.js";import{_ as z}from"./plugin-vue_export-helper.21dcd24c.js";import{Q as he}from"./QSpinnerDots.29ccc382.js";import{Q as ye,a as De}from"./QTable.00529ccc.js";import{Q as le}from"./QTooltip.02333757.js";import"./employee.aa880d45.js";import"./QVirtualScroll.37625985.js";import"./use-virtual-scroll.47f9879f.js";import"./rtl.1813a5ba.js";import"./QSelect.b9e84c2a.js";import"./QChip.e4b8526a.js";import"./QMenu.106ae137.js";import"./selection.21d0b633.js";const L=ve("devices",()=>{const i=g(null),m=g([]),v=async()=>{try{const o=await E.get("/api/device");m.value=o.data}catch(o){console.log("error fetchig  device",o),S.create({type:"negative",message:"Failed to fetch devices",setTimeout:1e3})}};return{device:i,devices:m,fetchDevices:v,createDevices:async o=>{Q.show(),console.log("Data parameters being sent:",o);try{const _=await E.post("/api/device",o);v(),S.create({type:"positive",message:"Device created successfully",setTimeout:1e3})}catch(_){console.error("error device",_),S.create({type:"negative",message:"Failed to create device",setTimeout:1e3})}finally{Q.hide()}},updateDevice:async(o,_)=>{Q.show();try{const u=await E.put(`/api/device/${o}`,_),c=m.value.findIndex(a=>a.id===o);c!==-1&&(m.value[c]=u.data),S.create({type:"positive",message:"Device updated successfully",setTimeout:1e3})}catch(u){console.log("update device error",u),S.create({type:"negative",message:"Failed to update device",setTimeout:1e3})}finally{Q.hide()}},deleteDevice:async o=>{Q.show();try{const _=await E.delete(`/api/device/${o}`);m.value=m.value.filter(u=>u.id!==o),S.create({type:"positive",message:"Device deleted successfully"})}catch{S.create({type:"negative",message:"Failed to delete device"})}finally{Q.hide()}}}});const U=i=>(W("data-v-3caa7c3c"),i=i(),j(),i),be=U(()=>n("div",{class:"text-h5 q-mr-md"},"\u{1F4F1} Add Device",-1)),we={class:"q-mt-lg"},qe=U(()=>n("div",null,"UUID",-1)),Ve={class:"q-mt-md"},xe=U(()=>n("div",null,"Name",-1)),ke={class:"q-mt-md"},$e=U(()=>n("div",null,"Model",-1)),Se={class:"q-mt-md"},Ue=U(()=>n("div",null,"OS Version",-1)),Qe={class:"q-gutter-x-lg"},Ce={key:0,class:"q-mt-md"},Ie=U(()=>n("div",null,"Designation Branch",-1)),Ne={key:0,class:"custom-list z-top"},Te={key:1,class:"q-mt-md"},Fe=U(()=>n("div",null,"Warehouse",-1)),Be={key:0,class:"custom-list z-top"},ze={__name:"AddDevice",setup(i){const m=L(),v=ge(),p=fe(),f=M(()=>v.branch),h=M(()=>p.warehouse),o=g(!1),_=g(!1),u=g(""),c=g(""),a=g(!1),s=g(!1),y=g(null),D=Z({uuid:"",name:"",model:"",os_version:"",reference_id:"",designation:""});ee(y,w=>{D.designation=w});const se=()=>{o.value=!0},ne=async()=>{u.value.trim()&&await v.search(u.value)},ie=w=>{D.reference_id=w.id,u.value=w.name,a.value=!1},de=async()=>{c.value.trim()&&await p.search(c.value)},re=w=>{D.reference_id=w.id,c.value=w.name,a.value=!1},ue=async()=>{console.log("deviceForm",D);try{_.value=!0;const w=await m.createDevices(D);console.log("reponse",w),o.value=!1}catch(w){console.log(w)}finally{_.value=!1}};return(w,r)=>(d(),b("div",null,[e(V,{outline:"",icon:"add_circle",label:"Add Device",onClick:se,style:{"background-color":"#ef4444"}}),e(R,{modelValue:o.value,"onUpdate:modelValue":r[10]||(r[10]=l=>o.value=l),persistent:"","transition-show":"jump-up","transition-hide":"jump-down"},{default:t(()=>[e(N,{class:"my-card q-pa-none",style:{width:"420px","border-radius":"16px","box-shadow":"0 12px 24px rgba(0, 0, 0, 0.2)"}},{default:t(()=>[e(k,{class:"row items-center q-px-md q-py-sm bg-gradient text-white"},{default:t(()=>[be,e(ae),T(e(V,{icon:"close",flat:"",dense:"",round:""},null,512),[[B]])]),_:1}),e(k,{class:"q-px-xl q-pt-none q-pb-lg"},{default:t(()=>[n("div",we,[qe,e(q,{modelValue:D.uuid,"onUpdate:modelValue":r[0]||(r[0]=l=>D.uuid=l),outlined:"",dense:"",rules:[l=>l&&l.length>0||"Device UUID is required"]},null,8,["modelValue","rules"])]),n("div",Ve,[xe,e(q,{class:"text-capitalize",modelValue:D.name,"onUpdate:modelValue":r[1]||(r[1]=l=>D.name=l),outlined:"",dense:"",rules:[l=>l&&l.length>0||"Device Name is required"]},null,8,["modelValue","rules"])]),n("div",ke,[$e,e(q,{modelValue:D.model,"onUpdate:modelValue":r[2]||(r[2]=l=>D.model=l),outlined:"",dense:"",rules:[l=>l&&l.length>0||"Device Model is required"]},null,8,["modelValue","rules"])]),n("div",Se,[Ue,e(q,{modelValue:D.os_version,"onUpdate:modelValue":r[3]||(r[3]=l=>D.os_version=l),outlined:"",dense:"",rules:[l=>l&&l.length>0||"Device OS Version is required"]},null,8,["modelValue","rules"])]),n("div",Qe,[e(K,{"keep-color":"",modelValue:y.value,"onUpdate:modelValue":r[4]||(r[4]=l=>y.value=l),label:"Branch",color:"red","true-value":"branch","false-value":null},null,8,["modelValue"]),e(K,{"keep-color":"",modelValue:y.value,"onUpdate:modelValue":r[5]||(r[5]=l=>y.value=l),label:"Warehouse",color:"blue-grey-10","true-value":"warehouse","false-value":null},null,8,["modelValue"])]),y.value==="branch"?(d(),b("div",Ce,[Ie,e(q,{modelValue:u.value,"onUpdate:modelValue":[r[6]||(r[6]=l=>u.value=l),ne],outlined:"",dense:"",debounce:"500",onFocus:r[7]||(r[7]=l=>a.value=!0)},{append:t(()=>[s.value?(d(),x(J,{key:1,color:"grey",size:"sm"})):(d(),x(O,{key:0,name:"search"}))]),default:t(()=>[a.value&&u.value?(d(),b("div",Ne,[e(N,null,{default:t(()=>[e(X,{separator:""},{default:t(()=>{var l;return[(l=f.value)!=null&&l.length?C("",!0):(d(),x(P,{key:0},{default:t(()=>[I("No Branch Record")]),_:1})),(d(!0),b(F,null,G(f.value,$=>(d(),x(P,{key:$.id,clickable:"",onClick:ce=>ie($)},{default:t(()=>[e(Y,null,{default:t(()=>[I(H($.name),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]}),_:1})]),_:1})])):C("",!0)]),_:1},8,["modelValue"])])):C("",!0),y.value==="warehouse"?(d(),b("div",Te,[Fe,e(q,{modelValue:c.value,"onUpdate:modelValue":[r[8]||(r[8]=l=>c.value=l),de],outlined:"",dense:"",debounce:"500",onFocus:r[9]||(r[9]=l=>a.value=!0)},{append:t(()=>[s.value?(d(),x(J,{key:1,color:"grey",size:"sm"})):(d(),x(O,{key:0,name:"search"}))]),default:t(()=>[a.value&&c.value?(d(),b("div",Be,[e(N,null,{default:t(()=>[e(X,{separator:""},{default:t(()=>{var l;return[(l=h.value)!=null&&l.length?C("",!0):(d(),x(P,{key:0},{default:t(()=>[I("No Warehouse Record")]),_:1})),(d(!0),b(F,null,G(h.value,$=>(d(),x(P,{key:$.id,onClick:ce=>re($),clickable:""},{default:t(()=>[e(Y,null,{default:t(()=>[I(H($.name),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]}),_:1})]),_:1})])):C("",!0)]),_:1},8,["modelValue"])])):C("",!0)]),_:1}),e(te,{class:"row q-px-lg q-py-sm q-pt-none",align:"right"},{default:t(()=>[T(e(V,{class:"btn-cancel glossy",color:"negative",label:"Dismiss"},null,512),[[B]]),e(V,{class:"btn-create glossy",color:"positive",label:"Create",onClick:ue})]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}};var Ae=z(ze,[["__scopeId","data-v-3caa7c3c"]]);const oe=i=>(W("data-v-2a721950"),i=i(),j(),i),Pe=oe(()=>n("div",{class:"text-h5 q-mb-xs"},"Confirm Deletion",-1)),Ee=oe(()=>n("p",{class:"text-body2 q-mb-none"}," Are you sure you want to delete this item? This action cannot be undone. ",-1)),Me={__name:"DeviceDelete",props:["delete"],emits:["device-deleted"],setup(i,{emit:m}){const v=L(),p=i,f=m,h=g(!1),o=()=>{h.value=!0},_=async()=>{try{await v.deleteDevice(p.delete.row.id),h.value=!1,f("device-deleted")}catch(u){console.error("Error deleting item:",u)}h.value=!1};return(u,c)=>(d(),b(F,null,[e(V,{color:"negative",icon:"delete",size:"sm",flat:"",round:"",dense:"",onClick:o},{default:t(()=>[e(le,{class:"bg-negative",delay:200},{default:t(()=>[I("Delete")]),_:1})]),_:1}),e(R,{modelValue:h.value,"onUpdate:modelValue":c[0]||(c[0]=a=>h.value=a)},{default:t(()=>[e(N,{class:"q-pa-md q-rounded q-elevate-2 bg-white text-grey-9"},{default:t(()=>[e(k,{class:"q-pt-none q-pb-sm"},{default:t(()=>[Pe,Ee]),_:1}),e(me,{class:"q-mb-md"}),e(k,{align:"right",class:"q-pt-none"},{default:t(()=>[T(e(V,{flat:"",dense:"",label:"Cancel",color:"primary",class:"q-mr-sm"},null,512),[[B]]),e(V,{dense:"",label:"Delete",color:"negative",onClick:_,class:"q-btn-rounded q-px-lg"})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};var Oe=z(Me,[["__scopeId","data-v-2a721950"]]);const A=i=>(W("data-v-737a91e1"),i=i(),j(),i),We=A(()=>n("div",{class:"text-h5 q-mr-md"},"\u{1F4F1} Edit Device",-1)),je={class:"q-mt-lg q-animated q-animate-bounce"},Le=A(()=>n("div",null,"UUID",-1)),Re={class:"q-mt-md q-animated q-animate-bounce"},Ke=A(()=>n("div",null,"Name",-1)),Je={class:"q-mt-md q-animated q-animate-bounce"},Ge=A(()=>n("div",null,"Model",-1)),He={class:"q-mt-md q-animated q-animate-bounce"},Xe=A(()=>n("div",null,"OS Version",-1)),Ye={__name:"DeviceEdit",props:["edit"],emits:["device-updated"],setup(i,{emit:m}){const v=L(),p=g(!1);g(!0);const f=i,h=m,o=Z({uuid:"",name:"",model:"",os_version:""}),_=()=>{Object.assign(o,f.edit.row),p.value=!0},u=async()=>{try{const c={...f.edit.row,...o};await v.updateDevice(f.edit.row.id,c),p.value=!1,h("device-updated")}catch(c){console.log("error update device",c)}};return(c,a)=>(d(),b(F,null,[e(V,{color:"positive",icon:"edit",size:"sm",flat:"",round:"",dense:"",onClick:_},{default:t(()=>[e(le,{class:"bg-positive",delay:200},{default:t(()=>[I("Edit")]),_:1})]),_:1}),e(R,{modelValue:p.value,"onUpdate:modelValue":a[4]||(a[4]=s=>p.value=s),persistent:"","transition-show":"jump-up","transition-hide":"jump-down"},{default:t(()=>[e(N,{class:"my-card q-pa-none",style:{width:"420px","border-radius":"16px","box-shadow":"0 12px 24px rgba(0, 0, 0, 0.2)"}},{default:t(()=>[e(k,{class:"row items-center q-px-md q-py-sm bg-gradient text-white"},{default:t(()=>[We,e(ae),T(e(V,{icon:"close",flat:"",dense:"",round:""},null,512),[[B]])]),_:1}),e(k,{class:"q-px-xl q-pt-none q-pb-lg"},{default:t(()=>[n("div",je,[Le,e(q,{modelValue:o.uuid,"onUpdate:modelValue":a[0]||(a[0]=s=>o.uuid=s),outlined:"",dense:"",rules:[s=>s&&s.length>0||"Device UUID is required"]},null,8,["modelValue","rules"])]),n("div",Re,[Ke,e(q,{modelValue:o.name,"onUpdate:modelValue":a[1]||(a[1]=s=>o.name=s),outlined:"",dense:"",rules:[s=>s&&s.length>0||"Device Name is required"]},null,8,["modelValue","rules"])]),n("div",Je,[Ge,e(q,{modelValue:o.model,"onUpdate:modelValue":a[2]||(a[2]=s=>o.model=s),outlined:"",dense:"",rules:[s=>s&&s.length>0||"Device Model is required"]},null,8,["modelValue","rules"])]),n("div",He,[Xe,e(q,{modelValue:o.os_version,"onUpdate:modelValue":a[3]||(a[3]=s=>o.os_version=s),outlined:"",dense:"",rules:[s=>s&&s.length>0||"Device OS Version is required"]},null,8,["modelValue","rules"])])]),_:1}),e(te,{class:"row q-px-lg q-py-sm q-pt-none",align:"right"},{default:t(()=>[T(e(V,{class:"btn-cancel glossy",color:"negative",label:"Dismiss"},null,512),[[B]]),e(V,{class:"btn-create glossy",color:"positive",label:"Save",onClick:u})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};var Ze=z(Ye,[["__scopeId","data-v-737a91e1"]]);const et=i=>(W("data-v-174421c6"),i=i(),j(),i),tt={key:0,class:"spinner-wrapper"},at={key:1},lt={key:0,class:"data-error"},ot=et(()=>n("div",{class:"q-ml-sm text-h6"},"No data available",-1)),st={class:"row justify-center q-gutter-x-md"},nt={__name:"DeviceTable",setup(i){const m=L(),v=g(""),p=g(!0),f=M(()=>m.devices),h=g(!1),o=g({rowPerPage:0}),_=M(()=>v.value?f.value.filter(a=>(a.name||"").toLowerCase().includes(v.value.toLowerCase())):f.value);pe(async()=>{const a=await u();console.log("response device",a)});const u=async()=>{try{p.value=!0;const a=await m.fetchDevices();f.value.length||(h.value=!0),console.log("device fetch:",f.value)}catch(a){console.log("error fetching device",a),h.value=!0}finally{p.value=!1}};ee(v,async a=>{p.value=!0,await new Promise(s=>setTimeout(s,1e3)),p.value=!1,h.value=_.value.length===0});const c=[{name:"name",label:"Name",align:"center",field:"name",format:a=>`${a}`,sortable:!0},{name:"model",label:"Model",align:"center",field:"model"},{name:"os_version",label:"OS Version",align:"center",field:"os_version"},{name:"uuid",label:"UUID",align:"center",field:"uuid"},{name:"designation",label:"Designation",align:"center",field:a=>a.branch?a.branch.name:a.warehouse?a.warehouse.name:"N/A"},{name:"action",label:"Action",align:"center",field:"action"}];return(a,s)=>(d(),b(F,null,[n("div",null,[e(q,{modelValue:v.value,"onUpdate:modelValue":s[0]||(s[0]=y=>v.value=y),class:"q-pb-lg q-pl-sm dynamic-width",outlined:"",placeholder:"search",flat:"",rounded:"",dense:"",debounce:"100"},{append:t(()=>[e(O,{name:"search"})]),_:1},8,["modelValue"])]),p.value?(d(),b("div",tt,[e(he,{size:"50px",color:"primary"})])):(d(),b("div",at,[_.value.length===0?(d(),b("div",lt,[e(O,{name:"warning",color:"warning",size:"4em"}),ot])):(d(),x(De,{key:1,class:"table-container elegant-container sticky-header",filter:v.value,"virtual-scroll-sticky-size-start":48,flat:"",style:{height:"400px"},columns:c,rows:f.value,"row-key":"name","virtual-scroll":"",pagination:o.value,"onUpdate:pagination":s[1]||(s[1]=y=>o.value=y),"rows-per-page-options":[0],"hide-bottom":""},{"body-cell-action":t(y=>[e(ye,{props:y},{default:t(()=>[n("div",st,[e(Ze,{edit:y,onDeviceUpdated:u},null,8,["edit"]),e(Oe,{delete:y,onDeviceDeleted:u},null,8,["delete"])])]),_:2},1032,["props"])]),_:1},8,["filter","rows","pagination"]))]))],64))}};var it=z(nt,[["__scopeId","data-v-174421c6"]]);const dt={align:"right"},rt={__name:"DevicesPage",setup(i){return(m,v)=>(d(),x(_e,null,{default:t(()=>[e(N,{class:"elegant-container",flat:""},{default:t(()=>[e(k,null,{default:t(()=>[n("div",dt,[e(Ae)])]),_:1}),e(k,null,{default:t(()=>[e(it)]),_:1})]),_:1})]),_:1}))}};var Qt=z(rt,[["__scopeId","data-v-68396a38"]]);export{Qt as default};
