import{r as k,c as I,o as c,a3 as b,f as a,M as D,w as r,Q as w,I as v,J as t,a0 as u,$ as n,a4 as N,a5 as z,bd as U,a2 as q,K as P,aJ as J,ae as K,P as Q,O as G,R as H,z as W,u as X,e as y,L as T,bc as Z}from"./index.910c5d89.js";import{Q as ee}from"./QSpinnerDots.88e59e0d.js";import{Q as te}from"./QBadge.151c3917.js";import{Q as ae}from"./QScrollArea.e2c01e40.js";import{Q as re}from"./QPage.df77130b.js";import{u as O}from"./baker-report.c6f86d63.js";import{q as M}from"./date.9007c85d.js";import{C as oe}from"./ClosePopup.e881cbae.js";import{u as se}from"./use-quasar.52d88981.js";import{_ as j}from"./plugin-vue_export-helper.21dcd24c.js";import"./QResizeObserver.4898283d.js";import"./QScrollObserver.1bd71369.js";import"./TouchPan.4ae56415.js";import"./touch.9135741d.js";import"./selection.6f067596.js";import"./axios.b52a58d3.js";const m=l=>(G("data-v-cb52edf8"),l=l(),H(),l),le=m(()=>t("div",{class:"report-title"},"Report Details",-1)),ne={class:"invoice-header"},ie=m(()=>t("strong",null,"Date:",-1)),ce=m(()=>t("strong",null,"Branch:",-1)),de={class:"invoice-body"},ue=m(()=>t("strong",null,"Baker:",-1)),pe=m(()=>t("strong",null,"Recipe:",-1)),me=m(()=>t("strong",null,"Status:",-1)),fe=m(()=>t("strong",null,"Kilo:",-1)),_e=m(()=>t("strong",null,"Over:",-1)),ve=m(()=>t("strong",null,"Short:",-1)),he=m(()=>t("strong",null,"Actual Target:",-1)),ge={key:0,class:"invoice-section"},ye=m(()=>t("div",{class:"section-title"},"Breads",-1)),ke={class:"bread-name"},be={class:"bread-production"},Re=m(()=>t("div",{class:"text-h6"},"Decline Report",-1)),Ce={__name:"BakersReportView",props:{report:{type:Object,required:!0}},setup(l){const _=l,R=k(!1),B=()=>{R.value=!0},f=se(),h=O(),p=k(!1),g=k(""),S=()=>{p.value=!0},C=o=>o.charAt(0).toUpperCase()+o.slice(1).toLowerCase(),x=o=>{const i=$=>$?$.charAt(0).toUpperCase()+$.slice(1).toLowerCase():"",e=o.firstname?i(o.firstname):"No Firstname",s=o.middlename?i(o.middlename).charAt(0)+".":"",d=o.lastname?i(o.lastname):"No Lastname";return`${e} ${s} ${d}`},L=o=>M.formatDate(o,"MMMM D, YYYY hh:mm A"),V=I(()=>_.report.bread_bakers_reports.filter(o=>o.bread_production>0)),Y=async()=>{try{Q.show();const o=await h.confirmReport(_.report.id);console.log("Report confirmed:",o),f.notify({type:"positive",message:"Report confirmed successfully"}),p.value=!1}catch{f.notify({type:"negative",message:"Failed to confirm report"})}finally{Q.hide()}},A=async()=>{try{if(Q.show(),!g.value.trim()){f.notify({type:"negative",message:"Remark cannot be empty"});return}await h.declineReport(_.report.id,g.value),f.notify({type:"positive",message:"Report declined successfully"}),p.value=!1,R.value=!1}catch{f.notify({type:"negative",message:"Failed to decline report"})}finally{Q.hide()}};return(o,i)=>(c(),b(N,null,[a(D,{color:"accent",icon:"visibility",size:"md",flat:"",round:"",dense:"",onClick:S}),a(q,{modelValue:p.value,"onUpdate:modelValue":i[1]||(i[1]=e=>p.value=e),class:"report-dialog"},{default:r(()=>[a(w,{class:"report-card"},{default:r(()=>[a(v,{class:"report-header"},{default:r(()=>[le,a(D,{class:"close-btn",color:"grey-8",flat:"",round:"",dense:"",icon:"close",onClick:i[0]||(i[0]=e=>p.value=!1)})]),_:1}),a(v,{class:"report-info"},{default:r(()=>[t("div",ne,[t("div",null,[ie,u(" "+n(L(l.report.created_at)),1)]),t("div",null,[ce,u(" "+n(C(l.report.branch.name)),1)])]),t("div",de,[t("div",null,[ue,u(" "+n(x(l.report.user.employee)),1)]),t("div",null,[pe,u(" "+n(C(l.report.branch_recipe.recipe.name)),1)]),t("div",null,[me,u(" "+n(C(l.report.status)),1)]),t("div",null,[fe,u(" "+n(l.report.kilo),1)]),t("div",null,[_e,u(" "+n(l.report.over),1)]),t("div",null,[ve,u(" "+n(l.report.short),1)]),t("div",null,[he,u(" "+n(l.report.actual_target),1)])]),V.value.length?(c(),b("div",ge,[ye,t("ul",null,[(c(!0),b(N,null,z(V.value,e=>(c(),b("li",{key:e.id},[t("span",ke,n(e.bread.name)+" -",1),t("span",be,n(e.bread_production)+" pcs",1)]))),128))])])):U("",!0)]),_:1}),a(v,{class:"report-actions q-gutter-sm",align:"right"},{default:r(()=>[a(D,{color:"negative",label:"Decline",onClick:B,class:"action-btn"}),a(D,{color:"positive",label:"Confirm",onClick:Y,class:"action-btn"})]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(q,{modelValue:R.value,"onUpdate:modelValue":i[3]||(i[3]=e=>R.value=e)},{default:r(()=>[a(w,null,{default:r(()=>[a(v,null,{default:r(()=>[Re]),_:1}),a(v,null,{default:r(()=>[a(P,{modelValue:g.value,"onUpdate:modelValue":i[2]||(i[2]=e=>g.value=e),placeholder:"Enter your remark",label:"Remark",type:"textarea",filled:"","lazy-rules":"",rules:[e=>!!e||"Remark is required"]},null,8,["modelValue","rules"])]),_:1}),a(J,{align:"right"},{default:r(()=>[K(a(D,{flat:"",label:"Cancel",color:"primary"},null,512),[[oe]]),a(D,{flat:"",label:"Confirm",color:"negative",onClick:A})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};var xe=j(Ce,[["__scopeId","data-v-cb52edf8"]]);const De={class:"q-gutter-md"},we={key:0,class:"spinner-wrapper"},Be={key:2},$e={class:"q-gutter-md q-ma-md"},Ve={class:"row justify-between"},Qe={class:"text-subtitle1"},Me={class:"text-subtitle1"},Se={class:"text-h6"},Le={__name:"BakersReportCard",setup(l){var o,i;const _=O(),B=((i=(o=I(()=>_.user).value)==null?void 0:o.device)==null?void 0:i.reference_id)||"",f=k(""),h=k(!1),p=k(!1),g=k(!0);W(async()=>{console.log("props.userID in onMounted:",B),B&&await S(B)});const S=async e=>{h.value=!0,g.value=!0,p.value=!1;try{await _.fetchDoughReports(e),p.value=_.reports.length===0}catch(s){console.error("Failed to fetch reports:",s),p.value=!0}finally{g.value=!1,h.value=!1}},C=e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase();X(f,async e=>{h.value=!0,await new Promise(s=>setTimeout(s,1e3)),h.value=!1});const x=I(()=>{if(!f.value)return _.reports;const e=f.value.toLowerCase();return _.reports.filter(s=>s.branch_recipe.recipe.name&&s.branch_recipe.recipe.name.toLowerCase().includes(e)||s.created_at&&M.formatDate(s.created_at,"MMMM D, YYYY").toLowerCase().includes(e)||s.branch_recipe.recipe.category&&s.branch_recipe.recipe.category.toLowerCase().includes(e))});console.log("baekr reports",x.value);const L=e=>M.formatDate(e,"MMMM D, YYYY"),V=e=>M.formatDate(e,"hh:mm A"),Y=e=>{const s=F=>F?F.charAt(0).toUpperCase()+F.slice(1).toLowerCase():"",d=e.firstname?s(e.firstname):"No Firstname",$=e.middlename?s(e.middlename).charAt(0)+".":"",E=e.lastname?s(e.lastname):"No Lastname";return`${d} ${$} ${E}`},A=e=>{switch(e){case"pending":return"orange";case"declined":return"negative";case"confirmed":return"green";default:return"grey"}};return(e,s)=>(c(),y(re,{padding:""},{default:r(()=>[t("div",De,[t("div",null,[a(P,{rounded:"",outlined:"",dense:"",debounce:"300",modelValue:f.value,"onUpdate:modelValue":s[0]||(s[0]=d=>f.value=d),placeholder:"Search",style:{width:"500px","max-width":"1500px","min-width":"100px"}},{append:r(()=>[h.value?(c(),y(Z,{key:1})):(c(),y(T,{key:0,name:"search"}))]),_:1},8,["modelValue"])]),g.value?(c(),b("div",we,[a(ee,{size:"50px",color:"primary"})])):U("",!0),p.value&&x.value.length===0?(c(),y(w,{key:1,flat:""},{default:r(()=>[a(v,{class:"text-h6 text-center"},{default:r(()=>[u("No reports found.")]),_:1})]),_:1})):(c(),b("div",Be,[p.value&&x.value.length===0?(c(),y(w,{key:0},{default:r(()=>[a(v,{class:"text-h6 text-center"},{default:r(()=>[u("No reports found.")]),_:1})]),_:1})):(c(),y(ae,{key:1,style:{height:"450px","max-width":"1500px"}},{default:r(()=>[t("div",$e,[(c(!0),b(N,null,z(x.value,d=>(c(),y(w,{key:d.id},{default:r(()=>[a(v,null,{default:r(()=>[t("div",Ve,[t("div",null,[t("div",Qe,n(L(d.created_at)),1),t("div",Me,n(V(d.created_at)),1)]),t("div",Se,n(Y(d.user.employee))+" - "+n(C(d.branch_recipe.recipe.name)),1),t("div",null,[a(te,{outlined:"",color:A(d.status)},{default:r(()=>[u(n(C(d.status)),1)]),_:2},1032,["color"])]),t("div",null,[a(xe,{report:d},null,8,["report"])])])]),_:2},1024)]),_:2},1024))),128))])]),_:1}))]))])]),_:1}))}};var Ye=j(Le,[["__scopeId","data-v-025beaa6"]]);const Ae={class:"text-h6 text-white"},Xe={__name:"BakersReportPage",setup(l){return(_,R)=>(c(),y(w,{flat:""},{default:r(()=>[a(v,{style:{"background-color":"#ef4444"}},{default:r(()=>[t("div",Ae,[a(T,{name:"fa-solid fa-layer-group"}),u(" Bakers Report ")])]),_:1}),a(v,null,{default:r(()=>[t("div",null,[a(Ye)])]),_:1})]),_:1}))}};export{Xe as default};
