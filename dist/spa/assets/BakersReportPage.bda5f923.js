import{r as V,h as A,o as f,a2 as x,e as t,M as k,w as o,Q as w,I as v,J as e,$ as u,_ as c,a3 as I,a4 as N,bc as q,a1 as F,K as U,aI as j,ad as E,O as K,R as J,z as G,u as H,c as R,L as z,bb as W}from"./index.43ba8d7d.js";import{Q as X}from"./QBadge.679c213a.js";import{Q as Z}from"./QScrollArea.bcb3eb12.js";import{Q as ee}from"./QPage.9a02bdd7.js";import{u as T}from"./baker-report.3eff434f.js";import{q as $}from"./date.a18c5465.js";import{C as te}from"./ClosePopup.02ad92c5.js";import{u as ae}from"./use-quasar.7709e763.js";import{_ as re}from"./plugin-vue_export-helper.21dcd24c.js";import"./QResizeObserver.565a78c7.js";import"./QScrollObserver.c9fd1ee3.js";import"./TouchPan.f7e74eb4.js";import"./touch.9135741d.js";import"./selection.1f2cf681.js";import"./axios.d49441bc.js";const m=n=>(K("data-v-a9e5dd86"),n=n(),J(),n),oe=m(()=>e("div",{class:"report-title"},"Report Details",-1)),se={class:"invoice-header"},le=m(()=>e("strong",null,"Date:",-1)),ne=m(()=>e("strong",null,"Branch:",-1)),ie={class:"invoice-body"},ce=m(()=>e("strong",null,"Baker:",-1)),de=m(()=>e("strong",null,"Recipe:",-1)),ue=m(()=>e("strong",null,"Status:",-1)),me=m(()=>e("strong",null,"Kilo:",-1)),pe=m(()=>e("strong",null,"Over:",-1)),fe=m(()=>e("strong",null,"Short:",-1)),_e=m(()=>e("strong",null,"Actual Target:",-1)),ve={key:0,class:"invoice-section"},he=m(()=>e("div",{class:"section-title"},"Breads",-1)),ge={class:"bread-name"},ye={class:"bread-production"},be=m(()=>e("div",{class:"text-h6"},"Decline Report",-1)),ke={__name:"BakersReportView",props:{report:{type:Object,required:!0}},setup(n){const _=n,y=V(!1),C=()=>{y.value=!0},p=ae(),h=T(),g=V(!1),M=()=>{g.value=!0},b=r=>r.charAt(0).toUpperCase()+r.slice(1).toLowerCase(),D=r=>{const d=i=>i?i.charAt(0).toUpperCase()+i.slice(1).toLowerCase():"",s=r.firstname?d(r.firstname):"No Firstname",a=r.middlename?d(r.middlename).charAt(0)+".":"",l=r.lastname?d(r.lastname):"No Lastname";return`${s} ${a} ${l}`},Q=r=>$.formatDate(r,"MMMM D, YYYY hh:mm A"),B=A(()=>_.report.bread_bakers_reports.filter(r=>r.bread_production>0)),L=async()=>{try{const r=await h.confirmReport(_.report.id);console.log("Report confirmed:",r),p.notify({type:"positive",message:"Report confirmed successfully"}),g.value=!1}catch{p.notify({type:"negative",message:"Failed to confirm report"})}},S=async()=>{try{if(!remark.value.trim()){p.notify({type:"negative",message:"Remark cannot be empty"});return}await h.declineReport(_.report.id,remark.value),p.notify({type:"positive",message:"Report declined successfully"}),g.value=!1,y.value=!1}catch{p.notify({type:"negative",message:"Failed to decline report"})}};return(r,d)=>(f(),x(I,null,[t(k,{color:"accent",icon:"visibility",size:"md",flat:"",round:"",dense:"",onClick:M}),t(F,{modelValue:g.value,"onUpdate:modelValue":d[1]||(d[1]=s=>g.value=s),class:"report-dialog"},{default:o(()=>[t(w,{class:"report-card"},{default:o(()=>[t(v,{class:"report-header"},{default:o(()=>[oe,t(k,{class:"close-btn",color:"grey-8",flat:"",round:"",dense:"",icon:"close",onClick:d[0]||(d[0]=s=>g.value=!1)})]),_:1}),t(v,{class:"report-info"},{default:o(()=>[e("div",se,[e("div",null,[le,u(" "+c(Q(n.report.created_at)),1)]),e("div",null,[ne,u(" "+c(b(n.report.branch.name)),1)])]),e("div",ie,[e("div",null,[ce,u(" "+c(D(n.report.user.employee)),1)]),e("div",null,[de,u(" "+c(b(n.report.branch_recipe.recipe.name)),1)]),e("div",null,[ue,u(" "+c(b(n.report.status)),1)]),e("div",null,[me,u(" "+c(n.report.kilo),1)]),e("div",null,[pe,u(" "+c(n.report.over),1)]),e("div",null,[fe,u(" "+c(n.report.short),1)]),e("div",null,[_e,u(" "+c(n.report.actual_target),1)])]),B.value.length?(f(),x("div",ve,[he,e("ul",null,[(f(!0),x(I,null,N(B.value,s=>(f(),x("li",{key:s.id},[e("span",ge,c(s.bread.name)+" -",1),e("span",ye,c(s.bread_production)+" pcs",1)]))),128))])])):q("",!0)]),_:1}),t(v,{class:"report-actions q-gutter-sm",align:"right"},{default:o(()=>[t(k,{color:"negative",label:"Decline",onClick:C,class:"action-btn"}),t(k,{color:"positive",label:"Confirm",onClick:L,class:"action-btn"})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(F,{modelValue:y.value,"onUpdate:modelValue":d[3]||(d[3]=s=>y.value=s)},{default:o(()=>[t(w,null,{default:o(()=>[t(v,null,{default:o(()=>[be]),_:1}),t(v,null,{default:o(()=>[t(U,{modelValue:r.remark,"onUpdate:modelValue":d[2]||(d[2]=s=>r.remark=s),placeholder:"Enter your remark",label:"Remark",type:"textarea",filled:"","lazy-rules":"",rules:[s=>!!s||"Remark is required"]},null,8,["modelValue","rules"])]),_:1}),t(j,{align:"right"},{default:o(()=>[E(t(k,{flat:"",label:"Cancel",color:"primary"},null,512),[[te]]),t(k,{flat:"",label:"Confirm",color:"negative",onClick:S})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};var Re=re(ke,[["__scopeId","data-v-a9e5dd86"]]);const Ce={class:"q-gutter-md"},De={class:"q-gutter-md q-ma-md"},xe={class:"row justify-between"},Ve={class:"text-subtitle1"},we={class:"text-subtitle1"},Be={class:"text-h6"},$e={__name:"BakersReportCard",setup(n){var r,d,s;const _=T(),C=((s=(d=(r=A(()=>_.user).value)==null?void 0:r.data)==null?void 0:d.employee)==null?void 0:s.branch_employee.branch_id)||"",p=V(""),h=V(!1),g=V(!1);G(async()=>{console.log("props.userID in onMounted:",C),C&&await M(C)});const M=async a=>{h.value=!0,await _.fetchDoughReports(a),h.value=!1},b=a=>a.charAt(0).toUpperCase()+a.slice(1).toLowerCase();H(p,async a=>{h.value=!0,await new Promise(l=>setTimeout(l,1e3)),h.value=!1});const D=A(()=>{if(!p.value)return _.reports;const a=p.value.toLowerCase();return _.reports.filter(l=>l.branch_recipe.recipe.name&&l.branch_recipe.recipe.name.toLowerCase().includes(a)||l.created_at&&$.formatDate(l.created_at,"MMMM D, YYYY").toLowerCase().includes(a)||l.branch_recipe.recipe.category&&l.branch_recipe.recipe.category.toLowerCase().includes(a))});console.log("baekr reports",D.value);const Q=a=>$.formatDate(a,"MMMM D, YYYY"),B=a=>$.formatDate(a,"hh:mm A"),L=a=>{const l=Y=>Y?Y.charAt(0).toUpperCase()+Y.slice(1).toLowerCase():"",i=a.firstname?l(a.firstname):"No Firstname",P=a.middlename?l(a.middlename).charAt(0)+".":"",O=a.lastname?l(a.lastname):"No Lastname";return`${i} ${P} ${O}`},S=a=>{switch(a){case"pending":return"orange";case"declined":return"negative";case"confirmed":return"green";default:return"grey"}};return(a,l)=>(f(),R(ee,{padding:""},{default:o(()=>[e("div",Ce,[e("div",null,[t(U,{rounded:"",outlined:"",dense:"",debounce:"300",modelValue:p.value,"onUpdate:modelValue":l[0]||(l[0]=i=>p.value=i),placeholder:"Search",style:{width:"500px","max-width":"1500px","min-width":"100px"}},{append:o(()=>[h.value?(f(),R(W,{key:1})):(f(),R(z,{key:0,name:"search"}))]),_:1},8,["modelValue"])]),t(Z,{style:{height:"450px","max-width":"1500px"}},{default:o(()=>[e("div",De,[(f(!0),x(I,null,N(D.value,i=>(f(),R(w,{key:i.id},{default:o(()=>[t(v,null,{default:o(()=>[e("div",xe,[e("div",null,[e("div",Ve,c(Q(i.created_at)),1),e("div",we,c(B(i.created_at)),1)]),e("div",Be,c(L(i.user.employee))+" - "+c(b(i.branch_recipe.recipe.name)),1),e("div",null,[t(X,{outlined:"",color:S(i.status)},{default:o(()=>[u(c(b(i.status)),1)]),_:2},1032,["color"])]),e("div",null,[t(Re,{report:i},null,8,["report"])])])]),_:2},1024)]),_:2},1024))),128))])]),_:1}),g.value&&D.value.length===0?(f(),R(w,{key:0},{default:o(()=>[t(v,{class:"text-h6 text-center"},{default:o(()=>[u("No reports found.")]),_:1})]),_:1})):q("",!0)])]),_:1}))}},Me={class:"text-h6 text-white"},Ee={__name:"BakersReportPage",setup(n){return(_,y)=>(f(),R(w,{flat:""},{default:o(()=>[t(v,{style:{"background-color":"#ef4444"}},{default:o(()=>[e("div",Me,[t(z,{name:"fa-solid fa-layer-group"}),u(" Bakers Report ")])]),_:1}),t(v,null,{default:o(()=>[e("div",null,[t($e)])]),_:1})]),_:1}))}};export{Ee as default};
