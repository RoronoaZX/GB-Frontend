import{c as R,o as c,a2 as m,J as e,f as a,w as o,e as $,Q as T,I as S,L as E,_ as u,M as F,a0 as X,a3 as Q,a4 as V,O as M,R as H,t as Y,u as B,$ as q,K as A,bc as J,r as Z,H as ee}from"./index.c079c05e.js";import{Q as te}from"./QSpace.a13d3777.js";import{Q as K}from"./QExpansionItem.5a20e9f4.js";import{Q as ae}from"./QVirtualScroll.63e2ae76.js";import{u as j}from"./baker-report.93bdc5a0.js";import{_ as G}from"./plugin-vue_export-helper.21dcd24c.js";import{Q as I,b as U}from"./use-virtual-scroll.04f2dfb3.js";import{Q as W,a as z,b as N}from"./QList.9f253224.js";import{u as se}from"./branch-recipe.0ef1a4b3.js";import"./QSlideTransition.8f3522e9.js";import"./axios.c33915f9.js";const L=h=>(M("data-v-21535d8a"),h=h(),H(),h),le=L(()=>e("div",{class:"text-h6",align:"center"},"Report List",-1)),oe={class:"q-pa-md row wrap justify-center"},re={class:"row justify-between q-gutter-x-md"},ne={class:"row items-center"},ie={class:"text-subtitle1 q-ml-sm"},de={class:"content-section"},ce={class:"q-mt-xs row justify-between"},ue=L(()=>e("div",null,"Kilo",-1)),_e={class:"q-mt-xs row justify-between"},pe=L(()=>e("div",null,"Short",-1)),me={class:"q-mt-xs row justify-between"},ve=L(()=>e("div",null,"Over",-1)),he={class:"q-mt-xs row justify-between"},be=L(()=>e("div",null,"Actual Target",-1)),ge={class:"q-pl-md"},ye={class:"row justify-between"},fe={class:"q-pl-md"},we={class:"row justify-between"},xe={align:"right"},ke={__name:"ReportListComponent",setup(h){const v=j(),_=R(()=>v.reports);console.log("bakers report:",_.value);const i=t=>{v.removeReport(t)},g=t=>t?t.split(" ").map(y=>y.charAt(0).toUpperCase()+y.slice(1).toLowerCase()).join(" "):"",C=async()=>{v.createReports()};return(t,y)=>(c(),m(Q,null,[le,e("div",oe,[a(ae,{items:_.value,"scroll-target":"body","virtual-scroll-horizontal":"",class:"my-virtual-scroll"},{default:o(({item:p,index:w})=>[(c(),$(T,{flat:"",bordered:"",class:"q-gutter-sm my-card",key:w},{default:o(()=>[a(S,null,{default:o(()=>[e("div",re,[e("div",ne,[a(E,{name:"assignment",color:"primary"}),e("div",ie,u(g(p.recipe_name))+" - "+u(p.recipe_category),1)]),e("div",null,[a(F,{flat:"",round:"",icon:"close",onClick:b=>i(w),class:"text-negative close-btn"},null,8,["onClick"])])])]),_:2},1024),a(X),a(S,null,{default:o(()=>[e("div",de,[e("div",ce,[ue,e("div",null,u(p.kilo)+" kgs",1)]),e("div",_e,[pe,e("div",null,u(p.short)+" pcs",1)]),e("div",me,[ve,e("div",null,u(p.over)+" pcs",1)]),e("div",he,[be,e("div",null,u(p.actual_target)+" pcs",1)]),(c(),$(K,{key:"breads-"+w,label:"Breads",dense:"",class:""},{default:o(()=>[e("ul",ge,[(c(!0),m(Q,null,V(p.breads,(b,f)=>(c(),m("li",{key:"bread-"+f,class:"q-my-sm"},[e("div",ye,[e("div",null,u(b.bread_name),1),e("div",null,u(b.bread_production),1)])]))),128))])]),_:2},1024)),(c(),$(K,{key:"ingredients-"+w,label:"Ingredients",dense:"",class:""},{default:o(()=>[e("ul",fe,[(c(!0),m(Q,null,V(p.ingredients,(b,f)=>(c(),m("li",{key:"ingredient-"+f,class:"q-my-sm"},[e("div",we,[e("div",null,u(b.code),1),e("div",null,u(b.quantity)+" "+u(b.unit),1)])]))),128))])]),_:2},1024))])]),_:2},1024)]),_:2},1024))]),_:1},8,["items"])]),e("div",xe,[a(F,{color:"red-6",icon:"edit",label:"Create",onClick:C})])],64))}};var qe=G(ke,[["__scopeId","data-v-21535d8a"]]);const D=h=>(M("data-v-dc31fdf6"),h=h(),H(),h),Re={class:"row justify-center"},Ce={class:"text-h6 q-ma-sm"},$e={class:"row q-gutter-sm"},Qe={class:"row q-mt-sm q-gutter-sm"},Ie={class:"q-mb-md"},Se=D(()=>e("div",{class:"q-mt-sm"},"Kilo",-1)),Ne={class:"q-mt-md q-gutter-md"},Ve={key:0},je=D(()=>e("div",{class:"q-mt-sm"},null,-1)),Le=D(()=>e("div",{class:"text-h6 q-mt-sm",align:"center"},"Ingredients List",-1)),Be={class:"q-mt-lg"},Fe={class:"ingredient-quantity"},Ae={class:"ingredient-quantity"},Ue={__name:"ReportRecipeInputComponent",setup(h){const v=j(),_=R(()=>v.user),i=R(()=>v.recipes);console.log("erwe:",i.value);const g=R(()=>{var r,n,d,x;const l=(n=(r=i.value)==null?void 0:r.name)!=null?n:"Recipe Name",s=(x=(d=i.value)==null?void 0:d.category)!=null?x:"Category";return`${l} - ${s}`}),C=l=>l?l.split(" ").map(s=>s.charAt(0).toUpperCase()+s.slice(1).toLowerCase()).join(" "):"",t=Y({user_id:null,branch_id:null,branch_recipe_id:null,recipe_name:"",recipe_category:"",kilo:"",short:0,over:0,target:0,actual_target:0,breads:[]}),y=()=>{var r;const l=parseFloat(t.kilo),s=parseFloat((r=i.value)==null?void 0:r.target);!isNaN(l)&&!isNaN(s)?t.actual_target=l*s:t.actual_target=0},p=()=>{const s=t.breads.reduce((r,n)=>r+(parseFloat(n.value)||0),0)-t.actual_target;s>0?(t.over=s,t.short=0):s<0?(t.short=Math.abs(s),t.over=0):(t.short=0,t.over=0)},w=()=>{var s,r,n,d,x,P,O;t.user_id=((s=_.value)==null?void 0:s.data.id)||"",t.branch_id=((n=(r=_.value)==null?void 0:r.employee)==null?void 0:n.branch_id)||"",t.branch_recipe_id=((d=i.value)==null?void 0:d.id)||"",t.recipe_name=((x=i.value)==null?void 0:x.name)||"",t.target=((P=i.value)==null?void 0:P.target)||"",t.recipe_category=((O=i.value)==null?void 0:O.category)||"";const l={user_id:t.user_id,branch_id:t.branch_id,branch_recipe_id:t.branch_recipe_id,recipe_name:t.recipe_name,recipe_category:t.recipe_category,status:"pending",kilo:t.kilo,short:t.short,over:t.over,target:t.target,actual_target:t.actual_target,breads:t.breads.map(k=>({bread_id:k.id,bread_name:k.bread_name,bread_production:parseInt(k.value,10)})),ingredients:f.value.map(k=>({ingredients_id:k.raw_materials_id,code:k.code,quantity:k.multipliedQuantity,unit:k.unit}))};console.log("reportssss dATA:",l),v.setReport(l),console.log("Report data set to store:",v.reports),b()},b=()=>{var l,s;i.value="",g.value="",t.recipe_name="",t.kilo="",t.short=0,t.over=0,t.target=0,t.actual_target=0,t.breads=((s=(l=i.value)==null?void 0:l.bread_groups)==null?void 0:s.map(r=>({id:r.product_id,bread_name:r.bread_name,value:""})))||[]},f=R(()=>{var s;const l=parseInt(t.kilo)||1;return(((s=i.value)==null?void 0:s.ingredients)||[]).map(r=>{const n=parseInt(r.quantity),d=!isNaN(l)&&!isNaN(n)?l*n:0;return{...r,multipliedQuantity:d}})});return B(()=>t.kilo,()=>{y(),p()}),B(()=>{var l;return(l=i.value)==null?void 0:l.ingredients},()=>{p()},{deep:!0}),B(()=>t.breads.map(l=>l.value),p,{deep:!0}),B(()=>{var l;return(l=i.value)==null?void 0:l.bread_groups},()=>{var l;t.breads=((l=i.value)==null?void 0:l.bread_groups.map(s=>({id:s.product_id,bread_name:s.bread_name,value:""})))||[],p()}),(l,s)=>{var r;return c(),m("div",Re,[e("div",null,[e("div",null,[e("div",Ce,u(C(g.value)),1)]),e("div",$e,[e("div",null,[q(" Target Pcs "),e("div",null,[a(I,{readonly:"",outlined:"",type:"number",dense:"",label:((r=i.value)==null?void 0:r.target)||0,style:{width:"100px","max-width":"300px","min-width":"50px"}},null,8,["label"])])]),e("div",null,[q(" Actual Target "),e("div",null,[a(I,{readonly:"",outlined:"",dense:"",label:t.actual_target,style:{width:"100px","max-width":"300px","min-width":"50px"}},null,8,["label"])])])]),e("div",Qe,[e("div",null,[q(" Short "),e("div",null,[a(I,{readonly:"",outlined:"",type:"number",dense:"",label:t.short,style:{width:"100px","max-width":"300px","min-width":"50px"}},null,8,["label"])])]),e("div",null,[q(" Over "),e("div",null,[a(I,{readonly:"",outlined:"",dense:"",label:t.over,style:{width:"100px","max-width":"300px","min-width":"50px"}},null,8,["label"])])])]),e("div",Ie,[Se,e("div",null,[a(A,{outlined:"",dense:"",modelValue:t.kilo,"onUpdate:modelValue":s[0]||(s[0]=n=>t.kilo=n),type:"number",placeholder:"kgs",style:{width:"210px","max-width":"300px","min-width":"50px"}},null,8,["modelValue"])])]),e("div",Ne,[t.breads.length?(c(),m("div",Ve,[(c(!0),m(Q,null,V(t.breads,(n,d)=>(c(),m("div",{key:n.id},[e("div",null,u(n.bread_name),1),e("div",null,[a(A,{outlined:"",modelValue:t.breads[d].value,"onUpdate:modelValue":x=>t.breads[d].value=x,dense:"",type:"number",placeholder:"Pcs",style:{width:"210px","max-width":"300px","min-width":"50px"}},null,8,["modelValue","onUpdate:modelValue"])])]))),128))])):J("",!0)]),je,a(F,{outline:"",dense:"",size:"md",icon:"add",label:"Report",class:"text-purple",onClick:w})]),e("div",null,[Le,e("div",Be,[a(I,{readonly:"",outlined:"",style:{width:"400px","max-width":"450px","min-width":"100px"}},{control:o(()=>[a(W,{dense:"",separator:""},{default:o(()=>[(c(!0),m(Q,null,V(f.value,(n,d)=>(c(),$(z,{key:d,class:"q-pa-xs justify-between"},{default:o(()=>[a(N,null,{default:o(()=>[a(U,{class:"ingredient-name"},{default:o(()=>[q(u(n.code),1)]),_:2},1024)]),_:2},1024),a(N,{side:"",class:"text-right"},{default:o(()=>[e("div",Fe,u(n.multipliedQuantity.toFixed(2)),1)]),_:2},1024),a(N,{side:"",class:"text-right"},{default:o(()=>[e("div",Ae,u(n.unit),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})])])])}}};var ze=G(Ue,[["__scopeId","data-v-dc31fdf6"]]);const Te={key:0,class:"custom-list z-top"},De={__name:"ReportSearchComponent",setup(h){var f,l;const v=j(),_=Z(""),i=j(),g=se(),C=R(()=>i.user);console.log("erw:",C.value);const t=R(()=>g.branchRecipe),y=((l=(f=C.value)==null?void 0:f.employee)==null?void 0:l.branch_id)||"";console.log("branch_id",y);const p=async()=>{g.searchBranchRecipe(_.value,y),console.log("searchQuery.value",_.value),console.log("branch_id",y)},w=s=>{console.log("branch recipe",s),v.setRecipe(s),_.value=""},b=s=>s?s.split(" ").map(r=>r.charAt(0).toUpperCase()+r.slice(1).toLowerCase()).join(" "):"";return console.log("recipessss",t.value),(s,r)=>(c(),$(A,{modelValue:_.value,"onUpdate:modelValue":[r[0]||(r[0]=n=>_.value=n),p],debounce:"1000",outlined:"",rounded:"",placeholder:"Search product",dense:""},{append:o(()=>[e("div",null,[a(E,{name:"search"})])]),default:o(()=>[_.value?(c(),m("div",Te,[a(T,null,{default:o(()=>[a(W,{separator:""},{default:o(()=>{var n;return[(n=t.value)!=null&&n.length?(c(!0),m(Q,{key:1},V(t.value,d=>(c(),$(z,{onClick:x=>w(d),key:d.id,clickable:""},{default:o(()=>[a(N,null,{default:o(()=>[a(U,null,{default:o(()=>[q(u(b(d==null?void 0:d.name)),1)]),_:2},1024)]),_:2},1024),a(N,null,{default:o(()=>[a(U,{side:""},{default:o(()=>[q(u(d==null?void 0:d.category),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128)):(c(),$(z,{key:0},{default:o(()=>[q(" No record found. ")]),_:1}))]}),_:1})]),_:1})])):J("",!0)]),_:1},8,["modelValue"]))}},Pe={class:"text-h6 text-dark row justify-between"},Oe=e("div",null," Bakers Report ",-1),Ke={class:"q-gutter-y-md"},Ee={class:"q-gutter-y-md"},st={__name:"ReportIdCreatePage",setup(h){const v=ee(),_=j(),i=R(()=>_.recipes);console.log("report",i);const g=()=>{_.clearData(),v.push("/branch/baker/report")};return(C,t)=>(c(),m("div",null,[a(T,{flat:""},{default:o(()=>[a(S,null,{default:o(()=>[e("div",Pe,[e("div",null,[a(F,{outline:"",flat:"",icon:"arrow_back",onClick:g})]),a(te),Oe])]),_:1}),a(S,null,{default:o(()=>[e("div",null,[a(De)]),e("div",Ke,[e("div",null,[a(ze)])])]),_:1}),a(S,null,{default:o(()=>[e("div",Ee,[e("div",null,[a(qe)])])]),_:1})]),_:1})]))}};export{st as default};
