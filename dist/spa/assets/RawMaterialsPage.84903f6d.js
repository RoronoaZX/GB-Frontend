import{r as n,c as v,u as C,z as B,o as i,a3 as _,J as h,f as s,w as u,K as S,bo as w,be as b,e as k,L as V,bg as $,a0 as x,$ as I}from"./index.4f8c3525.js";import{Q as N}from"./QChip.98970a3d.js";import{a as T,Q as P}from"./QTable.e1659363.js";import{Q as z}from"./QBanner.b99019fb.js";import{u as D}from"./baker-report.203f9701.js";import{_ as F}from"./plugin-vue_export-helper.21dcd24c.js";import"./QVirtualScroll.59b09b16.js";import"./QList.1c7a6cb4.js";import"./use-virtual-scroll.bd4d1fa2.js";import"./rtl.276c3f1b.js";import"./QSelect.3c4bd527.js";import"./QMenu.43508d5a.js";import"./position-engine.38e1658f.js";import"./selection.41406168.js";import"./axios.d00d26dd.js";const L={class:"q-gutter-md"},j={class:"table-container"},E={key:0,class:"loading-overlay row justify-center items-center"},K={key:1,class:"q-pa-md q-gutter-md row justify-center"},U={__name:"RawMaterialsPage",setup(A){const y=n({rowsPerPage:0}),r=n(""),p=n(!1),c=n(!0),m=D();v(()=>m.user);const g=localStorage.getItem("branch_id"),l=v(()=>m.rawmaterials),d=n(!1);C(r,async t=>{p.value=!0,await new Promise(e=>setTimeout(e,1e3)),p.value=!1,d.value=!c.value&&f.value.length===0,console.log("Filtered Rows:",f.value)}),B(async()=>{console.log("props.branchId in onMounted:",g),g&&await Q(g)});const Q=async t=>{console.log("Fetching products for branch ID:",t);try{c.value=!0;const e=await m.fetchBranchRawMaterials(t);l.value=e,l.value.length||(d.value=!0),console.log("Branch Raw Materials",l.value)}catch(e){console.log("Error fetching branch product:",e),d.value=!0}finally{c.value=!1}},f=v(()=>{if(!r.value)return l.value;const t=r.value.toLowerCase();return l.value.filter(e=>e.ingredients.code.toLowerCase().includes(t))}),M=[{name:"code",label:"Code",align:"center",field:t=>{var e,a;return(a=(e=t==null?void 0:t.ingredients)==null?void 0:e.code)!=null?a:"No Code"},format:t=>`${t}`,sortable:!0},{name:"total_quantity",align:"center",label:"Available Stocks",field:"total_quantity",sortable:!0}],q=t=>{console.log("check total quantity",t.total_quantity);const e=t.total_quantity;if(t.ingredients.unit==="Grams"&&e<1e3)return"bg-red";let o;return e>=1e3?o=e/1e3:o=e,o<5?o<=2?"bg-red":(o<=3,"bg-warning"):"bg-positive"},R=t=>{const e=t.total_quantity,a=t.ingredients.unit;if(e>1e3){const o=(e/1e3).toFixed(2);return o.endsWith(".00")?`${Math.round(e/1e3)} kilos`:`${o} kilos`}else return e>1?`${e} ${a}`:`${e} ${a}`};return(t,e)=>(i(),_("div",L,[h("div",null,[s(S,{rounded:"",outlined:"",dense:"",debounce:"300",modelValue:r.value,"onUpdate:modelValue":e[0]||(e[0]=a=>r.value=a),placeholder:"Search",style:{width:"500px","max-width":"1500px","min-width":"100px"}},{append:u(()=>[p.value?(i(),k(w,{key:1})):(i(),k(V,{key:0,name:"search"}))]),_:1},8,["modelValue"])]),h("div",j,[s(T,{class:"sticky-header",filter:r.value,"virtual-scroll-sticky-size-start":48,flat:"",style:{height:"350px"},columns:M,rows:f.value,"row-key":"name","virtual-scroll":"",pagination:y.value,"onUpdate:pagination":e[1]||(e[1]=a=>y.value=a),"rows-per-page-options":[0],"hide-bottom":""},{"body-cell-total_quantity":u(a=>[s(P,{props:a},{default:u(()=>[s(N,{square:"",class:$(["text-white",q(a.row)])},{default:u(()=>[x(I(R(a.row)),1)]),_:2},1032,["class"])]),_:2},1032,["props"])]),_:1},8,["filter","rows","pagination"]),c.value?(i(),_("div",E,[s(w,{size:"50px"})])):b("",!0),d.value?(i(),_("div",K,[s(z,{class:"bg-grey-1",dense:""},{default:u(()=>[x(" No data available ")]),_:1})])):b("",!0)])]))}};var ne=F(U,[["__scopeId","data-v-994bc9a0"]]);export{ne as default};
