import{d as i,N as a}from"./index.5e59852a.js";import{api as o}from"./axios.06eeae44.js";const d=i("salesReports",{state:()=>({salesReport:[],products:[],branchProducts:[],breadProducts:[],selectaProducts:[],softdrinksProducts:[],cakeProducts:[],othersProducts:[],reports:[],user:{},breadReports:[],selectaReports:[],softdrinksReports:[],cakeReports:[],otherProductsReports:[],expensesReports:[],employeeCreditReports:[],denominationReports:[],productsTotalAmount:0,expensesTotalAmount:0,employeeCreditTotalAmount:0,denominationTotal:0,charges:0,overTotal:0}),actions:{setUser(t){this.user=t},removeBread(t){this.breadReports.splice(t,1),this.updateProductsTotalAmount(),this.calculateCharges(this.denominationTotal)},removeSelecta(t){this.selectaReports.splice(t,1),this.updateProductsTotalAmount(),this.calculateCharges(this.denominationTotal)},removeSoftdrink(t){this.softdrinksReports.splice(t,1),this.updateProductsTotalAmount(),this.calculateCharges(this.denominationTotal)},removeCake(t){this.cakeReports.splice(t,1),this.updateProductsTotalAmount(),this.calculateCharges(this.denominationTotal)},removeOtherProducts(t){this.otherProductsReports.splice(t,1),this.updateProductsTotalAmount(),this.calculateCharges(this.denominationTotal)},removeEmployeeCreditReport(t){this.employeeCreditReports.splice(t,1)},removeExpenses(t){this.expensesReports.splice(t,1),this.updateProductsTotalAmount(),this.calculateCharges(this.denominationTotal)},filterBreadproducts(){this.breadProducts=this.branchProducts.filter(t=>t.category==="Bread")},filterSelectaproducts(){this.selectaProducts=this.branchProducts.filter(t=>t.category==="Selecta")},filterSoftdrinksproducts(){this.softdrinksProducts=this.branchProducts.filter(t=>t.category==="Softdrinks")},filterOthersproducts(){this.othersProducts=this.branchProducts.filter(t=>t.category==="Others")},updateBreadReport(t){const e=this.breadReports.findIndex(s=>s.name===t.name);e!==-1?this.breadReports.splice(e,1,t):this.breadReports.push(t)},updateSelectaReport(t){const e=this.selectaReports.findIndex(s=>s.name===t.name);e!==-1?this.selectaReports.splice(e,1,t):this.selectaReports.push(t)},updateSoftdrinksReport(t){const e=this.softdrinksReports.findIndex(s=>s.name===t.name);e!==-1?this.softdrinksReports.splice(e,1,t):this.softdrinksReports.push(t)},updateSoftdrinksReport(t){const e=this.softdrinksReports.findIndex(s=>s.name===t.name);e!==-1?this.softdrinksReports.splice(e,1,t):this.softdrinksReports.push(t)},updateCakeReport(t){const e=this.cakeReports.findIndex(s=>s.name===t.name);e!==-1?this.cakeReports.splice(e,1,t):this.cakeReports.push(t)},updateOtherProductsReport(t){const e=this.otherProductsReports.findIndex(s=>s.name===t.name);e!==-1?this.otherProductsReports.splice(e,1,t):this.otherProductsReports.push(t)},updateEmployeeCreditReports(t){this.employeeCreditReports.push(t)},updateExpensesReport(t){const e=this.expensesReports.findIndex(s=>s.name===t.name);e!==-1?this.expensesReports.splice(e,1,t):this.expensesReports.push(t)},getDenominationData(t){this.denominationReports.push(t)},updateDenominationTotal(t){this.denominationTotal=t},calculateCharges(t){const e=this.breadTotalAmount+this.selectaTotalAmount+this.softdrinksTotalAmount+this.cakeTotalAmount-this.creditExpensesTotal;t<e?(this.charges=e-t,this.overTotal=0):(this.charges=0,this.overTotal=t-e),console.log("Charges:",this.charges),console.log("Charges:",this.overTotal)},updateProductsTotalAmount(){this.productsTotalAmount=this.breadTotalAmount+this.selectaTotalAmount+this.softdrinksTotalAmount+this.cakeTotalAmount+this.otherProductsTotalAmount},updateExpensesTotalAmount(){this.expensesTotalAmount=this.expensesSumAmount},async searchBranchProducts(t,e){console.log("productSearch",t),console.log("branchId",e);try{const s=await o.post("/api/search-products",{keyword:t,branch_id:e});this.products=s.data,console.log("search Products",s.data)}catch(s){console.error("Error fetching products",s)}},async fetchBranchProducts(t){const e=await o.get(`/api/branches/${t}/products`);this.branchProducts=e.data,this.filterBreadproducts(),this.filterSelectaproducts(),this.filterSoftdrinksproducts(),this.filterOthersproducts()},async fetchSalesReports(t){try{const e=await o.get(`/api/branch/${t}/salesReport`);console.log("sales report",e.data),this.salesReport=e.data}catch(e){console.log(e)}},async submitSalesReports(){var e,s;this.creditTotalAmount;const t={user_id:this.user.id,branch_id:(s=(e=this.user)==null?void 0:e.employee)==null?void 0:s.branch_id,breadReports:this.breadReports,selectaReports:this.selectaReports,softdrinksReports:this.softdrinksReports,otherProductsReports:this.otherProductsReports,cakeReports:this.cakeReports,expensesReports:this.expensesReports,denominationReports:this.denominationReports,creditReports:this.employeeCreditReports,denomination_total:this.denominationTotal,expenses_total:this.expensesSumAmount,products_total_sales:this.totalSalesAmount,charges_amount:this.charges,over_total:this.overTotal,credit_total:this.creditTotalAmount};console.log("Payload data:",t);try{const r=await o.post("/api/sales-report",t);console.log("Data submitted successfully"),a.create({type:"positive",message:"Report submitted successfully"}),this.breadReports=[],this.selectaReports=[],this.softdrinksReports=[],this.otherProductsReports=[],this.expensesReports=[],this.denominationReports=[],this.employeeCreditReports=[],this.cakeReports=[],this.denominationTotal=0,this.expensesTotalAmount=0,this.productsTotalAmount=0,this.charges=0,this.overTotal=0,console.log("Sales Reports Data",r)}catch(r){console.error("Error submitting data:",r),a.create({type:"negative",message:"Error submitting report"})}}},getters:{breadTotalAmount:t=>t.breadReports.reduce((e,s)=>e+s.sales,0),selectaTotalAmount:t=>t.selectaReports.reduce((e,s)=>e+s.sales,0),softdrinksTotalAmount:t=>t.softdrinksReports.reduce((e,s)=>e+s.sales,0),otherProductsTotalAmount:t=>t.otherProductsReports.reduce((e,s)=>e+s.sales,0),cakeTotalAmount:t=>t.cakeReports.filter(e=>e.sales_status==="sold").reduce((e,s)=>e+Number(s.price),0),expensesSumAmount:t=>t.expensesReports.reduce((e,s)=>e+s.amount,0),creditTotalAmount:t=>t.employeeCreditReports.reduce((e,s)=>e+s.total_amount,0),creditExpensesTotal:t=>t.expensesSumAmount+t.creditTotalAmount,getDenominationTotal:t=>t.denominationTotal,getCharges:t=>t.charges,totalSalesAmount:t=>t.breadTotalAmount+t.selectaTotalAmount+t.softdrinksTotalAmount+t.cakeTotalAmount}});export{d as u};
