import{d as w,r as l,c as b,P as y,N as p}from"./index.99dcf656.js";import{api as n}from"./axios.66ae3d3b.js";import{u as S}from"./product.470edea2.js";const C=w("branchProducts",()=>{const v=l(null),d=l([]),f=l([]),u=l([]),h=l([]),g=l(0),m=l([]),B=S(),P=b(()=>B.products);return console.log("Branch PRoductssss:",P.value),{branchId:f,branchProduct:v,branchProducts:d,sampleFetchPagination:h,totalFetch:g,branchSendAddedProd:u,fetchBranchProducts:async e=>{const a=await n.get(`/api/branches/${e}/products`);d.value=a.data},createBranchProducts:async e=>{y.show();try{const{category:a,price:s}=e,t=await n.post("/api/branch-products",e);if(t.data.message==="Branch product saved successfully"){const o=P.value.find(i=>i.id===e.product_id),r={...t.data,category:a||"No Category",price:s?parseInt(s):0,product:o||{name:"No Product",category:"Unknown"},total_quantity:e.total_quantity};d.value.unshift(r),p.create({type:"positive",message:"Branch product saved successfully",position:"top"})}else t.data.message==="The product already exists in this branch."&&p.create({type:"warning",message:"The product already exists in this branch.",position:"top"})}catch{p.create({type:"negative",message:"An error occurred while saving the branch product.",position:"top"})}finally{y.hide()}},updateBranchProductPrice:async e=>{await n.put(`/api/update-branch-products/${e}`,{price:newPrice});const a=d.value.findIndex(s=>s.id===e);a!==-1&&(d.value[a].price=newPrice)},deleteBranchProducts:async e=>{await n.delete(`/api/branch-products/${e}`),d.value=d.value.filter(a=>a.id!==e)},searchBranchProducts:async({branches_id:e,query:a,category:s})=>{console.log("Branch ID:",e),console.log("Query:",a),console.log("Category:",s);try{const t=await n.post("/api/search-branch-products",{branches_id:e,query:a,category:s});d.value=t.data,console.log("Branch Products:",t.data)}catch(t){console.log("Error:",t)}},sampleFetchPaginationProducts:async({page:e,rowsPerPage:a,branchId:s})=>{console.log("Page:",e),console.log("RowsPerPage:",a),console.log("Branch ID:",s);try{const t=await n.get(`/api/sample-fetch-pagination-branch-products?page=${e}&rowsPerPage=${a}&branchId=${s}`);h.value=t.data.data,console.log("Sample Fetch Pagination:",t.data.data),g.value=t.data.total,console.log("Total Fetch:",t.data.total)}catch(t){console.log("Error:",t)}},sendProductsToBranch:async e=>{var a,s,t,o,r,i;try{const c=await n.post("/api/added-branch-products",e);return console.log("Responsssssse:",c.data),{success:!0,status:c.status,data:c.data}}catch(c){return console.log("Error:",c),{success:!1,status:((a=c.response)==null?void 0:a.status)||500,message:((t=(s=c.response)==null?void 0:s.data)==null?void 0:t.message)||c.message||"Something went wrong",errors:((i=(r=(o=c.response)==null?void 0:o.data)==null?void 0:r.errors)==null?void 0:i.stock)||null}}},fetchSendAddedBranchProducts:async(e,a,s,t,o)=>{console.log("Datassss:",e,a,s,t);try{const r=await n.get(`/api/send-added-branch-products/${a}/${e}`,{params:{page:s,per_page:t,search:o}});console.log("Responsesss:",r.data),u.value=r.data,console.log("branchSendAddedProd.value:",u.value)}catch(r){console.log("Error:",r)}},receivedSendBranchProducts:async e=>{var a;try{const s=await n.post("/api/received-branch-product",e);if(m.value=s.data,s.status===200&&((a=u.value)==null?void 0:a.data)&&Array.isArray(u.value.data)){const t=u.value.data.findIndex(o=>o.id===e.id);t!==-1&&(u.value.data[t].status="confirmed")}return s}catch(s){throw console.log("Error:",s),s}}}});export{C as u};
