import{be as O,c as I,r as M,t as Te,o as f,a3 as $,f as e,M as B,w as a,Q as F,I as T,ae as ie,J as l,K as W,L as K,e as P,a0 as w,a4 as N,a5 as E,$ as q,bd as be,aJ as ue,a2 as J,O as re,R as oe,a1 as Pe,N as G,P as ye,z as de,u as ce,aK as xe,bb as Ne,bf as ee,H as Ue}from"./index.bbc471a5.js";import{Q as me}from"./QSpace.1ae512fe.js";import{Q as Re,a as ae,b as Ce,c as te}from"./QTabPanels.9125b06d.js";import{Q as Fe}from"./QPage.66fd0a07.js";import{Q as j}from"./QBadge.061e5e25.js";import{Q as Le}from"./QSpinnerDots.0fc6cd62.js";import{Q as Me}from"./QTooltip.21086791.js";import{Q as ze}from"./QPopupEdit.4d659c38.js";import{Q as H,a as _e}from"./QTable.8a489d60.js";import{Q as le,a as A,b as S}from"./QList.fa8edf4e.js";import{Q as D}from"./rtl.a2d21784.js";import{C as pe}from"./ClosePopup.3787c292.js";import"./branch-product.17be3c3c.js";import{u as se}from"./warehouse-rawMaterials.f5675d07.js";import{u as ke}from"./raw-material.77f7f698.js";import{_ as X}from"./plugin-vue_export-helper.21dcd24c.js";import{api as qe}from"./axios.58d1e782.js";import{Q as ne}from"./QSkeleton.add9e94f.js";import{u as $e}from"./use-quasar.cceb1b6a.js";import{u as Ve}from"./warehouse.3de62812.js";import{u as Qe}from"./use-dialog-plugin-component.d667239d.js";import{u as Se}from"./premix.8f6d7657.js";import{q as We}from"./date.8eb8e4a2.js";import{Q as Ae,a as je}from"./QStepper.6fb33a4d.js";import{u as Ke}from"./baker-report.08263d11.js";import"./QResizeObserver.01cd8835.js";import"./use-panel.bf369f77.js";import"./touch.9135741d.js";import"./selection.79d5b637.js";import"./QMenu.477c3670.js";import"./QVirtualScroll.c801800c.js";import"./use-virtual-scroll.4fbdc11a.js";import"./QSelect.80cd56e8.js";import"./QChip.814bc863.js";import"./product.a2e1cfc9.js";import"./QSlideTransition.211f43cc.js";const Z=s=>(re("data-v-e1e644a2"),s=s(),oe(),s),Ee=Z(()=>l("div",{class:"text-h6"},"Create Warehouse Raw Materials",-1)),He={class:"q-mb-lg"},Oe={key:0,class:"custom-list z-top"},Ye=Z(()=>l("div",null,"Raw Materials Code",-1)),Ge=Z(()=>l("div",null,"Raw Materials Name",-1)),Je=Z(()=>l("div",null,"Category",-1)),Xe=Z(()=>l("div",null,"Quantity",-1)),Ze={__name:"RawMaterialsCreate",setup(s){const Q=O(),y=ke(),v=I(()=>y.rawMaterials),n=se(),u=M(""),R=async()=>{y.searchRawMaterials(u.value)},b=I(()=>r.total_quantity!==""),d=M(!1),V=()=>{d.value=!0},k=()=>{i(),d.value=!1},m=g=>{r.raw_material_id=g.id,r.raw_materials_name=g.name,r.raw_materials_code=g.code,r.category=g.category,r.unit=g.unit,u.value=""},r=Te({raw_material_id:"",raw_materials_name:"",raw_materials_code:"",total_quantity:"",category:"",unit:"",warehouse_id:Q.params.warehouse_id}),i=()=>{r.raw_material_id="",r.raw_materials_name="",r.raw_materials_code="",r.total_quantity="",r.raw_material_id="",r.category="",r.unit=""},x=async()=>{try{const{product_name:g,...t}=r;await n.createWarehouseRawMaterials(t),console.log("data to send",t),d.value=!1}catch(g){console.log(g)}};return(g,t)=>(f(),$(N,null,[e(B,{class:"bg-gradient text-white q-pa-sm",icon:"add_circle",label:"Create One",onClick:V}),e(J,{modelValue:d.value,"onUpdate:modelValue":t[5]||(t[5]=o=>d.value=o),persistent:""},{default:a(()=>[e(F,{class:"my-card",style:{width:"400px","max-width":"500px","min-width":"100px"}},{default:a(()=>[e(T,{class:"row items-center text-white bg-gradient"},{default:a(()=>[Ee,e(me),ie(e(B,{icon:"close",flat:"",dense:"",round:""},null,512),[[pe]])]),_:1}),e(T,{class:"q-ma-md q-gutter-y-sm"},{default:a(()=>[l("div",He,[e(W,{modelValue:u.value,"onUpdate:modelValue":[t[0]||(t[0]=o=>u.value=o),R],debounce:"1000",outlined:"",rounded:"",placeholder:"Search Raw Materials",dense:""},{append:a(()=>[l("div",null,[e(K,{name:"search"})])]),default:a(()=>[u.value?(f(),$("div",Oe,[e(F,null,{default:a(()=>[e(le,{separator:""},{default:a(()=>{var o;return[(o=v.value)!=null&&o.length?(f(!0),$(N,{key:1},E(v.value,_=>(f(),P(A,{onClick:C=>m(_),key:_.id,clickable:""},{default:a(()=>[e(S,null,{default:a(()=>[e(D,null,{default:a(()=>[w(q(_.name),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128)):(f(),P(A,{key:0},{default:a(()=>[w(" No record found. ")]),_:1}))]}),_:1})]),_:1})])):be("",!0)]),_:1},8,["modelValue"])]),l("div",null,[Ye,e(W,{modelValue:r.raw_materials_code,"onUpdate:modelValue":t[1]||(t[1]=o=>r.raw_materials_code=o),readonly:"",dense:"",outlined:""},null,8,["modelValue"])]),l("div",null,[Ge,e(W,{modelValue:r.raw_materials_name,"onUpdate:modelValue":t[2]||(t[2]=o=>r.raw_materials_name=o),readonly:"",dense:"",outlined:""},null,8,["modelValue"])]),l("div",null,[Je,e(W,{modelValue:r.category,"onUpdate:modelValue":t[3]||(t[3]=o=>r.category=o),readonly:"",dense:"",outlined:""},null,8,["modelValue"])]),l("div",null,[Xe,e(W,{modelValue:r.total_quantity,"onUpdate:modelValue":t[4]||(t[4]=o=>r.total_quantity=o),type:"number",outlined:"",suffix:r.unit||"",dense:"",rules:[o=>o&&o.length>0||"Total quantity is required"]},null,8,["modelValue","suffix","rules"])])]),_:1}),e(ue,{class:"row q-ma-md",align:"right"},{default:a(()=>[e(B,{class:"glossy",color:"grey-9",label:"Dismiss",onClick:k}),e(B,{class:"glossy",color:"teal",label:"Create",onClick:x,disable:!b.value},null,8,["disable"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};var ea=X(Ze,[["__scopeId","data-v-e1e644a2"]]);const De=s=>(re("data-v-7969abbc"),s=s(),oe(),s),aa=De(()=>l("div",{class:"text-h5 q-mb-xs"},"Confirm Deletion",-1)),ta=De(()=>l("p",{class:"text-body2 q-mb-none"}," Are you sure you want to delete this item? This action cannot be undone. ",-1)),la={__name:"RawMaterialsTableDelete",props:["delete"],setup(s){const Q=se(),y=s,v=async()=>{console.log("clickkkd");try{await Q.deleteWarehouseRawMaterials(y.delete.row.id),G.create({type:"negative",icon:"warning",message:`Raw Materials ${y.delete.row.name}  successfully deleted`,timeout:1e3,position:"top"}),n.value=!1}catch(R){console.error(R.message)}},n=M(!1),u=()=>{n.value=!0};return(R,b)=>(f(),$(N,null,[e(B,{onClick:u,color:"negative",icon:"delete",size:"sm",flat:"",round:"",dense:"",align:"center"},{default:a(()=>[e(Me,{class:"bg-negative",delay:200},{default:a(()=>[w("Delete")]),_:1})]),_:1}),e(J,{modelValue:n.value,"onUpdate:modelValue":b[0]||(b[0]=d=>n.value=d)},{default:a(()=>[e(F,null,{default:a(()=>[e(T,{class:"q-pa-md q-rounded q-elevate-2 bg-white text-grey-9"},{default:a(()=>[aa,ta]),_:1}),e(Pe,{class:"q-mb-md"}),e(T,null,{default:a(()=>[e(ue,{align:"right",class:"q-pt-none"},{default:a(()=>[ie(e(B,{flat:"",dense:"",label:"Cancel",color:"primary",class:"q-mr-sm"},null,512),[[pe]]),e(B,{dense:"",label:"Delete",color:"negative",onClick:v,class:"q-btn-rounded q-px-lg"})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};var ra=X(la,[["__scopeId","data-v-7969abbc"]]);const oa=s=>(re("data-v-656550b2"),s=s(),oe(),s),sa=oa(()=>l("div",{class:"text-h6"},"Create Warehouse Raw Materials",-1)),na={__name:"RawMaterialsCreateAll",setup(s){const Q=M(!1),y=async()=>{Q.value=!0},v=O(),n=ke(),u=I(()=>n.rawMaterials);console.log("rawMaterialsData",u.value);const R=se(),b=async()=>{if(ye.show(),await n.fetchRawMaterials(),!n.rawMaterials.length){G.create({type:"warning",message:"No raw materials found!"});return}ye.hide()},d=()=>{n.rawMaterials=[],Q.value=!1},V=async()=>{try{const k=u.value.map(m=>({raw_material_id:m.id,total_quantity:0,warehouse_id:v.params.warehouse_id}));await R.createMultipleWarehouseRawMaterials(k),console.log("materialsToSave",k),G.create({type:"positive",message:"All raw materials added to warehouse!"}),d()}catch(k){console.error("Error adding all raw materials:",k),G.create({type:"negative",message:"Failed to add all raw materials!"})}};return(k,m)=>(f(),$("div",null,[e(B,{class:"bg-gradient text-white q-pa-sm",icon:"add_circle",label:"Create All",onClick:y}),e(J,{modelValue:Q.value,"onUpdate:modelValue":m[0]||(m[0]=r=>Q.value=r)},{default:a(()=>[e(F,{style:{width:"700px","max-width":"80vw"}},{default:a(()=>[e(T,{class:"row items-center text-white bg-gradient"},{default:a(()=>[sa,e(me),ie(e(B,{icon:"close",flat:"",dense:"",round:""},null,512),[[pe]])]),_:1}),e(T,null,{default:a(()=>[e(B,{class:"bg-gradient text-white q-pa-sm",icon:"add_circle",label:"Fetch All",onClick:b})]),_:1}),e(T,null,{default:a(()=>[e(le,{dense:"",separator:"",class:"box"},{default:a(()=>[e(A,null,{default:a(()=>[e(S,null,{default:a(()=>[e(D,{class:"text-overline"},{default:a(()=>[w(" Code")]),_:1})]),_:1}),e(S,null,{default:a(()=>[e(D,{class:"text-overline"},{default:a(()=>[w(" Name")]),_:1})]),_:1}),e(S,null,{default:a(()=>[e(D,{class:"text-overline"},{default:a(()=>[w(" Category")]),_:1})]),_:1}),e(S,{side:""},{default:a(()=>[e(D,{class:"text-overline"},{default:a(()=>[w("Unit")]),_:1})]),_:1})]),_:1}),(f(!0),$(N,null,E(u.value,(r,i)=>(f(),P(A,{key:i},{default:a(()=>[e(S,null,{default:a(()=>[e(D,{class:"text-subtitle1"},{default:a(()=>[w(q(r.code),1)]),_:2},1024)]),_:2},1024),e(S,null,{default:a(()=>[e(D,{class:"text-subtitle1",align:"left"},{default:a(()=>[w(q(r.name),1)]),_:2},1024)]),_:2},1024),e(S,null,{default:a(()=>[e(D,{class:"text-subtitle1"},{default:a(()=>[w(q(r.category),1)]),_:2},1024)]),_:2},1024),e(S,{side:""},{default:a(()=>[e(D,{class:"text-subtitle1"},{default:a(()=>[w(q(r.unit),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}),e(ue,{class:"row q-ma-md",align:"right"},{default:a(()=>[e(B,{class:"glossy",color:"grey-9",label:"Dismiss",onClick:d}),e(B,{class:"glossy",color:"teal",label:"Create",onClick:V})]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}};var ia=X(na,[["__scopeId","data-v-656550b2"]]);const Ie=s=>(re("data-v-1ae236ac"),s=s(),oe(),s),ua={class:"row justify-between"},da={class:"row q-gutter-x-sm"},ca={key:0,class:"spinner-wrapper"},ma={key:1},_a={key:0,class:"data-error"},pa=Ie(()=>l("div",{class:"q-ml-sm text-h6"},"No data available",-1)),fa=Ie(()=>l("div",{class:"text-white"},"Edit Available Stocks",-1)),ga={class:"row justify-center q-gutter-x-md"},va={__name:"RawMaterialsTable",setup(s){const y=O().params.warehouse_id,v=se(),n=M(""),u=M(!0),R=M([]),b=M(!1),d=M({rowsPerPage:0}),V=I(()=>v.warehouseRawMaterials),k=I(()=>n.value?V.value.filter(t=>t.name.toLowerCase().includes(n.value.toLowerCase())):V.value);de(async()=>{console.log("props.warehouseId in onMounted:",y),y&&await m(y)});const m=async t=>{try{u.value=!0;const o=await v.fetchWarehouseRawMaterials(t);V.value=o,V.value.length||(b.value=!0),console.log("Warehouse Raw Materials",V.value)}catch(o){console.log("Error fetching branch product:",o),b.value=!0}finally{u.value=!1}};async function r(t,o){try{const _=await qe.put("/api/update-warehouse-rawMaterials/"+t.id,{total_quantity:parseInt(o)});if(_.status===200){const C=R.value.findIndex(U=>U.id==t.id);R.value[C]=parseInt(o),G.create({type:"positive",message:_.data.message,timout:1e3,position:"top"})}}catch(_){console.error("Error updating price:",_)}}ce(n,async t=>{u.value=!0,await new Promise(o=>setTimeout(o,1e3)),u.value=!1,b.value=k.value.length===0});const i=t=>{const o=t.total_quantity,_=t.raw_materials.unit;if(console.log("unit test",_),_==="Grams"&&o<1e3)return"bg-red";let C;return o>=1e3?C=o/1e3:C=o,C<5?C<=2?"bg-red":(C<=3,"bg-warning"):"bg-positive"},x=t=>{var U;const o=Number(t==null?void 0:t.total_quantity)||0,_=((U=t==null?void 0:t.raw_materials)==null?void 0:U.unit)||"units";console.log("totalQuantity:",o),console.log("unit:",_);const C=L=>{const z=Number(L);return Number.isInteger(z)?z:z.toFixed(2)};if(o>1e3){const L=o/1e3;if(L>=25){const z=L/25;return`${C(z)} sacks`}return`${C(L)} kilos`}return`${C(o)} ${_}`},g=[{name:"code",label:"Raw Materials Code",align:"center",field:t=>{var o,_;return(_=(o=t==null?void 0:t.raw_materials)==null?void 0:o.code)!=null?_:"No Code"},format:t=>`${t}`,sortable:!0},{name:"name",label:"Raw Materials Name",align:"center",field:t=>{var o,_;return(_=(o=t==null?void 0:t.raw_materials)==null?void 0:o.name)!=null?_:"No Code"},format:t=>`${t}`,sortable:!0},{name:"total_quantity",label:"Available Stocks",align:"center",field:"total_quantity",sortable:!0},{name:"action",label:"Action",align:"center",sortable:!0}];return(t,o)=>(f(),$(N,null,[l("div",ua,[l("div",null,[e(W,{class:"q-pb-lg q-pl-md",modelValue:n.value,"onUpdate:modelValue":o[0]||(o[0]=_=>n.value=_),outlined:"",placeholder:"Search",debounce:"1000",style:{width:"450px","max-width":"5000px","min-width":"100px"},flat:"",dense:"",rounded:""},{append:a(()=>[e(K,{name:"search"})]),_:1},8,["modelValue"])]),l("div",da,[l("div",null,[e(ea)]),l("div",null,[e(ia)])])]),u.value?(f(),$("div",ca,[e(Le,{size:"50px",color:"primary"})])):(f(),$("div",ma,[k.value.length===0?(f(),$("div",_a,[e(K,{name:"warning",color:"warning",size:"4em"}),pa])):(f(),P(_e,{key:1,class:"table-container sticky-header",filter:n.value,"virtual-scroll-sticky-size-start":48,flat:"",columns:g,rows:k.value,"row-key":"name","virtual-scroll":"",pagination:d.value,"onUpdate:pagination":o[1]||(o[1]=_=>d.value=_),"rows-per-page-options":[0],"hide-bottom":"",style:{height:"340px"}},{"body-cell-total_quantity":a(_=>[e(H,{props:_},{default:a(()=>[e(j,{square:"",class:xe(["text-white cursor-pointer",i(_.row)])},{default:a(()=>[w(q(x(_.row))+" ",1),e(Me,{class:"bg-blue-grey-8",offset:[10,10]},{default:a(()=>[fa]),_:1}),e(ze,{"onUpdate:modelValue":[C=>r(_.row,C),C=>_.row.total_quantity=C],modelValue:_.row.total_quantity,"auto-save":""},{default:a(C=>[e(W,{modelValue:C.value,"onUpdate:modelValue":U=>C.value=U,dense:"",suffix:_.row.raw_materials.unit,mask:"########",autofocus:"",counter:"",onKeyup:Ne(C.set,["enter"])},null,8,["modelValue","onUpdate:modelValue","suffix","onKeyup"])]),_:2},1032,["onUpdate:modelValue","modelValue"])]),_:2},1032,["class"])]),_:2},1032,["props"])]),"body-cell-action":a(_=>[e(H,{props:_},{default:a(()=>[l("div",ga,[e(ra,{delete:_},null,8,["delete"])])]),_:2},1032,["props"])]),_:1},8,["filter","rows","pagination"]))]))],64))}};var ha=X(va,[["__scopeId","data-v-1ae236ac"]]);const wa={class:"q-gutter-sm"},ya={class:"q-gutter-x-sm"},ba={__name:"WarehouseRawMaterialsPage",setup(s){return(Q,y)=>(f(),$("div",wa,[l("div",ya,[e(j,{label:"Good",class:"text-white",color:"positive"}),e(j,{label:"Warning",class:"text-white",color:"warning"}),e(j,{label:"Danger",class:"text-white",color:"red"})]),l("div",null,[e(ha)])]))}},xa={__name:"BranchRawMaterials",props:{branchReport:Object,getRawMaterialBadgeColor:Function,getBadgeCategoryColor:Function,formatTotalQuantity:Function,capitalizeFirstLetter:Function},setup(s){Qe(),console.log("branchReportss",s.branchReport),M(!1),M(!0);const y=M([{name:"raw_material",label:"Raw Materials Name",align:"left",field:v=>{var n;return((n=v.raw_material)==null?void 0:n.name)||"No record"}},{name:"code",label:"Code",align:"left",field:v=>{var n;return((n=v.raw_material)==null?void 0:n.code)||"No record"}},{name:"category",label:"Category",align:"left",field:v=>{var n;return((n=v.raw_material)==null?void 0:n.category)||"No record"}},{name:"total_quantity",label:"Available Stocks",align:"center",field:"total_quantity"}]);return(v,n)=>(f(),P(_e,{rows:s.branchReport.reports,columns:y.value,"row-key":"id",flat:"",bordered:"","virtual-scroll":"",pagination:v.pagination,"onUpdate:pagination":n[0]||(n[0]=u=>v.pagination=u),"rows-per-page-options":[0],"hide-bottom":"",class:"q-mt-md"},{"body-cell-total_quantity":a(u=>[e(H,{props:u},{default:a(()=>[e(j,{square:"",class:xe(["text-white cursor-pointer",s.getRawMaterialBadgeColor(u.row)])},{default:a(()=>[w(q(s.formatTotalQuantity(u.row)),1)]),_:2},1032,["class"])]),_:2},1032,["props"])]),"body-cell-category":a(u=>[e(H,{key:"name",props:u},{default:a(()=>[e(j,{color:s.getBadgeCategoryColor(u.row.raw_material.category)},{default:a(()=>[w(q(u.row.raw_material.category),1)]),_:2},1032,["color"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","pagination"]))}},Ra={class:"row justify-between"},Ca={class:"text-h6"},Ma=l("div",{class:"text-h6",align:"center"},"Premix",-1),ka=l("div",{class:"text-h6",align:"center"},"Ingredients List",-1),qa={class:"text-grey-7 q-mt-xs"},$a=l("div",{class:"text-h6 text-weight-regular"}," Do you want to receive the premix? ",-1),Va={__name:"TransactionView",props:{report:{type:Object,required:!0}},emits:["update-history"],setup(s,{emit:Q}){var fe,ge,ve,he,we;const y=Ke(),v=I(()=>y.user);console.log("userData in RawMaterialsTable:",v.value);const n=((ge=(fe=v.value)==null?void 0:fe.data)==null?void 0:ge.employee_id)||"";console.log("employeeId in PremixPage:",n);const u=Se();I(()=>u.branchPremix),$e();const R=M(!1),b=M(!1),d=s;console.log("props",d.report);const V=d.report.branch_premix.branch_id;console.log("branchId",V);const k=()=>{R.value=!0},m=p=>{const c=h=>h?h.charAt(0).toUpperCase()+h.slice(1).toLowerCase():"";return`${c(p.firstname||"No Firstname")} ${p.middlename?c(p.middlename).charAt(0)+".":""} ${c(p.lastname||"No Lastname")}`},r=[{label:"Pending",value:"pending"},{label:"Declined",value:"declined"},{label:"Confirmed",value:"confirmed"},{label:"Process",value:"process"},{label:"Completed",value:"completed"},{label:"To Deliver",value:"to deliver"},{label:"To Receive",value:"to receive"},{label:"Received",value:"received"}],i=I(()=>{var p;return(p=d.report.history)!=null&&p.length?r.filter(c=>d.report.history.some(h=>h.status===c.value)):[]}),x=p=>{const c=d.report.history.find(h=>h.status===p);return c?p==="received"?`Received by: ${m(c.employee)}`:p==="pending"?`Requested by: ${m(c.employee)}`:`Handled by: ${m(c.employee)}`:"No handler"},g=p=>{const c=Number(p);return isNaN(c)?"":(c%1===0,c.toString())},t=(p,c)=>{if(c==="Pcs")return`${p} pcs`;if(c==="Grams"){if(p>=1e3){let h=p/1e3;return`${h%1===0?h.toString():h.toString().replace(/^0+/,"")} kgs`}return`${p} g`}return`${p} ${c}`},o=((we=(he=(ve=d.report)==null?void 0:ve.branch_premix)==null?void 0:he.branch_recipe)==null?void 0:we.ingredient_groups)||"Undefined";console.log("ingrdientsData",o);const _=I(()=>o.map(p=>{const c=parseFloat(p.quantity)*parseFloat(d.report.quantity);return{...p,totalQuantity:c,formattedQuantity:t(c,p.ingredient.unit)}}));console.log("report to proceed",d.report);const C=I(()=>{var p,c;return((c=(p=d.report.history)==null?void 0:p[d.report.history.length-1])==null?void 0:c.status)||null});console.log("lastStatus",C.value);const U=I(()=>i.value.findIndex(p=>p.value===C.value)+1),L=p=>{var c;return(c=d.report.history)==null?void 0:c.some(h=>h.status===p)},z=p=>({pending:"warning",declined:"red-6",confirmed:"green",process:"primary",completed:"dark","to deliver":"brown-9","to receive":"amber-10",received:"secondary"})[p]||"grey",Be=async()=>{const p={request_premix_id:d.report.id,branch_premix_id:d.report.branch_premix_id,branch_id:d.report.branch_premix.branch_id,employee_id:n,status:"receive",notes:"Received Premix",quantity:d.report.quantity,warehouse_id:d.report.warehouse_id,ingredients:_.value.map(c=>({ingredients_id:c.ingredient.id,total_quantity:c.totalQuantity,unit:c.ingredient.unit}))};console.log("payload",p),await u.receivePremix(p),await u.fetchRequestBranchPremix(V),R.value=!1};return(p,c)=>(f(),$(N,null,[l("div",null,[e(B,{color:"accent",icon:"visibility",size:"md",flat:"",round:"",dense:"",onClick:k})]),e(J,{modelValue:R.value,"onUpdate:modelValue":c[2]||(c[2]=h=>R.value=h)},{default:a(()=>[e(F,{style:{width:"700px","max-width":"80vw"}},{default:a(()=>[e(T,null,{default:a(()=>[l("div",Ra,[l("div",Ca,q(s.report.name),1),e(B,{class:"close-btn",color:"grey-8",flat:"",round:"",dense:"",icon:"close",onClick:c[0]||(c[0]=h=>R.value=!1)})])]),_:1}),e(T,null,{default:a(()=>[l("div",null,"Baker: "+q(m(s.report.employee)),1),l("div",null," Branch: "+q(s.report.branch_premix.branch_recipe.branch.name),1),l("div",null,[w(" Status: "),e(j,{color:z(s.report.status),outlined:""},{default:a(()=>[w(q(s.report.status),1)]),_:1},8,["color"])])]),_:1}),e(T,{class:"q-gutter-y-md"},{default:a(()=>[l("div",null,[Ma,e(le,{dense:"",separator:"",class:"box"},{default:a(()=>[e(A,null,{default:a(()=>[e(S,null,{default:a(()=>[e(D,{class:"text-overline"},{default:a(()=>[w("Premix Name")]),_:1})]),_:1}),e(S,{side:""},{default:a(()=>[e(D,{class:"text-overline"},{default:a(()=>[w("Request Quantity / kgs")]),_:1})]),_:1})]),_:1}),e(A,null,{default:a(()=>[e(S,null,{default:a(()=>[e(D,{class:"text-h6"},{default:a(()=>[w(q(s.report.name),1)]),_:1})]),_:1}),e(S,{side:""},{default:a(()=>[e(D,{class:"text-h6"},{default:a(()=>[w(q(g(s.report.quantity)),1)]),_:1})]),_:1})]),_:1})]),_:1})]),l("div",null,[ka,e(le,{dense:"",separator:"",class:"box"},{default:a(()=>[e(A,null,{default:a(()=>[e(S,null,{default:a(()=>[e(D,{class:"text-overline"},{default:a(()=>[w(" Code")]),_:1})]),_:1}),e(S,null,{default:a(()=>[e(D,{class:"text-overline"},{default:a(()=>[w(" Name")]),_:1})]),_:1}),e(S,{side:""},{default:a(()=>[e(D,{class:"text-overline"},{default:a(()=>[w("Quantity")]),_:1})]),_:1})]),_:1}),(f(!0),$(N,null,E(ee(o),(h,Y)=>(f(),P(A,{key:Y},{default:a(()=>[e(S,null,{default:a(()=>[e(D,{class:"text-subtitle1"},{default:a(()=>[w(q(h.ingredient.code),1)]),_:2},1024)]),_:2},1024),e(S,null,{default:a(()=>[e(D,{class:"text-subtitle1",align:"left"},{default:a(()=>[w(q(h.ingredient.name),1)]),_:2},1024)]),_:2},1024),e(S,{side:""},{default:a(()=>[e(D,{class:"text-subtitle1"},{default:a(()=>[w(q(t(h.quantity*s.report.quantity,h.ingredient.unit)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})])]),_:1}),e(Ae,{modelValue:U.value,"onUpdate:modelValue":c[1]||(c[1]=h=>U.value=h),animated:"",class:"q-pa-lg"},{default:a(()=>[(f(!0),$(N,null,E(i.value,(h,Y)=>(f(),P(je,{key:Y,name:Y+1,title:h.label,color:z(h.value),done:L(h.value),icon:L(h.value)?"check":"radio_button_unchecked",class:"custom-step"},{default:a(()=>[l("div",qa,q(x(h.value)),1)]),_:2},1032,["name","title","color","done","icon"]))),128))]),_:1},8,["modelValue"]),C.value==="to receive"?(f(),P(T,{key:0,class:"text-center q-gutter-md"},{default:a(()=>[$a,e(B,{color:"amber-10",label:"Yes",icon:"check",onClick:Be,loading:b.value},null,8,["loading"])]),_:1})):be("",!0)]),_:1})]),_:1},8,["modelValue"])],64))}},Qa={__name:"BranchTransaction",props:{branchId:Object},setup(s){const Q=O();I(()=>Q.params.warehouse_id||null);const y=Se(),v=I(()=>y.branchPremix);console.log("premixDatas",v.value);const n=M(""),u=M(!0),b=s.branchId;de(async()=>{b&&await d(),console.log("premixdatas",v.value)});const d=async()=>{await y.fetchRequestBranchPremix(b)};ce(n,()=>{u.value=!0,setTimeout(()=>{u.value=!1})});const V=i=>We.formatDate(i,"MMM D, YYYY - hh:mm A"),k=i=>i.charAt(0).toUpperCase()+i.slice(1).toLowerCase(),m=i=>{switch(i){case"pending":return"warning";case"declined":return"red-6";case"confirmed":return"green";case"process":return"primary";case"completed":return"dark";case"to deliver":return"brown-9";case"to receive":return"amber-10";case"received":return"secondary";default:return"grey"}},r=[{name:"name",label:"Transactions Name",align:"left",field:i=>i.name,format:i=>`${i}`,sortable:!0},{name:"date",align:"center",label:"Created Date",field:"created_at",format:i=>V(i),sortable:!0},{name:"updated_at",align:"center",label:"Updated Date",field:"updated_at",format:i=>V(i),sortable:!0},{name:"status",align:"center",label:"Status",field:"status",sortable:!0},{name:"view",align:"right",label:"View",field:"view",sortable:!0}];return(i,x)=>(f(),$(N,null,[l("div",null,[e(W,{rounded:"",outlined:"",dense:"",debounce:"300",modelValue:n.value,"onUpdate:modelValue":x[0]||(x[0]=g=>n.value=g),placeholder:"Search",style:{width:"500px","max-width":"1500px","min-width":"100px"}},{append:a(()=>[u.value?(f(),P(K,{key:1,thickness:2,color:"teal",size:"1em"})):(f(),P(K,{key:0,name:"search"}))]),_:1},8,["modelValue"])]),l("div",null,[e(_e,{filter:n.value,flat:"",columns:r,rows:v.value,"row-key":"name"},{"body-cell-status":a(g=>[e(H,{props:g},{default:a(()=>[e(j,{outlined:"",color:m(g.row.status)},{default:a(()=>[w(q(k(g.row.status)),1)]),_:2},1032,["color"])]),_:2},1032,["props"])]),"body-cell-view":a(g=>[e(H,{props:g},{default:a(()=>[l("div",null,[e(Va,{report:g.row,onUpdateHistory:i.updateReportHistory},null,8,["report","onUpdateHistory"])])]),_:2},1032,["props"])]),_:1},8,["filter","rows"])])],64))}},Sa={class:"row justify-between"},Da={class:"text-h6"},Ia={__name:"DialogPage",props:{branchReport:Object,capitalizeFirstLetter:Function,getRawMaterialBadgeColor:Function,getBadgeCategoryColor:Function,formatTotalQuantity:Function},setup(s){const{dialogRef:Q,onDialogHide:y,onDialogOK:v,onDialogCancel:n}=Qe(),R=s.branchReport.branch_id,b=M("branchRawMaterials"),d=M(!1),V=M(!0);return(k,m)=>(f(),P(J,{ref_key:"dialogRef",ref:Q,onHide:ee(y),modelValue:d.value,"onUpdate:modelValue":m[2]||(m[2]=r=>d.value=r),maximized:V.value,"transition-show":"slide-up","transition-hide":"slide-down"},{default:a(()=>[e(F,null,{default:a(()=>[e(T,null,{default:a(()=>[l("div",Sa,[l("div",Da,q(s.capitalizeFirstLetter(s.branchReport.branch_name)),1),l("div",null,[e(B,{round:"",dense:"",flat:"",icon:"close",onClick:ee(n)},null,8,["onClick"])])]),l("div",null,[e(Re,{modelValue:b.value,"onUpdate:modelValue":m[0]||(m[0]=r=>b.value=r),align:"justify","narrow-indicator":"",class:"q-mb-lg"},{default:a(()=>[e(ae,{class:"text-purple",name:"branchRawMaterials",label:"Branch Raw Materials"}),e(ae,{class:"text-orange",name:"branchPremixTransactions",label:"Branch Premix Transactions"})]),_:1},8,["modelValue"]),l("div",null,[e(Ce,{modelValue:b.value,"onUpdate:modelValue":m[1]||(m[1]=r=>b.value=r),animated:"","transition-prev":"scale","transition-next":"scale"},{default:a(()=>[e(te,{name:"branchRawMaterials"},{default:a(()=>[e(xa,{branchReport:s.branchReport,getRawMaterialBadgeColor:s.getRawMaterialBadgeColor,getBadgeCategoryColor:s.getBadgeCategoryColor,formatTotalQuantity:s.formatTotalQuantity,capitalizeFirstLetter:s.capitalizeFirstLetter},null,8,["branchReport","getRawMaterialBadgeColor","getBadgeCategoryColor","formatTotalQuantity","capitalizeFirstLetter"])]),_:1}),e(te,{name:"branchPremixTransactions"},{default:a(()=>[e(Qa,{branchId:ee(R)},null,8,["branchId"])]),_:1})]),_:1},8,["modelValue"])])])]),_:1})]),_:1})]),_:1},8,["onHide","modelValue","maximized"]))}},Ba={class:"q-pa-md elegant-container"},Ta={key:0,class:"skeleton-wrapper row q-col-gutter-md"},Pa={key:1,class:"data-error"},Na=l("div",null,"No data available",-1),Ua={key:2,class:"q-pa-md row q-col-gutter-md"},Fa=l("img",{src:"https://cdn.quasar.dev/img/mountains.jpg"},null,-1),La={class:"q-mt-lg"},za={class:"text-h6 text-weight-medium elegant-name text-capitalize"},Wa={__name:"BranchCard",props:["branchRawMaterialsReport"],setup(s){const Q=O(),y=Ve(),v=$e(),n=I(()=>y.warehouseBranchReports),u=M(!1),R=I(()=>Q.params.warehouse_id||null),b=M(!1),d=i=>{v.dialog({component:Ia,componentProps:{branchReport:i,getRawMaterialBadgeColor:V,getBadgeCategoryColor:m,formatTotalQuantity:r,capitalizeFirstLetter:k}})},V=i=>{const x=i.quantity;if(i.raw_material.unit==="Grams"&&x<1e3)return"bg-red";let t;return x>=1e3?t=x/1e3:t=x,t<5?t<=2?"bg-red":(t<=3,"bg-warning"):"bg-positive"},k=i=>i?i.split(" ").map(x=>x.charAt(0).toUpperCase()+x.slice(1).toLowerCase()).join(" "):"",m=i=>{switch(i){case"Ingredients":return"teal";case"Packaging Materials":return"brown-6";default:return"grey"}},r=i=>{const x=i.quantity,g=i.raw_material.unit;if(x>1e3){const t=(x/1e3).toFixed(2);return t.endsWith(".00")?`${Math.round(x/1e3)} kilos`:`${t} kilos`}else return x>1?`${x} ${g}`:`${x} ${g}`};return ce(R,async i=>{if(i)try{u.value=!0,await y.fetchWarehouseByBranchID(i),b.value=n.value.length===0}catch(x){console.error("Error fetching warehouse data:",x),b.value=!0}finally{u.value=!1}},{immediate:!0}),(i,x)=>(f(),$("div",Ba,[u.value?(f(),$("div",Ta,[(f(),$(N,null,E(8,g=>l("div",{class:"col-xs-12 col-sm-6 col-md-4 col-lg-3",key:g},[e(F,{class:"user-card skeleton-card"},{default:a(()=>[e(ne,{height:"200px",class:"q-mb-md"}),e(T,{class:"text-center"},{default:a(()=>[e(ne,{type:"text",width:"60%",class:"q-mt-lg"}),e(ne,{type:"text",width:"40%",class:"q-mt-sm"})]),_:1})]),_:1})])),64))])):b.value?(f(),$("div",Pa,[e(K,{name:"error",size:"50px",color:"negative"}),Na])):(f(),$("div",Ua,[(f(!0),$(N,null,E(n.value,g=>(f(),$("div",{key:g.branch_id,class:"col-xs-12 col-sm-6 col-md-4 col-lg-3"},[e(F,{class:"user-card",onClick:t=>d(g)},{default:a(()=>[Fa,e(T,{class:"text-center"},{default:a(()=>[l("div",La,[l("div",za,q(k(g.branch_name)),1)])]),_:2},1024)]),_:2},1032,["onClick"])]))),128))]))]))}};const Aa={class:"elegant-container q-gutter-md"},ja={class:"text-h6 row justify-between"},Ka={class:"q-gutter-sm"},Ea={class:"tab-container"},Ha={__name:"WarehouseIdPage",setup(s){const Q=O(),y=Ue(),v=Ve(),n=M("");I(()=>v.warehouse);const u=I(()=>Q.params.warehouse_id||"Unknown Warehouse"),R=M("warehouseRawMaterials"),b=async m=>(await qe.get(`/api/warehouse/${m}`)).data,d=async()=>{try{const m=await b(u.value);m&&m.name?n.value=m.name:console.error("Warehouse name data is missing",m)}catch(m){console.error("Error fetching warehouse data:",m)}};de(()=>{d()});const V=m=>m?m.split(" ").map(r=>r.charAt(0).toUpperCase()+r.slice(1).toLowerCase()).join(" "):"",k=()=>{Loading.show(),y.push("/admin/warehouse").finally(()=>{Loading.hide()})};return(m,r)=>(f(),P(Fe,{padding:""},{default:a(()=>[l("div",Aa,[l("div",ja,[l("div",null,[e(B,{outline:"",flat:"",icon:"arrow_back",to:"/admin/warehouse",onClick:k}),e(me)]),l("div",null,[e(K,{name:"factory"}),w(" "+q(V(n.value)),1)])]),l("div",Ka,[l("div",Ea,[e(Re,{modelValue:R.value,"onUpdate:modelValue":r[0]||(r[0]=i=>R.value=i),dense:"",class:"bg-grey-2 text-grey-7 tabs-as-cards","active-color":"red-6","indicator-color":"transparent",align:"justify"},{default:a(()=>[e(ae,{name:"warehouseRawMaterials",label:"Warehouse Raw Materials"}),e(ae,{name:"branchRawMaterials",label:"Branch Raw Materials"})]),_:1},8,["modelValue"])]),e(F,{class:"q-mt-sm"},{default:a(()=>[e(Ce,{modelValue:R.value,"onUpdate:modelValue":r[1]||(r[1]=i=>R.value=i),animated:""},{default:a(()=>[e(te,{name:"warehouseRawMaterials"},{default:a(()=>[e(ba)]),_:1}),e(te,{name:"branchRawMaterials"},{default:a(()=>[e(Wa)]),_:1})]),_:1},8,["modelValue"])]),_:1})])])]),_:1}))}};var Qt=X(Ha,[["__scopeId","data-v-560de15d"]]);export{Qt as default};
