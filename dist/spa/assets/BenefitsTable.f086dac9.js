import{b as ne,Q as U,a as ie}from"./QTable.c8349ac7.js";import{Q as re}from"./QTr.d4a591cc.js";import{Q as I}from"./QTooltip.7d3fbf11.js";import{c as X,r as x,t as de,o as C,a3 as F,f as l,M as _,w as s,Q as ue,I as j,ae as Y,J as a,e as B,a0 as c,bd as G,a4 as Z,a5 as ee,$ as f,a1 as J,L as R,K as v,aJ as me,a2 as ce,O as le,R as te,z as pe,u as fe,bB as _e,bb as $,N as h}from"./index.a77a9bca.js";import{Q as H}from"./QPopupEdit.9eed8aca.js";import{Q as be}from"./QSpinnerIos.689df5a9.js";import{Q as ve}from"./QInnerLoading.ea0a8060.js";import{Q as ye}from"./QPage.ee6adeca.js";import{Q as he}from"./QSpace.d7a78df8.js";import{a as O,b as W}from"./QMenu.48995790.js";import{Q as ge}from"./QList.80cecbf1.js";import{Q as we}from"./QScrollArea.511bb82f.js";import{C as xe}from"./ClosePopup.b255fe3d.js";import{u as ae}from"./benefit.592ec222.js";import{u as Se}from"./employee.a2598ffe.js";import{_ as Ve,a as Ce}from"./TableFilter.68997b11.js";import{_ as oe}from"./plugin-vue_export-helper.21dcd24c.js";import{api as P}from"./axios.0b8ebdc6.js";import"./QVirtualScroll.8f5b7613.js";import"./use-virtual-scroll.41ae299d.js";import"./rtl.276c3f1b.js";import"./QSelect.aebd2263.js";import"./QChip.aea224e0.js";import"./selection.3e1c4973.js";import"./position-engine.56f31403.js";import"./QResizeObserver.cb9c00ec.js";import"./QScrollObserver.7f874144.js";import"./TouchPan.70f28007.js";import"./touch.9135741d.js";const z=g=>(le("data-v-0f599266"),g=g(),te(),g),qe=z(()=>a("div",{class:"text-h6 text-weight-bold"},"\u{1F4B0} Add Employee Benefits",-1)),Ne={style:{position:"relative"}},ke={key:0,class:"dropdown-list"},Ue={class:"row q-col-gutter-md q-mt-lg"},Ie={class:"col-12 col-sm-6"},$e=z(()=>a("div",{class:"text-subtitle2 text-grey-7 q-mb-xs"}," Employee Name: ",-1)),He={class:"text-body1 text-weight-medium"},Pe={class:"col-12 col-sm-6"},Ee=z(()=>a("div",{class:"text-subtitle2 text-grey-7 q-mb-xs"},"Position:",-1)),Qe={class:"text-body1 text-weight-medium"},De={class:"text-subtitle1 text-weight-bold text-primary q-mb-md"},Fe={class:"row q-col-gutter-md"},Be={class:"col-12 col-sm-6"},Me={class:"col-12 col-sm-6"},Ke={class:"text-subtitle1 text-weight-bold text-primary q-mb-md"},Ae={class:"row q-col-gutter-md"},Te={class:"col-12 col-sm-6"},Le={class:"col-12 col-sm-6"},je={class:"text-subtitle1 text-weight-bold text-primary q-mb-md"},Re={class:"row q-col-gutter-md"},ze={class:"col-12 col-sm-6"},Ge={class:"col-12 col-sm-6"},Je={__name:"AddDeduction",emits:["created"],setup(g,{emit:D}){const Q=Se(),q=X(()=>Q.employees),w=ae(),b=x(""),m=x(!1),N=x(!1),S=x(!1),M=()=>{S.value=!0},K=D,A=async()=>{b.value.trim()&&(N.value=!0,await Q.searchEmployee(b.value),N.value=!1)},T=y=>{i.employee_id=y.id,i.employee_name=`${y.firstname} ${y.middlename?y.middlename.charAt(0)+".":""} ${y.lastname}`,i.employee_position=y.position,b.value=""},i=de({employee_id:"",employee_name:"",employee_position:"",sss_number:"",hdmf_number:"",phic_number:"",sss:"",hdmf:"",phic:""}),L=()=>{i.employee_id="",i.employee_name="",i.employee_position="",i.sss_number="",i.hdmf_number="",i.phic_number="",i.sss="",i.hdmf="",i.phic=""},k=async()=>{m.value=!0;try{await w.createEmployeeBenefit(i),K("created"),S.value=!1,L()}catch(y){console.error("Error saving deductions:",y)}finally{m.value=!1}};return(y,u)=>(C(),F("div",null,[l(_,{padding:"sm md",label:"Add Employee Benefits",icon:"add_circle",size:"md",class:"q-px-lg q-py-md text-white button-gradient",onClick:M}),l(ce,{modelValue:S.value,"onUpdate:modelValue":u[7]||(u[7]=d=>S.value=d),persistent:"",position:"right","backdrop-filter":"blur(4px) saturate(150%)",class:"full-height-dialog"},{default:s(()=>[l(ue,{class:"dialog-card"},{default:s(()=>[l(we,{class:"fit"},{default:s(()=>[l(j,{class:"dialog-header row items-center no-wrap"},{default:s(()=>[qe,l(he),Y(l(_,{icon:"close",flat:"",dense:"",round:"",class:"text-white"},null,512),[[xe]])]),_:1}),l(j,{class:"q-pt-lg q-pb-md q-px-lg"},{default:s(()=>[a("div",Ne,[l(Ve,{modelValue:b.value,"onUpdate:modelValue":[u[0]||(u[0]=d=>b.value=d),A],"search-loading":N.value},null,8,["modelValue","search-loading"]),b.value?(C(),F("div",ke,[l(ge,{separator:""},{default:s(()=>{var d;return[(d=q.value)!=null&&d.length?G("",!0):(C(),B(O,{key:0},{default:s(()=>[l(W,{class:"text-grey-7"},{default:s(()=>[c("No employee found.")]),_:1})]),_:1})),(C(!0),F(Z,null,ee(q.value,V=>(C(),B(O,{key:V.id,clickable:"",onClick:o=>T(V)},{default:s(()=>[l(W,null,{default:s(()=>[c(f(`${V.firstname} ${V.middlename?V.middlename.charAt(0)+".":""} ${V.lastname}`),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]}),_:1})])):G("",!0)]),a("div",Ue,[a("div",Ie,[$e,a("div",He,f(i.employee_name||"----------"),1)]),a("div",Pe,[Ee,a("div",Qe,f(i.employee_position||"----------"),1)])])]),_:1}),l(J,{inset:"",class:"q-mx-lg q-my-md"}),l(j,{class:"q-gutter-y-lg q-px-lg"},{default:s(()=>[a("div",null,[a("div",De,[l(R,{name:"paid",class:"q-mr-xs"}),c(" SSS (Social Security System) ")]),a("div",Fe,[a("div",Be,[l(v,{dense:"",outlined:"",modelValue:i.sss_number,"onUpdate:modelValue":u[1]||(u[1]=d=>i.sss_number=d),label:"SSS Number",mask:"##-#######-##",placeholder:"00-0000000-00",clearable:""},null,8,["modelValue"])]),a("div",Me,[l(v,{dense:"",outlined:"",modelValue:i.sss,"onUpdate:modelValue":u[2]||(u[2]=d=>i.sss=d),label:"Amount",type:"number",prefix:"\u20B1",clearable:""},null,8,["modelValue"])])])]),a("div",null,[a("div",Ke,[l(R,{name:"home",class:"q-mr-xs"}),c(" HDMF (Pag-IBIG Fund) ")]),a("div",Ae,[a("div",Te,[l(v,{outlined:"",dense:"",modelValue:i.hdmf_number,"onUpdate:modelValue":u[3]||(u[3]=d=>i.hdmf_number=d),label:"HDMF Number",mask:"####-####-####",placeholder:"0000-0000-0000",clearable:""},null,8,["modelValue"])]),a("div",Le,[l(v,{dense:"",modelValue:i.hdmf,"onUpdate:modelValue":u[4]||(u[4]=d=>i.hdmf=d),outlined:"",label:"Amount",type:"number",prefix:"\u20B1",clearable:""},null,8,["modelValue"])])])]),a("div",null,[a("div",je,[l(R,{name:"local_hospital",class:"q-mr-xs"}),c(" PHIC (PhilHealth) ")]),a("div",Re,[a("div",ze,[l(v,{dense:"",modelValue:i.phic_number,"onUpdate:modelValue":u[5]||(u[5]=d=>i.phic_number=d),outlined:"",mask:"##-#########-##",placeholder:"00-00000000-00",label:"PHIC Number",clearable:""},null,8,["modelValue"])]),a("div",Ge,[l(v,{dense:"",modelValue:i.phic,"onUpdate:modelValue":u[6]||(u[6]=d=>i.phic=d),outlined:"",label:"Amount",type:"number",prefix:"\u20B1",clearable:""},null,8,["modelValue"])])])])]),_:1}),l(J,{inset:"",class:"q-mx-lg q-my-md"}),l(me,{align:"right",class:"q-px-lg q-pb-lg"},{default:s(()=>[l(_,{size:"md",padding:"sm lg",label:"Save","icon-right":"send",class:"text-white button-gradient",onClick:k,loading:m.value},null,8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}};var Oe=oe(Je,[["__scopeId","data-v-0f599266"]]);const E=g=>(le("data-v-201f1828"),g=g(),te(),g),We={class:"row justify-between q-mb-md",align:"right"},Xe={class:"row q-gutter-md"},Ye={class:"q-pa-md",style:{"min-width":"300px","max-width":"400px"}},Ze=E(()=>a("div",{class:"text-h6 text-primary text-center q-mb-sm"}," Edit SSS Number ",-1)),el={class:"text-subtitle2 q-mb-md"},ll={class:"row justify-end q-mt-md"},tl={class:"q-pa-md",style:{"min-width":"300px","max-width":"400px"}},al=E(()=>a("div",{class:"text-h6 text-primary text-center q-mb-sm"}," Edit SSS ",-1)),ol={class:"text-subtitle2 q-mb-md"},sl={class:"row justify-end q-mt-md"},nl={class:"q-pa-md",style:{"min-width":"300px","max-width":"400px"}},il=E(()=>a("div",{class:"text-h6 text-primary text-center q-mb-sm"}," Edit HDMF Number ",-1)),rl={class:"text-subtitle2 q-mb-md"},dl={class:"row justify-end q-mt-md"},ul={class:"q-pa-md",style:{"min-width":"300px","max-width":"400px"}},ml=E(()=>a("div",{class:"text-h6 text-primary text-center q-mb-xs"}," Edit HDMF ",-1)),cl={class:"text-subtitle2 q-mb-sm"},pl={class:"row justify-end q-mt-md"},fl={class:"q-pa-md",style:{"min-width":"300px","max-width":"400px"}},_l=E(()=>a("div",{class:"text-h6 text-primary text-center q-md-sm"}," Edit HDMF Number ",-1)),bl={class:"text-subtitle2 q-mb-md"},vl={class:"row justify-end q-mt-md"},yl={class:"q-pa-md",style:{"min-width":"300px","max-width":"400px"}},hl=E(()=>a("div",{class:"text-h6 text-primary text-center q-mb-xs"}," Edit PHIC ",-1)),gl={class:"text-subtitle2 q-mb-sm"},wl={class:"row justify-end q-mt-md"},xl={__name:"BenefitsTable",setup(g){const D=ae(),Q=X(()=>D.benefits),q=x([]),w=x({page:1,rowsPerPage:0,rowsNumber:0}),b=x(""),m=x(!1),N=x(!1);function S(o){if(o==null||o==="")return"";const n=parseFloat(o);return isNaN(n)?"":Number.isInteger(n)?String(parseInt(n)):String(n)}async function M(o,n){console.log("Updating SSS Number for",o,"to",n);try{m.value=!0,await P.put("/api/update-employee-sss-number-benefit/"+o.id,{sss_number:n}),h.create({message:"SSS Number updated successfully",color:"positive",position:"top",timeout:2e3})}catch(p){console.log(p),h.create({message:"Error updating SSS Number",color:"negative",position:"top",timeout:2e3})}finally{m.value=!1}}async function K(o,n){console.log("Updating SSS for",o,"to",n);try{m.value=!0,await P.put("/api/update-employee-sss-benefit/"+o.id,{sss:n}),h.create({message:"SSS updated successfully",color:"positive",position:"top",timeout:2e3})}catch(p){console.error("Error updating SSS:",p),h.create({message:"Error updating SSS",color:"negative",position:"top",timeout:2e3})}finally{m.value=!1}}async function A(o,n){console.log("Updating HDMF Number for",o,"to",n);try{m.value=!0,await P.put("/api/update-employee-hdmf-number-benefit/"+o.id,{hdmf_number:n}),h.create({message:"HDMF Number updated successfully",color:"positive",position:"top",timeout:2e3})}catch(p){console.error(p),h.create({message:"Error updating HDMF Number",color:"negative",position:"top",timeout:2e3})}finally{m.value=!1}}async function T(o,n){console.log("Updating HDMF for",o,"to",n);try{m.value=!0,await P.put("/api/update-employee-hdmf-benefit/"+o.id,{hdmf:n}),h.create({message:"HDMF updated successfully",color:"positive",position:"top",timeout:2e3})}catch(p){console.error("ERROR updating HDMF:",p)}finally{m.value=!1}}async function i(o,n){console.log("Updating PHIC Number for",o,"to",n);try{m.value=!0,await P.put("/api/update-employee-phic-number-benefit/"+o.id,{phic_number:n}),h.create({message:"PHIC Number updated successfully",color:"positive",position:"top",timeout:2e3})}catch(p){console.error(p),h.create({message:"Error updating PHIC Number",color:"negative",position:"top",timeout:2e3})}finally{m.value=!1}}async function L(o,n){console.log("Updating PHIC for",o,"to",n);try{m.value=!0,await P.put("/api/update-employee-phic-benefit/"+o.id,{phic:n}),h.create({message:" PHIC updated successfully",color:"positive",position:"top",timeout:2e3})}catch(p){console.error("Error updating PHIC:",p),h.create({message:"Error updating PHIC",color:"negative",position:"top",timeout:2e3})}finally{m.value=!1}}pe(async()=>{await k()});const k=async(o=1,n=7,p="")=>{try{m.value=!0,Q.value=await D.fetchEmployeeBenefit(o,n,p);const{data:t,current_page:e,per_page:r,total:se}=Q.value;q.value=t,console.log("employee benefit",q.value),w.value.page=e,w.value.rowsPerPage=r,w.value.rowsNumber=se,console.log("benefit",q.value)}catch(t){console.log("error fetching",t)}finally{m.value=!1}},y=o=>{console.log("handle benefits request",o),k(o.pagination.page,o.pagination.rowsPerPage,o.filter)};fe(b,async o=>{N.value=!0,await k(w.value.page,w.value.rowsPerPage,o),N.value=!1});const u=o=>{const n=r=>r?r.charAt(0).toUpperCase()+r.slice(1).toLowerCase():"",p=o.firstname?n(o.firstname):"No Firstname",t=o.middlename?n(o.middlename).charAt(0)+".":"",e=o.lastname?n(o.lastname):"No Lastname";return`${p} ${t} ${e}`.trim()},d=o=>new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(o),V=[{name:"name",required:!0,label:"Name",align:"left",field:o=>u(o.employee)},{name:"sss_number",label:"SSS Number",align:"center",field:o=>o.sss_number},{name:"sss",label:"Social Security System (SSS)",align:"center",field:o=>d(o.sss)},{name:"hdmf_number",label:"Pag-IBIG Number",align:"center",field:o=>o.hdmf_number},{name:"hdmf",label:"Pag-IBIG Fund (HDMF)",align:"center",field:o=>d(o.hdmf)},{name:"phic_number",label:"Phil - Health Number",align:"center",field:o=>o.phic_number},{name:"phic",label:"Phil - Health (PHIC)",align:"center",field:o=>d(o.phic)}];return(o,n)=>{const p=_e("mode");return C(),B(ye,{class:"q-my-md"},{default:s(()=>[a("div",We,[a("div",Xe,[a("div",null,[l(Oe,{onCreated:k})])]),l(Ce,{modelValue:b.value,"onUpdate:modelValue":[n[0]||(n[0]=t=>b.value=t),b.value]},null,8,["modelValue","onUpdate:modelValue"])]),l(ie,{rows:q.value,columns:V,"row-key":"name",pagination:w.value,"onUpdate:pagination":n[1]||(n[1]=t=>w.value=t),"rows-per-page-options":[5,7,10,0],onRequest:y,loading:m.value,filter:b.value},{header:s(t=>[l(re,{props:t,class:"gradient-header text-white text-weight-bold"},{default:s(()=>[(C(!0),F(Z,null,ee(t.cols,e=>(C(),B(ne,{key:e.name,props:t,class:"text-center text-subtitle2"},{default:s(()=>[c(f(e.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),"body-cell-sss_number":s(t=>[l(U,{props:t,class:"cursor-pointer"},{default:s(()=>[a("span",null,[c(f(t.row.sss_number?t.row.sss_number:" - - -")+" ",1),l(I,{class:"bg-blue-grey-8"},{default:s(()=>[c("Edit SSS Number")]),_:1})]),l(H,{"onUpdate:modelValue":[e=>M(t.row,e),e=>t.row.sss_number=e],modelValue:t.row.sss_number},{default:s(e=>[a("div",Ye,[Ze,a("div",el," Name: "+f(u(t.row.employee)),1),Y(l(v,{"model-value":e.value,"onUpdate:modelValue":r=>e.value=r,type:"text",mask:"##-#######-###",autofocus:"",counter:"",onKeyup:$(e.set,["enter"])},null,8,["model-value","onUpdate:modelValue","onKeyup"]),[[p,e.value]]),a("div",ll,[l(_,{flat:"",label:"Close",color:"primary",onClick:e.cancel},null,8,["onClick"]),l(_,{flat:"",label:"Save",color:"primary",onClick:e.set},null,8,["onClick"])])])]),_:2},1032,["onUpdate:modelValue","modelValue"])]),_:2},1032,["props"])]),"body-cell-sss":s(t=>[l(U,{props:t},{default:s(()=>[a("span",null,[c(f(t.row.sss?d(t.row.sss):" - - ")+" ",1),l(I,{class:"bg-blue-grey-8"},{default:s(()=>[c("Edit SSS")]),_:1})]),l(H,{"onUpdate:modelValue":[e=>K(t.row,e),e=>t.row.sss=e],modelValue:t.row.sss},{default:s(e=>[a("div",tl,[al,a("div",ol," Name: "+f(u(t.row.employee)),1),l(v,{modelValue:e.value,"onUpdate:modelValue":[r=>e.value=r,r=>e.value=r],"model-value":S(e.value),type:"text",autofocus:"",counter:"",onKeyup:$(e.set,["enter"])},null,8,["modelValue","onUpdate:modelValue","model-value","onKeyup"]),a("div",sl,[l(_,{flat:"",label:"Close",color:"primary",onClick:e.cancel},null,8,["onClick"]),l(_,{flat:"",label:"Save",color:"primary",onClick:e.set},null,8,["onClick"])])])]),_:2},1032,["onUpdate:modelValue","modelValue"])]),_:2},1032,["props"])]),"body-cell-hdmf_number":s(t=>[l(U,{props:t,class:"cursor-pointer"},{default:s(()=>[a("span",null,[c(f(t.row.hdmf_number?t.row.hdmf_number:" - - -")+" ",1),l(I,{class:"bg-blue-grey-8"},{default:s(()=>[c("Edit HDMF Number")]),_:1})]),l(H,{"onUpdate:modelValue":[e=>A(t.row,e),e=>t.row.hdmf_number=e],modelValue:t.row.hdmf_number},{default:s(e=>[a("div",nl,[il,a("div",rl," Name: "+f(u(t.row.employee)),1),l(v,{modelValue:e.value,"onUpdate:modelValue":[r=>e.value=r,r=>e.value=r],"model-value":e.value,type:"text",mask:"####-####-####",autofocus:"",counter:"",onKeyup:$(e.set,["enter"])},null,8,["modelValue","onUpdate:modelValue","model-value","onKeyup"]),a("div",dl,[l(_,{flat:"",label:"Close",color:"primary",onClick:e.cancel},null,8,["onClick"]),l(_,{flat:"",label:"Save",color:"primary",onClick:e.set},null,8,["onClick"])])])]),_:2},1032,["onUpdate:modelValue","modelValue"])]),_:2},1032,["props"])]),"body-cell-hdmf":s(t=>[l(U,{props:t,class:"cursor-pointer"},{default:s(()=>[a("span",null,[c(f(t.row.hdmf?d(t.row.hdmf):" - - -")+" ",1),l(I,{class:"bg-blue-grey-8"},{default:s(()=>[c("Edit HDMF")]),_:1})]),l(H,{"onUpdate:modelValue":[e=>T(t.row,e),e=>t.row.hdmf=e],modelValue:t.row.hdmf},{default:s(e=>[a("div",ul,[ml,a("div",cl," Name: "+f(u(t.row.employee)),1),l(v,{modelValue:e.value,"onUpdate:modelValue":[r=>e.value=r,r=>e.value=r],"model-value":S(e.value),type:"text",autofocus:"",counter:"",onKeyup:$(e.set,["enter"])},null,8,["modelValue","onUpdate:modelValue","model-value","onKeyup"]),a("div",pl,[l(_,{flat:"",label:"Close",color:"primary",onClick:e.cancel},null,8,["onClick"]),l(_,{flat:"",label:"Save",color:"primary",onClick:e.set},null,8,["onClick"])])])]),_:2},1032,["onUpdate:modelValue","modelValue"])]),_:2},1032,["props"])]),"body-cell-phic_number":s(t=>[l(U,{props:t,class:"cursor-pointer"},{default:s(()=>[a("span",null,[c(f(t.row.phic_number?t.row.phic_number:" - - -")+" ",1),l(I,{class:"bg-blue-grey-8"},{default:s(()=>[c("Edit PHIC Number")]),_:1})]),l(H,{"onUpdate:modelValue":[e=>i(t.row,e),e=>t.row.phic_number=e],modelValue:t.row.phic_number},{default:s(e=>[a("div",fl,[_l,a("div",bl," Name: "+f(u(t.row.employee)),1),l(v,{modelValue:e.value,"onUpdate:modelValue":r=>e.value=r,"model-value":e.value,"onValue:modelValue":r=>e.value=r,type:"text",mask:"##-#########-##",autofocus:"",counter:"",onKeyup:$(e.set,["enter"])},null,8,["modelValue","onUpdate:modelValue","model-value","onValue:modelValue","onKeyup"]),a("div",vl,[l(_,{flat:"",label:"Close",color:"primary",onClick:e.cancel},null,8,["onClick"]),l(_,{flat:"",label:"Save",color:"primary",onClick:e.set},null,8,["onClick"])])])]),_:2},1032,["onUpdate:modelValue","modelValue"])]),_:2},1032,["props"])]),"body-cell-phic":s(t=>[l(U,{props:t,class:"cursor-pointer"},{default:s(()=>[a("span",null,[c(f(t.row.phic?d(t.row.phic):" - - - ")+" ",1),l(I,{class:"bg-blue-grey-8"},{default:s(()=>[c("Edit PHIC")]),_:1})]),l(H,{"onUpdate:modelValue":[e=>L(t.row,e),e=>t.row.phic=e],modelValue:t.row.phic},{default:s(e=>[a("div",yl,[hl,a("div",gl," Name: "+f(u(t.row.employee)),1),l(v,{modelValue:e.value,"onUpdate:modelValue":[r=>e.value=r,r=>e.value=r],"model-value":S(e.value),type:"text",autofocus:"",counter:"",onKeyup:$(e.set,["enter"])},null,8,["modelValue","onUpdate:modelValue","model-value","onKeyup"]),a("div",wl,[l(_,{flat:"",label:"Close",color:"primary",onClick:e.cancel},null,8,["onClick"]),l(_,{flat:"",label:"Save",color:"primary",onClick:e.set},null,8,["onClick"])])])]),_:2},1032,["onUpdate:modelValue","modelValue"])]),_:2},1032,["props"])]),loading:s(()=>[l(ve,{showing:""},{default:s(()=>[l(be,{size:"50px",color:"grey-10"})]),_:1})]),_:1},8,["rows","pagination","loading","filter"])]),_:1})}}};var Yl=oe(xl,[["__scopeId","data-v-201f1828"]]);export{Yl as default};
