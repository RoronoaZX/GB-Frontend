import{r as u,c as h,u as D,z as I,o as n,a2 as w,J as c,f as o,w as s,e as x,L as $,bb as R,K as N,aJ as z,$ as Q,_ as F,bc as C,Q as P,I as y}from"./index.f9204663.js";import{Q as b}from"./QBadge.f90581b2.js";import{Q as L}from"./QChip.1e0b2b43.js";import{Q as j}from"./QTd.c919a918.js";import{Q as E}from"./QTable.bf0a912b.js";import{Q as G}from"./QBanner.6c8eff76.js";import{u as J}from"./baker-report.2071e6c1.js";import{_ as K}from"./plugin-vue_export-helper.21dcd24c.js";import"./QVirtualScroll.aec25fa2.js";import"./QList.9266f0ea.js";import"./use-virtual-scroll.6cb0d38e.js";import"./QSelect.7fad6eea.js";import"./QMenu.29311ca7.js";import"./selection.106a4db1.js";import"./axios.f9d7066b.js";const U={class:"q-gutter-md"},W={class:"table-container"},A={key:0,class:"loading-overlay row justify-center items-center"},H={key:1,class:"q-pa-md q-gutter-md row justify-center"},O={__name:"RawMaterialsTable",setup(q){var k,M;const f=u({rowsPerPage:0}),l=u(""),m=u(!1),d=u(!0),_=J(),g=((M=(k=h(()=>_.user).value)==null?void 0:k.employee)==null?void 0:M.branch_id)||"",i=h(()=>_.rawmaterials),p=u(!1);D(l,async t=>{m.value=!0,await new Promise(e=>setTimeout(e,1e3)),m.value=!1,p.value=!d.value&&v.value.length===0,console.log("Filtered Rows:",v.value)}),I(async()=>{console.log("props.branchId in onMounted:",g),g&&await B(g)});const B=async t=>{console.log("Fetching products for branch ID:",t);try{d.value=!0;const e=await _.fetchBranchRawMaterials(t);i.value=e,i.value.length||(p.value=!0),console.log("Branch Raw Materials",i.value)}catch(e){console.log("Error fetching branch product:",e),p.value=!0}finally{d.value=!1}},v=h(()=>{if(!l.value)return i.value;const t=l.value.toLowerCase();return i.value.filter(e=>e.ingredients.code.toLowerCase().includes(t))}),T=[{name:"code",label:"Code",align:"center",field:t=>{var e,a;return(a=(e=t==null?void 0:t.ingredients)==null?void 0:e.code)!=null?a:"No Code"},format:t=>`${t}`,sortable:!0},{name:"total_quantity",align:"center",label:"Available Stocks",field:"total_quantity",sortable:!0}],S=t=>{const e=t.total_quantity;if(t.ingredients.unit==="Grams"&&e<1e3)return"bg-red";let r;return e>=1e3?r=e/1e3:r=e,r<5?r<=2?"bg-red":(r<=3,"bg-warning"):"bg-positive"},V=t=>{const e=t.total_quantity,a=t.ingredients.unit;if(e>1e3){const r=(e/1e3).toFixed(2);return r.endsWith(".00")?`${Math.round(e/1e3)} kilos`:`${r} kilos`}else return e>1?`${e} ${a}`:`${e} ${a}`};return(t,e)=>(n(),w("div",U,[c("div",null,[o(N,{rounded:"",outlined:"",dense:"",debounce:"300",modelValue:l.value,"onUpdate:modelValue":e[0]||(e[0]=a=>l.value=a),placeholder:"Search",style:{width:"500px","max-width":"1500px","min-width":"100px"}},{append:s(()=>[m.value?(n(),x(R,{key:1})):(n(),x($,{key:0,name:"search"}))]),_:1},8,["modelValue"])]),c("div",W,[o(E,{class:"sticky-header",filter:l.value,"virtual-scroll-sticky-size-start":48,flat:"",style:{height:"350px"},columns:T,rows:v.value,"row-key":"name","virtual-scroll":"",pagination:f.value,"onUpdate:pagination":e[1]||(e[1]=a=>f.value=a),"rows-per-page-options":[0],"hide-bottom":""},{"body-cell-total_quantity":s(a=>[o(j,{props:a},{default:s(()=>[o(L,{square:"",class:z(["text-white",S(a.row)])},{default:s(()=>[Q(F(V(a.row)),1)]),_:2},1032,["class"])]),_:2},1032,["props"])]),_:1},8,["filter","rows","pagination"]),d.value?(n(),w("div",A,[o(R,{size:"50px"})])):C("",!0),p.value?(n(),w("div",H,[o(G,{class:"bg-grey-1",dense:""},{default:s(()=>[Q(" No data available ")]),_:1})])):C("",!0)])]))}};var X=K(O,[["__scopeId","data-v-763d3e0e"]]);const Y={class:"text-h6 text-white"},Z={class:"q-gutter-x-sm"},ge={__name:"RawMaterialsPage",setup(q){return(f,l)=>(n(),x(P,{flat:""},{default:s(()=>[o(y,{style:{"background-color":"#ef4444"}},{default:s(()=>[c("div",Y,[o($,{name:"fa-solid fa-layer-group"}),Q(" Raw Materials ")])]),_:1}),o(y,null,{default:s(()=>[c("div",Z,[o(b,{label:"Good",class:"text-white",color:"positive"}),o(b,{label:"Warning",class:"text-white",color:"warning"}),o(b,{label:"Danger",class:"text-white",color:"red"})])]),_:1}),o(y,null,{default:s(()=>[c("div",null,[o(X)])]),_:1})]),_:1}))}};export{ge as default};
