import{o as _,e as x,M as F,r as Q,a2 as h,f as e,w as t,Q as P,I as L,J as a,_ as n,$ as u,a0 as O,a3 as B,a4 as N,bc as S,a1 as E,O as J,R as G,c as T,u as H,z as W,L as K,bb as j,K as X}from"./index.e3af296d.js";import{_ as z}from"./plugin-vue_export-helper.21dcd24c.js";import{Q as Z}from"./QBadge.575f10e7.js";import{Q as U,a as ee}from"./QTable.37fbadea.js";import{Q as te}from"./QBanner.9f30e4ed.js";import{u as ae}from"./baker-report.6517220d.js";import{Q as se}from"./QChip.59ae3c76.js";import{b as p}from"./use-virtual-scroll.109b70f0.js";import{Q as Y,a as k,b as l}from"./QList.d6e9e111.js";import{q as A}from"./date.119c4063.js";import"./QVirtualScroll.e370624c.js";import"./QSelect.524dc2c5.js";import"./QMenu.8f5842ac.js";import"./selection.2d0cf300.js";import"./axios.a9f2bd60.js";const re={};function oe(s,C){return _(),x(F,{class:"q-pa-sm",color:"red-6",dense:"",elevated:"",icon:"add_circle",label:"Create Report",to:"/branch/baker/create_report"})}var le=z(re,[["render",oe]]);const m=s=>(J("data-v-7c798af2"),s=s(),G(),s),ne={class:"text-h6 text-weight-regular"},ie={class:"row justify-between"},ce={class:"section-content"},de={class:"row q-gutter-x-sm"},ue=m(()=>a("div",{class:"text-subtitle2"},"Date:",-1)),_e={class:"text-body1 text-weight-light"},pe={class:"row q-gutter-x-sm"},me=m(()=>a("div",{class:"text-subtitle2"},"Branch:",-1)),fe={class:"text-body1 text-weight-light"},ge={class:"row q-gutter-x-sm"},ve=m(()=>a("div",{class:"text-subtitle2"},"Baker:",-1)),he={class:"text-body1 text-weight-light"},be={class:"row q-gutter-x-sm"},xe=m(()=>a("div",{class:"text-subtitle2"},"Remarks:",-1)),ye={class:"text-body1 text-weight-light"},we={class:"row q-mt-sm item-start q-gutter-x-xl"},ke={class:"row q-gutter-x-sm text-overline"},Qe=m(()=>a("div",null,"Kilo:",-1)),Ce={class:"text-weight-light"},qe={class:"row q-gutter-x-sm text-overline"},Re=m(()=>a("div",null,"Over:",-1)),De={class:"text-weight-light"},$e={class:"row q-gutter-x-sm text-overline"},Be=m(()=>a("div",null,"Short:",-1)),Le={class:"text-weight-light"},Se={class:"row q-gutter-x-sm text-overline"},Me=m(()=>a("div",null,"Actual Target:",-1)),Ve={class:"text-weight-light"},Ie={class:"row justify-between"},Ne=m(()=>a("div",{class:"section-title",align:"center"},"Ingredients",-1)),Te={key:0},Ye=m(()=>a("div",{class:"section-title",align:"center"},"Breads",-1)),Fe={key:1},Ae=m(()=>a("div",{class:"section-title",align:"center"},"Fillings",-1)),ze={__name:"ReportView",props:{report:{type:Object,required:!0}},setup(s){console.log("bakerView",s.report);const g=Q(!1),D=r=>r.charAt(0).toUpperCase()+r.slice(1).toLowerCase(),M=r=>r?r.split(" ").map(i=>i.charAt(0).toUpperCase()+i.slice(1).toLowerCase()).join(" "):"",q=r=>{const i=w=>w?w.charAt(0).toUpperCase()+w.slice(1).toLowerCase():"",d=r.firstname?i(r.firstname):"No Firstname",v=r.middlename?i(r.middlename).charAt(0)+".":"",I=r.lastname?i(r.lastname):"No Lastname";return`${d} ${v} ${I}`.trim()},b=r=>{switch(r){case"pending":return"orange";case"declined":return"negative";case"confirmed":return"green";default:return"grey"}},y=()=>{g.value=!0},R=r=>A.formatDate(r,"MMMM D, YYYY"),$=r=>{if(r>=1e3){const i=r/1e3;return`${i} ${i===1?"kg":"kgs"}`}return`${r} g`},V=r=>{const i=Number(r)||0;return parseFloat(i.toFixed(3)).toString()};return(r,i)=>(_(),h(B,null,[e(F,{color:"accent",icon:"visibility",size:"md",flat:"",round:"",dense:"",onClick:y}),e(E,{modelValue:g.value,"onUpdate:modelValue":i[1]||(i[1]=d=>g.value=d),class:"report-dialog"},{default:t(()=>[e(P,{class:"report-card"},{default:t(()=>[e(L,{class:"report-header"},{default:t(()=>[a("div",ne,n(M(s.report.branch_recipe.recipe.name))+" - "+n(s.report.recipe_category),1),e(F,{class:"close-btn",color:"grey-8",flat:"",round:"",dense:"",icon:"close",onClick:i[0]||(i[0]=d=>g.value=!1)})]),_:1}),e(L,null,{default:t(()=>[a("div",ie,[a("div",null,[a("div",ce,[a("div",de,[ue,a("div",_e,n(R(s.report.created_at)),1)]),a("div",pe,[me,a("div",fe,n(M(s.report.branch.name)),1)]),a("div",ge,[ve,a("div",he,n(q(s.report.user.employee)),1)]),a("div",be,[xe,a("div",ye,n(s.report.remark?s.report.remark:"N/A"),1)])])]),a("div",null,[e(se,{square:"",color:b(s.report.status),"text-color":"white"},{default:t(()=>[u(n(D(s.report.status)),1)]),_:1},8,["color"])])]),a("div",we,[a("div",ke,[Qe,a("div",Ce,n(V(s.report.kilo)),1)]),a("div",qe,[Re,a("div",De,n(s.report.over),1)]),a("div",$e,[Be,a("div",Le,n(s.report.short),1)]),a("div",Se,[Me,a("div",Ve,n(s.report.actual_target),1)])]),e(O,{class:"q-my-md"}),a("div",Ie,[a("div",null,[Ne,e(Y,{dense:"",separator:"",class:"q-pa-md box"},{default:t(()=>[e(k,null,{default:t(()=>[e(l,null,{default:t(()=>[e(p,{class:"text-overline"},{default:t(()=>[u("Code")]),_:1})]),_:1}),e(l),e(l),e(l,null,{default:t(()=>[e(p,{class:"text-overline"},{default:t(()=>[u("Quantity")]),_:1})]),_:1}),e(l,{side:""})]),_:1}),(_(!0),h(B,null,N(s.report.ingredient_bakers_reports,(d,v)=>(_(),x(k,{key:v},{default:t(()=>[e(l,null,{default:t(()=>[e(p,{class:"text-caption justify",align:"center"},{default:t(()=>[u(n(d.ingredients.code),1)]),_:2},1024)]),_:2},1024),e(l),e(l,null,{default:t(()=>[e(p,{class:"text-caption",align:"center"},{default:t(()=>[u(n($(d.quantity)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),s.report.bread_bakers_reports&&s.report.bread_bakers_reports.length?(_(),h("div",Te,[Ye,e(Y,{dense:"",separator:"",class:"q-pa-md box"},{default:t(()=>[e(k,null,{default:t(()=>[e(l,null,{default:t(()=>[e(p,{class:"text-overline"},{default:t(()=>[u("Bread Name")]),_:1})]),_:1}),e(l),e(l,null,{default:t(()=>[e(p,{class:"text-overline"},{default:t(()=>[u("Quantity")]),_:1})]),_:1})]),_:1}),(_(!0),h(B,null,N(s.report.bread_bakers_reports,(d,v)=>(_(),x(k,{key:v},{default:t(()=>[e(l,null,{default:t(()=>[e(p,{class:"text-caption",align:"center"},{default:t(()=>[u(n(d.bread.name),1)]),_:2},1024)]),_:2},1024),e(l),e(l,null,{default:t(()=>[e(p,{class:"text-caption",align:"center"},{default:t(()=>[u(n(d.bread_production)+" pcs ",1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})])):S("",!0),s.report.filling_bakers_reports&&s.report.filling_bakers_reports.length?(_(),h("div",Fe,[Ae,e(Y,{dense:"",separator:"",class:"q-pa-md box"},{default:t(()=>[e(k,null,{default:t(()=>[e(l,null,{default:t(()=>[e(p,{class:"text-overline"},{default:t(()=>[u("Bread Name")]),_:1})]),_:1}),e(l),e(l,null,{default:t(()=>[e(p,{class:"text-overline"},{default:t(()=>[u("Quantity")]),_:1})]),_:1})]),_:1}),(_(!0),h(B,null,N(s.report.filling_bakers_reports,(d,v)=>(_(),x(k,{key:v},{default:t(()=>[e(l,null,{default:t(()=>[e(p,{class:"text-caption",align:"center"},{default:t(()=>[u(n(d.bread.name),1)]),_:2},1024)]),_:2},1024),e(l),e(l,null,{default:t(()=>[e(p,{class:"text-caption",align:"center"},{default:t(()=>[u(n(d.filling_production)+" pcs ",1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})])):S("",!0)])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};var je=z(ze,[["__scopeId","data-v-7c798af2"]]);const Ue={class:"q-mt-sm q-gutter-md"},Pe={class:"table-container"},Ke={key:0,class:"loading-overlay row justify-center items-center"},Oe={key:1,class:"q-pa-md q-gutter-md row justify-center"},Ee={__name:"ReportTable",setup(s){var w;const C=Q({rowsPerPage:0}),g=ae(),D=T(()=>g.reportToView),q=((w=T(()=>g.user).value)==null?void 0:w.data.id)||"",b=Q(""),y=Q(!0),R=Q(!1),$=Q(!1);H(b,async o=>{R.value=!0,await new Promise(c=>setTimeout(c,1e3)),R.value=!1,$.value=!y.value&&r.value.length===0,console.log("Filtered Rows:",r.value)}),W(async()=>{console.log("props.branchId in onMounted:",q),q&&await V(q)});const V=async o=>{y.value=!0,await g.fetchBakerReport(o),y.value=!1},r=T(()=>{if(!b.value)return D.value;const o=b.value.toLowerCase();return D.value.filter(c=>c.name&&c.name.toLowerCase().includes(o)||c.created_at&&A.formatDate(c.created_at,"MMMM D, YYYY").toLowerCase().includes(o)||c.recipe&&c.recipe.name&&c.recipe.name.toLowerCase().includes(o)||c.recipe&&c.recipe.category&&c.recipe.category.toLowerCase().includes(o))}),d=[{name:"date",align:"left",label:"Date",field:"created_at",format:o=>A.formatDate(o,"MMMM D, YYYY"),sortable:!0},{name:"name",label:"Reports Name",align:"center",field:o=>o.branch_recipe&&o.branch_recipe.recipe?{name:o.branch_recipe.recipe.name,category:o.branch_recipe.recipe.category}:{name:"N/A",category:"N/A"},format:o=>`${o.name} (${o.category})`,sortable:!0},{name:"status",align:"center",label:"Status",field:"status"},{name:"view",align:"right",label:"View",field:"view"}],v=o=>{switch(o){case"pending":return"orange";case"declined":return"negative";case"confirmed":return"green";default:return"grey"}},I=o=>o.charAt(0).toUpperCase()+o.slice(1).toLowerCase();return(o,c)=>(_(),h("div",Ue,[a("div",null,[e(X,{rounded:"",outlined:"",dense:"",debounce:"300",modelValue:b.value,"onUpdate:modelValue":c[0]||(c[0]=f=>b.value=f),placeholder:"Search",style:{width:"500px","max-width":"1500px","min-width":"100px"}},{append:t(()=>[R.value?(_(),x(j,{key:1})):(_(),x(K,{key:0,name:"search"}))]),_:1},8,["modelValue"])]),a("div",Pe,[e(ee,{class:"sticky-header",filter:b.value,flat:"",columns:d,rows:r.value,"row-key":"name","virtual-scroll-sticky-size-start":48,"virtual-scroll":"",pagination:C.value,"onUpdate:pagination":c[1]||(c[1]=f=>C.value=f),"rows-per-page-options":[0],"hide-bottom":"",style:{height:"900px","max-height":"1000px","min-height":"none"}},{"body-cell-status":t(f=>[e(U,{key:"name",props:f},{default:t(()=>[e(Z,{outlined:"",color:v(f.row.status)},{default:t(()=>[u(n(I(f.row.status)),1)]),_:2},1032,["color"])]),_:2},1032,["props"])]),"body-cell-view":t(f=>[e(U,{props:f},{default:t(()=>[a("div",null,[e(je,{report:f.row},null,8,["report"])])]),_:2},1032,["props"])]),_:1},8,["filter","rows","pagination"]),y.value?(_(),h("div",Ke,[e(j,{size:"50px"})])):S("",!0),$.value?(_(),h("div",Oe,[e(te,{class:"bg-grey-1",dense:""},{default:t(()=>[u(" No data available ")]),_:1})])):S("",!0)])]))}};var Je=z(Ee,[["__scopeId","data-v-4dcb26db"]]);const Ge={class:"text-h6 text-white"},He={class:"q-gutter-y-lg"},We={align:"right"},pt={__name:"ReportPage",setup(s){return(C,g)=>(_(),x(P,{flat:""},{default:t(()=>[e(L,{style:{"background-color":"#ef4444"}},{default:t(()=>[a("div",Ge,[e(K,{name:"fa-solid fa-layer-group"}),u(" Report ")])]),_:1}),e(L,null,{default:t(()=>[a("div",He,[a("div",We,[e(le)]),a("div",null,[e(Je)])])]),_:1})]),_:1}))}};export{pt as default};
