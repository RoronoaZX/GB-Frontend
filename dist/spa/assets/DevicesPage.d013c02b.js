import{d as ve,r as h,N as S,P as Q,c as M,u as Z,t as ee,o as d,a2 as D,f as e,M as V,w as a,Q as I,I as k,ad as N,J as n,K as w,b5 as K,e as x,L as O,bb as J,$ as C,a3 as F,a4 as G,_ as H,bc as A,aI as ae,a1 as R,O as W,R as j,a0 as pe,z as _e}from"./index.624b9ec7.js";import{Q as ge}from"./QPage.55226536.js";import{Q as te}from"./QSpace.439db3d5.js";import{Q as X,a as E,b as Y}from"./QList.82f6108f.js";import{C as T}from"./ClosePopup.b3fc46b1.js";import{api as P}from"./axios.09143b80.js";import{u as fe}from"./branch.73f3243c.js";import{u as he}from"./warehouse.b98e13d3.js";import{_ as B}from"./plugin-vue_export-helper.21dcd24c.js";import{Q as ye}from"./QSpinnerDots.527e1fbf.js";import{Q as be,a as De}from"./QTable.a71becb2.js";import{Q as le}from"./QTooltip.beaa8d6b.js";import"./employee.e1d18da1.js";import"./QVirtualScroll.4da1e9c3.js";import"./use-virtual-scroll.c14c8ef7.js";import"./rtl.df08cf02.js";import"./QSelect.6f6341f5.js";import"./QChip.fd3511f6.js";import"./QMenu.91871d4d.js";import"./selection.af1f8f11.js";const L=ve("devices",()=>{const i=h(null),p=h([]),v=async()=>{try{const o=await P.get("/api/device");p.value=o.data}catch(o){console.log("error fetchig  device",o),S.create({type:"negative",message:"Failed to fetch devices",setTimeout:1e3})}};return{device:i,devices:p,fetchDevices:v,createDevices:async o=>{Q.show(),console.log("Data parameters being sent:",o);try{const f=await P.post("/api/device",o);v(),S.create({type:"positive",message:"Device created successfully",setTimeout:1e3})}catch(f){console.error("error device",f),S.create({type:"negative",message:"Failed to create device",setTimeout:1e3})}finally{Q.hide()}},updateDevice:async(o,f)=>{Q.show();try{const c=await P.put(`/api/device/${o}`,f),u=p.value.findIndex(l=>l.id===o);u!==-1&&(p.value[u]=c.data),S.create({type:"positive",message:"Device updated successfully",setTimeout:1e3})}catch(c){console.log("update device error",c),S.create({type:"negative",message:"Failed to update device",setTimeout:1e3})}finally{Q.hide()}},deleteDevice:async o=>{Q.show();try{const f=await P.delete(`/api/device/${o}`);p.value=p.value.filter(c=>c.id!==o),S.create({type:"positive",message:"Device deleted successfully"})}catch{S.create({type:"negative",message:"Failed to delete device"})}finally{Q.hide()}}}});const U=i=>(W("data-v-b6c6623c"),i=i(),j(),i),qe=U(()=>n("div",{class:"text-h5 q-mr-md"},"\u{1F4F1} Add Device",-1)),we={class:"q-mt-lg q-animated q-animate-bounce"},Ve=U(()=>n("div",null,"UUID",-1)),xe={class:"q-mt-md q-animated q-animate-bounce"},ke=U(()=>n("div",null,"Name",-1)),$e={class:"q-mt-md q-animated q-animate-bounce"},Se=U(()=>n("div",null,"Model",-1)),Ue={class:"q-mt-md q-animated q-animate-bounce"},Qe=U(()=>n("div",null,"OS Version",-1)),Ce={class:"q-gutter-x-lg"},Ie={key:0,class:"q-mt-md q-animated q-animate-bounce"},Ne=U(()=>n("div",null,"Designation Branch",-1)),Fe={key:0,class:"custom-list z-top"},Te={key:1,class:"q-mt-md q-animated q-animate-bounce"},Be=U(()=>n("div",null,"Warehouse",-1)),ze={key:0,class:"custom-list z-top"},Ae={__name:"AddDevice",setup(i){const p=L(),v=fe(),_=M(()=>v.branch),b=he(),g=M(()=>b.warehouse);console.log("warehouse",g.value);const o=h(!1),f=h(!1),c=h(""),u=h(""),l=h(!1),s=h(!1),y=h(null);Z(y,q=>{m.designation=q});const se=()=>{o.value=!0},ne=async()=>{c.value.trim()&&await v.search(c.value)},ie=q=>{console.log("selected branch:",q),m.reference_id=q.id,c.value=q.name,l.value=!1,console.log("Filled addNewBranchForm Data:",m)},de=async()=>{u.value.trim()&&await b.search(u.value)},re=q=>{console.log("selected branch:",q),m.reference_id=q.id,u.value=q.name,l.value=!1,console.log("Filled addNewBranchForm Data:",m)},m=ee({uuid:"",name:"",model:"",os_version:"",reference_id:"",designation:""}),ce=async()=>{console.log("device sent:",m),f.value=!0;try{await p.createDevices(m),o.value=!1,ue()}catch(q){console.log(q)}finally{f.value=!1}},ue=()=>{m.uuid="",m.name="",m.model="",m.os_version=""};return(q,r)=>(d(),D("div",null,[e(V,{outline:"",icon:"add_circle",label:"Add Device",onClick:se,style:{"background-color":"#ef4444"}}),e(R,{modelValue:o.value,"onUpdate:modelValue":r[10]||(r[10]=t=>o.value=t),persistent:"","transition-show":"jump-up","transition-hide":"jump-down"},{default:a(()=>[e(I,{class:"my-card q-pa-none",style:{width:"420px","border-radius":"16px","box-shadow":"0 12px 24px rgba(0, 0, 0, 0.2)"}},{default:a(()=>[e(k,{class:"row items-center q-px-md q-py-sm bg-gradient text-white"},{default:a(()=>[qe,e(te),N(e(V,{icon:"close",flat:"",dense:"",round:""},null,512),[[T]])]),_:1}),e(k,{class:"q-px-xl q-pt-none q-pb-lg"},{default:a(()=>[n("div",we,[Ve,e(w,{modelValue:m.uuid,"onUpdate:modelValue":r[0]||(r[0]=t=>m.uuid=t),outlined:"",dense:"",rules:[t=>t&&t.length>0||"Device UUID is required"]},null,8,["modelValue","rules"])]),n("div",xe,[ke,e(w,{class:"text-capitalize",modelValue:m.name,"onUpdate:modelValue":r[1]||(r[1]=t=>m.name=t),outlined:"",dense:"",rules:[t=>t&&t.length>0||"Device Name is required"]},null,8,["modelValue","rules"])]),n("div",$e,[Se,e(w,{modelValue:m.model,"onUpdate:modelValue":r[2]||(r[2]=t=>m.model=t),outlined:"",dense:"",rules:[t=>t&&t.length>0||"Device Model is required"]},null,8,["modelValue","rules"])]),n("div",Ue,[Qe,e(w,{modelValue:m.os_version,"onUpdate:modelValue":r[3]||(r[3]=t=>m.os_version=t),outlined:"",dense:"",rules:[t=>t&&t.length>0||"Device OS Version is required"]},null,8,["modelValue","rules"])]),n("div",Ce,[e(K,{"keep-color":"",modelValue:y.value,"onUpdate:modelValue":r[4]||(r[4]=t=>y.value=t),label:"Branch",color:"red","true-value":"branch","false-value":null,"indeterminate-value":"false"},null,8,["modelValue"]),e(K,{"keep-color":"",modelValue:y.value,"onUpdate:modelValue":r[5]||(r[5]=t=>y.value=t),label:"Warehouse",color:"blue-grey-10","true-value":"warehouse","false-value":null,"indeterminate-value":"false"},null,8,["modelValue"])]),y.value==="branch"?(d(),D("div",Ie,[Ne,e(w,{modelValue:c.value,"onUpdate:modelValue":[r[6]||(r[6]=t=>c.value=t),ne],outlined:"",dense:"",debounce:"500",onFocus:r[7]||(r[7]=t=>l.value=!0)},{append:a(()=>[s.value?(d(),x(J,{key:1,color:"grey",size:"sm"})):(d(),x(O,{key:0,name:"search"}))]),default:a(()=>[l.value&&c.value?(d(),D("div",Fe,[e(I,null,{default:a(()=>[e(X,{separator:""},{default:a(()=>{var t;return[(t=_.value)!=null&&t.length?(d(!0),D(F,{key:1},G(_.value,$=>(d(),x(E,{onClick:me=>ie($),key:$.id,clickable:""},{default:a(()=>[e(Y,null,{default:a(()=>[C(H($.name),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128)):(d(),x(E,{key:0},{default:a(()=>[C("No Employee Record")]),_:1}))]}),_:1})]),_:1})])):A("",!0)]),_:1},8,["modelValue"])])):A("",!0),y.value==="warehouse"?(d(),D("div",Te,[Be,e(w,{modelValue:u.value,"onUpdate:modelValue":[r[8]||(r[8]=t=>u.value=t),de],outlined:"",dense:"",debounce:"500",onFocus:r[9]||(r[9]=t=>l.value=!0)},{append:a(()=>[s.value?(d(),x(J,{key:1,color:"grey",size:"sm"})):(d(),x(O,{key:0,name:"search"}))]),default:a(()=>[l.value&&u.value?(d(),D("div",ze,[e(I,null,{default:a(()=>[e(X,{separator:""},{default:a(()=>{var t;return[(t=g.value)!=null&&t.length?(d(!0),D(F,{key:1},G(g.value,$=>(d(),x(E,{key:$.id,onClick:me=>re($),clickable:""},{default:a(()=>[e(Y,null,{default:a(()=>[C(H($.name),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128)):(d(),x(E,{key:0},{default:a(()=>[C("No Warehouse Record")]),_:1}))]}),_:1})]),_:1})])):A("",!0)]),_:1},8,["modelValue"])])):A("",!0)]),_:1}),e(ae,{class:"row q-px-lg q-py-sm q-pt-none",align:"right"},{default:a(()=>[N(e(V,{class:"btn-cancel glossy",color:"negative",label:"Dismiss"},null,512),[[T]]),e(V,{class:"btn-create glossy",color:"positive",label:"Create",onClick:ce})]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}};var Ee=B(Ae,[["__scopeId","data-v-b6c6623c"]]);const oe=i=>(W("data-v-1abbd28a"),i=i(),j(),i),Pe=oe(()=>n("div",{class:"text-h5 q-mb-xs"},"Confirm Deletion",-1)),Me=oe(()=>n("p",{class:"text-body2 q-mb-none"}," Are you sure you want to delete this item? This action cannot be undone. ",-1)),Oe={__name:"DeviceDelete",props:["delete"],emits:["device-deleted"],setup(i,{emit:p}){const v=L(),_=i,b=p,g=h(!1),o=()=>{g.value=!0},f=async()=>{try{await v.deleteDevice(_.delete.row.id),g.value=!1,b("device-deleted")}catch(c){console.error("Error deleting item:",c)}g.value=!1};return(c,u)=>(d(),D(F,null,[e(V,{color:"negative",icon:"delete",size:"sm",flat:"",round:"",dense:"",onClick:o},{default:a(()=>[e(le,{class:"bg-negative",delay:200},{default:a(()=>[C("Delete")]),_:1})]),_:1}),e(R,{modelValue:g.value,"onUpdate:modelValue":u[0]||(u[0]=l=>g.value=l)},{default:a(()=>[e(I,{class:"q-pa-md q-rounded q-elevate-2 bg-white text-grey-9"},{default:a(()=>[e(k,{class:"q-pt-none q-pb-sm"},{default:a(()=>[Pe,Me]),_:1}),e(pe,{class:"q-mb-md"}),e(k,{align:"right",class:"q-pt-none"},{default:a(()=>[N(e(V,{flat:"",dense:"",label:"Cancel",color:"primary",class:"q-mr-sm"},null,512),[[T]]),e(V,{dense:"",label:"Delete",color:"negative",onClick:f,class:"q-btn-rounded q-px-lg"})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};var We=B(Oe,[["__scopeId","data-v-1abbd28a"]]);const z=i=>(W("data-v-1abd83be"),i=i(),j(),i),je=z(()=>n("div",{class:"text-h5 q-mr-md"},"\u{1F4F1} Edit Device",-1)),Le={class:"q-mt-lg q-animated q-animate-bounce"},Re=z(()=>n("div",null,"UUID",-1)),Ke={class:"q-mt-md q-animated q-animate-bounce"},Je=z(()=>n("div",null,"Name",-1)),Ge={class:"q-mt-md q-animated q-animate-bounce"},He=z(()=>n("div",null,"Model",-1)),Xe={class:"q-mt-md q-animated q-animate-bounce"},Ye=z(()=>n("div",null,"OS Version",-1)),Ze={__name:"DeviceEdit",props:["edit"],emits:["device-updated"],setup(i,{emit:p}){const v=L(),_=h(!1);h(!0);const b=i,g=p,o=ee({uuid:"",name:"",model:"",os_version:""}),f=()=>{Object.assign(o,b.edit.row),_.value=!0},c=async()=>{try{const u={...b.edit.row,...o};await v.updateDevice(b.edit.row.id,u),_.value=!1,g("device-updated")}catch(u){console.log("error update device",u)}};return(u,l)=>(d(),D(F,null,[e(V,{color:"positive",icon:"edit",size:"sm",flat:"",round:"",dense:"",onClick:f},{default:a(()=>[e(le,{class:"bg-positive",delay:200},{default:a(()=>[C("Edit")]),_:1})]),_:1}),e(R,{modelValue:_.value,"onUpdate:modelValue":l[4]||(l[4]=s=>_.value=s),persistent:"","transition-show":"jump-up","transition-hide":"jump-down"},{default:a(()=>[e(I,{class:"my-card q-pa-none",style:{width:"420px","border-radius":"16px","box-shadow":"0 12px 24px rgba(0, 0, 0, 0.2)"}},{default:a(()=>[e(k,{class:"row items-center q-px-md q-py-sm bg-gradient text-white"},{default:a(()=>[je,e(te),N(e(V,{icon:"close",flat:"",dense:"",round:""},null,512),[[T]])]),_:1}),e(k,{class:"q-px-xl q-pt-none q-pb-lg"},{default:a(()=>[n("div",Le,[Re,e(w,{modelValue:o.uuid,"onUpdate:modelValue":l[0]||(l[0]=s=>o.uuid=s),outlined:"",dense:"",rules:[s=>s&&s.length>0||"Device UUID is required"]},null,8,["modelValue","rules"])]),n("div",Ke,[Je,e(w,{modelValue:o.name,"onUpdate:modelValue":l[1]||(l[1]=s=>o.name=s),outlined:"",dense:"",rules:[s=>s&&s.length>0||"Device Name is required"]},null,8,["modelValue","rules"])]),n("div",Ge,[He,e(w,{modelValue:o.model,"onUpdate:modelValue":l[2]||(l[2]=s=>o.model=s),outlined:"",dense:"",rules:[s=>s&&s.length>0||"Device Model is required"]},null,8,["modelValue","rules"])]),n("div",Xe,[Ye,e(w,{modelValue:o.os_version,"onUpdate:modelValue":l[3]||(l[3]=s=>o.os_version=s),outlined:"",dense:"",rules:[s=>s&&s.length>0||"Device OS Version is required"]},null,8,["modelValue","rules"])])]),_:1}),e(ae,{class:"row q-px-lg q-py-sm q-pt-none",align:"right"},{default:a(()=>[N(e(V,{class:"btn-cancel glossy",color:"negative",label:"Dismiss"},null,512),[[T]]),e(V,{class:"btn-create glossy",color:"positive",label:"Save",onClick:c})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};var ea=B(Ze,[["__scopeId","data-v-1abd83be"]]);const aa=i=>(W("data-v-3b94b6f1"),i=i(),j(),i),ta={key:0,class:"spinner-wrapper"},la={key:1},oa={key:0,class:"data-error"},sa=aa(()=>n("div",{class:"q-ml-sm text-h6"},"No data available",-1)),na={class:"row justify-center q-gutter-x-md"},ia={__name:"DeviceTable",setup(i){const p=L(),v=h(""),_=h(!0),b=M(()=>p.devices),g=h(!1),o=h({rowPerPage:0}),f=M(()=>v.value?b.value.filter(l=>(l.name||"").toLowerCase().includes(v.value.toLowerCase())):b.value);_e(async()=>{const l=await c();console.log("response device",l)});const c=async()=>{try{_.value=!0;const l=await p.fetchDevices();b.value.length||(g.value=!0),console.log("device fetch:",l)}catch(l){console.log("error fetching device",l),g.value=!0}finally{_.value=!1}};Z(v,async l=>{_.value=!0,await new Promise(s=>setTimeout(s,1e3)),_.value=!1,g.value=f.value.length===0});const u=[{name:"name",label:"Name",align:"center",field:"name",format:l=>`${l}`,sortable:!0},{name:"model",label:"Model",align:"center",field:"model"},{name:"os_version",label:"OS Version",align:"center",field:"os_version"},{name:"uuid",label:"UUID",align:"center",field:"uuid"},{name:"branch_name",label:"Branch Name",align:"center",field:l=>l.branch?l.branch.name:"N/A"},{name:"action",label:"Action",align:"center",field:"action"}];return(l,s)=>(d(),D(F,null,[n("div",null,[e(w,{modelValue:v.value,"onUpdate:modelValue":s[0]||(s[0]=y=>v.value=y),class:"q-pb-lg q-pl-sm dynamic-width",outlined:"",placeholder:"search",flat:"",rounded:"",dense:"",debounce:"100"},{append:a(()=>[e(O,{name:"search"})]),_:1},8,["modelValue"])]),_.value?(d(),D("div",ta,[e(ye,{size:"50px",color:"primary"})])):(d(),D("div",la,[f.value.length===0?(d(),D("div",oa,[e(O,{name:"warning",color:"warning",size:"4em"}),sa])):(d(),x(De,{key:1,class:"table-container elegant-container sticky-header",filter:v.value,"virtual-scroll-sticky-size-start":48,flat:"",style:{height:"400px"},columns:u,rows:b.value,"row-key":"name","virtual-scroll":"",pagination:o.value,"onUpdate:pagination":s[1]||(s[1]=y=>o.value=y),"rows-per-page-options":[0],"hide-bottom":""},{"body-cell-action":a(y=>[e(be,{props:y},{default:a(()=>[n("div",na,[e(ea,{edit:y,onDeviceUpdated:c},null,8,["edit"]),e(We,{delete:y,onDeviceDeleted:c},null,8,["delete"])])]),_:2},1032,["props"])]),_:1},8,["filter","rows","pagination"]))]))],64))}};var da=B(ia,[["__scopeId","data-v-3b94b6f1"]]);const ra={align:"right"},ca={__name:"DevicesPage",setup(i){return(p,v)=>(d(),x(ge,null,{default:a(()=>[e(I,{class:"elegant-container",flat:""},{default:a(()=>[e(k,null,{default:a(()=>[n("div",ra,[e(Ee)])]),_:1}),e(k,null,{default:a(()=>[e(da)]),_:1})]),_:1})]),_:1}))}};var Ca=B(ca,[["__scopeId","data-v-bc8265ea"]]);export{Ca as default};
