import{d as me,r as h,N as S,P as Q,c as L,t as Z,u as ee,o as d,a3 as b,f as e,M as V,w as a,Q as N,I as k,ae as F,J as s,K as q,b6 as K,e as x,L as M,bc as J,a0 as I,bd as C,a4 as T,a5 as G,$ as H,aJ as te,a2 as R,O,R as j,a1 as ve,z as pe}from"./index.508afe23.js";import{Q as _e}from"./QPage.825d1612.js";import{Q as ae}from"./QSpace.f109ed07.js";import{Q as P,a as X}from"./QItem.b17c6dd6.js";import{Q as Y}from"./QList.1b94923f.js";import{C as z}from"./ClosePopup.98ec920e.js";import{api as E}from"./axios.7bae3343.js";import{u as fe}from"./branch.de5c9e8b.js";import{u as ge}from"./warehouse.ee11aa25.js";import{_ as B}from"./plugin-vue_export-helper.21dcd24c.js";import{Q as he}from"./QSpinnerDots.8659385e.js";import{Q as ye,a as De}from"./QTable.92bc9148.js";import{Q as le}from"./QTooltip.a9b474e0.js";import"./employee.a35b6df1.js";import"./QVirtualScroll.af9fd448.js";import"./use-virtual-scroll.25dd92d1.js";import"./QSelect.606c57e7.js";import"./QItemLabel.46b379f0.js";import"./QChip.d9bdfe5c.js";import"./QMenu.ed32a56a.js";import"./position-engine.d7ef5eb0.js";import"./selection.bbf0afa3.js";const W=me("devices",()=>{const n=h(null),_=h([]),p=async()=>{try{const o=await E.get("/api/device");_.value=o.data}catch(o){console.log("error fetchig  device",o),S.create({type:"negative",message:"Failed to fetch devices",setTimeout:1e3})}};return{device:n,devices:_,fetchDevices:p,createDevices:async o=>{Q.show(),console.log("Data parameters being sent:",o);try{const g=await E.post("/api/device",o);p(),S.create({type:"positive",message:"Device created successfully",setTimeout:1e3})}catch(g){console.error("error device",g),S.create({type:"negative",message:"Failed to create device",setTimeout:1e3})}finally{Q.hide()}},updateDevice:async(o,g)=>{Q.show();try{const c=await E.put(`/api/device/${o}`,g),r=_.value.findIndex(i=>i.id===o);r!==-1&&(_.value[r]=c.data),S.create({type:"positive",message:"Device updated successfully",setTimeout:1e3})}catch(c){console.log("update device error",c),S.create({type:"negative",message:"Failed to update device",setTimeout:1e3})}finally{Q.hide()}},deleteDevice:async o=>{Q.show();try{const g=await E.delete(`/api/device/${o}`);_.value=_.value.filter(c=>c.id!==o),S.create({type:"positive",message:"Device deleted successfully"})}catch{S.create({type:"negative",message:"Failed to delete device"})}finally{Q.hide()}}}});const U=n=>(O("data-v-3caa7c3c"),n=n(),j(),n),be=U(()=>s("div",{class:"text-h5 q-mr-md"},"\u{1F4F1} Add Device",-1)),we={class:"q-mt-lg"},qe=U(()=>s("div",null,"UUID",-1)),Ve={class:"q-mt-md"},xe=U(()=>s("div",null,"Name",-1)),ke={class:"q-mt-md"},$e=U(()=>s("div",null,"Model",-1)),Se={class:"q-mt-md"},Ue=U(()=>s("div",null,"OS Version",-1)),Qe={class:"q-gutter-x-lg"},Ce={key:0,class:"q-mt-md"},Ie=U(()=>s("div",null,"Designation Branch",-1)),Ne={key:0,class:"custom-list z-top"},Fe={key:1,class:"q-mt-md"},Te=U(()=>s("div",null,"Warehouse",-1)),ze={key:0,class:"custom-list z-top"},Be={__name:"AddDevice",setup(n){const _=W(),p=fe(),f=ge(),y=L(()=>p.branch),D=L(()=>f.warehouse),o=h(!1),g=h(!1),c=h(""),r=h(""),i=h(!1),t=h(!1),v=h(null),m=Z({uuid:"",name:"",model:"",os_version:"",reference_id:"",designation:""});ee(v,w=>{m.designation=w});const se=()=>{o.value=!0},ne=async()=>{c.value.trim()&&await p.search(c.value)},ie=w=>{m.reference_id=w.id,c.value=w.name,i.value=!1},de=async()=>{r.value.trim()&&await f.search(r.value)},re=w=>{m.reference_id=w.id,r.value=w.name,i.value=!1},ue=async()=>{console.log("deviceForm",m);try{g.value=!0;const w=await _.createDevices(m);console.log("reponse",w),o.value=!1}catch(w){console.log(w)}finally{g.value=!1}};return(w,u)=>(d(),b("div",null,[e(V,{outline:"",icon:"add_circle",label:"Add Device",onClick:se,style:{"background-color":"#ef4444"}}),e(R,{modelValue:o.value,"onUpdate:modelValue":u[10]||(u[10]=l=>o.value=l),persistent:"","transition-show":"jump-up","transition-hide":"jump-down"},{default:a(()=>[e(N,{class:"my-card q-pa-none",style:{width:"420px","border-radius":"16px","box-shadow":"0 12px 24px rgba(0, 0, 0, 0.2)"}},{default:a(()=>[e(k,{class:"row items-center q-px-md q-py-sm bg-gradient text-white"},{default:a(()=>[be,e(ae),F(e(V,{icon:"close",flat:"",dense:"",round:""},null,512),[[z]])]),_:1}),e(k,{class:"q-px-xl q-pt-none q-pb-lg"},{default:a(()=>[s("div",we,[qe,e(q,{modelValue:m.uuid,"onUpdate:modelValue":u[0]||(u[0]=l=>m.uuid=l),outlined:"",dense:"",rules:[l=>l&&l.length>0||"Device UUID is required"]},null,8,["modelValue","rules"])]),s("div",Ve,[xe,e(q,{class:"text-capitalize",modelValue:m.name,"onUpdate:modelValue":u[1]||(u[1]=l=>m.name=l),outlined:"",dense:"",rules:[l=>l&&l.length>0||"Device Name is required"]},null,8,["modelValue","rules"])]),s("div",ke,[$e,e(q,{modelValue:m.model,"onUpdate:modelValue":u[2]||(u[2]=l=>m.model=l),outlined:"",dense:"",rules:[l=>l&&l.length>0||"Device Model is required"]},null,8,["modelValue","rules"])]),s("div",Se,[Ue,e(q,{modelValue:m.os_version,"onUpdate:modelValue":u[3]||(u[3]=l=>m.os_version=l),outlined:"",dense:"",rules:[l=>l&&l.length>0||"Device OS Version is required"]},null,8,["modelValue","rules"])]),s("div",Qe,[e(K,{"keep-color":"",modelValue:v.value,"onUpdate:modelValue":u[4]||(u[4]=l=>v.value=l),label:"Branch",color:"red","true-value":"branch","false-value":null},null,8,["modelValue"]),e(K,{"keep-color":"",modelValue:v.value,"onUpdate:modelValue":u[5]||(u[5]=l=>v.value=l),label:"Warehouse",color:"blue-grey-10","true-value":"warehouse","false-value":null},null,8,["modelValue"])]),v.value==="branch"?(d(),b("div",Ce,[Ie,e(q,{modelValue:c.value,"onUpdate:modelValue":[u[6]||(u[6]=l=>c.value=l),ne],outlined:"",dense:"",debounce:"500",onFocus:u[7]||(u[7]=l=>i.value=!0)},{append:a(()=>[t.value?(d(),x(J,{key:1,color:"grey",size:"sm"})):(d(),x(M,{key:0,name:"search"}))]),default:a(()=>[i.value&&c.value?(d(),b("div",Ne,[e(N,null,{default:a(()=>[e(Y,{separator:""},{default:a(()=>{var l;return[(l=y.value)!=null&&l.length?C("",!0):(d(),x(P,{key:0},{default:a(()=>[I("No Branch Record")]),_:1})),(d(!0),b(T,null,G(y.value,$=>(d(),x(P,{key:$.id,clickable:"",onClick:ce=>ie($)},{default:a(()=>[e(X,null,{default:a(()=>[I(H($.name),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]}),_:1})]),_:1})])):C("",!0)]),_:1},8,["modelValue"])])):C("",!0),v.value==="warehouse"?(d(),b("div",Fe,[Te,e(q,{modelValue:r.value,"onUpdate:modelValue":[u[8]||(u[8]=l=>r.value=l),de],outlined:"",dense:"",debounce:"500",onFocus:u[9]||(u[9]=l=>i.value=!0)},{append:a(()=>[t.value?(d(),x(J,{key:1,color:"grey",size:"sm"})):(d(),x(M,{key:0,name:"search"}))]),default:a(()=>[i.value&&r.value?(d(),b("div",ze,[e(N,null,{default:a(()=>[e(Y,{separator:""},{default:a(()=>{var l;return[(l=D.value)!=null&&l.length?C("",!0):(d(),x(P,{key:0},{default:a(()=>[I("No Warehouse Record")]),_:1})),(d(!0),b(T,null,G(D.value,$=>(d(),x(P,{key:$.id,onClick:ce=>re($),clickable:""},{default:a(()=>[e(X,null,{default:a(()=>[I(H($.name),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]}),_:1})]),_:1})])):C("",!0)]),_:1},8,["modelValue"])])):C("",!0)]),_:1}),e(te,{class:"row q-px-lg q-py-sm q-pt-none",align:"right"},{default:a(()=>[F(e(V,{class:"btn-cancel glossy",color:"negative",label:"Dismiss"},null,512),[[z]]),e(V,{class:"btn-create glossy",color:"positive",label:"Create",onClick:ue})]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}};var Ae=B(Be,[["__scopeId","data-v-3caa7c3c"]]);const oe=n=>(O("data-v-2a721950"),n=n(),j(),n),Pe=oe(()=>s("div",{class:"text-h5 q-mb-xs"},"Confirm Deletion",-1)),Ee=oe(()=>s("p",{class:"text-body2 q-mb-none"}," Are you sure you want to delete this item? This action cannot be undone. ",-1)),Le={__name:"DeviceDelete",props:["delete"],emits:["device-deleted"],setup(n,{emit:_}){const p=W(),f=n,y=_,D=h(!1),o=()=>{D.value=!0},g=async()=>{try{await p.deleteDevice(f.delete.row.id),D.value=!1,y("device-deleted")}catch(c){console.error("Error deleting item:",c)}D.value=!1};return(c,r)=>(d(),b(T,null,[e(V,{color:"negative",icon:"delete",size:"sm",flat:"",round:"",dense:"",onClick:o},{default:a(()=>[e(le,{class:"bg-negative",delay:200},{default:a(()=>[I("Delete")]),_:1})]),_:1}),e(R,{modelValue:D.value,"onUpdate:modelValue":r[0]||(r[0]=i=>D.value=i)},{default:a(()=>[e(N,{class:"q-pa-md q-rounded q-elevate-2 bg-white text-grey-9"},{default:a(()=>[e(k,{class:"q-pt-none q-pb-sm"},{default:a(()=>[Pe,Ee]),_:1}),e(ve,{class:"q-mb-md"}),e(k,{align:"right",class:"q-pt-none"},{default:a(()=>[F(e(V,{flat:"",dense:"",label:"Cancel",color:"primary",class:"q-mr-sm"},null,512),[[z]]),e(V,{dense:"",label:"Delete",color:"negative",onClick:g,class:"q-btn-rounded q-px-lg"})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};var Me=B(Le,[["__scopeId","data-v-2a721950"]]);const A=n=>(O("data-v-737a91e1"),n=n(),j(),n),Oe=A(()=>s("div",{class:"text-h5 q-mr-md"},"\u{1F4F1} Edit Device",-1)),je={class:"q-mt-lg q-animated q-animate-bounce"},We=A(()=>s("div",null,"UUID",-1)),Re={class:"q-mt-md q-animated q-animate-bounce"},Ke=A(()=>s("div",null,"Name",-1)),Je={class:"q-mt-md q-animated q-animate-bounce"},Ge=A(()=>s("div",null,"Model",-1)),He={class:"q-mt-md q-animated q-animate-bounce"},Xe=A(()=>s("div",null,"OS Version",-1)),Ye={__name:"DeviceEdit",props:["edit"],emits:["device-updated"],setup(n,{emit:_}){const p=W(),f=h(!1);h(!0);const y=n,D=_,o=Z({uuid:"",name:"",model:"",os_version:""}),g=()=>{Object.assign(o,y.edit.row),f.value=!0},c=async()=>{try{const r={...y.edit.row,...o};await p.updateDevice(y.edit.row.id,r),f.value=!1,D("device-updated")}catch(r){console.log("error update device",r)}};return(r,i)=>(d(),b(T,null,[e(V,{color:"positive",icon:"edit",size:"sm",flat:"",round:"",dense:"",onClick:g},{default:a(()=>[e(le,{class:"bg-positive",delay:200},{default:a(()=>[I("Edit")]),_:1})]),_:1}),e(R,{modelValue:f.value,"onUpdate:modelValue":i[4]||(i[4]=t=>f.value=t),persistent:"","transition-show":"jump-up","transition-hide":"jump-down"},{default:a(()=>[e(N,{class:"my-card q-pa-none",style:{width:"420px","border-radius":"16px","box-shadow":"0 12px 24px rgba(0, 0, 0, 0.2)"}},{default:a(()=>[e(k,{class:"row items-center q-px-md q-py-sm bg-gradient text-white"},{default:a(()=>[Oe,e(ae),F(e(V,{icon:"close",flat:"",dense:"",round:""},null,512),[[z]])]),_:1}),e(k,{class:"q-px-xl q-pt-none q-pb-lg"},{default:a(()=>[s("div",je,[We,e(q,{modelValue:o.uuid,"onUpdate:modelValue":i[0]||(i[0]=t=>o.uuid=t),outlined:"",dense:"",rules:[t=>t&&t.length>0||"Device UUID is required"]},null,8,["modelValue","rules"])]),s("div",Re,[Ke,e(q,{modelValue:o.name,"onUpdate:modelValue":i[1]||(i[1]=t=>o.name=t),outlined:"",dense:"",rules:[t=>t&&t.length>0||"Device Name is required"]},null,8,["modelValue","rules"])]),s("div",Je,[Ge,e(q,{modelValue:o.model,"onUpdate:modelValue":i[2]||(i[2]=t=>o.model=t),outlined:"",dense:"",rules:[t=>t&&t.length>0||"Device Model is required"]},null,8,["modelValue","rules"])]),s("div",He,[Xe,e(q,{modelValue:o.os_version,"onUpdate:modelValue":i[3]||(i[3]=t=>o.os_version=t),outlined:"",dense:"",rules:[t=>t&&t.length>0||"Device OS Version is required"]},null,8,["modelValue","rules"])])]),_:1}),e(te,{class:"row q-px-lg q-py-sm q-pt-none",align:"right"},{default:a(()=>[F(e(V,{class:"btn-cancel glossy",color:"negative",label:"Dismiss"},null,512),[[z]]),e(V,{class:"btn-create glossy",color:"positive",label:"Save",onClick:c})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};var Ze=B(Ye,[["__scopeId","data-v-737a91e1"]]);const et=n=>(O("data-v-240c172f"),n=n(),j(),n),tt={key:0,class:"spinner-wrapper"},at={key:1},lt={key:0,class:"data-error"},ot=et(()=>s("div",{class:"q-ml-sm text-h6"},"No data available",-1)),st={class:"row justify-center q-gutter-x-md"},nt={__name:"DeviceTable",setup(n){const _=W(),p=h(""),f=h(!0),y=L(()=>_.devices),D=h(!1),o=h({rowPerPage:0}),g=L(()=>p.value?y.value.filter(t=>(t.name||"").toLowerCase().includes(p.value.toLowerCase())):y.value);pe(async()=>{const t=await c();console.log("response device",t)});const c=async()=>{try{f.value=!0;const t=await _.fetchDevices();y.value.length||(D.value=!0),console.log("device fetch:",y.value)}catch(t){console.log("error fetching device",t),D.value=!0}finally{f.value=!1}};ee(p,async t=>{f.value=!0,await new Promise(v=>setTimeout(v,1e3)),f.value=!1,D.value=g.value.length===0});const r=t=>t?t.split(" ").map(v=>v.charAt(0).toUpperCase()+v.slice(1).toLowerCase()).join(" "):"",i=[{name:"name",label:"Name",align:"center",field:"name",format:t=>`${r(t)}`,sortable:!0},{name:"model",label:"Model",align:"center",field:"model",format:t=>`${r(t)}`},{name:"os_version",label:"OS Version",align:"center",field:"os_version",format:t=>`${r(t)}`},{name:"uuid",label:"UUID",align:"center",field:"uuid"},{name:"designation",label:"Designation",align:"center",field:t=>{const v=t.branch?t.branch.name:t.warehouse?t.warehouse.name:"N/A";return r(v)}},{name:"action",label:"Action",align:"center",field:"action"}];return(t,v)=>(d(),b(T,null,[s("div",null,[e(q,{modelValue:p.value,"onUpdate:modelValue":v[0]||(v[0]=m=>p.value=m),class:"q-pb-lg q-pl-sm dynamic-width",outlined:"",placeholder:"search",flat:"",rounded:"",dense:"",debounce:"100"},{append:a(()=>[e(M,{name:"search"})]),_:1},8,["modelValue"])]),f.value?(d(),b("div",tt,[e(he,{size:"50px",color:"primary"})])):(d(),b("div",at,[g.value.length===0?(d(),b("div",lt,[e(M,{name:"warning",color:"warning",size:"4em"}),ot])):(d(),x(De,{key:1,class:"table-container elegant-container sticky-header",filter:p.value,"virtual-scroll-sticky-size-start":48,flat:"",style:{height:"400px"},columns:i,rows:y.value,"row-key":"name","virtual-scroll":"",pagination:o.value,"onUpdate:pagination":v[1]||(v[1]=m=>o.value=m),"rows-per-page-options":[0],"hide-bottom":""},{"body-cell-action":a(m=>[e(ye,{props:m},{default:a(()=>[s("div",st,[e(Ze,{edit:m,onDeviceUpdated:c},null,8,["edit"]),e(Me,{delete:m,onDeviceDeleted:c},null,8,["delete"])])]),_:2},1032,["props"])]),_:1},8,["filter","rows","pagination"]))]))],64))}};var it=B(nt,[["__scopeId","data-v-240c172f"]]);const dt={align:"right"},rt={__name:"DevicesPage",setup(n){return(_,p)=>(d(),x(_e,null,{default:a(()=>[e(N,{class:"elegant-container",flat:""},{default:a(()=>[e(k,null,{default:a(()=>[s("div",dt,[e(Ae)])]),_:1}),e(k,null,{default:a(()=>[e(it)]),_:1})]),_:1})]),_:1}))}};var It=B(rt,[["__scopeId","data-v-68396a38"]]);export{It as default};
