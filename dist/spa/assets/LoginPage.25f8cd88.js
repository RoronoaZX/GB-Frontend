import{_ as ie,r as $,c as le,H as ce,z as de,o as ue,e as fe,w as U,Q as me,f as C,I as K,J as j,K as G,L as ge,M as pe,P as z,N as J,O as ve,R as he}from"./index.95535fc5.js";import{Q as we}from"./QForm.3028ed96.js";import{_ as be}from"./GB_LOGO.b766a815.js";import{u as ye}from"./use-quasar.b4debcba.js";import{api as Pe}from"./axios.42e54811.js";import{_ as _e}from"./plugin-vue_export-helper.21dcd24c.js";/*! Capacitor: https://capacitorjs.com/ - MIT License */const Le=r=>{const e=new Map;e.set("web",{name:"web"});const t=r.CapacitorPlatforms||{currentPlatform:{name:"web"},platforms:e},o=(s,i)=>{t.platforms.set(s,i)},n=s=>{t.platforms.has(s)&&(t.currentPlatform=t.platforms.get(s))};return t.addPlatform=o,t.setPlatform=n,t},Ce=r=>r.CapacitorPlatforms=Le(r),Z=Ce(typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof global!="undefined"?global:{});Z.addPlatform;Z.setPlatform;var O;(function(r){r.Unimplemented="UNIMPLEMENTED",r.Unavailable="UNAVAILABLE"})(O||(O={}));class W extends Error{constructor(e,t,o){super(e),this.message=e,this.code=t,this.data=o}}const xe=r=>{var e,t;return r!=null&&r.androidBridge?"android":!((t=(e=r==null?void 0:r.webkit)===null||e===void 0?void 0:e.messageHandlers)===null||t===void 0)&&t.bridge?"ios":"web"},ke=r=>{var e,t,o,n,s;const i=r.CapacitorCustomPlatform||null,a=r.Capacitor||{},f=a.Plugins=a.Plugins||{},l=r.CapacitorPlatforms,x=()=>i!==null?i.name:xe(r),g=((e=l==null?void 0:l.currentPlatform)===null||e===void 0?void 0:e.getPlatform)||x,v=()=>g()!=="web",u=((t=l==null?void 0:l.currentPlatform)===null||t===void 0?void 0:t.isNativePlatform)||v,k=c=>{const d=R.get(c);return!!(d!=null&&d.platforms.has(g())||E(c))},T=((o=l==null?void 0:l.currentPlatform)===null||o===void 0?void 0:o.isPluginAvailable)||k,b=c=>{var d;return(d=a.PluginHeaders)===null||d===void 0?void 0:d.find(I=>I.name===c)},E=((n=l==null?void 0:l.currentPlatform)===null||n===void 0?void 0:n.getPluginHeader)||b,A=c=>r.console.error(c),te=(c,d,I)=>Promise.reject(`${I} does not have an implementation of "${d}".`),R=new Map,re=(c,d={})=>{const I=R.get(c);if(I)return console.warn(`Capacitor plugin "${c}" already registered. Cannot register plugins twice.`),I.proxy;const L=g(),S=E(c);let y;const ae=async()=>(!y&&L in d?y=typeof d[L]=="function"?y=await d[L]():y=d[L]:i!==null&&!y&&"web"in d&&(y=typeof d.web=="function"?y=await d.web():y=d.web),y),oe=(m,p)=>{var w,P;if(S){const _=S==null?void 0:S.methods.find(h=>p===h.name);if(_)return _.rtype==="promise"?h=>a.nativePromise(c,p.toString(),h):(h,M)=>a.nativeCallback(c,p.toString(),h,M);if(m)return(w=m[p])===null||w===void 0?void 0:w.bind(m)}else{if(m)return(P=m[p])===null||P===void 0?void 0:P.bind(m);throw new W(`"${c}" plugin is not implemented on ${L}`,O.Unimplemented)}},H=m=>{let p;const w=(...P)=>{const _=ae().then(h=>{const M=oe(h,m);if(M){const q=M(...P);return p=q==null?void 0:q.remove,q}else throw new W(`"${c}.${m}()" is not implemented on ${L}`,O.Unimplemented)});return m==="addListener"&&(_.remove=async()=>p()),_};return w.toString=()=>`${m.toString()}() { [capacitor code] }`,Object.defineProperty(w,"name",{value:m,writable:!1,configurable:!1}),w},F=H("addListener"),Q=H("removeListener"),ne=(m,p)=>{const w=F({eventName:m},p),P=async()=>{const h=await w;Q({eventName:m,callbackId:h},p)},_=new Promise(h=>w.then(()=>h({remove:P})));return _.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await P()},_},V=new Proxy({},{get(m,p){switch(p){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return S?ne:F;case"removeListener":return Q;default:return H(p)}}});return f[c]=V,R.set(c,{name:c,proxy:V,platforms:new Set([...Object.keys(d),...S?[L]:[]])}),V},se=((s=l==null?void 0:l.currentPlatform)===null||s===void 0?void 0:s.registerPlugin)||re;return a.convertFileSrc||(a.convertFileSrc=c=>c),a.getPlatform=g,a.handleError=A,a.isNativePlatform=u,a.isPluginAvailable=T,a.pluginMethodNoop=te,a.registerPlugin=se,a.Exception=W,a.DEBUG=!!a.DEBUG,a.isLoggingEnabled=!!a.isLoggingEnabled,a.platform=a.getPlatform(),a.isNative=a.isNativePlatform(),a},Ee=r=>r.Capacitor=ke(r),D=Ee(typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof global!="undefined"?global:{}),B=D.registerPlugin;D.Plugins;class N{constructor(e){this.listeners={},this.retainedEventArguments={},this.windowListeners={},e&&(console.warn(`Capacitor WebPlugin "${e.name}" config object was deprecated in v3 and will be removed in v4.`),this.config=e)}addListener(e,t){let o=!1;this.listeners[e]||(this.listeners[e]=[],o=!0),this.listeners[e].push(t);const s=this.windowListeners[e];s&&!s.registered&&this.addWindowListener(s),o&&this.sendRetainedArgumentsForEvent(e);const i=async()=>this.removeListener(e,t);return Promise.resolve({remove:i})}async removeAllListeners(){this.listeners={};for(const e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,t,o){const n=this.listeners[e];if(!n){if(o){let s=this.retainedEventArguments[e];s||(s=[]),s.push(t),this.retainedEventArguments[e]=s}return}n.forEach(s=>s(t))}hasListeners(e){return!!this.listeners[e].length}registerWindowListener(e,t){this.windowListeners[t]={registered:!1,windowEventName:e,pluginEventName:t,handler:o=>{this.notifyListeners(t,o)}}}unimplemented(e="not implemented"){return new D.Exception(e,O.Unimplemented)}unavailable(e="not available"){return new D.Exception(e,O.Unavailable)}async removeListener(e,t){const o=this.listeners[e];if(!o)return;const n=o.indexOf(t);this.listeners[e].splice(n,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){!e||(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){const t=this.retainedEventArguments[e];!t||(delete this.retainedEventArguments[e],t.forEach(o=>{this.notifyListeners(e,o)}))}}const X=r=>encodeURIComponent(r).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),Y=r=>r.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class Ie extends N{async getCookies(){const e=document.cookie,t={};return e.split(";").forEach(o=>{if(o.length<=0)return;let[n,s]=o.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");n=Y(n).trim(),s=Y(s).trim(),t[n]=s}),t}async setCookie(e){try{const t=X(e.key),o=X(e.value),n=`; expires=${(e.expires||"").replace("expires=","")}`,s=(e.path||"/").replace("path=",""),i=e.url!=null&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${t}=${o||""}${n}; path=${s}; ${i};`}catch(t){return Promise.reject(t)}}async deleteCookie(e){try{document.cookie=`${e.key}=; Max-Age=0`}catch(t){return Promise.reject(t)}}async clearCookies(){try{const e=document.cookie.split(";")||[];for(const t of e)document.cookie=t.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}}B("CapacitorCookies",{web:()=>new Ie});const Se=async r=>new Promise((e,t)=>{const o=new FileReader;o.onload=()=>{const n=o.result;e(n.indexOf(",")>=0?n.split(",")[1]:n)},o.onerror=n=>t(n),o.readAsDataURL(r)}),$e=(r={})=>{const e=Object.keys(r);return Object.keys(r).map(n=>n.toLocaleLowerCase()).reduce((n,s,i)=>(n[s]=r[e[i]],n),{})},Oe=(r,e=!0)=>r?Object.entries(r).reduce((o,n)=>{const[s,i]=n;let a,f;return Array.isArray(i)?(f="",i.forEach(l=>{a=e?encodeURIComponent(l):l,f+=`${s}=${a}&`}),f.slice(0,-1)):(a=e?encodeURIComponent(i):i,f=`${s}=${a}`),`${o}&${f}`},"").substr(1):null,Ae=(r,e={})=>{const t=Object.assign({method:r.method||"GET",headers:r.headers},e),n=$e(r.headers)["content-type"]||"";if(typeof r.data=="string")t.body=r.data;else if(n.includes("application/x-www-form-urlencoded")){const s=new URLSearchParams;for(const[i,a]of Object.entries(r.data||{}))s.set(i,a);t.body=s.toString()}else if(n.includes("multipart/form-data")||r.data instanceof FormData){const s=new FormData;if(r.data instanceof FormData)r.data.forEach((a,f)=>{s.append(f,a)});else for(const a of Object.keys(r.data))s.append(a,r.data[a]);t.body=s;const i=new Headers(t.headers);i.delete("content-type"),t.headers=i}else(n.includes("application/json")||typeof r.data=="object")&&(t.body=JSON.stringify(r.data));return t};class Ue extends N{async request(e){const t=Ae(e,e.webFetchExtra),o=Oe(e.params,e.shouldEncodeUrlParams),n=o?`${e.url}?${o}`:e.url,s=await fetch(n,t),i=s.headers.get("content-type")||"";let{responseType:a="text"}=s.ok?e:{};i.includes("application/json")&&(a="json");let f,l;switch(a){case"arraybuffer":case"blob":l=await s.blob(),f=await Se(l);break;case"json":f=await s.json();break;case"document":case"text":default:f=await s.text()}const x={};return s.headers.forEach((g,v)=>{x[v]=g}),{data:f,headers:x,status:s.status,url:s.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))}}B("CapacitorHttp",{web:()=>new Ue});const je=B("Device",{web:()=>ie(()=>import("./web.fcc50d12.js"),["assets/web.fcc50d12.js","assets/index.95535fc5.js","assets/index.141a42db.css","assets/QForm.3028ed96.js","assets/GB_LOGO.b766a815.js","assets/use-quasar.b4debcba.js","assets/axios.42e54811.js","assets/plugin-vue_export-helper.21dcd24c.js"]).then(r=>new r.DeviceWeb)});const ee=r=>(ve("data-v-7a08ab68"),r=r(),he(),r),Me=ee(()=>j("div",{class:"text-h5 text-red-6 q-mb-sm"},[j("img",{src:be,class:"logo"})],-1)),qe=ee(()=>j("div",{class:"text-caption text-grey-8 q-mb-sm"}," Please log in to continue. ",-1)),De={class:"q-gutter-y-sm"},Te={class:"q-my-md text-center"},Re={__name:"LoginPage",setup(r){const e=$(!0),t=$(""),o=$(""),n=$(""),s=$(!1),i=le(()=>t.value!==""&&o.value!=="");ye();const a=ce(),f=$(""),l=async()=>{try{const g=await je.getId();n.value=g.identifier,console.log("Device UUID:",n.value)}catch(g){console.error("Error fetching device UUID:",g)}};de(()=>{l()});const x=async()=>{var g,v;z.show();try{const u=await Pe.post("/api/login",{uuid:n.value,email:t.value,password:o.value});console.log("user123:",u.data),localStorage.setItem("activeMenuItem","dashboard"),localStorage.setItem("token",u.data.token),localStorage.setItem("role",u.data.role),localStorage.setItem("uuid",u.data.device.uuid),localStorage.setItem("reference_id",u.data.device.reference_id);const k=u.data.device,T=k.designation==="branch"?"branch_id":"warehouse_id";localStorage.setItem(T,k.reference_id);const b=u.data.role,E=localStorage.getItem("activeMenuItem");if(b==="Admin"||b==="Super Admin"){let A;E?(A=`/admin/${E}`,f.value=E):(A="/admin/dashboard",localStorage.setItem("activeMenuItem","dashboard"),f.value="dashboard"),await a.push(A),J.create({type:"positive",message:u.data.message||"Login successful!",setTimeout:5e3})}else b==="Baker"?await a.push("/branch/baker"):b==="Cake Maker"?await a.push("/branch/cake_maker/raw_materials"):b==="Cashier"||b==="Sales Clerk"?await a.push("/branch/sales_lady/products"):b==="Scaler"&&await a.push("/warehouse")}catch(u){console.error("Error during login:",u);const k=((v=(g=u.response)==null?void 0:g.data)==null?void 0:v.message)||"Login failed. Incorrect email & password.";J.create({type:"negative",message:k})}finally{z.hide()}};return(g,v)=>(ue(),fe(me,{class:"my-card q-pa-md q-ma-lg",style:{width:"430px","max-width":"90%",height:"500px","border-radius":"16px","box-shadow":"0 4px 12px rgba(0, 0, 0, 0.1)",display:"flex","flex-direction":"column","justify-content":"space-between"}},{default:U(()=>[C(K,{class:"q-pa-sm text-center"},{default:U(()=>[Me,qe]),_:1}),C(K,{class:"q-mt-sm flex-grow-1"},{default:U(()=>[C(we,{onSubmit:x},{default:U(()=>[j("div",De,[C(G,{modelValue:t.value,"onUpdate:modelValue":v[0]||(v[0]=u=>t.value=u),outlined:"",placeholder:"Email",dense:"",autofocus:"",required:"",class:"input-dynamic"},null,8,["modelValue"]),C(G,{modelValue:o.value,"onUpdate:modelValue":v[2]||(v[2]=u=>o.value=u),outlined:"",placeholder:"Password",type:e.value?"password":"text",dense:"",required:"",class:"input-dynamic"},{append:U(()=>[C(ge,{name:e.value?"visibility_off":"visibility",onClick:v[1]||(v[1]=u=>e.value=!e.value),class:"cursor-pointer",style:{color:"#9e9e9e"}},null,8,["name"])]),_:1},8,["modelValue","type"])]),j("div",Te,[C(pe,{type:"submit",color:"red-6",label:"Login",class:"q-mt-sm",dense:"",loading:s.value,disable:!i.value,style:{width:"100%","max-width":"350px","border-radius":"8px"}},null,8,["loading","disable"])])]),_:1})]),_:1})]),_:1}))}};var He=_e(Re,[["__scopeId","data-v-7a08ab68"]]),Ge=Object.freeze(Object.defineProperty({__proto__:null,default:He},Symbol.toStringTag,{value:"Module"}));export{Ge as L,N as W};
