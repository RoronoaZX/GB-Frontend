import{be as Y,c as I,r as R,t as Te,o as g,a3 as $,f as e,M as D,w as a,Q as z,I as B,ae as de,J as r,K as W,L as E,e as U,a0 as y,a4 as F,a5 as H,$ as V,bd as xe,aJ as ce,a2 as ee,O as G,R as J,a1 as Ue,N as Z,P as be,z as me,u as _e,aK as Re,bb as Fe,bf as le,H as Le}from"./index.731fa509.js";import{Q as pe}from"./QSpace.6ff7332b.js";import{Q as Ce,a as oe,b as Me,c as re}from"./QTabPanels.88955b05.js";import{Q as ze}from"./QPage.b50c4e31.js";import{Q as j}from"./QBadge.b36ed745.js";import{Q as qe}from"./QSpinnerDots.db0f1fbc.js";import{Q as ke}from"./QTooltip.1352bb69.js";import{Q as We}from"./QPopupEdit.8d56270b.js";import{Q as O,a as ge}from"./QTable.2ff1fc36.js";import{Q as se,a as A,b as S}from"./QList.325c1623.js";import{Q as P}from"./rtl.a5858d5a.js";import{C as fe}from"./ClosePopup.3358c279.js";import"./branch-product.1c57d3fc.js";import{u as ne}from"./warehouse-rawMaterials.0386e751.js";import{u as $e}from"./raw-material.4d9402ab.js";import{_ as K}from"./plugin-vue_export-helper.21dcd24c.js";import{api as Ve}from"./axios.3cfbb276.js";import{Q as ue}from"./QSkeleton.faf377e8.js";import{u as Qe}from"./use-quasar.f0dc8a1f.js";import{u as Se}from"./warehouse.09b5cdbb.js";import{u as Pe}from"./use-dialog-plugin-component.8163d500.js";import{u as Ie}from"./premix.2bd9dfc2.js";import{q as Ae}from"./date.2b5164a1.js";import{Q as je,a as Ke}from"./QStepper.134f9c83.js";import{u as Ee}from"./baker-report.97b8dc52.js";import"./QResizeObserver.62b7f9af.js";import"./use-panel.b2620ab4.js";import"./touch.9135741d.js";import"./selection.f62843a1.js";import"./QMenu.2bb85cbd.js";import"./QVirtualScroll.c5e37448.js";import"./use-virtual-scroll.bf0e489d.js";import"./QSelect.66308d7f.js";import"./QChip.ce5b7fa3.js";import"./product.5a2a785e.js";import"./QSlideTransition.05d5825d.js";const ae=o=>(G("data-v-e1e644a2"),o=o(),J(),o),He=ae(()=>r("div",{class:"text-h6"},"Create Warehouse Raw Materials",-1)),Oe={class:"q-mb-lg"},Ye={key:0,class:"custom-list z-top"},Ge=ae(()=>r("div",null,"Raw Materials Code",-1)),Je=ae(()=>r("div",null,"Raw Materials Name",-1)),Xe=ae(()=>r("div",null,"Category",-1)),Ze=ae(()=>r("div",null,"Quantity",-1)),ea={__name:"RawMaterialsCreate",setup(o){const Q=Y(),x=$e(),v=I(()=>x.rawMaterials),n=ne(),u=R(""),b=async()=>{x.searchRawMaterials(u.value)},C=I(()=>s.total_quantity!==""),d=R(!1),h=()=>{d.value=!0},M=()=>{f(),d.value=!1},c=k=>{s.raw_material_id=k.id,s.raw_materials_name=k.name,s.raw_materials_code=k.code,s.category=k.category,s.unit=k.unit,u.value=""},s=Te({raw_material_id:"",raw_materials_name:"",raw_materials_code:"",total_quantity:"",category:"",unit:"",warehouse_id:Q.params.warehouse_id}),f=()=>{s.raw_material_id="",s.raw_materials_name="",s.raw_materials_code="",s.total_quantity="",s.raw_material_id="",s.category="",s.unit=""},q=async()=>{try{const{product_name:k,...l}=s;await n.createWarehouseRawMaterials(l),console.log("data to send",l),d.value=!1}catch(k){console.log(k)}};return(k,l)=>(g(),$(F,null,[e(D,{class:"bg-gradient text-white q-pa-sm",icon:"add_circle",label:"Create One",onClick:h}),e(ee,{modelValue:d.value,"onUpdate:modelValue":l[5]||(l[5]=t=>d.value=t),persistent:""},{default:a(()=>[e(z,{class:"my-card",style:{width:"400px","max-width":"500px","min-width":"100px"}},{default:a(()=>[e(B,{class:"row items-center text-white bg-gradient"},{default:a(()=>[He,e(pe),de(e(D,{icon:"close",flat:"",dense:"",round:""},null,512),[[fe]])]),_:1}),e(B,{class:"q-ma-md q-gutter-y-sm"},{default:a(()=>[r("div",Oe,[e(W,{modelValue:u.value,"onUpdate:modelValue":[l[0]||(l[0]=t=>u.value=t),b],debounce:"1000",outlined:"",rounded:"",placeholder:"Search Raw Materials",dense:""},{append:a(()=>[r("div",null,[e(E,{name:"search"})])]),default:a(()=>[u.value?(g(),$("div",Ye,[e(z,null,{default:a(()=>[e(se,{separator:""},{default:a(()=>{var t;return[(t=v.value)!=null&&t.length?(g(!0),$(F,{key:1},H(v.value,i=>(g(),U(A,{onClick:_=>c(i),key:i.id,clickable:""},{default:a(()=>[e(S,null,{default:a(()=>[e(P,null,{default:a(()=>[y(V(i.name),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128)):(g(),U(A,{key:0},{default:a(()=>[y(" No record found. ")]),_:1}))]}),_:1})]),_:1})])):xe("",!0)]),_:1},8,["modelValue"])]),r("div",null,[Ge,e(W,{modelValue:s.raw_materials_code,"onUpdate:modelValue":l[1]||(l[1]=t=>s.raw_materials_code=t),readonly:"",dense:"",outlined:""},null,8,["modelValue"])]),r("div",null,[Je,e(W,{modelValue:s.raw_materials_name,"onUpdate:modelValue":l[2]||(l[2]=t=>s.raw_materials_name=t),readonly:"",dense:"",outlined:""},null,8,["modelValue"])]),r("div",null,[Xe,e(W,{modelValue:s.category,"onUpdate:modelValue":l[3]||(l[3]=t=>s.category=t),readonly:"",dense:"",outlined:""},null,8,["modelValue"])]),r("div",null,[Ze,e(W,{modelValue:s.total_quantity,"onUpdate:modelValue":l[4]||(l[4]=t=>s.total_quantity=t),type:"number",outlined:"",suffix:s.unit||"",dense:"",rules:[t=>t&&t.length>0||"Total quantity is required"]},null,8,["modelValue","suffix","rules"])])]),_:1}),e(ce,{class:"row q-ma-md",align:"right"},{default:a(()=>[e(D,{class:"glossy",color:"grey-9",label:"Dismiss",onClick:M}),e(D,{class:"glossy",color:"teal",label:"Create",onClick:q,disable:!C.value},null,8,["disable"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};var aa=K(ea,[["__scopeId","data-v-e1e644a2"]]);const De=o=>(G("data-v-7969abbc"),o=o(),J(),o),ta=De(()=>r("div",{class:"text-h5 q-mb-xs"},"Confirm Deletion",-1)),la=De(()=>r("p",{class:"text-body2 q-mb-none"}," Are you sure you want to delete this item? This action cannot be undone. ",-1)),oa={__name:"RawMaterialsTableDelete",props:["delete"],setup(o){const Q=ne(),x=o,v=async()=>{console.log("clickkkd");try{await Q.deleteWarehouseRawMaterials(x.delete.row.id),Z.create({type:"negative",icon:"warning",message:`Raw Materials ${x.delete.row.name}  successfully deleted`,timeout:1e3,position:"top"}),n.value=!1}catch(b){console.error(b.message)}},n=R(!1),u=()=>{n.value=!0};return(b,C)=>(g(),$(F,null,[e(D,{onClick:u,color:"negative",icon:"delete",size:"sm",flat:"",round:"",dense:"",align:"center"},{default:a(()=>[e(ke,{class:"bg-negative",delay:200},{default:a(()=>[y("Delete")]),_:1})]),_:1}),e(ee,{modelValue:n.value,"onUpdate:modelValue":C[0]||(C[0]=d=>n.value=d)},{default:a(()=>[e(z,null,{default:a(()=>[e(B,{class:"q-pa-md q-rounded q-elevate-2 bg-white text-grey-9"},{default:a(()=>[ta,la]),_:1}),e(Ue,{class:"q-mb-md"}),e(B,null,{default:a(()=>[e(ce,{align:"right",class:"q-pt-none"},{default:a(()=>[de(e(D,{flat:"",dense:"",label:"Cancel",color:"primary",class:"q-mr-sm"},null,512),[[fe]]),e(D,{dense:"",label:"Delete",color:"negative",onClick:v,class:"q-btn-rounded q-px-lg"})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};var ra=K(oa,[["__scopeId","data-v-7969abbc"]]);const sa=o=>(G("data-v-656550b2"),o=o(),J(),o),na=sa(()=>r("div",{class:"text-h6"},"Create Warehouse Raw Materials",-1)),ia={__name:"RawMaterialsCreateAll",setup(o){const Q=R(!1),x=async()=>{Q.value=!0},v=Y(),n=$e(),u=I(()=>n.rawMaterials);console.log("rawMaterialsData",u.value);const b=ne(),C=async()=>{if(be.show(),await n.fetchRawMaterials(),!n.rawMaterials.length){Z.create({type:"warning",message:"No raw materials found!"});return}be.hide()},d=()=>{n.rawMaterials=[],Q.value=!1},h=async()=>{try{const M=u.value.map(c=>({raw_material_id:c.id,total_quantity:0,warehouse_id:v.params.warehouse_id}));await b.createMultipleWarehouseRawMaterials(M),console.log("materialsToSave",M),Z.create({type:"positive",message:"All raw materials added to warehouse!"}),d()}catch(M){console.error("Error adding all raw materials:",M),Z.create({type:"negative",message:"Failed to add all raw materials!"})}};return(M,c)=>(g(),$("div",null,[e(D,{class:"bg-gradient text-white q-pa-sm",icon:"add_circle",label:"Create All",onClick:x}),e(ee,{modelValue:Q.value,"onUpdate:modelValue":c[0]||(c[0]=s=>Q.value=s)},{default:a(()=>[e(z,{style:{width:"700px","max-width":"80vw"}},{default:a(()=>[e(B,{class:"row items-center text-white bg-gradient"},{default:a(()=>[na,e(pe),de(e(D,{icon:"close",flat:"",dense:"",round:""},null,512),[[fe]])]),_:1}),e(B,null,{default:a(()=>[e(D,{class:"bg-gradient text-white q-pa-sm",icon:"add_circle",label:"Fetch All",onClick:C})]),_:1}),e(B,null,{default:a(()=>[e(se,{dense:"",separator:"",class:"box"},{default:a(()=>[e(A,null,{default:a(()=>[e(S,null,{default:a(()=>[e(P,{class:"text-overline"},{default:a(()=>[y(" Code")]),_:1})]),_:1}),e(S,null,{default:a(()=>[e(P,{class:"text-overline"},{default:a(()=>[y(" Name")]),_:1})]),_:1}),e(S,null,{default:a(()=>[e(P,{class:"text-overline"},{default:a(()=>[y(" Category")]),_:1})]),_:1}),e(S,{side:""},{default:a(()=>[e(P,{class:"text-overline"},{default:a(()=>[y("Unit")]),_:1})]),_:1})]),_:1}),(g(!0),$(F,null,H(u.value,(s,f)=>(g(),U(A,{key:f},{default:a(()=>[e(S,null,{default:a(()=>[e(P,{class:"text-subtitle1"},{default:a(()=>[y(V(s.code),1)]),_:2},1024)]),_:2},1024),e(S,null,{default:a(()=>[e(P,{class:"text-subtitle1",align:"left"},{default:a(()=>[y(V(s.name),1)]),_:2},1024)]),_:2},1024),e(S,null,{default:a(()=>[e(P,{class:"text-subtitle1"},{default:a(()=>[y(V(s.category),1)]),_:2},1024)]),_:2},1024),e(S,{side:""},{default:a(()=>[e(P,{class:"text-subtitle1"},{default:a(()=>[y(V(s.unit),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}),e(ce,{class:"row q-ma-md",align:"right"},{default:a(()=>[e(D,{class:"glossy",color:"grey-9",label:"Dismiss",onClick:d}),e(D,{class:"glossy",color:"teal",label:"Create",onClick:h})]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}};var ua=K(ia,[["__scopeId","data-v-656550b2"]]);const Be=o=>(G("data-v-33b05e1b"),o=o(),J(),o),da={class:"row justify-between"},ca={class:"row q-gutter-x-sm"},ma={key:0,class:"spinner-wrapper"},_a={key:1},pa={key:0,class:"data-error"},ga=Be(()=>r("div",{class:"q-ml-sm text-h6"},"No data available",-1)),fa=Be(()=>r("div",{class:"text-white"},"Edit Available Stocks",-1)),va={class:"row justify-center q-gutter-x-md"},ha={__name:"RawMaterialsTable",setup(o){const x=Y().params.warehouse_id,v=ne(),n=R(""),u=R(!0),b=R([]),C=R(!1),d=R({rowsPerPage:0}),h=I(()=>v.warehouseRawMaterials),M=I(()=>n.value?h.value.filter(l=>l.name.toLowerCase().includes(n.value.toLowerCase())):h.value);me(async()=>{console.log("props.warehouseId in onMounted:",x),x&&await c(x)});const c=async l=>{try{u.value=!0;const t=await v.fetchWarehouseRawMaterials(l);h.value=t,h.value.length||(C.value=!0),console.log("Warehouse Raw Materials",h.value)}catch(t){console.log("Error fetching branch product:",t),C.value=!0}finally{u.value=!1}};async function s(l,t){try{const i=await Ve.put("/api/update-warehouse-rawMaterials/"+l.id,{total_quantity:parseInt(t)});if(i.status===200){const _=b.value.findIndex(T=>T.id==l.id);b.value[_]=parseInt(t),Z.create({type:"positive",message:i.data.message,timout:1e3,position:"top"})}}catch(i){console.error("Error updating price:",i)}}_e(n,async l=>{u.value=!0,await new Promise(t=>setTimeout(t,1e3)),u.value=!1,C.value=M.value.length===0});const f=l=>{const t=l.total_quantity,i=l.raw_materials.unit;if(console.log("unit test",i),i==="Grams"&&t<1e3)return"bg-red";let _;return t>=1e3?_=t/1e3:_=t,_<5?_<=2?"bg-red":(_<=3,"bg-warning"):"bg-positive"},q=l=>{var T;const t=Number(l==null?void 0:l.total_quantity)||0,i=((T=l==null?void 0:l.raw_materials)==null?void 0:T.unit)||"units";console.log("totalQuantity:",t),console.log("unit:",i);const _=N=>{const L=Number(N);return Number.isInteger(L)?L:L.toFixed(2)};if(t>1e3){const N=t/1e3;if(N>=25){const L=N/25;return`${_(L)} sacks`}return`${_(N)} kilos`}return`${_(t)} ${i}`},k=[{name:"code",label:"Raw Materials Code",align:"center",field:l=>{var t,i;return(i=(t=l==null?void 0:l.raw_materials)==null?void 0:t.code)!=null?i:"No Code"},format:l=>`${l}`,sortable:!0},{name:"name",label:"Raw Materials Name",align:"center",field:l=>{var t,i;return(i=(t=l==null?void 0:l.raw_materials)==null?void 0:t.name)!=null?i:"No Code"},format:l=>`${l}`,sortable:!0},{name:"total_quantity",label:"Available Stocks",align:"center",field:"total_quantity",sortable:!0},{name:"action",label:"Action",align:"center",sortable:!0}];return(l,t)=>(g(),$(F,null,[r("div",da,[r("div",null,[e(W,{class:"q-pb-lg q-pl-md",modelValue:n.value,"onUpdate:modelValue":t[0]||(t[0]=i=>n.value=i),outlined:"",placeholder:"Search",debounce:"1000",style:{width:"450px","max-width":"5000px","min-width":"100px"},flat:"",dense:"",rounded:""},{append:a(()=>[e(E,{name:"search"})]),_:1},8,["modelValue"])]),r("div",ca,[r("div",null,[e(aa)]),r("div",null,[e(ua)])])]),u.value?(g(),$("div",ma,[e(qe,{size:"50px",color:"primary"})])):(g(),$("div",_a,[M.value.length===0?(g(),$("div",pa,[e(E,{name:"warning",color:"warning",size:"4em"}),ga])):(g(),U(ge,{key:1,class:"table-container sticky-header",filter:n.value,flat:"",columns:k,rows:M.value,"row-key":"name",pagination:d.value,"onUpdate:pagination":t[1]||(t[1]=i=>d.value=i),"rows-per-page-options":[0],"hide-bottom":"",style:{height:"375px"}},{"body-cell-total_quantity":a(i=>[e(O,{props:i},{default:a(()=>[e(j,{square:"",class:Re(["text-white cursor-pointer",f(i.row)])},{default:a(()=>[y(V(q(i.row))+" ",1),e(ke,{class:"bg-blue-grey-8",offset:[10,10]},{default:a(()=>[fa]),_:1}),e(We,{"onUpdate:modelValue":[_=>s(i.row,_),_=>i.row.total_quantity=_],modelValue:i.row.total_quantity,"auto-save":""},{default:a(_=>[e(W,{modelValue:_.value,"onUpdate:modelValue":T=>_.value=T,dense:"",suffix:i.row.raw_materials.unit,mask:"########",autofocus:"",counter:"",onKeyup:Fe(_.set,["enter"])},null,8,["modelValue","onUpdate:modelValue","suffix","onKeyup"])]),_:2},1032,["onUpdate:modelValue","modelValue"])]),_:2},1032,["class"])]),_:2},1032,["props"])]),"body-cell-action":a(i=>[e(O,{props:i},{default:a(()=>[r("div",va,[e(ra,{delete:i},null,8,["delete"])])]),_:2},1032,["props"])]),_:1},8,["filter","rows","pagination"]))]))],64))}};var wa=K(ha,[["__scopeId","data-v-33b05e1b"]]);const ya={class:"q-gutter-sm"},ba={class:"q-gutter-x-sm"},xa={__name:"WarehouseRawMaterialsPage",setup(o){return(Q,x)=>(g(),$("div",ya,[r("div",ba,[e(j,{label:"Good",class:"text-white",color:"positive"}),e(j,{label:"Warning",class:"text-white",color:"warning"}),e(j,{label:"Danger",class:"text-white",color:"red"})]),r("div",null,[e(wa)])]))}},Ra={__name:"BranchRawMaterials",props:{branchReport:Object,getRawMaterialBadgeColor:Function,getBadgeCategoryColor:Function,formatTotalQuantity:Function,capitalizeFirstLetter:Function},setup(o){Pe(),console.log("branchReportss",o.branchReport),R(!1),R(!0);const x=R([{name:"raw_material",label:"Raw Materials Name",align:"left",field:v=>{var n;return((n=v.raw_material)==null?void 0:n.name)||"No record"}},{name:"code",label:"Code",align:"left",field:v=>{var n;return((n=v.raw_material)==null?void 0:n.code)||"No record"}},{name:"category",label:"Category",align:"left",field:v=>{var n;return((n=v.raw_material)==null?void 0:n.category)||"No record"}},{name:"total_quantity",label:"Available Stocks",align:"center",field:"total_quantity"}]);return(v,n)=>(g(),U(ge,{rows:o.branchReport.reports,columns:x.value,"row-key":"id",flat:"",bordered:"",pagination:v.pagination,"onUpdate:pagination":n[0]||(n[0]=u=>v.pagination=u),"rows-per-page-options":[0],"hide-bottom":"",class:"q-mt-md sticky-header3",style:{height:"450px"}},{"body-cell-total_quantity":a(u=>[e(O,{props:u},{default:a(()=>[e(j,{square:"",class:Re(["text-white cursor-pointer",o.getRawMaterialBadgeColor(u.row)])},{default:a(()=>[y(V(o.formatTotalQuantity(u.row)),1)]),_:2},1032,["class"])]),_:2},1032,["props"])]),"body-cell-category":a(u=>[e(O,{key:"name",props:u},{default:a(()=>[e(j,{color:o.getBadgeCategoryColor(u.row.raw_material.category)},{default:a(()=>[y(V(u.row.raw_material.category),1)]),_:2},1032,["color"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","pagination"]))}},Ca={class:"row justify-between"},Ma={class:"text-h6"},qa=r("div",{class:"text-h6",align:"center"},"Premix",-1),ka=r("div",{class:"text-h6",align:"center"},"Ingredients List",-1),$a={class:"text-grey-7 q-mt-xs"},Va=r("div",{class:"text-h6 text-weight-regular"}," Do you want to receive the premix? ",-1),Qa={__name:"TransactionView",props:{report:{type:Object,required:!0}},emits:["update-history"],setup(o,{emit:Q}){var te,ve,he,we,ye;const x=Ee(),v=I(()=>x.user);console.log("userData in RawMaterialsTable:",v.value);const n=((ve=(te=v.value)==null?void 0:te.data)==null?void 0:ve.employee_id)||"";console.log("employeeId in PremixPage:",n);const u=Ie();I(()=>u.branchPremix),Qe();const b=R(!1),C=R(!1),d=o;console.log("props",d.report);const h=d.report.branch_premix.branch_id;console.log("branchId",h);const M=()=>{b.value=!0},c=p=>{const m=w=>w?w.charAt(0).toUpperCase()+w.slice(1).toLowerCase():"";return`${m(p.firstname||"No Firstname")} ${p.middlename?m(p.middlename).charAt(0)+".":""} ${m(p.lastname||"No Lastname")}`},s=[{label:"Pending",value:"pending"},{label:"Declined",value:"declined"},{label:"Confirmed",value:"confirmed"},{label:"Process",value:"process"},{label:"Completed",value:"completed"},{label:"To Deliver",value:"to deliver"},{label:"To Receive",value:"to receive"},{label:"Received",value:"received"}],f=I(()=>{var p;return(p=d.report.history)!=null&&p.length?s.filter(m=>d.report.history.some(w=>w.status===m.value)):[]}),q=p=>{const m=d.report.history.find(w=>w.status===p);return m?p==="received"?`Received by: ${c(m.employee)}`:p==="pending"?`Requested by: ${c(m.employee)}`:`Handled by: ${c(m.employee)}`:"No handler"},k=p=>{const m=Number(p);return isNaN(m)?"":(m%1===0,m.toString())},l=(p,m)=>{if(m==="Pcs")return`${p} pcs`;if(m==="Grams"){if(p>=1e3){let w=p/1e3;return`${w%1===0?w.toString():w.toString().replace(/^0+/,"")} kgs`}return`${p} g`}return`${p} ${m}`},t=((ye=(we=(he=d.report)==null?void 0:he.branch_premix)==null?void 0:we.branch_recipe)==null?void 0:ye.ingredient_groups)||"Undefined";console.log("ingrdientsData",t);const i=I(()=>t.map(p=>{const m=parseFloat(p.quantity)*parseFloat(d.report.quantity);return{...p,totalQuantity:m,formattedQuantity:l(m,p.ingredient.unit)}}));console.log("report to proceed",d.report);const _=I(()=>{var p,m;return((m=(p=d.report.history)==null?void 0:p[d.report.history.length-1])==null?void 0:m.status)||null});console.log("lastStatus",_.value);const T=I(()=>f.value.findIndex(p=>p.value===_.value)+1),N=p=>{var m;return(m=d.report.history)==null?void 0:m.some(w=>w.status===p)},L=p=>({pending:"warning",declined:"red-6",confirmed:"green",process:"primary",completed:"dark","to deliver":"brown-9","to receive":"amber-10",received:"secondary"})[p]||"grey",ie=async()=>{const p={request_premix_id:d.report.id,branch_premix_id:d.report.branch_premix_id,branch_id:d.report.branch_premix.branch_id,employee_id:n,status:"receive",notes:"Received Premix",quantity:d.report.quantity,warehouse_id:d.report.warehouse_id,ingredients:i.value.map(m=>({ingredients_id:m.ingredient.id,total_quantity:m.totalQuantity,unit:m.ingredient.unit}))};console.log("payload",p),await u.receivePremix(p),await u.fetchRequestBranchPremix(h),b.value=!1};return(p,m)=>(g(),$(F,null,[r("div",null,[e(D,{color:"accent",icon:"visibility",size:"md",flat:"",round:"",dense:"",onClick:M})]),e(ee,{modelValue:b.value,"onUpdate:modelValue":m[2]||(m[2]=w=>b.value=w)},{default:a(()=>[e(z,{style:{width:"700px","max-width":"80vw"}},{default:a(()=>[e(B,null,{default:a(()=>[r("div",Ca,[r("div",Ma,V(o.report.name),1),e(D,{class:"close-btn",color:"grey-8",flat:"",round:"",dense:"",icon:"close",onClick:m[0]||(m[0]=w=>b.value=!1)})])]),_:1}),e(B,null,{default:a(()=>[r("div",null,"Baker: "+V(c(o.report.employee)),1),r("div",null," Branch: "+V(o.report.branch_premix.branch_recipe.branch.name),1),r("div",null,[y(" Status: "),e(j,{color:L(o.report.status),outlined:""},{default:a(()=>[y(V(o.report.status),1)]),_:1},8,["color"])])]),_:1}),e(B,{class:"q-gutter-y-md"},{default:a(()=>[r("div",null,[qa,e(se,{dense:"",separator:"",class:"box"},{default:a(()=>[e(A,null,{default:a(()=>[e(S,null,{default:a(()=>[e(P,{class:"text-overline"},{default:a(()=>[y("Premix Name")]),_:1})]),_:1}),e(S,{side:""},{default:a(()=>[e(P,{class:"text-overline"},{default:a(()=>[y("Request Quantity / kgs")]),_:1})]),_:1})]),_:1}),e(A,null,{default:a(()=>[e(S,null,{default:a(()=>[e(P,{class:"text-h6"},{default:a(()=>[y(V(o.report.name),1)]),_:1})]),_:1}),e(S,{side:""},{default:a(()=>[e(P,{class:"text-h6"},{default:a(()=>[y(V(k(o.report.quantity)),1)]),_:1})]),_:1})]),_:1})]),_:1})]),r("div",null,[ka,e(se,{dense:"",separator:"",class:"box"},{default:a(()=>[e(A,null,{default:a(()=>[e(S,null,{default:a(()=>[e(P,{class:"text-overline"},{default:a(()=>[y(" Code")]),_:1})]),_:1}),e(S,null,{default:a(()=>[e(P,{class:"text-overline"},{default:a(()=>[y(" Name")]),_:1})]),_:1}),e(S,{side:""},{default:a(()=>[e(P,{class:"text-overline"},{default:a(()=>[y("Quantity")]),_:1})]),_:1})]),_:1}),(g(!0),$(F,null,H(le(t),(w,X)=>(g(),U(A,{key:X},{default:a(()=>[e(S,null,{default:a(()=>[e(P,{class:"text-subtitle1"},{default:a(()=>[y(V(w.ingredient.code),1)]),_:2},1024)]),_:2},1024),e(S,null,{default:a(()=>[e(P,{class:"text-subtitle1",align:"left"},{default:a(()=>[y(V(w.ingredient.name),1)]),_:2},1024)]),_:2},1024),e(S,{side:""},{default:a(()=>[e(P,{class:"text-subtitle1"},{default:a(()=>[y(V(l(w.quantity*o.report.quantity,w.ingredient.unit)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})])]),_:1}),e(je,{modelValue:T.value,"onUpdate:modelValue":m[1]||(m[1]=w=>T.value=w),animated:"",class:"q-pa-lg"},{default:a(()=>[(g(!0),$(F,null,H(f.value,(w,X)=>(g(),U(Ke,{key:X,name:X+1,title:w.label,color:L(w.value),done:N(w.value),icon:N(w.value)?"check":"radio_button_unchecked",class:"custom-step"},{default:a(()=>[r("div",$a,V(q(w.value)),1)]),_:2},1032,["name","title","color","done","icon"]))),128))]),_:1},8,["modelValue"]),_.value==="to receive"?(g(),U(B,{key:0,class:"text-center q-gutter-md"},{default:a(()=>[Va,e(D,{color:"amber-10",label:"Yes",icon:"check",onClick:ie,loading:C.value},null,8,["loading"])]),_:1})):xe("",!0)]),_:1})]),_:1},8,["modelValue"])],64))}};const Sa=o=>(G("data-v-a70b2fce"),o=o(),J(),o),Pa={key:0,class:"spinner-wrapper"},Ia={key:1},Da={key:0,class:"data-error"},Ba=Sa(()=>r("div",{class:"q-ml-sm text-h6"},"No data available",-1)),Na={__name:"BranchTransaction",props:{branchId:Object},setup(o){const Q=Y();I(()=>Q.params.warehouse_id||null);const x=Ie(),v=I(()=>x.branchPremix);console.log("premixDatas",v.value);const n=R([]),u=R(""),b=R(!0),C=o,d=R(!1),h=R({page:1,rowsPerPage:0,rowsNumber:0}),M=C.branchId,c=async(t,i=0,_=5,T="")=>{try{d.value=!0,await x.fetchRequestBranchPremix(t,i,_,T),console.log("Fetch premix data",v.value);const{data:N,current_page:L,per_page:ie,total:te}=v.value;n.value=N,h.value.page=L,console.log("pagination.value.page",h.value.page),h.value.rowsPerPage=ie,console.log("pagination.value.rowsPerPage",h.value.rowsPerPage),h.value.rowsNumber=te,console.log("pagination.value.rowsNumber",h.value.rowsNumber)}catch(N){console.log("error",N)}finally{d.value=!1}};me(async()=>{M&&await c(M),console.log("premixdatas",v.value)});const s=t=>{c(M,t.pagination.page,t.pagination.rowsPerPage)};_e(u,async t=>{b.value=!0,await c(M,h.value.page,h.value.rowsPerPage,t),b.value=!1});const f=t=>Ae.formatDate(t,"MMM D, YYYY - hh:mm A"),q=t=>t.charAt(0).toUpperCase()+t.slice(1).toLowerCase(),k=t=>{switch(t){case"pending":return"warning";case"declined":return"red-6";case"confirmed":return"green";case"process":return"primary";case"completed":return"dark";case"to deliver":return"brown-9";case"to receive":return"amber-10";case"received":return"secondary";default:return"grey"}},l=[{name:"name",label:"Transactions Name",align:"left",field:t=>t.name,format:t=>`${t}`,sortable:!0},{name:"date",align:"center",label:"Created Date",field:"created_at",format:t=>f(t),sortable:!0},{name:"updated_at",align:"center",label:"Updated Date",field:"updated_at",format:t=>f(t),sortable:!0},{name:"status",align:"center",label:"Status",field:"status",sortable:!0},{name:"view",align:"right",label:"View",field:"view",sortable:!0}];return(t,i)=>(g(),$(F,null,[r("div",null,[e(W,{rounded:"",outlined:"",dense:"",debounce:"300",modelValue:u.value,"onUpdate:modelValue":i[0]||(i[0]=_=>u.value=_),placeholder:"Search",style:{width:"500px","max-width":"1500px","min-width":"100px"}},null,8,["modelValue"])]),d.value?(g(),$("div",Pa,[e(qe,{size:"50px",color:"primary"})])):(g(),$("div",Ia,[n.value.length===0?(g(),$("div",Da,[e(E,{name:"warning",color:"warning",size:"4em"}),Ba])):(g(),U(ge,{key:1,bordered:"",class:"q-mt-md",flat:"",columns:l,rows:n.value,pagination:h.value,"onUpdate:pagination":i[1]||(i[1]=_=>h.value=_),"rows-per-page-options":[5,7,10,0],"row-key":"id",onRequest:s,loading:d.value},{"body-cell-status":a(_=>[e(O,{props:_},{default:a(()=>[e(j,{outlined:"",color:k(_.row.status)},{default:a(()=>[y(V(q(_.row.status)),1)]),_:2},1032,["color"])]),_:2},1032,["props"])]),"body-cell-view":a(_=>[e(O,{props:_},{default:a(()=>[r("div",null,[e(Qa,{report:_.row,onUpdateHistory:t.updateReportHistory},null,8,["report","onUpdateHistory"])])]),_:2},1032,["props"])]),_:1},8,["rows","pagination","loading"]))]))],64))}};var Ta=K(Na,[["__scopeId","data-v-a70b2fce"]]);const Ua={class:"row justify-between"},Fa={class:"text-h6"},La={__name:"DialogPage",props:{branchReport:Object,capitalizeFirstLetter:Function,getRawMaterialBadgeColor:Function,getBadgeCategoryColor:Function,formatTotalQuantity:Function},setup(o){const{dialogRef:Q,onDialogHide:x,onDialogOK:v,onDialogCancel:n}=Pe(),b=o.branchReport.branch_id,C=R("branchRawMaterials"),d=R(!1),h=R(!0);return(M,c)=>(g(),U(ee,{ref_key:"dialogRef",ref:Q,onHide:le(x),modelValue:d.value,"onUpdate:modelValue":c[2]||(c[2]=s=>d.value=s),maximized:h.value,"transition-show":"slide-up","transition-hide":"slide-down"},{default:a(()=>[e(z,null,{default:a(()=>[e(B,null,{default:a(()=>[r("div",Ua,[r("div",Fa,V(`${o.capitalizeFirstLetter(o.branchReport.branch_name)}  Branch`),1),r("div",null,[e(D,{round:"",dense:"",flat:"",icon:"close",onClick:le(n)},null,8,["onClick"])])]),r("div",null,[e(Ce,{modelValue:C.value,"onUpdate:modelValue":c[0]||(c[0]=s=>C.value=s),align:"justify","narrow-indicator":"",class:"q-mb-lg"},{default:a(()=>[e(oe,{class:"text-purple",name:"branchRawMaterials",label:"Branch Raw Materials"}),e(oe,{class:"text-orange",name:"branchPremixTransactions",label:"Branch Premix Transactions"})]),_:1},8,["modelValue"]),r("div",null,[e(Me,{modelValue:C.value,"onUpdate:modelValue":c[1]||(c[1]=s=>C.value=s),animated:"","transition-prev":"scale","transition-next":"scale"},{default:a(()=>[e(re,{name:"branchRawMaterials"},{default:a(()=>[e(Ra,{branchReport:o.branchReport,getRawMaterialBadgeColor:o.getRawMaterialBadgeColor,getBadgeCategoryColor:o.getBadgeCategoryColor,formatTotalQuantity:o.formatTotalQuantity,capitalizeFirstLetter:o.capitalizeFirstLetter},null,8,["branchReport","getRawMaterialBadgeColor","getBadgeCategoryColor","formatTotalQuantity","capitalizeFirstLetter"])]),_:1}),e(re,{name:"branchPremixTransactions"},{default:a(()=>[e(Ta,{branchId:le(b)},null,8,["branchId"])]),_:1})]),_:1},8,["modelValue"])])])]),_:1})]),_:1})]),_:1},8,["onHide","modelValue","maximized"]))}};const Ne=o=>(G("data-v-8e017a4c"),o=o(),J(),o),za={class:"q-pa-md elegant-container"},Wa={key:0,class:"skeleton-wrapper row q-col-gutter-md"},Aa={key:1,class:"data-error"},ja=Ne(()=>r("div",null,"No data available",-1)),Ka={key:2,class:"q-pa-md row q-col-gutter-md"},Ea=Ne(()=>r("img",{src:"https://cdn.quasar.dev/img/mountains.jpg"},null,-1)),Ha={class:"q-mt-lg"},Oa={class:"text-h6 text-weight-medium elegant-name text-capitalize"},Ya={__name:"BranchCard",props:["branchRawMaterialsReport"],setup(o){const Q=Y(),x=Se(),v=Qe(),n=I(()=>x.warehouseBranchReports),u=R(!1),b=I(()=>Q.params.warehouse_id||null),C=R(!1),d=f=>{v.dialog({component:La,componentProps:{branchReport:f,getRawMaterialBadgeColor:h,getBadgeCategoryColor:c,formatTotalQuantity:s,capitalizeFirstLetter:M}})},h=f=>{const q=f.quantity;if(f.raw_material.unit==="Grams"&&q<1e3)return"bg-red";let l;return q>=1e3?l=q/1e3:l=q,l<5?l<=2?"bg-red":(l<=3,"bg-warning"):"bg-positive"},M=f=>f?f.split(" ").map(q=>q.charAt(0).toUpperCase()+q.slice(1).toLowerCase()).join(" "):"",c=f=>{switch(f){case"Ingredients":return"teal";case"Packaging Materials":return"brown-6";default:return"grey"}},s=f=>{const q=f.quantity,k=f.raw_material.unit;if(q>1e3){const l=(q/1e3).toFixed(2);return l.endsWith(".00")?`${Math.round(q/1e3)} kilos`:`${l} kilos`}else return q>1?`${q} ${k}`:`${q} ${k}`};return _e(b,async f=>{if(f)try{u.value=!0,await x.fetchWarehouseByBranchID(f),C.value=n.value.length===0}catch(q){console.error("Error fetching warehouse data:",q),C.value=!0}finally{u.value=!1}},{immediate:!0}),(f,q)=>(g(),$("div",za,[u.value?(g(),$("div",Wa,[(g(),$(F,null,H(8,k=>r("div",{class:"col-xs-12 col-sm-6 col-md-4 col-lg-3",key:k},[e(z,{class:"user-card skeleton-card"},{default:a(()=>[e(ue,{height:"200px",class:"q-mb-md"}),e(B,{class:"text-center"},{default:a(()=>[e(ue,{type:"text",width:"60%",class:"q-mt-lg"}),e(ue,{type:"text",width:"40%",class:"q-mt-sm"})]),_:1})]),_:1})])),64))])):C.value?(g(),$("div",Aa,[e(E,{name:"error",size:"50px",color:"negative"}),ja])):(g(),$("div",Ka,[(g(!0),$(F,null,H(n.value,k=>(g(),$("div",{key:k.branch_id,class:"col-xs-12 col-sm-6 col-md-4 col-lg-3"},[e(z,{class:"user-card",onClick:l=>d(k)},{default:a(()=>[Ea,e(B,{class:"text-center"},{default:a(()=>[r("div",Ha,[r("div",Oa,V(M(k.branch_name)),1)])]),_:2},1024)]),_:2},1032,["onClick"])]))),128))]))]))}};var Ga=K(Ya,[["__scopeId","data-v-8e017a4c"]]);const Ja={class:"elegant-container q-gutter-md"},Xa={class:"text-h6 row justify-between"},Za={class:"q-gutter-sm"},et={class:"tab-container"},at={__name:"WarehouseIdPage",setup(o){const Q=Y(),x=Le(),v=Se(),n=R("");I(()=>v.warehouse);const u=I(()=>Q.params.warehouse_id||"Unknown Warehouse"),b=R("warehouseRawMaterials"),C=async c=>(await Ve.get(`/api/warehouse/${c}`)).data,d=async()=>{try{const c=await C(u.value);c&&c.name?n.value=c.name:console.error("Warehouse name data is missing",c)}catch(c){console.error("Error fetching warehouse data:",c)}};me(()=>{d()});const h=c=>c?c.split(" ").map(s=>s.charAt(0).toUpperCase()+s.slice(1).toLowerCase()).join(" "):"",M=()=>{Loading.show(),x.push("/admin/warehouse").finally(()=>{Loading.hide()})};return(c,s)=>(g(),U(ze,{padding:""},{default:a(()=>[r("div",Ja,[r("div",Xa,[r("div",null,[e(D,{outline:"",flat:"",icon:"arrow_back",to:"/admin/warehouse",onClick:M}),e(pe)]),r("div",null,[e(E,{name:"factory"}),y(" "+V(h(n.value)),1)])]),r("div",Za,[r("div",et,[e(Ce,{modelValue:b.value,"onUpdate:modelValue":s[0]||(s[0]=f=>b.value=f),dense:"",class:"bg-grey-2 text-grey-7 tabs-as-cards","active-color":"red-6","indicator-color":"transparent",align:"justify"},{default:a(()=>[e(oe,{name:"warehouseRawMaterials",label:"Warehouse Raw Materials"}),e(oe,{name:"branchRawMaterials",label:"Branch Raw Materials"})]),_:1},8,["modelValue"])]),e(z,{class:"q-mt-sm"},{default:a(()=>[e(Me,{modelValue:b.value,"onUpdate:modelValue":s[1]||(s[1]=f=>b.value=f),animated:""},{default:a(()=>[e(re,{name:"warehouseRawMaterials"},{default:a(()=>[e(xa)]),_:1}),e(re,{name:"branchRawMaterials"},{default:a(()=>[e(Ga)]),_:1})]),_:1},8,["modelValue"])]),_:1})])])]),_:1}))}};var Ut=K(at,[["__scopeId","data-v-560de15d"]]);export{Ut as default};
