import{r as R,c as F,o as m,a2 as x,f as o,M as b,w as s,Q as w,I as f,J as e,$ as c,_ as n,a3 as N,a4 as U,bc as z,a1 as q,K as P,aI as j,ad as E,P as M,O as K,R as J,z as G,u as H,e as k,L as T,bb as W}from"./index.396b8b2c.js";import{Q as X}from"./QBadge.b7276359.js";import{Q as Z}from"./QScrollArea.b9767528.js";import{Q as ee}from"./QPage.34780c7a.js";import{u as O}from"./baker-report.6dbeba07.js";import{q as Q}from"./date.b0cc1a6c.js";import{C as te}from"./ClosePopup.f6501674.js";import{u as ae}from"./use-quasar.25daf951.js";import{_ as oe}from"./plugin-vue_export-helper.21dcd24c.js";import"./QResizeObserver.1a4a2898.js";import"./QScrollObserver.3cdb672b.js";import"./TouchPan.2b4e7a90.js";import"./touch.9135741d.js";import"./selection.aff67700.js";import"./axios.afda6b01.js";const d=l=>(K("data-v-43a5f382"),l=l(),J(),l),re=d(()=>e("div",{class:"report-title"},"Report Details",-1)),se={class:"invoice-header"},le=d(()=>e("strong",null,"Date:",-1)),ne=d(()=>e("strong",null,"Branch:",-1)),ie={class:"invoice-body"},ce=d(()=>e("strong",null,"Baker:",-1)),de=d(()=>e("strong",null,"Recipe:",-1)),ue=d(()=>e("strong",null,"Status:",-1)),me=d(()=>e("strong",null,"Kilo:",-1)),pe=d(()=>e("strong",null,"Over:",-1)),fe=d(()=>e("strong",null,"Short:",-1)),_e=d(()=>e("strong",null,"Actual Target:",-1)),ve={key:0,class:"invoice-section"},he=d(()=>e("div",{class:"section-title"},"Breads",-1)),ge={class:"bread-name"},ye={class:"bread-production"},be=d(()=>e("div",{class:"text-h6"},"Decline Report",-1)),ke={__name:"BakersReportView",props:{report:{type:Object,required:!0}},setup(l){const p=l,g=R(!1),C=()=>{g.value=!0},u=ae(),_=O(),v=R(!1),y=R(""),V=()=>{v.value=!0},h=r=>r.charAt(0).toUpperCase()+r.slice(1).toLowerCase(),L=r=>{const t=D=>D?D.charAt(0).toUpperCase()+D.slice(1).toLowerCase():"",a=r.firstname?t(r.firstname):"No Firstname",i=r.middlename?t(r.middlename).charAt(0)+".":"",A=r.lastname?t(r.lastname):"No Lastname";return`${a} ${i} ${A}`},S=r=>Q.formatDate(r,"MMMM D, YYYY hh:mm A"),B=F(()=>p.report.bread_bakers_reports.filter(r=>r.bread_production>0)),Y=async()=>{try{M.show();const r=await _.confirmReport(p.report.id);console.log("Report confirmed:",r),u.notify({type:"positive",message:"Report confirmed successfully"}),v.value=!1}catch{u.notify({type:"negative",message:"Failed to confirm report"})}finally{M.hide()}},$=async()=>{try{if(M.show(),!y.value.trim()){u.notify({type:"negative",message:"Remark cannot be empty"});return}await _.declineReport(p.report.id,y.value),u.notify({type:"positive",message:"Report declined successfully"}),v.value=!1,g.value=!1}catch{u.notify({type:"negative",message:"Failed to decline report"})}finally{M.hide()}};return(r,t)=>(m(),x(N,null,[o(b,{color:"accent",icon:"visibility",size:"md",flat:"",round:"",dense:"",onClick:V}),o(q,{modelValue:v.value,"onUpdate:modelValue":t[1]||(t[1]=a=>v.value=a),class:"report-dialog"},{default:s(()=>[o(w,{class:"report-card"},{default:s(()=>[o(f,{class:"report-header"},{default:s(()=>[re,o(b,{class:"close-btn",color:"grey-8",flat:"",round:"",dense:"",icon:"close",onClick:t[0]||(t[0]=a=>v.value=!1)})]),_:1}),o(f,{class:"report-info"},{default:s(()=>[e("div",se,[e("div",null,[le,c(" "+n(S(l.report.created_at)),1)]),e("div",null,[ne,c(" "+n(h(l.report.branch.name)),1)])]),e("div",ie,[e("div",null,[ce,c(" "+n(L(l.report.user.employee)),1)]),e("div",null,[de,c(" "+n(h(l.report.branch_recipe.recipe.name)),1)]),e("div",null,[ue,c(" "+n(h(l.report.status)),1)]),e("div",null,[me,c(" "+n(l.report.kilo),1)]),e("div",null,[pe,c(" "+n(l.report.over),1)]),e("div",null,[fe,c(" "+n(l.report.short),1)]),e("div",null,[_e,c(" "+n(l.report.actual_target),1)])]),B.value.length?(m(),x("div",ve,[he,e("ul",null,[(m(!0),x(N,null,U(B.value,a=>(m(),x("li",{key:a.id},[e("span",ge,n(a.bread.name)+" -",1),e("span",ye,n(a.bread_production)+" pcs",1)]))),128))])])):z("",!0)]),_:1}),o(f,{class:"report-actions q-gutter-sm",align:"right"},{default:s(()=>[o(b,{color:"negative",label:"Decline",onClick:C,class:"action-btn"}),o(b,{color:"positive",label:"Confirm",onClick:Y,class:"action-btn"})]),_:1})]),_:1})]),_:1},8,["modelValue"]),o(q,{modelValue:g.value,"onUpdate:modelValue":t[3]||(t[3]=a=>g.value=a)},{default:s(()=>[o(w,null,{default:s(()=>[o(f,null,{default:s(()=>[be]),_:1}),o(f,null,{default:s(()=>[o(P,{modelValue:y.value,"onUpdate:modelValue":t[2]||(t[2]=a=>y.value=a),placeholder:"Enter your remark",label:"Remark",type:"textarea",filled:"","lazy-rules":"",rules:[a=>!!a||"Remark is required"]},null,8,["modelValue","rules"])]),_:1}),o(j,{align:"right"},{default:s(()=>[E(o(b,{flat:"",label:"Cancel",color:"primary"},null,512),[[te]]),o(b,{flat:"",label:"Confirm",color:"negative",onClick:$})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};var Re=oe(ke,[["__scopeId","data-v-43a5f382"]]);const Ce={class:"q-gutter-md"},De={class:"q-gutter-md q-ma-md"},xe={class:"row justify-between"},we={class:"text-subtitle1"},Ve={class:"text-subtitle1"},Be={class:"text-h6"},$e={__name:"BakersReportCard",setup(l){var $,r;const p=O(),C=((r=($=F(()=>p.user).value)==null?void 0:$.device)==null?void 0:r.branch_id)||"",u=R(""),_=R(!1),v=R(!1);G(async()=>{console.log("props.userID in onMounted:",C),C&&await y(C)});const y=async t=>{_.value=!0,await p.fetchDoughReports(t),_.value=!1},V=t=>t.charAt(0).toUpperCase()+t.slice(1).toLowerCase();H(u,async t=>{_.value=!0,await new Promise(a=>setTimeout(a,1e3)),_.value=!1});const h=F(()=>{if(!u.value)return p.reports;const t=u.value.toLowerCase();return p.reports.filter(a=>a.branch_recipe.recipe.name&&a.branch_recipe.recipe.name.toLowerCase().includes(t)||a.created_at&&Q.formatDate(a.created_at,"MMMM D, YYYY").toLowerCase().includes(t)||a.branch_recipe.recipe.category&&a.branch_recipe.recipe.category.toLowerCase().includes(t))});console.log("baekr reports",h.value);const L=t=>Q.formatDate(t,"MMMM D, YYYY"),S=t=>Q.formatDate(t,"hh:mm A"),B=t=>{const a=I=>I?I.charAt(0).toUpperCase()+I.slice(1).toLowerCase():"",i=t.firstname?a(t.firstname):"No Firstname",A=t.middlename?a(t.middlename).charAt(0)+".":"",D=t.lastname?a(t.lastname):"No Lastname";return`${i} ${A} ${D}`},Y=t=>{switch(t){case"pending":return"orange";case"declined":return"negative";case"confirmed":return"green";default:return"grey"}};return(t,a)=>(m(),k(ee,{padding:""},{default:s(()=>[e("div",Ce,[e("div",null,[o(P,{rounded:"",outlined:"",dense:"",debounce:"300",modelValue:u.value,"onUpdate:modelValue":a[0]||(a[0]=i=>u.value=i),placeholder:"Search",style:{width:"500px","max-width":"1500px","min-width":"100px"}},{append:s(()=>[_.value?(m(),k(W,{key:1})):(m(),k(T,{key:0,name:"search"}))]),_:1},8,["modelValue"])]),o(Z,{style:{height:"450px","max-width":"1500px"}},{default:s(()=>[e("div",De,[(m(!0),x(N,null,U(h.value,i=>(m(),k(w,{key:i.id},{default:s(()=>[o(f,null,{default:s(()=>[e("div",xe,[e("div",null,[e("div",we,n(L(i.created_at)),1),e("div",Ve,n(S(i.created_at)),1)]),e("div",Be,n(B(i.user.employee))+" - "+n(V(i.branch_recipe.recipe.name)),1),e("div",null,[o(X,{outlined:"",color:Y(i.status)},{default:s(()=>[c(n(V(i.status)),1)]),_:2},1032,["color"])]),e("div",null,[o(Re,{report:i},null,8,["report"])])])]),_:2},1024)]),_:2},1024))),128))])]),_:1}),v.value&&h.value.length===0?(m(),k(w,{key:0},{default:s(()=>[o(f,{class:"text-h6 text-center"},{default:s(()=>[c("No reports found.")]),_:1})]),_:1})):z("",!0)])]),_:1}))}},Me={class:"text-h6 text-white"},Ee={__name:"BakersReportPage",setup(l){return(p,g)=>(m(),k(w,{flat:""},{default:s(()=>[o(f,{style:{"background-color":"#ef4444"}},{default:s(()=>[e("div",Me,[o(T,{name:"fa-solid fa-layer-group"}),c(" Bakers Report ")])]),_:1}),o(f,null,{default:s(()=>[e("div",null,[o($e)])]),_:1})]),_:1}))}};export{Ee as default};
