import{c as P,r as f,t as Y,o as c,a3 as U,f as o,M as E,w as n,Q as F,I as N,ae as Z,K as w,e as b,L as K,bc as ee,a0 as Q,a4 as J,a5 as M,$ as v,bd as ae,J as r,aJ as te,a2 as oe,O as j,R as H,z as le,u as ne,bb as R,N as $}from"./index.a8c32b7d.js";import{b as se,Q as T,a as re}from"./QTable.bdaae1f4.js";import{Q as de}from"./QTr.a342b969.js";import{Q as L}from"./QTooltip.d12e59ab.js";import{Q as z}from"./QPopupEdit.9ce05591.js";import{Q as ie}from"./QSpinnerIos.44b92c62.js";import{Q as ue}from"./QInnerLoading.10bac593.js";import{Q as me}from"./QPage.e310e205.js";import{Q as ce}from"./QSpace.ceca8436.js";import{Q as B,a as pe}from"./QItem.5b264bd1.js";import{Q as ve}from"./QList.82e76513.js";import{C as fe}from"./ClosePopup.d653f6e2.js";import{u as _e}from"./employee.f6e8e8a0.js";import{u as O}from"./CashAdvanceTable.vue_vue_type_style_index_0_scoped_true_lang.c3497505.js";import{_ as G}from"./plugin-vue_export-helper.21dcd24c.js";import"./QVirtualScroll.ee317096.js";import"./use-virtual-scroll.b2169e1f.js";import"./QSelect.3a6d3ac9.js";import"./QItemLabel.86d156a2.js";import"./QChip.65d671d0.js";import"./QMenu.fc3e6ff0.js";import"./position-engine.dd0951d3.js";import"./selection.befc2b7d.js";import"./axios.b0e603be.js";const D=p=>(j("data-v-dc9c2930"),p=p(),H(),p),ge=D(()=>r("div",{class:"text-h5 q-mr-md"},"\u{1F4B2} Add Cash Advance",-1)),he={key:0,class:"custom-list z-top"},ye={class:"row q-gutter-md text-subtitle1"},be=D(()=>r("div",null,"Name:",-1)),we={class:"text-weight-meduim"},xe={class:"row q-gutter-md text-subtitle1"},Ve=D(()=>r("div",null,"Position:",-1)),Ae={class:"text-weight-meduim"},Ce={class:"q-gutter-y-md"},Qe={__name:"CashAdvanceButton",emits:["created"],setup(p,{emit:_}){const k=_,g=_e(),i=P(()=>g.employees),u=O();P(()=>u.cashAdvances);const d=f(""),x=f(!1),V=f(!1),h=f(!1),y=()=>{h.value=!0},A=async()=>{d.value.trim()&&(V.value=!0,await g.searchEmployee(d.value),V.value=!1)},I=e=>{console.log("Selected Employee:",e),s.employee_id=e.id,s.employee_name=`${e.firstname} ${e.middlename?e.middlename.charAt(0)+".":""} ${e.lastname} `,s.employee_position=e.position,d.value="",console.log("Filled Designation Data:",s)},s=Y({employee_id:"",employee_name:"",employee_position:"",amount:"",reason:""}),S=()=>{s.employee_id="",s.employee_name="",s.employee_position="",s.amount="",s.reason=""},q=async()=>{x.value=!0;try{await u.createCashAdvance(s),k("created"),h.value=!1,S()}catch(e){console.log(e)}finally{x.value=!1}};return(e,l)=>(c(),U("div",null,[o(E,{padding:"sm md",label:"Cash Advance",icon:"attach_money",size:"md",class:"gradient-btn text-white",onClick:y}),o(oe,{modelValue:h.value,"onUpdate:modelValue":l[3]||(l[3]=a=>h.value=a),persistent:"",position:"right","backdrop-filter":"blur(4px) saturate(150%)"},{default:n(()=>[o(F,{style:{width:"400px","max-width":"80vw"}},{default:n(()=>[o(N,{class:"row items-center q-px-md q-py-sm gradient-btn text-white"},{default:n(()=>[ge,o(ce),Z(o(E,{icon:"arrow_forward_ios",flat:"",dense:"",round:""},null,512),[[fe]])]),_:1}),o(N,null,{default:n(()=>[o(w,{modelValue:d.value,"onUpdate:modelValue":[l[0]||(l[0]=a=>d.value=a),A],label:"Search Employee",outlined:"",rounded:"",dense:"",debounce:"500",placeholder:"Enter name"},{append:n(()=>[V.value?(c(),b(ee,{key:1,color:"grey",size:"sm"})):(c(),b(K,{key:0,name:"search"}))]),default:n(()=>[d.value?(c(),U("div",he,[o(F,null,{default:n(()=>[o(ve,{separator:""},{default:n(()=>{var a;return[(a=i.value)!=null&&a.length?(c(!0),U(J,{key:1},M(i.value,t=>(c(),b(B,{onClick:m=>I(t),key:t.id,clickable:""},{default:n(()=>[o(pe,null,{default:n(()=>[Q(v(`${t.firstname} ${t.middlename?t.middlename.charAt(0)+".":""} ${t.lastname}`),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128)):(c(),b(B,{key:0},{default:n(()=>[Q(" No Employee record ")]),_:1}))]}),_:1})]),_:1})])):ae("",!0)]),_:1},8,["modelValue"])]),_:1}),o(N,null,{default:n(()=>[r("div",ye,[be,r("div",we,v(s.employee_name?s.employee_name:"-------"),1)]),r("div",xe,[Ve,r("div",Ae,v(s.employee_position?s.employee_position:"-------"),1)])]),_:1}),o(N,null,{default:n(()=>[r("div",Ce,[r("div",null,[o(w,{modelValue:s.amount,"onUpdate:modelValue":l[1]||(l[1]=a=>s.amount=a),type:"number",outlined:"",label:"Amount"},null,8,["modelValue"])]),r("div",null,[o(w,{modelValue:s.reason,"onUpdate:modelValue":l[2]||(l[2]=a=>s.reason=a),filled:"",type:"textarea",outlined:"",label:"Reason"},null,8,["modelValue"])])])]),_:1}),o(te,null,{default:n(()=>[o(E,{size:"md",padding:"xs md",label:"save","icon-right":"send",class:"gradient-btn text-white",loading:x.value,onClick:q},null,8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}};var Se=G(Qe,[["__scopeId","data-v-dc9c2930"]]);const W=p=>(j("data-v-2847b9a0"),p=p(),H(),p),Ne={class:"row justify-between q-mb-md",align:"right"},$e={class:"row q-gutter-md"},Ue=W(()=>r("div",{class:"text-h6 text-primary text-center q-mb-xs"}," Edit Amount ",-1)),ke={class:"text-subtitle2 q-mb-sm"},Ie=W(()=>r("div",{class:"text-h6 text-primary text-center q-mb-xs"}," Edit Reason ",-1)),qe={class:"text-subtitle2 q-mb-sm"},Ee={__name:"CashAdvanceTable",setup(p){const _=O(),k=P(()=>_.cashAdvances),g=f([]),i=f({page:1,rowsPerPage:0,rowsNumber:0}),u=f(!0),d=f("");function x(e){if(e==null||e==="")return"";const l=parseFloat(e);return isNaN(l)?"":Number.isInteger(l)?String(parseInt(l)):String(l)}async function V(e,l){u.value=!0;try{await _.updateAmount(e,l),$.create({message:"Amount updated successfully",color:"positive",position:"top",timeout:2e3})}catch(a){console.log(a),$.create({message:"Failed to update amount",color:"negative",position:"top",timeout:2e3})}finally{u.value=!1}}async function h(e,l){u.value=!0;try{await _.updateReason(e,l),$.create({message:"Cash Advance reason updated successfully!",color:"positive",position:"top",timeout:2e3})}catch(a){console.log(a),$.create({message:"Cash Advance reasons updated successfully!",color:"negative",position:"top",timeout:2e3})}finally{u.value=!1}}le(async()=>{await y()});const y=async(e=1,l=7,a="")=>{try{u.value=!0,await _.fetchCashAdvance(e,l,a);const{data:t,current_page:m,per_page:C,total:X}=k.value;g.value=t,console.log("Cash Advance",g.value),i.value.page=m,i.value.rowsPerPage=C,i.value.rowsNumber=X}catch(t){console.log("===================================="),console.log(t),console.log("====================================")}finally{u.value=!1}},A=e=>{const l=C=>C?C.charAt(0).toUpperCase()+C.slice(1).toLowerCase():"",a=e.firstname?l(e.firstname):"No Firstname",t=e.middlename?l(e.middlename).charAt(0)+".":"",m=e.lastname?l(e.lastname):"No Lastname";return`${a} ${t} ${m}`.trim()},I=e=>{y(e.pagination.page,e.pagination.rowsPerPage,e.filter)};ne(d,async e=>{await y(i.value.page,i.value.rowsPerPage,e)});const s=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(e),S=e=>{if(!e)return" - - ";const l=new Date(e);return isNaN(l.getTime())?" - - ":l.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})},q=[{name:"date",label:"Date Created",align:"left",field:e=>S(e.created_at)},{name:"date",label:"Date Updated",align:"left",field:e=>S(e.updated_at)},{name:"name",label:"Employee Name",align:"left",field:e=>A(e.employee)},{name:"amount",label:"Amount",align:"center",field:e=>s(e.amount)},{name:"reason",label:"Reason",align:"center",field:"reason"}];return(e,l)=>(c(),b(me,{class:"q-my-md"},{default:n(()=>[r("div",Ne,[r("div",$e,[o(Se,{onCreated:y})]),o(w,{modelValue:d.value,"onUpdate:modelValue":l[0]||(l[0]=a=>d.value=a),outlined:"",dense:"",debounce:"300",flat:"",label:"Search",style:{width:"300px"}},{append:n(()=>[r("div",null,[o(K,{name:"search"})])]),_:1},8,["modelValue"])]),o(re,{rows:g.value,columns:q,"row-key":"name",pagination:i.value,"onUpdate:pagination":l[1]||(l[1]=a=>i.value=a),"rows-per-page-options":[5,7,10,0],loading:u.value,filter:d.value,onRequest:I},{header:n(a=>[o(de,{props:a,class:"gradient-header text-white text-weight-bold"},{default:n(()=>[(c(!0),U(J,null,M(a.cols,t=>(c(),b(se,{key:t.name,props:a,class:"text-center text-subtitle2"},{default:n(()=>[Q(v(t.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),"body-cell-amount":n(a=>[o(T,{props:a,class:"cursor-pointer"},{default:n(()=>[r("span",null,v(a.row.amount?s(a.row.amount):" - - - "),1),o(L,{class:"bg-blue-grey-8"},{default:n(()=>[Q("Edit Amount")]),_:1}),o(z,{"onUpdate:modelValue":[t=>V(a.row,t),t=>a.row.amount=t],modelValue:a.row.amount,buttons:"","label-set":"Save","label-cancel":"Close"},{default:n(t=>[Ue,r("div",ke," Name: "+v(A(a.row.employee)),1),o(w,{modelValue:t.value,"onUpdate:modelValue":[m=>t.value=m,m=>t.value=m],"model-value":x(t.value),type:"text",autofocus:"",counter:"",onKeyup:R(t.set,["enter"])},null,8,["modelValue","onUpdate:modelValue","model-value","onKeyup"])]),_:2},1032,["onUpdate:modelValue","modelValue"])]),_:2},1032,["props"])]),"body-cell-reason":n(a=>[o(T,{props:a,class:"cursor-pointer"},{default:n(()=>[r("span",null,v(a.row.reason||" - - - "),1),o(L,{class:"bg-blue-grey-8"},{default:n(()=>[Q("Edit Reason")]),_:1}),o(z,{modelValue:a.row.reason,"onUpdate:modelValue":[t=>a.row.reason=t,t=>h(a.row,t)],buttons:"","label-set":"Save","label-cancel":"Close"},{default:n(t=>[Ie,r("div",qe," Name: "+v(A(a.row.employee)),1),o(w,{modelValue:t.value,"onUpdate:modelValue":m=>t.value=m,type:"text",autofocus:"",counter:"",onKeyup:R(t.set,["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1032,["props"])]),loading:n(()=>[o(ue,{showing:""},{default:n(()=>[o(ie,{size:"50px",color:"grey-10"})]),_:1})]),_:1},8,["rows","pagination","loading","filter"])]),_:1}))}};var na=G(Ee,[["__scopeId","data-v-2847b9a0"]]);export{na as default};
