import{Q as J}from"./QBadge.b71b5624.js";import{r as v,c as T,t as re,z as ie,o as p,a3 as V,f as a,M as k,w as t,Q as W,I as L,ae as j,a1 as te,J as s,K as Q,e as S,L as H,bo as de,a0 as N,a4 as O,a5 as ue,$ as I,bc as ce,aJ as oe,a2 as le,N as ge,O as Y,R as Z,H as be,u as ye,aI as we,P as ne}from"./index.5a162820.js";import{Q as qe}from"./QPage.0d5a8a18.js";import{Q as me}from"./QSpace.286cd555.js";import{a as G,b as pe}from"./QMenu.282f9a5b.js";import{Q as he}from"./QList.39b26f6f.js";import{Q as X}from"./QSelect.687b4581.js";import{C as M}from"./ClosePopup.6a2ba672.js";import{u as ee}from"./branch.93b8b698.js";import{u as se}from"./warehouse.d8c70afd.js";import{u as _e}from"./employee.ffa7f405.js";import{_ as K}from"./plugin-vue_export-helper.21dcd24c.js";import{Q as $e}from"./QSpinnerDots.6eac22df.js";import{Q as z,a as Ce}from"./QTable.c006a11c.js";import{Q as ve}from"./QTooltip.2dc6f82b.js";import"./position-engine.67ff3bd3.js";import"./selection.1a09d2ec.js";import"./QChip.5e6d1bc8.js";import"./use-virtual-scroll.29848ab5.js";import"./rtl.276c3f1b.js";import"./axios.9ecc35b0.js";import"./QVirtualScroll.a457ef5c.js";const xe=m=>(Y("data-v-e7a94c60"),m=m(),Z(),m),Ve=xe(()=>s("div",{class:"text-h5 q-mr-md"},"\u{1F3EA} Add New Branch",-1)),ke={class:"q-mt-lg q-animated q-animate-bounce"},Be={class:"q-mt-lg q-animated q-animate-bounce"},Se={class:"q-mt-lg q-animated q-animate-bounce"},Ne={key:0,class:"custom-list z-top"},De={class:"q-mt-lg q-animated q-animate-bounce"},Qe={class:"row q-mt-lg q-gutter-x-sm justify-between"},Ee={class:"col-6 q-animated q-animate-bounce"},Fe={class:"col-5 q-animated q-animate-bounce"},Ie={__name:"BranchesCreateComponent",setup(m){const B=_e(),f=v(!1),F=ee(),$=()=>{f.value=!0},y=se(),h=v([]),w=v([]),_=v(!1),D=["Open","Open soon","Close"],C=v(!1),x=v(null),q=v(null),E=v(!1),P=T(()=>B.employee),u=async()=>{q.value.trim()&&(C.value=!0,await B.searchPersonInCharge(q.value),C.value=!1,E.value=!0)},o=i=>{console.log("Selected Employee:",i),e.employee_id=i.id,e.employee_name=`${i.firstname} ${i.middlename?i.middlename.charAt(0)+".":""} ${i.lastname}`,q.value=`${i.firstname} ${i.middlename?i.middlename.charAt(0)+".":""} ${i.lastname}`,E.value=!1,console.log("Filled addNewBranchForm Data:",e)},c=i=>{const d=ae=>ae?ae.charAt(0).toUpperCase()+ae.slice(1).toLowerCase():"",l=i.firstname?d(i.firstname):"No Firstname",b=i.middlename?d(i.middlename).charAt(0)+".":"",A=i.lastname?d(i.lastname):"No Lastname";return`${l} ${b} ${A}`},e=re({name:"",location:"",employee_id:"",employee_name:"",phone:"",status:""});ie(async()=>{_.value=!0;try{const i=await y.fetchWarehouses();h.value=y.warehouses.map(d=>({label:d.name,value:d.id})),w.value=h.value}catch(i){console.error("Error fetching warehouse data:",i)}finally{_.value=!1}});const r=(i,d)=>{d(()=>{const l=i.toLowerCase();w.value=i===""?h.value:h.value.filter(b=>b.label.toLowerCase().includes(l))})},g=async()=>{var i,d,l;try{_.value=!0;const b={...e,warehouse_id:((i=x.value)==null?void 0:i.value)||null};console.log("brabrbbar",b);const A=await F.createBranches(b);console.log(A),f.value=!1,R()}catch(b){console.error("Error creating branch:",b);const A=((l=(d=b.response)==null?void 0:d.data)==null?void 0:l.message)||b.message||"Failed to create branch. Please try again.";f.value=!0,ge.create({color:"negative",icon:"warning",message:A})}finally{_.value=!1}},R=()=>{e.name="",e.location="",e.employee_id="",e.employee_name="",q.value=null,x.value=null,e.phone="",e.status=""};return(i,d)=>(p(),V(O,null,[a(k,{class:"text-dark q-pa-sm",outline:"",dense:"",elevated:"",icon:"add_circle",label:"Add Store Branch",onClick:$,style:{"background-color":"#ef4444"}}),a(le,{modelValue:f.value,"onUpdate:modelValue":d[7]||(d[7]=l=>f.value=l),persistent:"","transition-show":"jump-up","transition-hide":"jump-down"},{default:t(()=>[a(W,{class:"my-card q-pa-none",style:{width:"420px","border-radius":"16px","box-shadow":"0 12px 24px rgba(0, 0, 0, 0.2)"}},{default:t(()=>[a(L,{class:"row items-center q-px-md q-py-sm bg-gradient text-white"},{default:t(()=>[Ve,a(me),j(a(k,{icon:"close",flat:"",dense:"",round:""},null,512),[[M]])]),_:1}),a(te,{class:"separator-gradient"}),a(L,{class:"q-px-xl q-pt-none q-pb-lg"},{default:t(()=>[s("div",ke,[a(Q,{class:"text-capitalize",modelValue:e.name,"onUpdate:modelValue":d[0]||(d[0]=l=>e.name=l),outlined:"",dense:"",label:"Branch Name",rules:[l=>l&&l.length>0||"Name is required"]},null,8,["modelValue","rules"])]),s("div",Be,[a(Q,{class:"text-capitalize",modelValue:e.location,"onUpdate:modelValue":d[1]||(d[1]=l=>e.location=l),outlined:"",dense:"",label:"Location",rules:[l=>l&&l.length>0||"Label is required"]},null,8,["modelValue","rules"])]),s("div",Se,[s("div",null,[a(Q,{modelValue:q.value,"onUpdate:modelValue":[d[2]||(d[2]=l=>q.value=l),u],label:"Search Employee",outlined:"",dense:"",debounce:"500",placeholder:"Enter name or position",onFocus:d[3]||(d[3]=l=>E.value=!0)},{append:t(()=>[C.value?(p(),S(de,{key:1,color:"grey",size:"sm"})):(p(),S(H,{key:0,name:"search"}))]),default:t(()=>[E.value&&q.value?(p(),V("div",Ne,[a(W,null,{default:t(()=>[a(he,{separator:""},{default:t(()=>{var l;return[(l=P.value)!=null&&l.length?(p(!0),V(O,{key:1},ue(P.value,b=>(p(),S(G,{onClick:A=>o(b),key:b.id,clickable:""},{default:t(()=>[a(pe,null,{default:t(()=>[N(I(c(b)),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128)):(p(),S(G,{key:0},{default:t(()=>[N(" No Employee Record ")]),_:1}))]}),_:1})]),_:1})])):ce("",!0)]),_:1},8,["modelValue"])])]),s("div",De,[a(X,{modelValue:x.value,"onUpdate:modelValue":d[4]||(d[4]=l=>x.value=l),clearable:"","use-input":"","input-debounce":"0",options:w.value,"hide-dropdown-icon":"","stack-label":"",outlined:"",dense:"",label:"Warehouse",onFilter:r,behavior:"menu"},null,8,["modelValue","options"])]),s("div",Qe,[s("div",Ee,[a(Q,{modelValue:e.phone,"onUpdate:modelValue":d[5]||(d[5]=l=>e.phone=l),outlined:"",dense:"",mask:"(+63) ### - ### - ####",placeholder:"(+63) ### - ### - ####",label:"Phone Number",rules:[l=>l&&l.length>0||"Phone number is required"]},null,8,["modelValue","rules"])]),s("div",Fe,[a(X,{modelValue:e.status,"onUpdate:modelValue":d[6]||(d[6]=l=>e.status=l),outlined:"",dense:"",label:"Status",options:D,"hide-dropdown-icon":"",behavior:"menu",rules:[l=>l&&l.length>0||"Status is required"]},null,8,["modelValue","rules"])])])]),_:1}),a(oe,{class:"row q-px-lg q-py-sm q-pt-none",align:"right"},{default:t(()=>[j(a(k,{class:"glossy",color:"grey-9",label:"Dismiss"},null,512),[[M]]),a(k,{class:"glossy",color:"teal",label:"Create",onClick:g,loading:_.value},null,8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};var Le=K(Ie,[["__scopeId","data-v-e7a94c60"]]);const U=m=>(Y("data-v-7b71c333"),m=m(),Z(),m),Ue=U(()=>s("div",{class:"text-h5 q-mr-md"},"\u{1F3EA} Edit Branch",-1)),Pe={class:"q-mt-lg q-animated q-animate-bounce"},Ae=U(()=>s("div",null,"Name of Branch",-1)),ze={class:"q-mt-lg q-animated q-animate-bounce"},Oe=U(()=>s("div",null,"Location",-1)),Te={class:"q-mt-lg q-animated q-animate-bounce"},We=U(()=>s("div",null,"Person In-charge",-1)),je={key:0,class:"custom-list z-top"},Me={class:"q-mt-lg q-animated q-animate-bounce"},Ke=U(()=>s("div",null,"Under Warehouse",-1)),Re={class:"row q-gutter-x-sm justify-between q-mt-sm"},Je={class:"col-6 q-animated q-animate-bounce"},He=U(()=>s("div",null,"Phone Number",-1)),Ge={class:"col-5 q-animated q-animate-bounce"},Xe=U(()=>s("div",null,"Status",-1)),Ye={__name:"BranchesEditComponent",props:["edit"],setup(m){const B=_e(),f=ee(),F=se(),$=T(()=>F.warehouses),y=m,h=v(!1);v([]);const w=["Open","Open soon","Close"],_=v(null),D=v(!1),C=v(!1),x=T(()=>B.employee),q=async()=>{_.value.trim()&&(D.value=!0,await B.searchPersonInCharge(_.value),D.value=!1,C.value=!0)},E=e=>{console.log("Selected Employee:",e),u.employee_id=e.id,u.employee_name=`${e.firstname} ${e.middlename?e.middlename.charAt(0)+".":""} ${e.lastname}`,_.value=`${e.firstname} ${e.middlename?e.middlename.charAt(0)+".":""} ${e.lastname}`,C.value=!1,console.log("Filled editBranchesForm Data:",u)},P=()=>{var n,r;const e=y.edit.row;console.log("Edit Row Data:",e),C.value=!1,u.name=e.name,u.location=e.location,u.employee_id=e.employee_id,u.employee_name=e.employees?o(e.employees):"No Person in Charge",_.value=e.employees?o(e.employees):"No Person in Charge",u.warehouse_id=e!=null&&e.warehouse_id?e.warehouse_id:(n=e==null?void 0:e.warehouse)!=null&&n.id?(r=e==null?void 0:e.warehouse)==null?void 0:r.id:"",u.phone=e.phone,u.status=e.status,h.value=!0,console.log("Edit Data:",u)},u=re({name:"",location:"",person_incharge:"",employee_id:"",employee_name:"",warehouse_id:null,phone:"",status:null}),o=e=>{const n=i=>i?i.charAt(0).toUpperCase()+i.slice(1).toLowerCase():"",r=e.firstname?n(e.firstname):"No Firstname",g=e.middlename?n(e.middlename).charAt(0)+".":"",R=e.lastname?n(e.lastname):"No Lastname";return`${r} ${g} ${R}`},c=async()=>{console.log("editBranchesForm",u);try{await f.updateBranches(y.edit.row.id,u),h.value=!1}catch(e){console.error("Error updating branch:",e)}};return(e,n)=>(p(),V(O,null,[a(k,{onClick:P,color:"positive",icon:"edit",size:"sm",flat:"",round:"",dense:""},{default:t(()=>[a(ve,{class:"bg-positive",delay:200},{default:t(()=>[N("Edit")]),_:1})]),_:1}),a(le,{modelValue:h.value,"onUpdate:modelValue":n[7]||(n[7]=r=>h.value=r),persistent:"","transition-show":"jump-up","transition-hide":"jump-down"},{default:t(()=>[a(W,{class:"my-card q-pa-none",style:{width:"420px","border-radius":"16px","box-shadow":"0 12px 24px rgba(0, 0, 0, 0.2)"}},{default:t(()=>[a(L,{class:"row items-center q-px-md q-py-sm bg-gradient text-white"},{default:t(()=>[Ue,a(me),j(a(k,{icon:"close",flat:"",dense:"",round:""},null,512),[[M]])]),_:1}),a(te,{class:"separator-gradient"}),a(L,{class:"q-px-xl q-pt-none q-pb-lg"},{default:t(()=>[s("div",Pe,[Ae,a(Q,{modelValue:u.name,"onUpdate:modelValue":n[0]||(n[0]=r=>u.name=r),outlined:"",dense:""},null,8,["modelValue"])]),s("div",ze,[Oe,a(Q,{modelValue:u.location,"onUpdate:modelValue":n[1]||(n[1]=r=>u.location=r),outlined:"",dense:""},null,8,["modelValue"])]),s("div",Te,[We,s("div",null,[a(Q,{modelValue:_.value,"onUpdate:modelValue":[n[2]||(n[2]=r=>_.value=r),q],label:"Search Employee",outlined:"",dense:"",debounce:"500",placeholder:"Enter name or position",onFocus:n[3]||(n[3]=r=>C.value=!0)},{append:t(()=>[D.value?(p(),S(de,{key:1,color:"grey",size:"sm"})):(p(),S(H,{key:0,name:"search"}))]),default:t(()=>[C.value&&_.value?(p(),V("div",je,[a(W,null,{default:t(()=>[a(he,{separator:""},{default:t(()=>{var r;return[(r=x.value)!=null&&r.length?(p(!0),V(O,{key:1},ue(x.value,g=>(p(),S(G,{onClick:R=>E(g),key:g.id,clickable:""},{default:t(()=>[a(pe,null,{default:t(()=>[N(I(`${g.firstname} ${g.middlename?g.middlename.charAt(0)+".":""} ${g.lastname}`),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128)):(p(),S(G,{key:0},{default:t(()=>[N(" No Employee Record ")]),_:1}))]}),_:1})]),_:1})])):ce("",!0)]),_:1},8,["modelValue"])])]),s("div",Me,[Ke,a(X,{modelValue:u.warehouse_id,"onUpdate:modelValue":n[4]||(n[4]=r=>u.warehouse_id=r),"use-input":"","input-debounce":"0",options:$.value,"stack-label":"",outlined:"",dense:"","emit-value":"","map-options":"","option-label":"name","option-value":"id"},null,8,["modelValue","options"])]),s("div",Re,[s("div",Je,[He,a(Q,{modelValue:u.phone,"onUpdate:modelValue":n[5]||(n[5]=r=>u.phone=r),outlined:"",dense:"",mask:"(+63) ### - ### - ####",placeholder:"(+63) ### - ### - ####",rules:[r=>r&&r.length>0]},null,8,["modelValue","rules"])]),s("div",Ge,[Xe,a(X,{modelValue:u.status,"onUpdate:modelValue":n[6]||(n[6]=r=>u.status=r),outlined:"",dense:"",options:w},null,8,["modelValue"])])])]),_:1}),a(oe,{class:"row q-px-lg q-py-sm q-pt-none",align:"right"},{default:t(()=>[j(a(k,{class:"glossy",color:"grey-9",label:"Dismiss"},null,512),[[M]]),a(k,{class:"glossy",color:"teal",label:"Save",onClick:c})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};var Ze=K(Ye,[["__scopeId","data-v-7b71c333"]]);const fe=m=>(Y("data-v-df6f3850"),m=m(),Z(),m),ea=fe(()=>s("div",{class:"text-h5 q-mb-xs"},"Confirm Deletion",-1)),aa=fe(()=>s("p",{class:"text-body2 q-mb-none"}," Are you sure you want to delete this item? This action cannot be undone. ",-1)),ta={__name:"BranchesDeleteComponent",props:["delete"],setup(m){const B=ee(),f=v(!1),F=()=>{f.value=!0},$=m,y=async()=>{try{await B.deleteBranches($.delete.row.id)}catch(h){console.error(h.message)}f.value=!1};return(h,w)=>(p(),V(O,null,[a(k,{onClick:F,color:"negative",icon:"delete",size:"sm",flat:"",round:"",dense:""},{default:t(()=>[a(ve,{class:"bg-negative",delay:200},{default:t(()=>[N("Delete")]),_:1})]),_:1}),a(le,{modelValue:f.value,"onUpdate:modelValue":w[0]||(w[0]=_=>f.value=_)},{default:t(()=>[a(W,{class:"q-pa-md q-rounded q-elevate-2 bg-white text-grey-9"},{default:t(()=>[a(L,{class:"q-pt-none q-pb-sm"},{default:t(()=>[ea,aa]),_:1}),a(te,{class:"q-mb-md"}),a(oe,{align:"right",class:"q-pt-none"},{default:t(()=>[j(a(k,{flat:"",dense:"",label:"Cancel",color:"primary",class:"q-mr-sm"},null,512),[[M]]),a(k,{dense:"",label:"Delete",color:"negative",onClick:y,class:"q-btn-rounded q-px-lg"})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};var oa=K(ta,[["__scopeId","data-v-df6f3850"]]);const la=m=>(Y("data-v-3b0df9c8"),m=m(),Z(),m),sa={key:0,class:"spinner-wrapper"},na={key:1},ra={key:0,class:"data-error"},ia=la(()=>s("div",{class:"q-ml-sm text-h6"},"No data available",-1)),da=["onClick"],ua={class:"row justify-center q-gutter-x-md"},ca={__name:"BranchesTableComponent",setup(m){const B=be(),f=ee(),F=se(),$=v(""),y=T(()=>f.branches),h=v(!0),w=v(!1),_=v({rowsPerPage:0}),D=T(()=>{if(!$.value)return y.value;const o=$.value.toLowerCase();return y.value.filter(c=>{var r;const e=c.name?c.name.toLowerCase():"",n=(r=c==null?void 0:c.warehouse)!=null&&r.name?c.warehouse.name.toLowerCase():"";return e.includes(o)||n.includes(o)})});ie(async()=>{await F.fetchWarehouses(),await C()});const C=async()=>{h.value=!0;try{const o=await f.fetchBranches();console.log("branches data",o),w.value=y.value.length===0,console.log("branchesRow",y.value)}catch{w.value=!0}finally{h.value=!1}};ye($,async o=>{h.value=!0,await new Promise(c=>setTimeout(c,1e3)),h.value=!1,w.value=D.value.length===0});const x=o=>o?o.split(" ").map(c=>c.charAt(0).toUpperCase()+c.slice(1).toLowerCase()).join(" "):"",q=o=>{const c=g=>g?g.charAt(0).toUpperCase()+g.slice(1).toLowerCase():"",e=o.firstname?c(o.firstname):"No Firstname",n=o.middlename?c(o.middlename).charAt(0)+".":"",r=o.lastname?c(o.lastname):"No Lastname";return`${e} ${n} ${r}`},E=[{name:"branch_name",label:"Name of Branch",align:"left",field:o=>o.name,format:o=>`${o}`,sortable:!0},{name:"warehouse",label:"Warehouse",align:"left",field:o=>o!=null&&o.warehouse?o.warehouse:"No warehouse ",sortable:!0},{name:"location",label:"Location",align:"left",field:"location"},{name:"personIncharge",label:"Person In-charge",align:"left",field:o=>q(o)},{name:"phone",label:"Phone",align:"center",field:"phone"},{name:"status",label:"Status",align:"center",field:"status"},{name:"action",label:"Action",align:"center",field:"action"}],P=o=>{switch(o){case"Open":return"info";case"Open soon":return"warning";case"Close":return"accent";default:return"grey"}},u=async o=>{console.log("brach",o),ne.show();try{await B.push({name:"BranchDetail",params:{branch_id:o.id}})}finally{ne.hide()}};return(o,c)=>(p(),V(O,null,[s("div",null,[a(Q,{class:"q-pb-lg q-pl-sm dynamic-width",modelValue:$.value,"onUpdate:modelValue":c[0]||(c[0]=e=>$.value=e),outlined:"",placeholder:"Search",debounced:"1000",flat:"",dense:"",rounded:""},{append:t(()=>[a(H,{name:"search"})]),_:1},8,["modelValue"])]),h.value?(p(),V("div",sa,[a($e,{size:"50px",color:"primary"})])):(p(),V("div",na,[D.value.length===0?(p(),V("div",ra,[a(H,{name:"warning",color:"warning",size:"4em"}),ia])):(p(),S(Ce,{key:1,class:"table-container elegant-container sticky-header","virtual-scroll-sticky-size-start":48,flat:"",style:{height:"500px"},columns:E,rows:D.value,"row-key":"name",pagination:_.value,"onUpdate:pagination":c[1]||(c[1]=e=>_.value=e),"rows-per-page-options":[0],"hide-bottom":""},{"body-cell-branch_name":t(e=>[a(z,{key:"name",props:e},{default:t(()=>[s("a",{onClick:we(n=>u(e.row),["prevent"]),class:"branch-link"},I(x(e.row.name)),9,da)]),_:2},1032,["props"])]),"body-cell-warehouse":t(e=>[a(z,{props:e},{default:t(()=>{var n;return[N(I(x((n=e.row.warehouse)==null?void 0:n.name)),1)]}),_:2},1032,["props"])]),"body-cell-location":t(e=>[a(z,{props:e},{default:t(()=>[N(I(x(e.row.location)),1)]),_:2},1032,["props"])]),"body-cell-status":t(e=>[a(z,{key:"name",props:e},{default:t(()=>[a(J,{outline:"",color:P(e.row.status)},{default:t(()=>[N(I(e.row.status),1)]),_:2},1032,["color"])]),_:2},1032,["props"])]),"body-cell-personIncharge":t(e=>[a(z,{props:e},{default:t(()=>[N(I(q(e.row.employees)),1)]),_:2},1032,["props"])]),"body-cell-action":t(e=>[a(z,{props:e},{default:t(()=>[s("div",ua,[a(Ze,{edit:e},null,8,["edit"]),a(oa,{delete:e},null,8,["delete"])])]),_:2},1032,["props"])]),_:1},8,["rows","pagination"]))]))],64))}};var ma=K(ca,[["__scopeId","data-v-3b0df9c8"]]);const pa={class:"text-h6 text-dark"},ha={class:"q-gutter-x-sm"},_a={__name:"BranchesPage",setup(m){return(B,f)=>(p(),S(qe,{class:"elegant-container",flat:""},{default:t(()=>[a(L,{class:"row justify-between"},{default:t(()=>[s("div",pa,[s("div",ha,[a(J,{outline:"",label:"Open",color:"info"}),a(J,{outline:"",label:"Open Soon",color:"warning"}),a(J,{outline:"",label:"Close",color:"accent"})])]),s("div",null,[a(Le)])]),_:1}),a(L,null,{default:t(()=>[s("div",null,[a(ma)])]),_:1})]),_:1}))}};var Pa=K(_a,[["__scopeId","data-v-cf3d1d4c"]]);export{Pa as default};
