import{r as x,o as u,a3 as y,f as e,w as t,L as O,K as G,e as $,M as j,Q as U,I,bg as W,aK as f,J as a,$ as l,a0 as c,a1 as X,a4 as B,a5 as D,be as z,a2 as Y,O as Z,R as ee,u as te,H as ae,c as L,z as se}from"./index.eb4f300f.js";import{_ as P}from"./plugin-vue_export-helper.21dcd24c.js";import{Q as re}from"./QBadge.8124d379.js";import{Q as K,a as oe}from"./QTable.fdc4a007.js";import{Q as le}from"./QPagination.94aa843e.js";import{u as ne}from"./baker-report.f85b7b2f.js";import{Q as ie}from"./QChip.030ab730.js";import{a as p}from"./QSelect.3b40ae5d.js";import{a as T,b as o}from"./QMenu.bcc901ec.js";import{Q as F}from"./QList.ed048353.js";import{t as E}from"./typography-format.2b1c1c09.js";import{b as H}from"./badge-color.f568cd69.js";import{u as ce}from"./use-quasar.101c5f2d.js";import"./QVirtualScroll.161c03a9.js";import"./use-virtual-scroll.7d67df79.js";import"./rtl.276c3f1b.js";import"./selection.0cd99d5a.js";import"./axios.700d89a2.js";import"./position-engine.e09c586f.js";import"./date.683de555.js";const de={class:"q-mb-md row items-center justify-between"},ue={__name:"ReportSearch",emits:["search"],setup(s,{emit:i}){const w=x(""),k=i,S=h=>k("search",h);return(h,V)=>(u(),y("div",de,[e(G,{outlined:"",dense:"",placeholder:"Search Reports Name",class:"q-mb-sm","bg-color":"grey-1","input-class":"text-grey-8","label-color":"grey-6",modelValue:w.value,"onUpdate:modelValue":[V[0]||(V[0]=Q=>w.value=Q),S]},{append:t(()=>[e(O,{name:"search",color:"grey-6"})]),_:1},8,["modelValue"])]))}},_e={};function pe(s,i){return u(),$(j,{class:"q-pa-sm",color:"red-6",dense:"",elevated:"",icon:"add_circle",label:"Create Report",to:"/branch/baker/create_report"})}var me=P(_e,[["render",pe]]);const g=s=>(Z("data-v-5efc17a1"),s=s(),ee(),s),fe={class:"text-h6 text-weight-regular"},ge={class:"row justify-between"},ve={class:"section-content"},he={class:"row q-gutter-x-sm"},be=g(()=>a("div",{class:"text-subtitle2"},"Date:",-1)),xe={class:"text-body1 text-weight-light"},ye={class:"row q-gutter-x-sm"},we=g(()=>a("div",{class:"text-subtitle2"},"Branch:",-1)),ke={class:"text-body1 text-weight-light"},Qe={class:"row q-gutter-x-sm"},Re=g(()=>a("div",{class:"text-subtitle2"},"Baker:",-1)),qe={class:"text-body1 text-weight-light"},Se={class:"row q-gutter-x-sm"},Te=g(()=>a("div",{class:"text-subtitle2"},"Remarks:",-1)),$e={class:"text-body1 text-weight-light"},Ve={class:"row q-mt-sm item-start q-gutter-x-xl"},Ce={class:"row q-gutter-x-sm text-overline"},Be=g(()=>a("div",null,"Kilo:",-1)),Ie={class:"text-weight-light"},Ne={class:"row q-gutter-x-sm text-overline"},De=g(()=>a("div",null,"Over:",-1)),Le={class:"text-weight-light"},Fe={class:"row q-gutter-x-sm text-overline"},je=g(()=>a("div",null,"Short:",-1)),ze={class:"text-weight-light"},Pe={class:"row q-gutter-x-sm text-overline"},Ae=g(()=>a("div",null,"Actual Target:",-1)),Ke={class:"text-weight-light"},Oe={class:"row justify-between"},Ue=g(()=>a("div",{class:"section-title",align:"center"},"Ingredients",-1)),Ee={key:0},He=g(()=>a("div",{class:"section-title",align:"center"},"Breads",-1)),Me={key:1},Je=g(()=>a("div",{class:"section-title",align:"center"},"Fillings",-1)),Ge={__name:"ReportView",props:{report:{type:Object,required:!0}},setup(s){const{capitalizeFirstLetter:i,formatFullname:w,formatTimestamp:k}=E(),{getStatusColor:S,getHeaderClass:h}=H();console.log("bakerView",s.report);const Q=x(!1),C=()=>{Q.value=!0},R=d=>{if(d>=1e3){const _=d/1e3;return`${_} ${_===1?"kg":"kgs"}`}return`${d} g`},b=d=>{const _=Number(d)||0;return parseFloat(_.toFixed(3)).toString()};return(d,_)=>(u(),y(B,null,[e(j,{color:"accent",icon:"visibility",size:"md",flat:"",round:"",dense:"",onClick:C}),e(Y,{modelValue:Q.value,"onUpdate:modelValue":_[1]||(_[1]=n=>Q.value=n),class:"report-dialog"},{default:t(()=>[e(U,{class:"report-card"},{default:t(()=>[e(I,{class:W([f(h)(s.report.status),"row justify-between"])},{default:t(()=>[a("div",fe,l(f(i)(s.report.branch_recipe.recipe.name))+" - "+l(s.report.recipe_category),1),e(j,{class:"close-btn",color:"grey-8",flat:"",round:"",dense:"",icon:"close",onClick:_[0]||(_[0]=n=>Q.value=!1)})]),_:1},8,["class"]),e(I,null,{default:t(()=>[a("div",ge,[a("div",null,[a("div",ve,[a("div",he,[be,a("div",xe,l(f(k)(s.report.created_at)),1)]),a("div",ye,[we,a("div",ke,l(f(i)(s.report.branch.name)),1)]),a("div",Qe,[Re,a("div",qe,l(f(w)(s.report.user.employee)),1)]),a("div",Se,[Te,a("div",$e,l(s.report.remark?s.report.remark:"N/A"),1)])])]),a("div",null,[e(ie,{square:"",color:f(S)(s.report.status),"text-color":"white"},{default:t(()=>[c(l(f(i)(s.report.status)),1)]),_:1},8,["color"])])]),a("div",Ve,[a("div",Ce,[Be,a("div",Ie,l(b(s.report.kilo)),1)]),a("div",Ne,[De,a("div",Le,l(s.report.over),1)]),a("div",Fe,[je,a("div",ze,l(s.report.short),1)]),a("div",Pe,[Ae,a("div",Ke,l(s.report.actual_target),1)])]),e(X,{class:"q-my-md"}),a("div",Oe,[a("div",null,[Ue,e(F,{dense:"",separator:"",class:"q-pa-md box"},{default:t(()=>[e(T,null,{default:t(()=>[e(o,null,{default:t(()=>[e(p,{class:"text-overline"},{default:t(()=>[c("Code")]),_:1})]),_:1}),e(o),e(o),e(o,null,{default:t(()=>[e(p,{class:"text-overline"},{default:t(()=>[c("Quantity")]),_:1})]),_:1}),e(o,{side:""})]),_:1}),(u(!0),y(B,null,D(s.report.ingredient_bakers_reports,(n,q)=>(u(),$(T,{key:q},{default:t(()=>[e(o,null,{default:t(()=>[e(p,{class:"text-caption justify",align:"center"},{default:t(()=>[c(l(n.ingredients.code),1)]),_:2},1024)]),_:2},1024),e(o),e(o,null,{default:t(()=>[e(p,{class:"text-caption",align:"center"},{default:t(()=>[c(l(R(n.quantity)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),s.report.bread_bakers_reports&&s.report.bread_bakers_reports.length?(u(),y("div",Ee,[He,e(F,{dense:"",separator:"",class:"q-pa-md box"},{default:t(()=>[e(T,null,{default:t(()=>[e(o,null,{default:t(()=>[e(p,{class:"text-overline"},{default:t(()=>[c("Bread Name")]),_:1})]),_:1}),e(o),e(o,null,{default:t(()=>[e(p,{class:"text-overline"},{default:t(()=>[c("Quantity")]),_:1})]),_:1})]),_:1}),(u(!0),y(B,null,D(s.report.bread_bakers_reports,(n,q)=>(u(),$(T,{key:q},{default:t(()=>[e(o,null,{default:t(()=>[e(p,{class:"text-caption",align:"center"},{default:t(()=>[c(l(f(i)(n.bread.name)),1)]),_:2},1024)]),_:2},1024),e(o),e(o,null,{default:t(()=>[e(p,{class:"text-caption",align:"center"},{default:t(()=>[c(l(n.bread_production)+" pcs ",1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})])):z("",!0),s.report.filling_bakers_reports&&s.report.filling_bakers_reports.length?(u(),y("div",Me,[Je,e(F,{dense:"",separator:"",class:"q-pa-md box"},{default:t(()=>[e(T,null,{default:t(()=>[e(o,null,{default:t(()=>[e(p,{class:"text-overline"},{default:t(()=>[c("Bread Name")]),_:1})]),_:1}),e(o),e(o,null,{default:t(()=>[e(p,{class:"text-overline"},{default:t(()=>[c("Quantity")]),_:1})]),_:1})]),_:1}),(u(!0),y(B,null,D(s.report.filling_bakers_reports,(n,q)=>(u(),$(T,{key:q},{default:t(()=>[e(o,null,{default:t(()=>[e(p,{class:"text-caption",align:"center"},{default:t(()=>[c(l(f(i)(n.bread.name)),1)]),_:2},1024)]),_:2},1024),e(o),e(o,null,{default:t(()=>[e(p,{class:"text-caption",align:"center"},{default:t(()=>[c(l(n.filling_production)+" pcs ",1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})])):z("",!0)])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};var We=P(Ge,[["__scopeId","data-v-5efc17a1"]]);const Xe={class:"q-mt-sm q-gutter-md"},Ye={class:"table-container"},Ze={key:0,class:"q-pt-md flex flex-center"},et={__name:"ReportTable",props:{searchText:{type:String,default:""}},setup(s){var A;const{capitalizeFirstLetter:i,formatTimestamp:w}=E(),{getStatusColor:k}=H(),S=s;te(()=>S.searchText,r=>{_.value=r,q()}),ae();const h=ne(),Q=((A=L(()=>h.user).value)==null?void 0:A.data.id)||"";x(""),x(!0),x(!1),x(!1);const C=ce(),R=L(()=>{var r,m;return((m=(r=h.bakerReport)==null?void 0:r.data)==null?void 0:m.data)||[]}),b=L(()=>{var r;return((r=h.bakerReport)==null?void 0:r.pagination)||{current_page:1,last_page:1,per_page:5}}),d=x(null),_=x("");let n=null;const q=()=>{n&&clearTimeout(n),n=setTimeout(()=>{N(1)},500)},N=async(r=1)=>{C.loading.show();try{await h.fetchBakerReport(Q,r,b.value.rowsPerPage||5,_.value),!R.value.length&&d.value&&(d.value=null),d.value&&!R.value.some(m=>m.id===d.value.id)&&(d.value=null),!d.value&&R.value,length>0&&(d.value=R.value[0]),console.log("bakersReportList",R.value),console.log("pagination",b.value)}catch(m){console.error("Error fetching baker report:",m)}finally{C.loading.hide()}};se(async()=>{N(b.value.current_page)});const M=r=>{N(r)},J=[{name:"date",align:"left",label:"Date",field:"created_at",format:w,sortable:!0},{name:"name",label:"Reports Name",align:"center",field:r=>{if(r.branch_recipe&&r.branch_recipe.recipe){const m=r.branch_recipe.recipe.name,v=r.branch_recipe.recipe.category;return{name:i(m),category:i(v)}}else return{name:"N/A",category:"N/A"}},format:r=>`${r.name} (${r.category})`,sortable:!0},{name:"status",align:"center",label:"Status",field:"status"},{name:"view",align:"right",label:"View",field:"view"}];return(r,m)=>(u(),y("div",Xe,[a("div",Ye,[e(oe,{rows:R.value||[],columns:J,"rows-per-page-options":[5],"row-key":"id",flat:"",bordered:"",dense:""},{"body-cell-status":t(v=>[e(K,{key:"name",props:v},{default:t(()=>[e(re,{outlined:"",color:f(k)(v.row.status)},{default:t(()=>[c(l(f(i)(v.row.status)),1)]),_:2},1032,["color"])]),_:2},1032,["props"])]),"body-cell-view":t(v=>[e(K,{props:v},{default:t(()=>[a("div",null,[e(We,{report:v.row},null,8,["report"])])]),_:2},1032,["props"])]),_:1},8,["rows"]),b.value.last_page>1?(u(),y("div",Ze,[e(le,{modelValue:b.value.current_page,"onUpdate:modelValue":[m[0]||(m[0]=v=>b.value.current_page=v),M],max:b.value.last_page,"max-pages":5,"boundary-numbers":"","direction-links":"","icon-first":"skip_previous","icon-last":"skip_next","icon-prev":"fast_rewind","icon-next":"fast_forward"},null,8,["modelValue","max"])])):z("",!0)])]))}};var tt=P(et,[["__scopeId","data-v-29ae0428"]]);const at={class:"text-h6 text-white"},st={class:"q-gutter-y-lg"},rt={class:"row justify-between"},Rt={__name:"ReportPage",setup(s){const i=x(""),w=k=>{i.value=k};return(k,S)=>(u(),$(U,{flat:""},{default:t(()=>[e(I,{style:{"background-color":"#ef4444"}},{default:t(()=>[a("div",at,[e(O,{name:"fa-solid fa-layer-group"}),c(" Report ")])]),_:1}),e(I,null,{default:t(()=>[a("div",st,[a("div",rt,[a("div",null,[e(ue,{onSearch:w})]),a("div",null,[e(me)])]),a("div",null,[e(tt,{searchText:i.value},null,8,["searchText"])])])]),_:1})]),_:1}))}};export{Rt as default};
