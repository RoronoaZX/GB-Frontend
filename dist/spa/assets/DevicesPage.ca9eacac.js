import{d as R,n as _,N as b,P as w,t as E,o as f,a2 as q,a as e,M as g,w as o,Q,I as y,ad as x,J as n,K as h,aI as M,a1 as N,O as C,R as k,$ as z,a0 as J,a3 as F,g as P,z as K,u as G,L as A,c as O}from"./index.6a2e76bf.js";import{Q as H}from"./QPage.7db98d65.js";import{Q as j}from"./QSpace.d0a88e4a.js";import{C as V}from"./ClosePopup.f12b67c7.js";import{api as I}from"./axios.eb07d1a5.js";import{_ as $}from"./plugin-vue_export-helper.21dcd24c.js";import{Q as W}from"./QSpinnerDots.76b45734.js";import{Q as X,a as Y}from"./QTable.769fbca3.js";import{Q as B}from"./QTooltip.3e66b858.js";import"./QVirtualScroll.e04732f7.js";import"./QList.ed3bcae4.js";import"./use-virtual-scroll.d9a7d35f.js";import"./rtl.276c3f1b.js";import"./QSelect.6c695fe4.js";import"./QItemLabel.fa8563a5.js";import"./QItem.a0938a99.js";import"./QMenu.94dae428.js";import"./selection.6e8843f8.js";const T=R("devices",()=>{const i=_(null),r=_([]);return{device:i,devices:r,fetchDevices:async()=>{try{const a=await I.get("/api/device");r.value=a.data}catch(a){console.log("error fetchig  device",a),b.create({type:"negative",message:"Failed to fetch devices",setTimeout:1e3})}},createDevices:async a=>{w.show(),console.log("Data parameters being sent:",a);try{const u=await I.post("/api/device",a);r.value.unshift(u.data),b.create({type:"positive",message:"Device created successfully",setTimeout:1e3})}catch(u){console.error("error device",u),b.create({type:"negative",message:"Failed to create device",setTimeout:1e3})}finally{w.hide()}},updateDevice:async(a,u)=>{w.show();try{const m=await I.put(`/api/device/${a}`,u),d=r.value.findIndex(t=>t.id===a);d!==-1&&(r.value[d]=m.data),b.create({type:"positive",message:"Device updated successfully",setTimeout:1e3})}catch(m){console.log("update device error",m),b.create({type:"negative",message:"Failed to update device",setTimeout:1e3})}finally{w.hide()}},deleteDevice:async a=>{w.show();try{const u=await I.delete(`/api/device/${a}`);r.value=r.value.filter(m=>m.id!==a),b.create({type:"positive",message:"Device deleted successfully"})}catch{b.create({type:"negative",message:"Failed to delete device"})}finally{w.hide()}}}});const U=i=>(C("data-v-a1928490"),i=i(),k(),i),Z=U(()=>n("div",{class:"text-h5 q-mr-md"},"\u{1F4F1} Add Device",-1)),ee={class:"q-mt-lg q-animated q-animate-bounce"},te=U(()=>n("div",null,"UUID",-1)),ae={class:"q-mt-md q-animated q-animate-bounce"},se=U(()=>n("div",null,"Name",-1)),le={class:"q-mt-md q-animated q-animate-bounce"},oe=U(()=>n("div",null,"Model",-1)),ie={class:"q-mt-md q-animated q-animate-bounce"},ne=U(()=>n("div",null,"OS Version",-1)),de={__name:"AddDevice",setup(i){const r=T(),c=_(!1),v=_(!1),p=()=>{c.value=!0},l=E({uuid:"",name:"",model:"",os_version:""}),a=async()=>{v.value=!0;try{await r.createDevices(l),c.value=!1,u()}catch(m){console.log(m)}finally{v.value=!1}},u=()=>{l.uuid="",l.name="",l.model="",l.os_version=""};return(m,d)=>(f(),q("div",null,[e(g,{outline:"",icon:"add_circle",label:"Add Device",onClick:p,style:{"background-color":"#ef4444"}}),e(N,{modelValue:c.value,"onUpdate:modelValue":d[4]||(d[4]=t=>c.value=t),persistent:"","transition-show":"jump-up","transition-hide":"jump-down"},{default:o(()=>[e(Q,{class:"my-card q-pa-none",style:{width:"420px","border-radius":"16px","box-shadow":"0 12px 24px rgba(0, 0, 0, 0.2)"}},{default:o(()=>[e(y,{class:"row items-center q-px-md q-py-sm bg-gradient text-white"},{default:o(()=>[Z,e(j),x(e(g,{icon:"close",flat:"",dense:"",round:""},null,512),[[V]])]),_:1}),e(y,{class:"q-px-xl q-pt-none q-pb-lg"},{default:o(()=>[n("div",ee,[te,e(h,{modelValue:l.uuid,"onUpdate:modelValue":d[0]||(d[0]=t=>l.uuid=t),outlined:"",dense:"",rules:[t=>t&&t.length>0||"Device UUID is required"]},null,8,["modelValue","rules"])]),n("div",ae,[se,e(h,{class:"text-capitalize",modelValue:l.name,"onUpdate:modelValue":d[1]||(d[1]=t=>l.name=t),outlined:"",dense:"",rules:[t=>t&&t.length>0||"Device Name is required"]},null,8,["modelValue","rules"])]),n("div",le,[oe,e(h,{modelValue:l.model,"onUpdate:modelValue":d[2]||(d[2]=t=>l.model=t),outlined:"",dense:"",rules:[t=>t&&t.length>0||"Device Model is required"]},null,8,["modelValue","rules"])]),n("div",ie,[ne,e(h,{modelValue:l.os_version,"onUpdate:modelValue":d[3]||(d[3]=t=>l.os_version=t),outlined:"",dense:"",rules:[t=>t&&t.length>0||"Device OS Version is required"]},null,8,["modelValue","rules"])])]),_:1}),e(M,{class:"row q-px-lg q-py-sm q-pt-none",align:"right"},{default:o(()=>[x(e(g,{class:"btn-cancel glossy",color:"negative",label:"Dismiss"},null,512),[[V]]),e(g,{class:"btn-create glossy",color:"positive",label:"Create",onClick:a})]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}};var re=$(de,[["__scopeId","data-v-a1928490"]]);const L=i=>(C("data-v-1abbd28a"),i=i(),k(),i),ce=L(()=>n("div",{class:"text-h5 q-mb-xs"},"Confirm Deletion",-1)),ue=L(()=>n("p",{class:"text-body2 q-mb-none"}," Are you sure you want to delete this item? This action cannot be undone. ",-1)),me={__name:"DeviceDelete",props:["delete"],emits:["device-deleted"],setup(i,{emit:r}){const c=T(),v=i,p=r,l=_(!1),a=()=>{l.value=!0},u=async()=>{try{await c.deleteDevice(v.delete.row.id),l.value=!1,p("device-deleted")}catch(m){console.error("Error deleting item:",m)}l.value=!1};return(m,d)=>(f(),q(F,null,[e(g,{color:"negative",icon:"delete",size:"sm",flat:"",round:"",dense:"",onClick:a},{default:o(()=>[e(B,{class:"bg-negative",delay:200},{default:o(()=>[z("Delete")]),_:1})]),_:1}),e(N,{modelValue:l.value,"onUpdate:modelValue":d[0]||(d[0]=t=>l.value=t)},{default:o(()=>[e(Q,{class:"q-pa-md q-rounded q-elevate-2 bg-white text-grey-9"},{default:o(()=>[e(y,{class:"q-pt-none q-pb-sm"},{default:o(()=>[ce,ue]),_:1}),e(J,{class:"q-mb-md"}),e(y,{align:"right",class:"q-pt-none"},{default:o(()=>[x(e(g,{flat:"",dense:"",label:"Cancel",color:"primary",class:"q-mr-sm"},null,512),[[V]]),e(g,{dense:"",label:"Delete",color:"negative",onClick:u,class:"q-btn-rounded q-px-lg"})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};var ve=$(me,[["__scopeId","data-v-1abbd28a"]]);const S=i=>(C("data-v-1abd83be"),i=i(),k(),i),pe=S(()=>n("div",{class:"text-h5 q-mr-md"},"\u{1F4F1} Edit Device",-1)),_e={class:"q-mt-lg q-animated q-animate-bounce"},ge=S(()=>n("div",null,"UUID",-1)),fe={class:"q-mt-md q-animated q-animate-bounce"},he=S(()=>n("div",null,"Name",-1)),ye={class:"q-mt-md q-animated q-animate-bounce"},De=S(()=>n("div",null,"Model",-1)),be={class:"q-mt-md q-animated q-animate-bounce"},qe=S(()=>n("div",null,"OS Version",-1)),we={__name:"DeviceEdit",props:["edit"],emits:["device-updated"],setup(i,{emit:r}){const c=T(),v=_(!1);_(!0);const p=i,l=r,a=E({uuid:"",name:"",model:"",os_version:""}),u=()=>{Object.assign(a,p.edit.row),v.value=!0},m=async()=>{try{const d={...p.edit.row,...a};await c.updateDevice(p.edit.row.id,d),v.value=!1,l("device-updated")}catch(d){console.log("error update device",d)}};return(d,t)=>(f(),q(F,null,[e(g,{color:"positive",icon:"edit",size:"sm",flat:"",round:"",dense:"",onClick:u},{default:o(()=>[e(B,{class:"bg-positive",delay:200},{default:o(()=>[z("Edit")]),_:1})]),_:1}),e(N,{modelValue:v.value,"onUpdate:modelValue":t[4]||(t[4]=s=>v.value=s),persistent:"","transition-show":"jump-up","transition-hide":"jump-down"},{default:o(()=>[e(Q,{class:"my-card q-pa-none",style:{width:"420px","border-radius":"16px","box-shadow":"0 12px 24px rgba(0, 0, 0, 0.2)"}},{default:o(()=>[e(y,{class:"row items-center q-px-md q-py-sm bg-gradient text-white"},{default:o(()=>[pe,e(j),x(e(g,{icon:"close",flat:"",dense:"",round:""},null,512),[[V]])]),_:1}),e(y,{class:"q-px-xl q-pt-none q-pb-lg"},{default:o(()=>[n("div",_e,[ge,e(h,{modelValue:a.uuid,"onUpdate:modelValue":t[0]||(t[0]=s=>a.uuid=s),outlined:"",dense:"",rules:[s=>s&&s.length>0||"Device UUID is required"]},null,8,["modelValue","rules"])]),n("div",fe,[he,e(h,{modelValue:a.name,"onUpdate:modelValue":t[1]||(t[1]=s=>a.name=s),outlined:"",dense:"",rules:[s=>s&&s.length>0||"Device Name is required"]},null,8,["modelValue","rules"])]),n("div",ye,[De,e(h,{modelValue:a.model,"onUpdate:modelValue":t[2]||(t[2]=s=>a.model=s),outlined:"",dense:"",rules:[s=>s&&s.length>0||"Device Model is required"]},null,8,["modelValue","rules"])]),n("div",be,[qe,e(h,{modelValue:a.os_version,"onUpdate:modelValue":t[3]||(t[3]=s=>a.os_version=s),outlined:"",dense:"",rules:[s=>s&&s.length>0||"Device OS Version is required"]},null,8,["modelValue","rules"])])]),_:1}),e(M,{class:"row q-px-lg q-py-sm q-pt-none",align:"right"},{default:o(()=>[x(e(g,{class:"btn-cancel glossy",color:"negative",label:"Dismiss"},null,512),[[V]]),e(g,{class:"btn-create glossy",color:"positive",label:"Save",onClick:m})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};var xe=$(we,[["__scopeId","data-v-1abd83be"]]);const Ve=i=>(C("data-v-01f7d2f7"),i=i(),k(),i),$e={key:0,class:"spinner-wrapper"},Ue={key:1},Se={key:0,class:"data-error"},Ie=Ve(()=>n("div",{class:"q-ml-sm text-h6"},"No data available",-1)),Qe={class:"row justify-center q-gutter-x-md"},Ce={__name:"DeviceTable",setup(i){const r=T(),c=_(""),v=_(!0),p=P(()=>r.devices),l=_(!1),a=_({rowPerPage:0}),u=P(()=>c.value?p.value.filter(t=>(t.name||"").toLowerCase().includes(c.value.toLowerCase())):p.value);K(async()=>{const t=await m();console.log("response device",t)});const m=async()=>{try{v.value=!0;const t=await r.fetchDevices();p.value.length||(l.value=!0),console.log("device fetch:",t)}catch(t){console.log("error fetching device",t),l.value=!0}finally{v.value=!1}};G(c,async t=>{v.value=!0,await new Promise(s=>setTimeout(s,1e3)),v.value=!1,l.value=u.value.length===0});const d=[{name:"name",label:"Name",align:"center",field:"name",format:t=>`${t}`,sortable:!0},{name:"model",label:"Model",align:"center",field:"model"},{name:"os_version",label:"OS Version",align:"center",field:"os_version"},{name:"uuid",label:"UUID",align:"center",field:"uuid"},{name:"action",label:"Action",align:"center",field:"action"}];return(t,s)=>(f(),q(F,null,[n("div",null,[e(h,{modelValue:c.value,"onUpdate:modelValue":s[0]||(s[0]=D=>c.value=D),class:"q-pb-lg q-pl-sm",outlined:"",placeholder:"search",flat:"",rounded:"",dense:"",debounce:"100",style:{width:"500px","max-width":"1500px","min-width":"100px"}},{append:o(()=>[e(A,{name:"search"})]),_:1},8,["modelValue"])]),v.value?(f(),q("div",$e,[e(W,{size:"50px",color:"primary"})])):(f(),q("div",Ue,[u.value.length===0?(f(),q("div",Se,[e(A,{name:"warning",color:"warning",size:"4em"}),Ie])):(f(),O(Y,{key:1,class:"table-container elegant-container sticky-header",filter:c.value,"virtual-scroll-sticky-size-start":48,flat:"",style:{height:"400px"},columns:d,rows:u.value,"row-key":"name","virtual-scroll":"",pagination:a.value,"onUpdate:pagination":s[1]||(s[1]=D=>a.value=D),"rows-per-page-options":[0],"hide-bottom":""},{"body-cell-action":o(D=>[e(X,{props:D},{default:o(()=>[n("div",Qe,[e(xe,{edit:D,onDeviceUpdated:m},null,8,["edit"]),e(ve,{delete:D,onDeviceDeleted:m},null,8,["delete"])])]),_:2},1032,["props"])]),_:1},8,["filter","rows","pagination"]))]))],64))}};var ke=$(Ce,[["__scopeId","data-v-01f7d2f7"]]);const Te={align:"right"},Ne={__name:"DevicesPage",setup(i){return(r,c)=>(f(),O(H,null,{default:o(()=>[e(Q,{class:"elegant-container",flat:""},{default:o(()=>[e(y,null,{default:o(()=>[n("div",Te,[e(re)])]),_:1}),e(y,null,{default:o(()=>[e(ke)]),_:1})]),_:1})]),_:1}))}};var Ze=$(Ne,[["__scopeId","data-v-bc8265ea"]]);export{Ze as default};
