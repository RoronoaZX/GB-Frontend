import{c as R,o as c,a2 as m,J as e,f as s,w as o,e as Q,Q as z,I as S,L as E,_ as u,M as N,a0 as X,a3 as $,a4 as V,O as M,R as H,t as Y,u as B,$ as q,K as A,bc as J,r as Z,H as ee}from"./index.d066e79a.js";import{Q as te}from"./QSpace.0f68764e.js";import{Q as K}from"./QExpansionItem.2a4eeafb.js";import{Q as ae}from"./QVirtualScroll.8d959ffc.js";import{u as j}from"./baker-report.b9c715aa.js";import{_ as G}from"./plugin-vue_export-helper.21dcd24c.js";import{Q as I,b as T}from"./use-virtual-scroll.d18c8f58.js";import{Q as W,a as U,b as F}from"./QList.cc8cbfd3.js";import{u as se}from"./branch-recipe.3839d80c.js";import"./QSlideTransition.08edb2c1.js";import"./axios.4ee8ecb2.js";const L=h=>(M("data-v-21535d8a"),h=h(),H(),h),le=L(()=>e("div",{class:"text-h6",align:"center"},"Report List",-1)),oe={class:"q-pa-md row wrap justify-center"},re={class:"row justify-between q-gutter-x-md"},ne={class:"row items-center"},ie={class:"text-subtitle1 q-ml-sm"},de={class:"content-section"},ce={class:"q-mt-xs row justify-between"},ue=L(()=>e("div",null,"Kilo",-1)),_e={class:"q-mt-xs row justify-between"},pe=L(()=>e("div",null,"Short",-1)),me={class:"q-mt-xs row justify-between"},ve=L(()=>e("div",null,"Over",-1)),he={class:"q-mt-xs row justify-between"},ge=L(()=>e("div",null,"Actual Target",-1)),ye={class:"q-pl-md"},be={class:"row justify-between"},fe={class:"q-pl-md"},we={class:"row justify-between"},xe={align:"right"},ke={__name:"ReportListComponent",setup(h){const v=j(),_=R(()=>v.reports);console.log("bakers report:",_.value);const d=t=>{v.removeReport(t)},b=t=>t?t.split(" ").map(f=>f.charAt(0).toUpperCase()+f.slice(1).toLowerCase()).join(" "):"",C=async()=>{v.createReports()};return(t,f)=>(c(),m($,null,[le,e("div",oe,[s(ae,{items:_.value,"scroll-target":"body","virtual-scroll-horizontal":"",class:"my-virtual-scroll"},{default:o(({item:p,index:x})=>[(c(),Q(z,{flat:"",bordered:"",class:"q-gutter-sm my-card",key:x},{default:o(()=>[s(S,null,{default:o(()=>[e("div",re,[e("div",ne,[s(E,{name:"assignment",color:"primary"}),e("div",ie,u(b(p.recipe_name))+" - "+u(p.recipe_category),1)]),e("div",null,[s(N,{flat:"",round:"",icon:"close",onClick:g=>d(x),class:"text-negative close-btn"},null,8,["onClick"])])])]),_:2},1024),s(X),s(S,null,{default:o(()=>[e("div",de,[e("div",ce,[ue,e("div",null,u(p.kilo)+" kgs",1)]),e("div",_e,[pe,e("div",null,u(p.short)+" pcs",1)]),e("div",me,[ve,e("div",null,u(p.over)+" pcs",1)]),e("div",he,[ge,e("div",null,u(p.actual_target)+" pcs",1)]),(c(),Q(K,{key:"breads-"+x,label:"Breads",dense:"",class:""},{default:o(()=>[e("ul",ye,[(c(!0),m($,null,V(p.breads,(g,w)=>(c(),m("li",{key:"bread-"+w,class:"q-my-sm"},[e("div",be,[e("div",null,u(g.bread_name),1),e("div",null,u(g.bread_production),1)])]))),128))])]),_:2},1024)),(c(),Q(K,{key:"ingredients-"+x,label:"Ingredients",dense:"",class:""},{default:o(()=>[e("ul",fe,[(c(!0),m($,null,V(p.ingredients,(g,w)=>(c(),m("li",{key:"ingredient-"+w,class:"q-my-sm"},[e("div",we,[e("div",null,u(g.code),1),e("div",null,u(g.quantity)+" "+u(g.unit),1)])]))),128))])]),_:2},1024))])]),_:2},1024)]),_:2},1024))]),_:1},8,["items"])]),e("div",xe,[s(N,{color:"red-6",icon:"edit",label:"Create",onClick:C})])],64))}};var qe=G(ke,[["__scopeId","data-v-21535d8a"]]);const D=h=>(M("data-v-4822f488"),h=h(),H(),h),Re={class:"row justify-center"},Ce={class:"text-h6 q-ma-sm"},Qe={class:"row q-gutter-sm"},$e={class:"row q-mt-sm q-gutter-sm"},Ie={class:"q-mb-md"},Se=D(()=>e("div",{class:"q-mt-sm"},"Kilo",-1)),Fe={class:"q-mt-md q-gutter-md"},Ve={key:0},je=D(()=>e("div",{class:"q-mt-sm"},null,-1)),Le=D(()=>e("div",{class:"text-h6 q-mt-sm",align:"center"},"Ingredients List",-1)),Be={class:"q-mt-lg"},Ne={class:"ingredient-quantity"},Ae={class:"ingredient-quantity"},Te={__name:"ReportRecipeInputComponent",setup(h){const v=j(),_=R(()=>v.user),d=R(()=>v.recipes);console.log("erwe:",d.value);const b=R(()=>{var r,n,i,y;const a=(n=(r=d.value)==null?void 0:r.name)!=null?n:"Recipe Name",l=(y=(i=d.value)==null?void 0:i.category)!=null?y:"Category";return`${a} - ${l}`}),C=a=>a?a.split(" ").map(l=>l.charAt(0).toUpperCase()+l.slice(1).toLowerCase()).join(" "):"",t=Y({user_id:null,branch_id:null,branch_recipe_id:null,recipe_name:"",recipe_category:"",kilo:0,short:0,over:0,target:0,actual_target:0,breads:[]}),f=()=>{var r;const a=parseFloat(t.kilo),l=parseFloat((r=d.value)==null?void 0:r.target);if(!isNaN(a)&&!isNaN(l)){const n=a*l;t.actual_target=Math.ceil(n)}else t.actual_target=0},p=()=>{const a=t.breads.reduce((r,n)=>r+(parseFloat(n.value)||0),0),l=t.actual_target;a===l?(t.short=0,t.over=0):a>l?(t.over=a-l,t.short=0):a<l&&(t.short=l-a,t.over=0)},x=()=>{var l,r,n,i,y,O,P;t.user_id=((l=_.value)==null?void 0:l.data.id)||"",t.branch_id=((n=(r=_.value)==null?void 0:r.device)==null?void 0:n.branch_id)||"",t.branch_recipe_id=((i=d.value)==null?void 0:i.id)||"",t.recipe_name=((y=d.value)==null?void 0:y.name)||"",t.target=((O=d.value)==null?void 0:O.target)||"",t.recipe_category=((P=d.value)==null?void 0:P.category)||"";const a={user_id:t.user_id,branch_id:t.branch_id,branch_recipe_id:t.branch_recipe_id,recipe_name:t.recipe_name,recipe_category:t.recipe_category,status:"pending",kilo:t.kilo,short:t.short,over:t.over,target:t.target,actual_target:t.actual_target,breads:t.breads.map(k=>({bread_id:k.id,bread_name:k.bread_name,bread_production:parseInt(k.value,10)||0})),ingredients:w.value.map(k=>({ingredients_id:k.raw_materials_id,code:k.code,quantity:k.multipliedQuantity,unit:k.unit}))};console.log("reportssss dATA:",a),v.setReport(a),console.log("Report data set to store:",v.reports),g()},g=()=>{var a,l;d.value="",b.value="",t.recipe_name="",t.kilo="",t.short=0,t.over=0,t.target=0,t.actual_target=0,t.breads=((l=(a=d.value)==null?void 0:a.bread_groups)==null?void 0:l.map(r=>({id:r.product_id,bread_name:r.bread_name,value:""})))||[]},w=R(()=>{var l;const a=parseFloat(t.kilo)||0;return(((l=d.value)==null?void 0:l.ingredients)||[]).map(r=>{const n=parseFloat(r.quantity)||0,i=a*n,y=i%1===0?i:parseFloat(i.toFixed(2));return{...r,multipliedQuantity:y}})});return B(()=>t.kilo,()=>{f(),p()}),B(()=>{var a;return(a=d.value)==null?void 0:a.ingredients},()=>{p()},{deep:!0}),B(()=>t.breads.map(a=>a.value),p,{deep:!0}),B(()=>{var a;return(a=d.value)==null?void 0:a.bread_groups},()=>{var a;t.breads=((a=d.value)==null?void 0:a.bread_groups.map(l=>({id:l.product_id,bread_name:l.bread_name,value:""})))||[],p()}),(a,l)=>{var r;return c(),m("div",Re,[e("div",null,[e("div",null,[e("div",Ce,u(C(b.value)),1)]),e("div",Qe,[e("div",null,[q(" Target Pcs "),e("div",null,[s(I,{readonly:"",outlined:"",type:"number",dense:"",label:((r=d.value)==null?void 0:r.target)||0,style:{width:"100px","max-width":"300px","min-width":"50px"}},null,8,["label"])])]),e("div",null,[q(" Actual Target "),e("div",null,[s(I,{readonly:"",outlined:"",dense:"",label:t.actual_target,style:{width:"100px","max-width":"300px","min-width":"50px"}},null,8,["label"])])])]),e("div",$e,[e("div",null,[q(" Short "),e("div",null,[s(I,{readonly:"",outlined:"",type:"number",dense:"",label:t.short,style:{width:"100px","max-width":"300px","min-width":"50px"}},null,8,["label"])])]),e("div",null,[q(" Over "),e("div",null,[s(I,{readonly:"",outlined:"",dense:"",label:t.over,style:{width:"100px","max-width":"300px","min-width":"50px"}},null,8,["label"])])])]),e("div",Ie,[Se,e("div",null,[s(A,{outlined:"",dense:"",modelValue:t.kilo,"onUpdate:modelValue":l[0]||(l[0]=n=>t.kilo=n),type:"number",placeholder:"kgs",style:{width:"210px","max-width":"300px","min-width":"50px"}},null,8,["modelValue"])])]),e("div",Fe,[t.breads.length?(c(),m("div",Ve,[(c(!0),m($,null,V(t.breads,(n,i)=>(c(),m("div",{key:n.id,class:"q-my-md"},[e("div",null,[e("div",null,u(n.bread_name),1),e("div",null,[s(A,{outlined:"",modelValue:t.breads[i].value,"onUpdate:modelValue":y=>t.breads[i].value=y,dense:"",type:"number",placeholder:"Pcs",style:{width:"210px","max-width":"300px","min-width":"50px"}},null,8,["modelValue","onUpdate:modelValue"])])])]))),128))])):J("",!0)]),je,s(N,{outline:"",dense:"",size:"md",icon:"add",label:"Report",class:"text-purple",onClick:x})]),e("div",null,[Le,e("div",Be,[s(I,{readonly:"",outlined:"",style:{width:"400px","max-width":"450px","min-width":"100px"}},{control:o(()=>[s(W,{dense:"",separator:""},{default:o(()=>[(c(!0),m($,null,V(w.value,(n,i)=>(c(),Q(U,{key:i,class:"q-pa-xs justify-between"},{default:o(()=>[s(F,null,{default:o(()=>[s(T,{class:"ingredient-name"},{default:o(()=>[q(u(n.code),1)]),_:2},1024)]),_:2},1024),s(F,{side:"",class:"text-right"},{default:o(()=>[e("div",Ne,u(n.multipliedQuantity),1)]),_:2},1024),s(F,{side:"",class:"text-right"},{default:o(()=>[e("div",Ae,u(n.unit),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})])])])}}};var Ue=G(Te,[["__scopeId","data-v-4822f488"]]);const ze={key:0,class:"custom-list z-top"},De={__name:"ReportSearchComponent",setup(h){var w,a;const v=j(),_=Z(""),d=j(),b=se(),C=R(()=>d.user);console.log("erw:",C.value);const t=R(()=>b.branchRecipe),f=((a=(w=C.value)==null?void 0:w.employee)==null?void 0:a.branch_id)||"";console.log("branch_id",f);const p=async()=>{b.searchBranchRecipe(_.value,f),console.log("searchQuery.value",_.value),console.log("branch_id",f)},x=l=>{console.log("branch recipe",l),v.setRecipe(l),_.value=""},g=l=>l?l.split(" ").map(r=>r.charAt(0).toUpperCase()+r.slice(1).toLowerCase()).join(" "):"";return console.log("recipessss",t.value),(l,r)=>(c(),Q(A,{modelValue:_.value,"onUpdate:modelValue":[r[0]||(r[0]=n=>_.value=n),p],debounce:"1000",outlined:"",rounded:"",placeholder:"Search product",dense:""},{append:o(()=>[e("div",null,[s(E,{name:"search"})])]),default:o(()=>[_.value?(c(),m("div",ze,[s(z,null,{default:o(()=>[s(W,{separator:""},{default:o(()=>{var n;return[(n=t.value)!=null&&n.length?(c(!0),m($,{key:1},V(t.value,i=>(c(),Q(U,{onClick:y=>x(i),key:i.id,clickable:""},{default:o(()=>[s(F,null,{default:o(()=>[s(T,null,{default:o(()=>[q(u(g(i==null?void 0:i.name)),1)]),_:2},1024)]),_:2},1024),s(F,null,{default:o(()=>[s(T,{side:""},{default:o(()=>[q(u(i==null?void 0:i.category),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128)):(c(),Q(U,{key:0},{default:o(()=>[q(" No record found. ")]),_:1}))]}),_:1})]),_:1})])):J("",!0)]),_:1},8,["modelValue"]))}},Oe={class:"text-h6 text-dark row justify-between"},Pe=e("div",null," Bakers Report ",-1),Ke={class:"q-gutter-y-md"},Ee={class:"q-gutter-y-md"},st={__name:"ReportIdCreatePage",setup(h){const v=ee(),_=j(),d=R(()=>_.recipes);console.log("report",d);const b=()=>{_.clearData(),v.push("/branch/baker/report")};return(C,t)=>(c(),m("div",null,[s(z,{flat:""},{default:o(()=>[s(S,null,{default:o(()=>[e("div",Oe,[e("div",null,[s(N,{outline:"",flat:"",icon:"arrow_back",onClick:b})]),s(te),Pe])]),_:1}),s(S,null,{default:o(()=>[e("div",null,[s(De)]),e("div",Ke,[e("div",null,[s(Ue)])])]),_:1}),s(S,null,{default:o(()=>[e("div",Ee,[e("div",null,[s(qe)])])]),_:1})]),_:1})]))}};export{st as default};
