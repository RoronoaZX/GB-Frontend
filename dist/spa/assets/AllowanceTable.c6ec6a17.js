import{c as T,r as u,t as H,o as m,a3 as N,f as o,M as V,w as n,Q as O,I as k,ae as G,J as s,K as w,e as b,L as z,bc as W,a0 as q,bd as P,a4 as B,a5 as D,$ as h,aJ as X,a2 as Y,O as K,R,z as Z,u as ee,bb as ae,N as U}from"./index.94c77fd6.js";import{b as te,Q as oe,a as le}from"./QTable.c51a3968.js";import{Q as ne}from"./QTr.8d6dd874.js";import{Q as se}from"./QTooltip.4dab85c8.js";import{Q as re}from"./QPopupEdit.7f5f33cc.js";import{Q as ie}from"./QSpinnerIos.50425f75.js";import{Q as de}from"./QInnerLoading.91165b51.js";import{Q as me}from"./QPage.3fc3d23e.js";import{u as j}from"./AllowanceTable.vue_vue_type_style_index_0_scoped_true_lang.93044d0c.js";import{Q as ue}from"./QSpace.65df66a4.js";import{Q as F,a as L}from"./QItem.8c9b5e82.js";import{Q as ce}from"./QList.efc29e9c.js";import{C as pe}from"./ClosePopup.f93b8122.js";import{u as fe}from"./employee.650041bf.js";import{_ as J}from"./plugin-vue_export-helper.21dcd24c.js";import"./QVirtualScroll.4001b6e2.js";import"./use-virtual-scroll.01174c13.js";import"./QSelect.3d607b48.js";import"./QItemLabel.489c9a54.js";import"./QChip.f7beea7b.js";import"./QMenu.ede0aec6.js";import"./position-engine.27bd2550.js";import"./selection.a3acc90c.js";import"./axios.669ebcd4.js";const I=c=>(K("data-v-482de200"),c=c(),R(),c),_e=I(()=>s("div",{class:"text-h6 text-weight-bold"},"\u{1F4BC} Add Employee Allowance",-1)),ge={style:{position:"relative"}},ye={key:0,class:"dropdown-list"},ve={class:"row q-col-gutter-md q-mt-lg"},we={class:"col-12 col-sm-6"},be=I(()=>s("div",{class:"text-subtitle2 text-grey-7 q-mb-xs"}," Employee Name: ",-1)),he={class:"text-body1 text-weight-medium"},xe={class:"col-12 col-sm-6"},Ae=I(()=>s("div",{class:"text-subtitle2 text-grey-7 q-mb-xs"},"Position:",-1)),Qe={class:"text-body1 text-weight-medium"},Ve={class:"row q-col-gutter-md"},qe={class:"col-12 col-sm-6"},Ce={class:"col-12 col-sm-6"},Se={__name:"AddAllowance",emits:["created"],setup(c,{emit:x}){const C=x,d=fe(),g=T(()=>d.employees),_=j(),p=u(""),f=u(!1),A=u(!1),Q=u(!1),y=()=>{f.value=!0},E=async()=>{p.value.trim()&&(Q.value=!0,await d.searchEmployee(p.value),Q.value=!1)},S=l=>{r.employee_id=l.id,r.employee_name=`${l.firstname} ${l.middlename?l.middlename.charAt(0)+".":""} ${l.lastname}`,r.employee_position=l.position,p.value=""},r=H({employee_id:"",employee_name:"",employee_position:"",amount:""}),$=()=>{r.employee_id="",r.employee_name="",r.employee_position="",r.amount=""},a=async()=>{A.value=!0;try{await _.createEmployeeAllowance(r),C("created"),f.value=!1,$()}catch(l){console.error(l)}finally{A.value=!1}};return(l,t)=>(m(),N("div",null,[o(V,{padding:"sm md",label:"Add Allowance",icon:"add_circle",size:"md",class:"gradient-btn text-white",onClick:y}),o(Y,{modelValue:f.value,"onUpdate:modelValue":t[4]||(t[4]=e=>f.value=e),persistent:"",position:"right","backdrop-filter":"blur(4px) saturate(150%)"},{default:n(()=>[o(O,{class:"compact-dialog-card"},{default:n(()=>[o(k,{class:"dialog-header row items-center no-wrap"},{default:n(()=>[_e,o(ue),G(o(V,{icon:"close",flat:"",dense:"",round:"",class:"text-white"},null,512),[[pe]])]),_:1}),o(k,{class:"q-px-lg q-pt-md"},{default:n(()=>[s("div",ge,[o(w,{modelValue:p.value,"onUpdate:modelValue":[t[0]||(t[0]=e=>p.value=e),E],label:"Search Employee",outlined:"",dense:"",rounded:"",debounce:"500",placeholder:"Enter employee name",clearable:""},{append:n(()=>[Q.value?(m(),b(W,{key:1,color:"primary",size:"sm"})):(m(),b(z,{key:0,name:"search"}))]),_:1},8,["modelValue"]),p.value?(m(),N("div",ye,[o(ce,{separator:""},{default:n(()=>{var e;return[(e=g.value)!=null&&e.length?P("",!0):(m(),b(F,{key:0},{default:n(()=>[o(L,{class:"text-grey-7"},{default:n(()=>[q("No employee found.")]),_:1})]),_:1})),(m(!0),N(B,null,D(g.value,i=>(m(),b(F,{key:i.id,clickable:"",onClick:v=>S(i)},{default:n(()=>[o(L,null,{default:n(()=>[q(h(`${i.firstname} ${i.middlename?i.middlename.charAt(0)+".":""} ${i.lastname}`),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]}),_:1})])):P("",!0)]),s("div",ve,[s("div",we,[be,s("div",he,h(r.employee_name||"----------"),1)]),s("div",xe,[Ae,s("div",Qe,h(r.employee_position||"----------"),1)])])]),_:1}),o(k,{class:"q-px-lg q-pt-md"},{default:n(()=>[s("div",Ve,[s("div",qe,[o(w,{modelValue:r.employee_name,"onUpdate:modelValue":t[1]||(t[1]=e=>r.employee_name=e),outlined:"",dense:"",readonly:"",label:"Name"},null,8,["modelValue"])]),s("div",Ce,[o(w,{modelValue:r.employee_position,"onUpdate:modelValue":t[2]||(t[2]=e=>r.employee_position=e),outlined:"",dense:"",readonly:"",label:"Position"},null,8,["modelValue"])])])]),_:1}),o(k,{class:"q-px-lg q-pt-md"},{default:n(()=>[o(w,{modelValue:r.amount,"onUpdate:modelValue":t[3]||(t[3]=e=>r.amount=e),outlined:"",dense:"",label:"Allowance Amount",prefix:"\u20B1",type:"number",clearable:""},null,8,["modelValue"])]),_:1}),o(X,{align:"right",class:"q-px-lg q-pb-md"},{default:n(()=>[o(V,{size:"md",padding:"sm lg",label:"Save","icon-right":"send",class:"gradient-btn text-white",onClick:a,loading:A.value},null,8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}};var ke=J(Se,[["__scopeId","data-v-482de200"]]);const Ne=c=>(K("data-v-18b191aa"),c=c(),R(),c),Ee={class:"row justify-between q-mb-md",align:"right"},$e={class:"q-pa-md",style:{"min-width":"300px","max-width":"400px"}},Ie=Ne(()=>s("div",{class:"text-h6 text-primary text-center q-mb-sm"}," Edit Amount ",-1)),Pe={class:"text-subtitle2 q-mb-md"},Ue={class:"row justify-end q-mt-md"},Fe={__name:"AllowanceTable",setup(c){const x=j(),C=T(()=>x.allowances),d=u({page:1,rowsPerPage:0,rowsNumber:0}),g=u([]),_=u(!1),p=u(!1),f=u("");u(!1);function A(a){if(a==null||a==="")return"";const l=parseFloat(a);return isNaN(l)?"":Number.isInteger(l)?String(parseInt(l)):String(l)}async function Q(a,l){console.log("updateteAmount",a,l),_.value=!0;try{await x.updateAmount(a,l),U.create({message:"Amount updated successfully",color:"positive",position:"top",timeout:2e3})}catch(t){console.error("Error updating amount:",t),U.create({message:"Failed to update amount",color:"negative",position:"top",timeout:2e3})}finally{_.value=!1}}Z(async()=>{await y()});const y=async(a=1,l=7,t="")=>{try{_.value=!0,await x.fetchEmployeeAllowance(a,l,t),console.log("allowance",C.value);const{data:e,current_page:i,per_page:v,total:M}=C.value;g.value=e,console.log("employeeAllowance",g.value),d.value.page=i,d.value.rowsPerPage=v,d.value.rowsNumber=M}catch(e){console.log("Error fetching allowance",e)}finally{_.value=!1}},E=a=>{console.log("handle request",a),y(a.pagination.page,a.pagination.rowsPerPage,a.filter)};ee(f,async a=>{p.value=!0,await y(d.value.page,d.value.rowsPerPage,a),p.value=!1});const S=a=>{const l=v=>v?v.charAt(0).toUpperCase()+v.slice(1).toLowerCase():"",t=a.firstname?l(a.firstname):"No Firstname",e=a.middlename?l(a.middlename).charAt(0)+".":"",i=a.lastname?l(a.lastname):"No Lastname";return`${t} ${e} ${i}`.trim()},r=a=>new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(a),$=[{name:"name",required:!0,label:"Name",align:"center",field:a=>S(a.employee)},{name:"amount",required:!0,label:"Amount",align:"center",field:a=>r(a.amount)}];return(a,l)=>(m(),b(me,{class:"q-my-md"},{default:n(()=>[s("div",Ee,[s("div",null,[o(ke,{onCreated:y})]),o(w,{modelValue:f.value,"onUpdate:modelValue":l[0]||(l[0]=t=>f.value=t),outlined:"",dense:"",debounce:"300",flat:"",label:"Search",style:{width:"300px"}},{append:n(()=>[s("div",null,[o(z,{name:"search"})])]),_:1},8,["modelValue"])]),o(le,{flat:"",bordered:"",rows:g.value,columns:$,"row-key":"name",pagination:d.value,"onUpdate:pagination":l[1]||(l[1]=t=>d.value=t),"rows-per-page-options":[5,7,10,0],onRequest:E,loading:_.value},{header:n(t=>[o(ne,{props:t,class:"gradient-header text-white text-weight-bold"},{default:n(()=>[(m(!0),N(B,null,D(t.cols,e=>(m(),b(te,{key:e.name,props:t,class:"text-center text-subtitle2"},{default:n(()=>[q(h(e.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),"body-cell-amount":n(t=>[o(oe,{props:t,class:"cursor-pointer"},{default:n(()=>[s("span",null,[q(h(t.row.amount?r(t.row.amount):" - - ")+" ",1),o(se,{class:"bg-blue-grey-8"},{default:n(()=>[q("Edit Amount")]),_:1})]),o(re,{modelValue:t.row.amount,"onUpdate:modelValue":[e=>t.row.amount=e,e=>Q(t.row,e)]},{default:n(e=>[s("div",$e,[Ie,s("div",Pe," Name: "+h(S(t.row.employee)),1),o(w,{modelValue:e.value,"onUpdate:modelValue":[i=>e.value=i,i=>e.value=i],type:"text",outlined:"",dense:"",autofocus:"",counter:"","model-value":A(e.value),onKeyup:ae(e.set,["enter"])},null,8,["modelValue","onUpdate:modelValue","model-value","onKeyup"]),s("div",Ue,[o(V,{flat:"",label:"Close",color:"primary",onClick:e.cancel},null,8,["onClick"]),o(V,{flat:"",label:"Save",color:"primary",onClick:e.set},null,8,["onClick"])])])]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1032,["props"])]),loading:n(()=>[o(de,{showing:""},{default:n(()=>[o(ie,{size:"50px",color:"grey-10"})]),_:1})]),_:1},8,["rows","pagination","loading"])]),_:1}))}};var ra=J(Fe,[["__scopeId","data-v-18b191aa"]]);export{ra as default};
