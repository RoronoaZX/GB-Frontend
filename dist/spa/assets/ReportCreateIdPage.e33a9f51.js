import{c as V,r as u,H as E,t as Q,z as G,u as H,o as f,e as S,w as i,Q as J,f as t,J as n,M as c,I as B,K as v,a0 as k,bb as W,aI as X,a3 as N,a5 as Y,$ as x,a4 as Z,bd as ee,N as ae,O as te,R as se}from"./index.e5795df4.js";import{Q as le}from"./QSpace.2ecef08c.js";import{a as D,b as y}from"./QMenu.6ef38b83.js";import{Q as ne,a as oe}from"./QSelect.7cf2275b.js";import{Q as ie}from"./QList.0a117bee.js";import{u as re}from"./cake-maker-report.6f2c37e3.js";import{u as de}from"./branch-rawMaterials.68a68aca.js";import{_ as ue}from"./plugin-vue_export-helper.21dcd24c.js";import"./position-engine.9614e285.js";import"./selection.f114dc12.js";import"./QChip.5d2a10d5.js";import"./use-virtual-scroll.8c1ede6a.js";import"./rtl.276c3f1b.js";import"./axios.f42c3627.js";import"./raw-material.df4841d1.js";const L=m=>(te("data-v-f87fca3e"),m=m(),se(),m),ce={class:"text-h6 text-dark row justify-between"},me=L(()=>n("div",null," Cake Report ",-1)),pe={class:"q-px-xl q-mx-xl"},_e={class:"q-my-sm"},fe={class:"row justify-between"},ve={class:""},ye={class:"row q-mt-md justify-between"},be=["onKeyup"],we={class:"q-mt-sm q-gutter-sm",align:"right"},he={class:"q-mt-md"},ge=L(()=>n("div",{class:"q-my-sm text-weight-light",align:"center"}," Ingredient List ",-1)),ke={key:0,class:"q-pa-sm q-mt-lg",align:"right"},xe={__name:"ReportCreateIdPage",setup(m){var C,I;const p=localStorage.getItem("branch_id"),b=de();V(()=>b.branchRawMaterials),u(!1);const w=re();u("");const O=E(),d=u([]),_=u([]),j=u(!1),h=u(_.value),M=((I=(C=V(()=>w.user).value)==null?void 0:C.data)==null?void 0:I.id)||"";console.log("user_id",M);const s=Q({name:"",quantity:""}),U=async l=>{const a=await b.fetchBranchRawMaterials(l);console.log("branch raw Materials",a),j.value=!1,_.value=b.branchRawMaterials.map(e=>{var r;return{label:(r=e.ingredients)==null?void 0:r.name,value:e.id,unit:e.ingredients.unit}})};G(async()=>{console.log("props.branchId in onMounted:",p),p&&await U(p)});const g=()=>{s.name="",s.quantity="",s.unit=""},F=()=>{o.branch_id="",o.user_id="",o.name="",o.layers="",o.pieces="",o.price="",d.value=[],g()},K=(l,a)=>{a(()=>{if(l==="")h.value=_.value;else{const e=l.toLowerCase();h.value=_.value.filter(r=>r.label.toLowerCase().indexOf(e)>-1)}})},R=()=>{const l=d.value;function a(q,$){return q.find(A=>A.rawMaterials_id==$)}const e=s.name.value;a(l,e)?ae.create({type:"negative",icon:"warning",message:"Ingredient already exist",timeout:2e3}):(d.value=[...l,{rawMaterials_id:s.name.value,label:s.name.label,quantity:s.quantity,unit:s.name.unit}],g())},P=l=>{d.value.splice(l,1)};H(()=>s.name,l=>{l&&l.unit?s.unit=l.unit:s.unit=""});const o=Q({branch_id:p,user_id:M,name:"",layers:"",confirmation_status:"pending",price:""}),z=async()=>{const l={...o,ingredients:d.value.map(a=>({branch_raw_materials_reports_id:a.rawMaterials_id,quantity:a.quantity,unit:a.unit}))};await w.createReports(l),F()},T=()=>{w.clearData(),O.push("/branch/cake_maker/report")};return(l,a)=>(f(),S(J,{flat:""},{default:i(()=>[t(B,null,{default:i(()=>[n("div",ce,[n("div",null,[t(c,{outline:"",flat:"",icon:"arrow_back",onClick:T})]),t(le),me])]),_:1}),t(B,null,{default:i(()=>[n("div",pe,[n("div",_e,[t(v,{modelValue:o.name,"onUpdate:modelValue":a[0]||(a[0]=e=>o.name=e),outlined:"",dense:"",label:"Cake Name"},null,8,["modelValue"])]),n("div",fe,[t(v,{modelValue:o.price,"onUpdate:modelValue":a[1]||(a[1]=e=>o.price=e),outlined:"",dense:"",label:"Price",mask:"###,###.##","reverse-fill-mask":"","input-class":"text-right",style:{width:"300px"}},null,8,["modelValue"]),t(v,{modelValue:o.layers,"onUpdate:modelValue":a[2]||(a[2]=e=>o.layers=e),outlined:"",dense:"",label:"Layer/s",type:"number",style:{width:"100px"}},null,8,["modelValue"])]),n("div",null,[n("div",ve,[n("div",ye,[t(ne,{modelValue:s.name,"onUpdate:modelValue":a[3]||(a[3]=e=>s.name=e),debounce:"3000",outlined:"",options:h.value,dense:"",behavior:"menu","use-input":"","hide-dropdown-icon":"",onFilter:K,label:"Ingredients",style:{width:"330px"}},{default:i(()=>[n("template",null,[t(D,null,{default:i(()=>[t(y,{class:"text-grey"},{default:i(()=>[k(" No results ")]),_:1})]),_:1})])]),_:1},8,["modelValue","options"]),t(v,{modelValue:s.quantity,"onUpdate:modelValue":a[4]||(a[4]=e=>s.quantity=e),outlined:"",dense:"",label:"Quantity",suffix:s.name.unit||"",style:{width:"170px"}},null,8,["modelValue","suffix"])]),n("form",{onKeyup:W(X(R,["prevent"]),["enter"])},[n("div",we,[t(c,{padding:"sm md",type:"button",size:"sm",outline:"",dense:"",icon:"delete_sweep",label:"Clear Input",color:"red",onClick:g}),t(c,{padding:"sm md",type:"button",size:"sm",outline:"",dense:"",label:"Add Ingredients",icon:"add",color:"purple",onClick:R})])],40,be)])]),n("div",he,[ge,n("div",null,[t(ie,{dense:"",separator:"",class:"box q-mr-sm"},{default:i(()=>[(f(!0),N(Z,null,Y(d.value,(e,r)=>(f(),S(D,{key:r},{default:i(()=>[t(y,null,{default:i(()=>[t(oe,null,{default:i(()=>[k(x(e.label),1)]),_:2},1024)]),_:2},1024),t(y,null,{default:i(()=>[k(x(e.quantity)+" "+x(e.unit),1)]),_:2},1024),t(y,{side:""},{default:i(()=>[t(c,{color:"grey-10",icon:"backspace",dense:"",flat:"",round:"",onClick:q=>P(r)},null,8,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})])]),d.value.length>0?(f(),N("div",ke,[t(c,{color:"red-6",icon:"edit",label:"Create",onClick:z})])):ee("",!0)])]),_:1})]),_:1}))}};var Ke=ue(xe,[["__scopeId","data-v-f87fca3e"]]);export{Ke as default};
