import{c as V,r as u,H as E,t as Q,z as G,u as H,o as f,e as S,w as i,Q as J,f as a,J as n,M as c,I as B,K as v,a0 as k,bb as W,aI as X,a3 as N,a5 as Y,$ as x,a4 as Z,bd as ee,N as te,O as ae,R as se}from"./index.3e3525c7.js";import{Q as le}from"./QSpace.2dc67d2c.js";import{Q as D,a as y}from"./QItem.5243002e.js";import{Q as ne}from"./QSelect.f94a5cc6.js";import{a as oe}from"./QItemLabel.72cc67ca.js";import{Q as ie}from"./QList.9ab35285.js";import{u as re}from"./cake-maker-report.5de6a57d.js";import{u as de}from"./branch-rawMaterials.1e26bf4f.js";import{_ as ue}from"./plugin-vue_export-helper.21dcd24c.js";import"./QChip.e1fd42ad.js";import"./QMenu.397baca8.js";import"./position-engine.291b8a8d.js";import"./selection.8fec0821.js";import"./use-virtual-scroll.65859bd0.js";import"./axios.d6309847.js";import"./raw-material.1619bc2e.js";const L=m=>(ae("data-v-f87fca3e"),m=m(),se(),m),ce={class:"text-h6 text-dark row justify-between"},me=L(()=>n("div",null," Cake Report ",-1)),pe={class:"q-px-xl q-mx-xl"},_e={class:"q-my-sm"},fe={class:"row justify-between"},ve={class:""},ye={class:"row q-mt-md justify-between"},be=["onKeyup"],we={class:"q-mt-sm q-gutter-sm",align:"right"},he={class:"q-mt-md"},ge=L(()=>n("div",{class:"q-my-sm text-weight-light",align:"center"}," Ingredient List ",-1)),ke={key:0,class:"q-pa-sm q-mt-lg",align:"right"},xe={__name:"ReportCreateIdPage",setup(m){var C,I;const p=localStorage.getItem("branch_id"),b=de();V(()=>b.branchRawMaterials),u(!1);const w=re();u("");const O=E(),d=u([]),_=u([]),j=u(!1),h=u(_.value),M=((I=(C=V(()=>w.user).value)==null?void 0:C.data)==null?void 0:I.id)||"";console.log("user_id",M);const s=Q({name:"",quantity:""}),U=async l=>{const t=await b.fetchBranchRawMaterials(l);console.log("branch raw Materials",t),j.value=!1,_.value=b.branchRawMaterials.map(e=>{var r;return{label:(r=e.ingredients)==null?void 0:r.name,value:e.id,unit:e.ingredients.unit}})};G(async()=>{console.log("props.branchId in onMounted:",p),p&&await U(p)});const g=()=>{s.name="",s.quantity="",s.unit=""},F=()=>{o.branch_id="",o.user_id="",o.name="",o.layers="",o.pieces="",o.price="",d.value=[],g()},K=(l,t)=>{t(()=>{if(l==="")h.value=_.value;else{const e=l.toLowerCase();h.value=_.value.filter(r=>r.label.toLowerCase().indexOf(e)>-1)}})},R=()=>{const l=d.value;function t(q,$){return q.find(A=>A.rawMaterials_id==$)}const e=s.name.value;t(l,e)?te.create({type:"negative",icon:"warning",message:"Ingredient already exist",timeout:2e3}):(d.value=[...l,{rawMaterials_id:s.name.value,label:s.name.label,quantity:s.quantity,unit:s.name.unit}],g())},P=l=>{d.value.splice(l,1)};H(()=>s.name,l=>{l&&l.unit?s.unit=l.unit:s.unit=""});const o=Q({branch_id:p,user_id:M,name:"",layers:"",confirmation_status:"pending",price:""}),z=async()=>{const l={...o,ingredients:d.value.map(t=>({branch_raw_materials_reports_id:t.rawMaterials_id,quantity:t.quantity,unit:t.unit}))};await w.createReports(l),F()},T=()=>{w.clearData(),O.push("/branch/cake_maker/report")};return(l,t)=>(f(),S(J,{flat:""},{default:i(()=>[a(B,null,{default:i(()=>[n("div",ce,[n("div",null,[a(c,{outline:"",flat:"",icon:"arrow_back",onClick:T})]),a(le),me])]),_:1}),a(B,null,{default:i(()=>[n("div",pe,[n("div",_e,[a(v,{modelValue:o.name,"onUpdate:modelValue":t[0]||(t[0]=e=>o.name=e),outlined:"",dense:"",label:"Cake Name"},null,8,["modelValue"])]),n("div",fe,[a(v,{modelValue:o.price,"onUpdate:modelValue":t[1]||(t[1]=e=>o.price=e),outlined:"",dense:"",label:"Price",mask:"###,###.##","reverse-fill-mask":"","input-class":"text-right",style:{width:"300px"}},null,8,["modelValue"]),a(v,{modelValue:o.layers,"onUpdate:modelValue":t[2]||(t[2]=e=>o.layers=e),outlined:"",dense:"",label:"Layer/s",type:"number",style:{width:"100px"}},null,8,["modelValue"])]),n("div",null,[n("div",ve,[n("div",ye,[a(ne,{modelValue:s.name,"onUpdate:modelValue":t[3]||(t[3]=e=>s.name=e),debounce:"3000",outlined:"",options:h.value,dense:"",behavior:"menu","use-input":"","hide-dropdown-icon":"",onFilter:K,label:"Ingredients",style:{width:"330px"}},{default:i(()=>[n("template",null,[a(D,null,{default:i(()=>[a(y,{class:"text-grey"},{default:i(()=>[k(" No results ")]),_:1})]),_:1})])]),_:1},8,["modelValue","options"]),a(v,{modelValue:s.quantity,"onUpdate:modelValue":t[4]||(t[4]=e=>s.quantity=e),outlined:"",dense:"",label:"Quantity",suffix:s.name.unit||"",style:{width:"170px"}},null,8,["modelValue","suffix"])]),n("form",{onKeyup:W(X(R,["prevent"]),["enter"])},[n("div",we,[a(c,{padding:"sm md",type:"button",size:"sm",outline:"",dense:"",icon:"delete_sweep",label:"Clear Input",color:"red",onClick:g}),a(c,{padding:"sm md",type:"button",size:"sm",outline:"",dense:"",label:"Add Ingredients",icon:"add",color:"purple",onClick:R})])],40,be)])]),n("div",he,[ge,n("div",null,[a(ie,{dense:"",separator:"",class:"box q-mr-sm"},{default:i(()=>[(f(!0),N(Z,null,Y(d.value,(e,r)=>(f(),S(D,{key:r},{default:i(()=>[a(y,null,{default:i(()=>[a(oe,null,{default:i(()=>[k(x(e.label),1)]),_:2},1024)]),_:2},1024),a(y,null,{default:i(()=>[k(x(e.quantity)+" "+x(e.unit),1)]),_:2},1024),a(y,{side:""},{default:i(()=>[a(c,{color:"grey-10",icon:"backspace",dense:"",flat:"",round:"",onClick:q=>P(r)},null,8,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})])]),d.value.length>0?(f(),N("div",ke,[a(c,{color:"red-6",icon:"edit",label:"Create",onClick:z})])):ee("",!0)])]),_:1})]),_:1}))}};var Pe=ue(xe,[["__scopeId","data-v-f87fca3e"]]);export{Pe as default};
