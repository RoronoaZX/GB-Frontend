import{bp as J,c as D,r as V,t as Ae,o as f,a3 as q,f as e,M as N,w as a,Q as A,I as T,ae as ge,J as n,K as j,L as Z,e as z,a0 as $,a4 as B,a5 as ee,$ as Q,be as qe,aJ as fe,a2 as ae,O as Y,R as X,a1 as Le,N as le,P as $e,z as ce,u as ve,bg as he,bd as je,aK as S,H as He}from"./index.54513f60.js";import{Q as we}from"./QSpace.bcf18154.js";import{Q as oe}from"./QTab.2ab910f4.js";import{Q as Ve}from"./QTabs.d7d5bfcb.js";import{Q as re}from"./QTabPanel.46bac562.js";import{Q as Qe}from"./QTabPanels.8d43cc24.js";import{Q as Ke}from"./QPage.7c49b310.js";import{Q as K}from"./QBadge.1648ae50.js";import{Q as Se}from"./QSpinnerDots.8039292f.js";import{Q as Pe}from"./QTooltip.6b99dd6b.js";import{Q as Ee}from"./QPopupEdit.95607603.js";import{Q as G,a as se}from"./QTable.5f65edd3.js";import{a as H,b as P}from"./QMenu.efa00d76.js";import{a as I}from"./QSelect.09dd491e.js";import{Q as de}from"./QList.145edb2d.js";import{C as ye}from"./ClosePopup.6a488dc1.js";import"./branch-product.1a4eb8dc.js";import{u as ne}from"./warehouse-rawMaterials.36afa308.js";import{u as Ie}from"./raw-material.4135c561.js";import{_ as E}from"./plugin-vue_export-helper.21dcd24c.js";import{api as Ne}from"./axios.a916ec36.js";import{Q as _e}from"./QSkeleton.128425c4.js";import{u as De}from"./use-quasar.ce1b63bf.js";import{u as Te}from"./warehouse.a34b7927.js";import{u as Oe}from"./use-dialog-plugin-component.f2fbbe80.js";import{t as O}from"./typography-format.b883865d.js";import{b as me}from"./badge-color.f568cd69.js";import{u as Be}from"./premix.9c332e5a.js";import{Q as Ge,a as Je}from"./QStepper.81697ad4.js";import{u as Ye}from"./baker-report.08d046b3.js";import{Q as Xe}from"./QSpinnerGears.5abca8ea.js";import{Q as Ze}from"./QInnerLoading.f5c7dde1.js";import"./QResizeObserver.ff1eb5bf.js";import"./rtl.276c3f1b.js";import"./use-panel.bfbb59bb.js";import"./touch.9135741d.js";import"./selection.fae6cefa.js";import"./use-render-cache.3aae9b27.js";import"./position-engine.aff0f025.js";import"./QVirtualScroll.ca341e08.js";import"./use-virtual-scroll.0aceeb38.js";import"./QChip.8bb9d2c5.js";import"./product.f5b7cc6f.js";import"./date.351a060a.js";import"./QSlideTransition.ce74e610.js";const ie=s=>(Y("data-v-e1e644a2"),s=s(),X(),s),ea=ie(()=>n("div",{class:"text-h6"},"Create Warehouse Raw Materials",-1)),aa={class:"q-mb-lg"},ta={key:0,class:"custom-list z-top"},la=ie(()=>n("div",null,"Raw Materials Code",-1)),oa=ie(()=>n("div",null,"Raw Materials Name",-1)),ra=ie(()=>n("div",null,"Category",-1)),sa=ie(()=>n("div",null,"Quantity",-1)),na={__name:"RawMaterialsCreate",setup(s){const R=J(),v=Ie(),k=D(()=>v.rawMaterials),w=ne(),m=V(""),p=async()=>{v.searchRawMaterials(m.value)},_=D(()=>l.total_quantity!==""),y=V(!1),h=()=>{y.value=!0},i=()=>{c(),y.value=!1},t=x=>{l.raw_material_id=x.id,l.raw_materials_name=x.name,l.raw_materials_code=x.code,l.category=x.category,l.unit=x.unit,m.value=""},l=Ae({raw_material_id:"",raw_materials_name:"",raw_materials_code:"",total_quantity:"",category:"",unit:"",warehouse_id:R.params.warehouse_id}),c=()=>{l.raw_material_id="",l.raw_materials_name="",l.raw_materials_code="",l.total_quantity="",l.raw_material_id="",l.category="",l.unit=""},u=async()=>{try{const{product_name:x,...r}=l;await w.createWarehouseRawMaterials(r),console.log("data to send",r),y.value=!1}catch(x){console.log(x)}};return(x,r)=>(f(),q(B,null,[e(N,{class:"bg-gradient text-white q-pa-sm",icon:"add_circle",label:"Create One",onClick:h}),e(ae,{modelValue:y.value,"onUpdate:modelValue":r[5]||(r[5]=o=>y.value=o),persistent:""},{default:a(()=>[e(A,{class:"my-card",style:{width:"400px","max-width":"500px","min-width":"100px"}},{default:a(()=>[e(T,{class:"row items-center text-white bg-gradient"},{default:a(()=>[ea,e(we),ge(e(N,{icon:"close",flat:"",dense:"",round:""},null,512),[[ye]])]),_:1}),e(T,{class:"q-ma-md q-gutter-y-sm"},{default:a(()=>[n("div",aa,[e(j,{modelValue:m.value,"onUpdate:modelValue":[r[0]||(r[0]=o=>m.value=o),p],debounce:"1000",outlined:"",rounded:"",placeholder:"Search Raw Materials",dense:""},{append:a(()=>[n("div",null,[e(Z,{name:"search"})])]),default:a(()=>[m.value?(f(),q("div",ta,[e(A,null,{default:a(()=>[e(de,{separator:""},{default:a(()=>{var o;return[(o=k.value)!=null&&o.length?(f(!0),q(B,{key:1},ee(k.value,d=>(f(),z(H,{onClick:g=>t(d),key:d.id,clickable:""},{default:a(()=>[e(P,null,{default:a(()=>[e(I,null,{default:a(()=>[$(Q(d.name),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128)):(f(),z(H,{key:0},{default:a(()=>[$(" No record found. ")]),_:1}))]}),_:1})]),_:1})])):qe("",!0)]),_:1},8,["modelValue"])]),n("div",null,[la,e(j,{modelValue:l.raw_materials_code,"onUpdate:modelValue":r[1]||(r[1]=o=>l.raw_materials_code=o),readonly:"",dense:"",outlined:""},null,8,["modelValue"])]),n("div",null,[oa,e(j,{modelValue:l.raw_materials_name,"onUpdate:modelValue":r[2]||(r[2]=o=>l.raw_materials_name=o),readonly:"",dense:"",outlined:""},null,8,["modelValue"])]),n("div",null,[ra,e(j,{modelValue:l.category,"onUpdate:modelValue":r[3]||(r[3]=o=>l.category=o),readonly:"",dense:"",outlined:""},null,8,["modelValue"])]),n("div",null,[sa,e(j,{modelValue:l.total_quantity,"onUpdate:modelValue":r[4]||(r[4]=o=>l.total_quantity=o),type:"number",outlined:"",suffix:l.unit||"",dense:"",rules:[o=>o&&o.length>0||"Total quantity is required"]},null,8,["modelValue","suffix","rules"])])]),_:1}),e(fe,{class:"row q-ma-md",align:"right"},{default:a(()=>[e(N,{class:"glossy",color:"grey-9",label:"Dismiss",onClick:i}),e(N,{class:"glossy",color:"teal",label:"Create",onClick:u,disable:!_.value},null,8,["disable"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};var ia=E(na,[["__scopeId","data-v-e1e644a2"]]);const Ue=s=>(Y("data-v-7969abbc"),s=s(),X(),s),ua=Ue(()=>n("div",{class:"text-h5 q-mb-xs"},"Confirm Deletion",-1)),da=Ue(()=>n("p",{class:"text-body2 q-mb-none"}," Are you sure you want to delete this item? This action cannot be undone. ",-1)),ca={__name:"RawMaterialsTableDelete",props:["delete"],setup(s){const R=ne(),v=s,k=async()=>{console.log("clickkkd");try{await R.deleteWarehouseRawMaterials(v.delete.row.id),le.create({type:"negative",icon:"warning",message:`Raw Materials ${v.delete.row.name}  successfully deleted`,timeout:1e3,position:"top"}),w.value=!1}catch(p){console.error(p.message)}},w=V(!1),m=()=>{w.value=!0};return(p,_)=>(f(),q(B,null,[e(N,{onClick:m,color:"negative",icon:"delete",size:"sm",flat:"",round:"",dense:"",align:"center"},{default:a(()=>[e(Pe,{class:"bg-negative",delay:200},{default:a(()=>[$("Delete")]),_:1})]),_:1}),e(ae,{modelValue:w.value,"onUpdate:modelValue":_[0]||(_[0]=y=>w.value=y)},{default:a(()=>[e(A,null,{default:a(()=>[e(T,{class:"q-pa-md q-rounded q-elevate-2 bg-white text-grey-9"},{default:a(()=>[ua,da]),_:1}),e(Le,{class:"q-mb-md"}),e(T,null,{default:a(()=>[e(fe,{align:"right",class:"q-pt-none"},{default:a(()=>[ge(e(N,{flat:"",dense:"",label:"Cancel",color:"primary",class:"q-mr-sm"},null,512),[[ye]]),e(N,{dense:"",label:"Delete",color:"negative",onClick:k,class:"q-btn-rounded q-px-lg"})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};var ma=E(ca,[["__scopeId","data-v-7969abbc"]]);const pa=s=>(Y("data-v-656550b2"),s=s(),X(),s),_a=pa(()=>n("div",{class:"text-h6"},"Create Warehouse Raw Materials",-1)),ga={__name:"RawMaterialsCreateAll",setup(s){const R=V(!1),v=async()=>{R.value=!0},k=J(),w=Ie(),m=D(()=>w.rawMaterials);console.log("rawMaterialsData",m.value);const p=ne(),_=async()=>{if($e.show(),await w.fetchRawMaterials(),!w.rawMaterials.length){le.create({type:"warning",message:"No raw materials found!"});return}$e.hide()},y=()=>{w.rawMaterials=[],R.value=!1},h=async()=>{try{const i=m.value.map(t=>({raw_material_id:t.id,total_quantity:0,warehouse_id:k.params.warehouse_id}));await p.createMultipleWarehouseRawMaterials(i),console.log("materialsToSave",i),le.create({type:"positive",message:"All raw materials added to warehouse!"}),y()}catch(i){console.error("Error adding all raw materials:",i),le.create({type:"negative",message:"Failed to add all raw materials!"})}};return(i,t)=>(f(),q("div",null,[e(N,{class:"bg-gradient text-white q-pa-sm",icon:"add_circle",label:"Create All",onClick:v}),e(ae,{modelValue:R.value,"onUpdate:modelValue":t[0]||(t[0]=l=>R.value=l)},{default:a(()=>[e(A,{style:{width:"700px","max-width":"80vw"}},{default:a(()=>[e(T,{class:"row items-center text-white bg-gradient"},{default:a(()=>[_a,e(we),ge(e(N,{icon:"close",flat:"",dense:"",round:""},null,512),[[ye]])]),_:1}),e(T,null,{default:a(()=>[e(N,{class:"bg-gradient text-white q-pa-sm",icon:"add_circle",label:"Fetch All",onClick:_})]),_:1}),e(T,null,{default:a(()=>[e(de,{dense:"",separator:"",class:"box"},{default:a(()=>[e(H,null,{default:a(()=>[e(P,null,{default:a(()=>[e(I,{class:"text-overline"},{default:a(()=>[$(" Code")]),_:1})]),_:1}),e(P,null,{default:a(()=>[e(I,{class:"text-overline"},{default:a(()=>[$(" Name")]),_:1})]),_:1}),e(P,null,{default:a(()=>[e(I,{class:"text-overline"},{default:a(()=>[$(" Category")]),_:1})]),_:1}),e(P,{side:""},{default:a(()=>[e(I,{class:"text-overline"},{default:a(()=>[$("Unit")]),_:1})]),_:1})]),_:1}),(f(!0),q(B,null,ee(m.value,(l,c)=>(f(),z(H,{key:c},{default:a(()=>[e(P,null,{default:a(()=>[e(I,{class:"text-subtitle1"},{default:a(()=>[$(Q(l.code),1)]),_:2},1024)]),_:2},1024),e(P,null,{default:a(()=>[e(I,{class:"text-subtitle1",align:"left"},{default:a(()=>[$(Q(l.name),1)]),_:2},1024)]),_:2},1024),e(P,null,{default:a(()=>[e(I,{class:"text-subtitle1"},{default:a(()=>[$(Q(l.category),1)]),_:2},1024)]),_:2},1024),e(P,{side:""},{default:a(()=>[e(I,{class:"text-subtitle1"},{default:a(()=>[$(Q(l.unit),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}),e(fe,{class:"row q-ma-md",align:"right"},{default:a(()=>[e(N,{class:"glossy",color:"grey-9",label:"Dismiss",onClick:y}),e(N,{class:"glossy",color:"teal",label:"Create",onClick:h})]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}};var fa=E(ga,[["__scopeId","data-v-656550b2"]]);const Fe=s=>(Y("data-v-33b05e1b"),s=s(),X(),s),va={class:"row justify-between"},ha={class:"row q-gutter-x-sm"},wa={key:0,class:"spinner-wrapper"},ya={key:1},ba={key:0,class:"data-error"},xa=Fe(()=>n("div",{class:"q-ml-sm text-h6"},"No data available",-1)),Ra=Fe(()=>n("div",{class:"text-white"},"Edit Available Stocks",-1)),ka={class:"row justify-center q-gutter-x-md"},Ca={__name:"RawMaterialsTable",setup(s){const v=J().params.warehouse_id,k=ne(),w=V(""),m=V(!0),p=V([]),_=V(!1),y=V({rowsPerPage:0}),h=D(()=>k.warehouseRawMaterials),i=D(()=>w.value?h.value.filter(r=>r.name.toLowerCase().includes(w.value.toLowerCase())):h.value);ce(async()=>{console.log("props.warehouseId in onMounted:",v),v&&await t(v)});const t=async r=>{try{m.value=!0;const o=await k.fetchWarehouseRawMaterials(r);h.value=o,h.value.length||(_.value=!0),console.log("Warehouse Raw Materials",h.value)}catch(o){console.log("Error fetching branch product:",o),_.value=!0}finally{m.value=!1}};async function l(r,o){try{const d=await Ne.put("/api/update-warehouse-rawMaterials/"+r.id,{total_quantity:parseInt(o)});if(d.status===200){const g=p.value.findIndex(F=>F.id==r.id);p.value[g]=parseInt(o),le.create({type:"positive",message:d.data.message,timout:1e3,position:"top"})}}catch(d){console.error("Error updating price:",d)}}ve(w,async r=>{m.value=!0,await new Promise(o=>setTimeout(o,1e3)),m.value=!1,_.value=i.value.length===0});const c=r=>{const o=r.total_quantity,d=r.raw_materials.unit;if(console.log("unit test",d),d==="Grams"&&o<1e3)return"bg-red";let g;return o>=1e3?g=o/1e3:g=o,g<5?g<=2?"bg-red":(g<=3,"bg-warning"):"bg-positive"},u=r=>{var F;const o=Number(r==null?void 0:r.total_quantity)||0,d=((F=r==null?void 0:r.raw_materials)==null?void 0:F.unit)||"units";console.log("totalQuantity:",o),console.log("unit:",d);const g=U=>{const W=Number(U);return Number.isInteger(W)?W:W.toFixed(2)};if(o>1e3){const U=o/1e3;if(U>=25){const W=U/25;return`${g(W)} sacks`}return`${g(U)} kilos`}return`${g(o)} ${d}`},x=[{name:"code",label:"Raw Materials Code",align:"center",field:r=>{var o,d;return(d=(o=r==null?void 0:r.raw_materials)==null?void 0:o.code)!=null?d:"No Code"},format:r=>`${r}`,sortable:!0},{name:"name",label:"Raw Materials Name",align:"center",field:r=>{var o,d;return(d=(o=r==null?void 0:r.raw_materials)==null?void 0:o.name)!=null?d:"No Code"},format:r=>`${r}`,sortable:!0},{name:"total_quantity",label:"Available Stocks",align:"center",field:"total_quantity",sortable:!0},{name:"action",label:"Action",align:"center",sortable:!0}];return(r,o)=>(f(),q(B,null,[n("div",va,[n("div",null,[e(j,{class:"q-pb-lg q-pl-md",modelValue:w.value,"onUpdate:modelValue":o[0]||(o[0]=d=>w.value=d),outlined:"",placeholder:"Search",debounce:"1000",style:{width:"450px","max-width":"5000px","min-width":"100px"},flat:"",dense:"",rounded:""},{append:a(()=>[e(Z,{name:"search"})]),_:1},8,["modelValue"])]),n("div",ha,[n("div",null,[e(ia)]),n("div",null,[e(fa)])])]),m.value?(f(),q("div",wa,[e(Se,{size:"50px",color:"primary"})])):(f(),q("div",ya,[i.value.length===0?(f(),q("div",ba,[e(Z,{name:"warning",color:"warning",size:"4em"}),xa])):(f(),z(se,{key:1,class:"table-container sticky-header",filter:w.value,flat:"",columns:x,rows:i.value,"row-key":"name",pagination:y.value,"onUpdate:pagination":o[1]||(o[1]=d=>y.value=d),"rows-per-page-options":[0],"hide-bottom":"",style:{height:"375px"}},{"body-cell-total_quantity":a(d=>[e(G,{props:d},{default:a(()=>[e(K,{square:"",class:he(["text-white cursor-pointer",c(d.row)])},{default:a(()=>[$(Q(u(d.row))+" ",1),e(Pe,{class:"bg-blue-grey-8",offset:[10,10]},{default:a(()=>[Ra]),_:1}),e(Ee,{"onUpdate:modelValue":[g=>l(d.row,g),g=>d.row.total_quantity=g],modelValue:d.row.total_quantity,"auto-save":""},{default:a(g=>[e(j,{modelValue:g.value,"onUpdate:modelValue":F=>g.value=F,dense:"",suffix:d.row.raw_materials.unit,mask:"########",autofocus:"",counter:"",onKeyup:je(g.set,["enter"])},null,8,["modelValue","onUpdate:modelValue","suffix","onKeyup"])]),_:2},1032,["onUpdate:modelValue","modelValue"])]),_:2},1032,["class"])]),_:2},1032,["props"])]),"body-cell-action":a(d=>[e(G,{props:d},{default:a(()=>[n("div",ka,[e(ma,{delete:d},null,8,["delete"])])]),_:2},1032,["props"])]),_:1},8,["filter","rows","pagination"]))]))],64))}};var Ma=E(Ca,[["__scopeId","data-v-33b05e1b"]]);const $a={class:"q-gutter-sm"},qa={class:"q-gutter-x-sm"},Va={__name:"WarehouseRawMaterialsPage",setup(s){return(R,v)=>(f(),q("div",$a,[n("div",qa,[e(K,{label:"Good",class:"text-white",color:"positive"}),e(K,{label:"Warning",class:"text-white",color:"warning"}),e(K,{label:"Danger",class:"text-white",color:"red"})]),n("div",null,[e(Ma)])]))}},Qa={__name:"BranchRawMaterials",props:{branchReport:Object,getRawMaterialBadgeColorForStocks:Function,formatTotalQuantity:Function},setup(s){const{capitalizeFirstLetter:R}=O(),{getRawMaterialBadgeCategoryColor:v}=me();console.log("branchReportss",s.branchReport);const w=V([{name:"raw_material",label:"Raw Materials Name",align:"left",field:m=>{var p;return R((p=m.raw_material)==null?void 0:p.name)||"No record"}},{name:"code",label:"Code",align:"left",field:m=>{var p;return((p=m.raw_material)==null?void 0:p.code)||"No record"}},{name:"category",label:"Category",align:"left",field:m=>{var p;return R((p=m.raw_material)==null?void 0:p.category)||"No record"}},{name:"total_quantity",label:"Available Stocks",align:"center",field:"total_quantity"}]);return(m,p)=>(f(),z(se,{rows:s.branchReport.reports,columns:w.value,"row-key":"id",flat:"",bordered:"",pagination:m.pagination,"onUpdate:pagination":p[0]||(p[0]=_=>m.pagination=_),"rows-per-page-options":[0],"hide-bottom":"",class:"q-mt-md sticky-header3",style:{height:"450px"}},{"body-cell-total_quantity":a(_=>[e(G,{props:_},{default:a(()=>[e(K,{square:"",class:he(["text-white cursor-pointer",s.getRawMaterialBadgeColorForStocks(_.row)])},{default:a(()=>[$(Q(s.formatTotalQuantity(_.row)),1)]),_:2},1032,["class"])]),_:2},1032,["props"])]),"body-cell-category":a(_=>[e(G,{key:"name",props:_},{default:a(()=>[e(K,{color:S(v)(_.row.raw_material.category)},{default:a(()=>[$(Q(_.row.raw_material.category),1)]),_:2},1032,["color"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","pagination"]))}};const be=s=>(Y("data-v-350124f2"),s=s(),X(),s),Sa={class:"row justify-between"},Pa={class:"text-h6"},Ia=be(()=>n("div",{class:"text-h6",align:"center"},"Premix",-1)),Na=be(()=>n("div",{class:"text-h6",align:"center"},"Ingredients List",-1)),Da={class:"text-grey-7 q-mt-xs"},Ta=be(()=>n("div",{class:"text-h6 text-weight-regular"}," Do you want to receive the premix? ",-1)),Ba={__name:"TransactionView",props:{report:{type:Object,required:!0}},emits:["update-history"],setup(s,{emit:R}){var xe,Re,ke,Ce,Me;const{capitalizeFirstLetter:v,formatFullname:k}=O(),{getPremixBadgeStatusColor:w}=me(),m=Ye(),p=D(()=>m.user);console.log("userData in RawMaterialsTable:",p.value);const _=((Re=(xe=p.value)==null?void 0:xe.data)==null?void 0:Re.employee_id)||"";console.log("employeeId in PremixPage:",_);const y=Be();D(()=>y.branchPremix),De();const h=V(!1),i=V(!1),t=s;console.log("props",t.report);const l=t.report.branch_premix.branch_id;console.log("branchId",l);const c=()=>{h.value=!0},u=[{label:"Pending",value:"pending"},{label:"Declined",value:"declined"},{label:"Confirmed",value:"confirmed"},{label:"Process",value:"process"},{label:"Completed",value:"completed"},{label:"To Deliver",value:"to deliver"},{label:"To Receive",value:"to receive"},{label:"Received",value:"received"}],x=D(()=>{var C;return(C=t.report.history)!=null&&C.length?u.filter(b=>t.report.history.some(M=>M.status===b.value)):[]}),r=C=>{const b=t.report.history.find(M=>M.status===C);return b?C==="received"?`Received by: ${k(b.employee)}`:C==="pending"?`Requested by: ${k(b.employee)}`:`Handled by: ${k(b.employee)}`:"No handler"},o=C=>{const b=Number(C);return isNaN(b)?"":(b%1===0,b.toString())},d=(C,b)=>{if(b==="Pcs")return`${C} pcs`;if(b==="Grams"){if(C>=1e3){let M=C/1e3;return`${M%1===0?M.toString():M.toString().replace(/^0+/,"")} kgs`}return`${C} g`}return`${C} ${b}`},g=((Me=(Ce=(ke=t.report)==null?void 0:ke.branch_premix)==null?void 0:Ce.branch_recipe)==null?void 0:Me.ingredient_groups)||"Undefined";console.log("ingrdientsData",g);const F=D(()=>g.map(C=>{const b=parseFloat(C.quantity)*parseFloat(t.report.quantity);return{...C,totalQuantity:b,formattedQuantity:d(b,C.ingredient.unit)}}));console.log("report to proceed",t.report);const U=D(()=>{var C,b;return((b=(C=t.report.history)==null?void 0:C[t.report.history.length-1])==null?void 0:b.status)||null});console.log("lastStatus",U.value);const W=D(()=>x.value.findIndex(C=>C.value===U.value)+1),ue=C=>{var b;return(b=t.report.history)==null?void 0:b.some(M=>M.status===C)},pe=async()=>{const C={request_premix_id:t.report.id,branch_premix_id:t.report.branch_premix_id,branch_id:t.report.branch_premix.branch_id,employee_id:_,status:"receive",notes:"Received Premix",quantity:t.report.quantity,warehouse_id:t.report.warehouse_id,ingredients:F.value.map(b=>({ingredients_id:b.ingredient.id,total_quantity:b.totalQuantity,unit:b.ingredient.unit}))};console.log("payload",C),await y.receivePremix(C),await y.fetchRequestBranchPremix(l),h.value=!1},We=C=>{switch(C){case"pending":return"pending-header";case"confirmed":return"confirm-header";case"declined":return"decline-header";case"process":return"process-header";case"completed":return"completed-header";case"to deliver":return"to-deliver-header";case"to receive":return"to-receive-header";case"received":return"receive-header";default:return""}};return(C,b)=>(f(),q(B,null,[n("div",null,[e(N,{color:"accent",icon:"visibility",size:"md",flat:"",round:"",dense:"",onClick:c})]),e(ae,{modelValue:h.value,"onUpdate:modelValue":b[2]||(b[2]=M=>h.value=M)},{default:a(()=>[e(A,{style:{width:"700px","max-width":"80vw"}},{default:a(()=>[e(T,{class:he(We(s.report.status))},{default:a(()=>[n("div",Sa,[n("div",Pa,Q(S(v)(s.report.name)||"-"),1),e(N,{class:"close-btn",color:"grey-8",flat:"",round:"",dense:"",icon:"close",onClick:b[0]||(b[0]=M=>h.value=!1)})])]),_:1},8,["class"]),e(T,null,{default:a(()=>{var M,L,te;return[n("div",null,"Baker: "+Q(S(k)(s.report.employee)||"-"),1),n("div",null," Branch: "+Q(S(v)((te=(L=(M=s.report.branch_premix)==null?void 0:M.branch_recipe)==null?void 0:L.branch)==null?void 0:te.name)||"-"),1),n("div",null,[$(" Status: "),e(K,{color:S(w)(s.report.status),outlined:""},{default:a(()=>[$(Q(S(v)(s.report.status)||"-"),1)]),_:1},8,["color"])])]}),_:1}),e(T,{class:"q-gutter-y-md"},{default:a(()=>[n("div",null,[Ia,e(de,{dense:"",separator:"",class:"box"},{default:a(()=>[e(H,null,{default:a(()=>[e(P,null,{default:a(()=>[e(I,{class:"text-overline"},{default:a(()=>[$("Premix Name")]),_:1})]),_:1}),e(P,{side:""},{default:a(()=>[e(I,{class:"text-overline"},{default:a(()=>[$("Request Quantity / kgs")]),_:1})]),_:1})]),_:1}),e(H,null,{default:a(()=>[e(P,null,{default:a(()=>[e(I,{class:"text-h6"},{default:a(()=>[$(Q(S(v)(s.report.name)||"-"),1)]),_:1})]),_:1}),e(P,{side:""},{default:a(()=>[e(I,{class:"text-h6"},{default:a(()=>[$(Q(o(s.report.quantity)||"-"),1)]),_:1})]),_:1})]),_:1})]),_:1})]),n("div",null,[Na,e(de,{dense:"",separator:"",class:"box"},{default:a(()=>[e(H,null,{default:a(()=>[e(P,null,{default:a(()=>[e(I,{class:"text-overline"},{default:a(()=>[$(" Code")]),_:1})]),_:1}),e(P,null,{default:a(()=>[e(I,{class:"text-overline"},{default:a(()=>[$(" Name")]),_:1})]),_:1}),e(P,{side:""},{default:a(()=>[e(I,{class:"text-overline"},{default:a(()=>[$("Quantity")]),_:1})]),_:1})]),_:1}),(f(!0),q(B,null,ee(S(g),(M,L)=>(f(),z(H,{key:L},{default:a(()=>[e(P,null,{default:a(()=>[e(I,{class:"text-subtitle1"},{default:a(()=>[$(Q(M.ingredient.code),1)]),_:2},1024)]),_:2},1024),e(P,null,{default:a(()=>[e(I,{class:"text-subtitle1",align:"left"},{default:a(()=>{var te;return[$(Q(S(v)((te=M==null?void 0:M.ingredient)==null?void 0:te.name)||"-"),1)]}),_:2},1024)]),_:2},1024),e(P,{side:""},{default:a(()=>[e(I,{class:"text-subtitle1"},{default:a(()=>[$(Q(d(M.quantity*s.report.quantity,M.ingredient.unit)||"-"),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})])]),_:1}),e(Ge,{modelValue:W.value,"onUpdate:modelValue":b[1]||(b[1]=M=>W.value=M),animated:"",class:"q-pa-lg"},{default:a(()=>[(f(!0),q(B,null,ee(x.value,(M,L)=>(f(),z(Je,{key:L,name:L+1,title:M.label,color:S(w)(M.value),done:ue(M.value),icon:ue(M.value)?"check":"radio_button_unchecked",class:"custom-step"},{default:a(()=>[n("div",Da,Q(r(M.value)),1)]),_:2},1032,["name","title","color","done","icon"]))),128))]),_:1},8,["modelValue"]),U.value==="to receive"?(f(),z(T,{key:0,class:"text-center q-gutter-md"},{default:a(()=>[Ta,e(N,{color:"amber-10",label:"Yes",icon:"check",onClick:pe,loading:i.value},null,8,["loading"])]),_:1})):qe("",!0)]),_:1})]),_:1},8,["modelValue"])],64))}};var Ua=E(Ba,[["__scopeId","data-v-350124f2"]]);const Fa=s=>(Y("data-v-54e6b98c"),s=s(),X(),s),za={key:0,class:"spinner-wrapper"},Wa={key:1},Aa={key:0,class:"data-error"},La=Fa(()=>n("div",{class:"q-ml-sm text-h6"},"No data available",-1)),ja={__name:"BranchTransaction",props:{branchId:Object},setup(s){const{capitalizeFirstLetter:R,formatTimestamp:v}=O(),{getPremixBadgeStatusColor:k}=me(),w=J();D(()=>w.params.warehouse_id||null);const m=Be(),p=D(()=>m.branchPremix);console.log("premixDatas",p.value);const _=V([]),y=V(""),h=V(!0),i=s,t=V(!1),l=V({page:1,rowsPerPage:0,rowsNumber:0}),c=i.branchId,u=async(o,d=0,g=5,F="")=>{try{t.value=!0,await m.fetchRequestBranchPremix(o,d,g,F),console.log("Fetch premix data",p.value);const{data:U,current_page:W,per_page:ue,total:pe}=p.value;_.value=U,l.value.page=W,console.log("pagination.value.page",l.value.page),l.value.rowsPerPage=ue,console.log("pagination.value.rowsPerPage",l.value.rowsPerPage),l.value.rowsNumber=pe,console.log("pagination.value.rowsNumber",l.value.rowsNumber)}catch(U){console.log("error",U)}finally{t.value=!1}};ce(async()=>{c&&await u(c),console.log("premixdatas",p.value)});const x=o=>{u(c,o.pagination.page,o.pagination.rowsPerPage)};ve(y,async o=>{h.value=!0,await u(c,l.value.page,l.value.rowsPerPage,o),h.value=!1});const r=[{name:"name",label:"Transactions Name",align:"left",field:o=>R(o.name)||"N/A",format:o=>`${o}`,sortable:!0},{name:"date",align:"center",label:"Created Date",field:"created_at",format:o=>v(o),sortable:!0},{name:"updated_at",align:"center",label:"Updated Date",field:"updated_at",format:o=>v(o),sortable:!0},{name:"status",align:"center",label:"Status",field:"status",sortable:!0},{name:"view",align:"right",label:"View",field:"view",sortable:!0}];return(o,d)=>(f(),q(B,null,[n("div",null,[e(j,{rounded:"",outlined:"",dense:"",debounce:"300",modelValue:y.value,"onUpdate:modelValue":d[0]||(d[0]=g=>y.value=g),placeholder:"Search",style:{width:"500px","max-width":"1500px","min-width":"100px"}},null,8,["modelValue"])]),t.value?(f(),q("div",za,[e(Se,{size:"50px",color:"primary"})])):(f(),q("div",Wa,[_.value.length===0?(f(),q("div",Aa,[e(Z,{name:"warning",color:"warning",size:"4em"}),La])):(f(),z(se,{key:1,bordered:"",class:"q-mt-md",flat:"",columns:r,rows:_.value,pagination:l.value,"onUpdate:pagination":d[1]||(d[1]=g=>l.value=g),"rows-per-page-options":[5,7,10,0],"row-key":"id",onRequest:x,loading:t.value},{"body-cell-status":a(g=>[e(G,{props:g},{default:a(()=>[e(K,{outlined:"",color:S(k)(g.row.status)},{default:a(()=>[$(Q(S(R)(g.row.status)),1)]),_:2},1032,["color"])]),_:2},1032,["props"])]),"body-cell-view":a(g=>[e(G,{props:g},{default:a(()=>[n("div",null,[e(Ua,{report:g.row,onUpdateHistory:o.updateReportHistory},null,8,["report","onUpdateHistory"])])]),_:2},1032,["props"])]),_:1},8,["rows","pagination","loading"]))]))],64))}};var Ha=E(ja,[["__scopeId","data-v-54e6b98c"]]);const Ka={class:"row justify-between"},Ea={class:"text-h6"},Oa={__name:"DialogPage",props:{branchReport:Object,getRawMaterialBadgeColorForStocks:Function,getBadgeCategoryColor:Function,formatTotalQuantity:Function},setup(s){const{capitalizeFirstLetter:R}=O(),{getRawMaterialBadgeCategoryColor:v}=me(),{dialogRef:k,onDialogHide:w,onDialogOK:m,onDialogCancel:p}=Oe(),y=s.branchReport.branch_id,h=V("branchRawMaterials"),i=V(!1),t=V(!0);return(l,c)=>(f(),z(ae,{ref_key:"dialogRef",ref:k,onHide:S(w),modelValue:i.value,"onUpdate:modelValue":c[2]||(c[2]=u=>i.value=u),maximized:t.value,"transition-show":"slide-up","transition-hide":"slide-down"},{default:a(()=>[e(A,null,{default:a(()=>[e(T,null,{default:a(()=>[n("div",Ka,[n("div",Ea,Q(`${S(R)(s.branchReport.branch_name)}  Branch`),1),n("div",null,[e(N,{round:"",dense:"",flat:"",icon:"close",onClick:S(p)},null,8,["onClick"])])]),n("div",null,[e(Ve,{modelValue:h.value,"onUpdate:modelValue":c[0]||(c[0]=u=>h.value=u),align:"justify","narrow-indicator":"",class:"q-mb-lg"},{default:a(()=>[e(oe,{class:"text-purple",name:"branchRawMaterials",label:"Branch Raw Materials"}),e(oe,{class:"text-orange",name:"branchPremixTransactions",label:"Branch Premix Transactions"})]),_:1},8,["modelValue"]),n("div",null,[e(Qe,{modelValue:h.value,"onUpdate:modelValue":c[1]||(c[1]=u=>h.value=u),animated:"","transition-prev":"scale","transition-next":"scale"},{default:a(()=>[e(re,{name:"branchRawMaterials"},{default:a(()=>[e(Qa,{branchReport:s.branchReport,getRawMaterialBadgeColorForStocks:s.getRawMaterialBadgeColorForStocks,getBadgeCategoryColor:S(v),formatTotalQuantity:s.formatTotalQuantity,capitalizeFirstLetter:S(R)},null,8,["branchReport","getRawMaterialBadgeColorForStocks","getBadgeCategoryColor","formatTotalQuantity","capitalizeFirstLetter"])]),_:1}),e(re,{name:"branchPremixTransactions"},{default:a(()=>[e(Ha,{branchId:S(y)},null,8,["branchId"])]),_:1})]),_:1},8,["modelValue"])])])]),_:1})]),_:1})]),_:1},8,["onHide","modelValue","maximized"]))}};const ze=s=>(Y("data-v-68030530"),s=s(),X(),s),Ga={class:"q-pa-md elegant-container"},Ja={key:0,class:"skeleton-wrapper row q-col-gutter-md"},Ya={key:1,class:"data-error"},Xa=ze(()=>n("div",null,"No data available",-1)),Za={key:2,class:"q-pa-md row q-col-gutter-md"},et=ze(()=>n("img",{src:"https://cdn.quasar.dev/img/mountains.jpg"},null,-1)),at={class:"q-mt-lg"},tt={class:"text-h6 text-weight-medium elegant-name text-capitalize"},lt={__name:"BranchCard",props:["branchRawMaterialsReport"],setup(s){const{capitalizeFirstLetter:R}=O(),v=J(),k=Te(),w=De(),m=D(()=>k.warehouseBranchReports),p=V(!1),_=D(()=>v.params.warehouse_id||null),y=V(!1),h=c=>{w.dialog({component:Oa,componentProps:{branchReport:c,getRawMaterialBadgeColorForStocks:i,getBadgeCategoryColor:t,formatTotalQuantity:l}})},i=c=>{const u=c.quantity;if(c.raw_material.unit==="Grams"&&u<1e3)return"bg-red";let r;return u>=1e3?r=u/1e3:r=u,r<5?r<=2?"bg-red":(r<=3,"bg-warning"):"bg-positive"},t=c=>{switch(c){case"Ingredients":return"teal";case"Packaging Materials":return"brown-6";default:return"grey"}},l=c=>{const u=c.quantity,x=c.raw_material.unit;if(u>1e3){const r=(u/1e3).toFixed(2);return r.endsWith(".00")?`${Math.round(u/1e3)} kilos`:`${r} kilos`}else return u>1?`${u} ${x}`:`${u} ${x}`};return ve(_,async c=>{if(c)try{p.value=!0,await k.fetchWarehouseByBranchID(c),y.value=m.value.length===0}catch(u){console.error("Error fetching warehouse data:",u),y.value=!0}finally{p.value=!1}},{immediate:!0}),(c,u)=>(f(),q("div",Ga,[p.value?(f(),q("div",Ja,[(f(),q(B,null,ee(8,x=>n("div",{class:"col-xs-12 col-sm-6 col-md-4 col-lg-3",key:x},[e(A,{class:"user-card skeleton-card"},{default:a(()=>[e(_e,{height:"200px",class:"q-mb-md"}),e(T,{class:"text-center"},{default:a(()=>[e(_e,{type:"text",width:"60%",class:"q-mt-lg"}),e(_e,{type:"text",width:"40%",class:"q-mt-sm"})]),_:1})]),_:1})])),64))])):y.value?(f(),q("div",Ya,[e(Z,{name:"error",size:"50px",color:"negative"}),Xa])):(f(),q("div",Za,[(f(!0),q(B,null,ee(m.value,x=>(f(),q("div",{key:x.branch_id,class:"col-xs-12 col-sm-6 col-md-4 col-lg-3"},[e(A,{class:"user-card",onClick:r=>h(x)},{default:a(()=>[et,e(T,{class:"text-center"},{default:a(()=>[n("div",at,[n("div",tt,Q(S(R)(x.branch_name)),1)])]),_:2},1024)]),_:2},1032,["onClick"])]))),128))]))]))}};var ot=E(lt,[["__scopeId","data-v-68030530"]]);const rt={class:"row justify-between"},st=n("span",{class:"text-caption"},"Supplier's Company Name: ",-1),nt={class:"text-caption text-weight-medium"},it={class:"text-subtitle1"},ut=n("span",{class:"text-caption"}," Supplier's Name: ",-1),dt={class:"text-caption text-weight-medium"},ct={__name:"HistoryView",props:["report"],setup(s){var h;const{capitalizeFirstLetter:R}=O(),v=s,k=V(!1),w=()=>{k.value=!0},m=((h=v==null?void 0:v.report)==null?void 0:h.warehouse_added_stocks)||"Undefined";function p(i,t){const l=i.toLowerCase();return["grams","liters"].includes(l)||t===1?l:l+"s"}function _(i,t){if(!t||i===void 0)return"Undefined";t=t.toLowerCase(),t==="grams"&&i>=1e3&&(i=i/1e3,t="kilo"),t==="kilo"&&i>=25&&(i=i/25,t="sack");const l=p(t,i);return`${i} ${l}`}const y=[{name:"code",label:"Raw Materials Code",align:"left",field:i=>{var t;return((t=i==null?void 0:i.raw_materials)==null?void 0:t.code)||"Undefined"}},{name:"rawMaterialsName",label:"Raw Materials Name",align:"left",field:i=>{var t;return((t=i==null?void 0:i.raw_materials)==null?void 0:t.name)||"Undefined"}},{name:"quantityWithUnit",label:"Quantity",align:"left",field:i=>{var c,u,x;const t=(c=i==null?void 0:i.quantity)!=null?c:0,l=(x=(u=i==null?void 0:i.raw_materials)==null?void 0:u.unit)!=null?x:"Undefined";return _(t,l)}}];return(i,t)=>(f(),q(B,null,[e(N,{color:"accent",icon:"visibility",size:"md",flat:"",round:"",dense:"",onClick:w}),e(ae,{modelValue:k.value,"onUpdate:modelValue":t[1]||(t[1]=l=>k.value=l)},{default:a(()=>[e(A,{style:{width:"700px","max-width":"80vw"}},{default:a(()=>[e(T,null,{default:a(()=>{var l,c;return[n("div",rt,[n("div",null,[st,n("span",nt,Q(S(R)((l=s.report)==null?void 0:l.supplier_company_name)||"Undefined"),1),n("div",it,[ut,n("span",dt,Q(S(R)((c=s.report)==null?void 0:c.supplier_name)||"Undefined"),1)])]),e(N,{class:"close-btn",color:"grey-8",flat:"",round:"",dense:"",icon:"close",onClick:t[0]||(t[0]=u=>k.value=!1)})])]}),_:1}),e(T,null,{default:a(()=>[e(se,{rows:S(m),columns:y,flat:"",bordered:""},null,8,["rows"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}},mt=n("div",null,null,-1),pt={__name:"TablePage",setup(s){const{capitalizeFirstLetter:R,formatTimestamp:v,formatFullname:k}=O(),w=J(),m=ne(),p=D(()=>m.historyRawMaterials),_=V([]),y=w.params.warehouse_id||"",h=V({page:1,rowsPerPage:0,rowsNumber:0}),i=V(!0),t=async(u,x=0,r=5)=>{try{i.value=!0,await m.fetchWarehouseAddedStocks(u,x,r),console.log("historyRawMaterials",p.value);const{data:o,current_page:d,per_page:g,total:F}=p.value;_.value=o,console.log("historyRawMaterialsData.value",_.value),h.value.page=d,h.value.rowsPerPage=g,h.value.rowsNumber=F}catch(o){console.log(o)}finally{i.value=!1}};ce(async()=>{y&&await t(y)});const l=u=>{console.log("props",u),t(y,u.pagination.page,u.pagination.rowsPerPage)},c=[{name:"created_at",label:"Date",align:"left",field:u=>v(u.created_at)||"Not Available"},{name:"supplier_company_name",label:"Supplier's Company Name",align:"center",field:u=>R(u.supplier_company_name)||"Not Available"},{name:"supplier_name",label:"Supplier's Name",align:"center",field:u=>R(u.supplier_name)||"Not Available"},{name:"addedBy",label:"Added By:",align:"center",field:u=>k(u.employee)||"Not Available"},{name:"action",label:"Action",align:"left",field:"action"}];return(u,x)=>(f(),q(B,null,[mt,n("div",null,[e(se,{flat:"",rows:_.value,columns:c,"row-key":"id",bordered:"",loading:i.value,pagination:h.value,"onUpdate:pagination":x[0]||(x[0]=r=>h.value=r),"rows-per-page-options":[5,7,10,0],onRequest:l},{"body-cell-action":a(r=>[e(G,{props:r},{default:a(()=>[e(ct,{report:r.row},null,8,["report"])]),_:2},1032,["props"])]),loading:a(()=>[e(Ze,{showing:""},{default:a(()=>[e(Xe,{size:"50px",color:"indigo-8"})]),_:1})]),_:1},8,["rows","loading","pagination"])])],64))}},_t=n("div",{class:"text-h6"},"Raw Materials Transactions",-1),gt={__name:"TransactionsWarehouse",setup(s){return(R,v)=>(f(),q(B,null,[_t,e(pt)],64))}};const ft={class:"elegant-container q-gutter-md"},vt={class:"text-h6 row justify-between"},ht={class:"q-gutter-sm"},wt={class:"tab-container"},yt={__name:"WarehouseIdPage",setup(s){const{capitalizeFirstLetter:R}=O(),v=J(),k=He(),w=Te(),m=V("");D(()=>w.warehouse);const p=D(()=>v.params.warehouse_id||"Unknown Warehouse"),_=V("warehouseRawMaterials"),y=async t=>(await Ne.get(`/api/warehouse/${t}`)).data,h=async()=>{try{const t=await y(p.value);t&&t.name?m.value=t.name:console.error("Warehouse name data is missing",t)}catch(t){console.error("Error fetching warehouse data:",t)}};ce(()=>{h()});const i=()=>{Loading.show(),k.push("/admin/warehouse").finally(()=>{Loading.hide()})};return(t,l)=>(f(),z(Ke,{padding:""},{default:a(()=>[n("div",ft,[n("div",vt,[n("div",null,[e(N,{outline:"",flat:"",icon:"arrow_back",to:"/admin/warehouse",onClick:i}),e(we)]),n("div",null,[e(Z,{name:"factory"}),$(" "+Q(S(R)(m.value)),1)])]),n("div",ht,[n("div",wt,[e(Ve,{modelValue:_.value,"onUpdate:modelValue":l[0]||(l[0]=c=>_.value=c),dense:"",class:"bg-grey-2 text-grey-7 tabs-as-cards","active-color":"red-6","indicator-color":"transparent",align:"justify"},{default:a(()=>[e(oe,{name:"warehouseRawMaterials",label:"Warehouse Raw Materials"}),e(oe,{name:"branchRawMaterials",label:"Branch Raw Materials"}),e(oe,{name:"transactions",label:"Transactions"})]),_:1},8,["modelValue"])]),e(A,{class:"q-mt-sm"},{default:a(()=>[e(Qe,{modelValue:_.value,"onUpdate:modelValue":l[1]||(l[1]=c=>_.value=c),animated:""},{default:a(()=>[e(re,{name:"warehouseRawMaterials"},{default:a(()=>[e(Va)]),_:1}),e(re,{name:"branchRawMaterials"},{default:a(()=>[e(ot)]),_:1}),e(re,{name:"transactions"},{default:a(()=>[e(gt)]),_:1})]),_:1},8,["modelValue"])]),_:1})])])]),_:1}))}};var ml=E(yt,[["__scopeId","data-v-e12908da"]]);export{ml as default};
