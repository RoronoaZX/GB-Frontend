import{be as E,c as N,r as M,t as Te,o as h,a3 as q,f as e,M as D,w as a,Q as L,I,ae as me,J as s,K as z,L as Y,e as A,a0 as k,a4 as U,a5 as O,$ as Q,bd as xe,aJ as pe,a2 as G,O as J,R as X,a1 as Ae,N as ee,P as be,z as ue,u as _e,aK as Ce,bb as Fe,bf as ae,H as Le}from"./index.f18b2a00.js";import{Q as ge}from"./QSpace.c9b129fa.js";import{Q as Re,a as te,b as Me,c as le}from"./QTabPanels.34e8491e.js";import{Q as ze}from"./QPage.810b553e.js";import{Q as j}from"./QBadge.abd8e966.js";import{Q as $e}from"./QSpinnerDots.96935c17.js";import{Q as ke}from"./QTooltip.cc435071.js";import{Q as We}from"./QPopupEdit.7ae1428d.js";import{Q as K,a as oe}from"./QTable.d0617d40.js";import{Q as ie,a as W,b as S}from"./QList.e1265666.js";import{b as P}from"./use-virtual-scroll.2095f3f3.js";import{C as fe}from"./ClosePopup.246c3a40.js";import"./branch-product.a5573dd1.js";import{u as re}from"./warehouse-rawMaterials.5eaffe98.js";import{u as qe}from"./raw-material.71f56644.js";import{_ as H}from"./plugin-vue_export-helper.21dcd24c.js";import{api as Ve}from"./axios.3f6fad34.js";import{Q as ce}from"./QSkeleton.b7a64141.js";import{u as Qe}from"./use-quasar.508ed1ff.js";import{u as Se}from"./warehouse.f15f6309.js";import{u as Pe}from"./use-dialog-plugin-component.9a1fea17.js";import{u as De}from"./premix.fd52ffd4.js";import{q as Ne}from"./date.0373e458.js";import{Q as je,a as Ke}from"./QStepper.75d1b01f.js";import{u as Ee}from"./baker-report.2d51ba2b.js";import{Q as He}from"./QSpinnerGears.ffe97fee.js";import{Q as Ye}from"./QInnerLoading.581bf24d.js";import"./QResizeObserver.e87c441b.js";import"./use-panel.c6accc44.js";import"./touch.9135741d.js";import"./selection.fe554e01.js";import"./QMenu.5673f55b.js";import"./QVirtualScroll.214bfa0a.js";import"./QSelect.5a8284a2.js";import"./QChip.f6a8dbae.js";import"./product.c19265a6.js";import"./QSlideTransition.c4dcfffa.js";const se=n=>(J("data-v-e1e644a2"),n=n(),X(),n),Oe=se(()=>s("div",{class:"text-h6"},"Create Warehouse Raw Materials",-1)),Ge={class:"q-mb-lg"},Je={key:0,class:"custom-list z-top"},Xe=se(()=>s("div",null,"Raw Materials Code",-1)),Ze=se(()=>s("div",null,"Raw Materials Name",-1)),ea=se(()=>s("div",null,"Category",-1)),aa=se(()=>s("div",null,"Quantity",-1)),ta={__name:"RawMaterialsCreate",setup(n){const V=E(),b=qe(),w=N(()=>b.rawMaterials),d=re(),c=M(""),x=async()=>{b.searchRawMaterials(c.value)},R=N(()=>l.total_quantity!==""),p=M(!1),C=()=>{p.value=!0},i=()=>{g(),p.value=!1},r=f=>{l.raw_material_id=f.id,l.raw_materials_name=f.name,l.raw_materials_code=f.code,l.category=f.category,l.unit=f.unit,c.value=""},l=Te({raw_material_id:"",raw_materials_name:"",raw_materials_code:"",total_quantity:"",category:"",unit:"",warehouse_id:V.params.warehouse_id}),g=()=>{l.raw_material_id="",l.raw_materials_name="",l.raw_materials_code="",l.total_quantity="",l.raw_material_id="",l.category="",l.unit=""},u=async()=>{try{const{product_name:f,...o}=l;await d.createWarehouseRawMaterials(o),console.log("data to send",o),p.value=!1}catch(f){console.log(f)}};return(f,o)=>(h(),q(U,null,[e(D,{class:"bg-gradient text-white q-pa-sm",icon:"add_circle",label:"Create One",onClick:C}),e(G,{modelValue:p.value,"onUpdate:modelValue":o[5]||(o[5]=t=>p.value=t),persistent:""},{default:a(()=>[e(L,{class:"my-card",style:{width:"400px","max-width":"500px","min-width":"100px"}},{default:a(()=>[e(I,{class:"row items-center text-white bg-gradient"},{default:a(()=>[Oe,e(ge),me(e(D,{icon:"close",flat:"",dense:"",round:""},null,512),[[fe]])]),_:1}),e(I,{class:"q-ma-md q-gutter-y-sm"},{default:a(()=>[s("div",Ge,[e(z,{modelValue:c.value,"onUpdate:modelValue":[o[0]||(o[0]=t=>c.value=t),x],debounce:"1000",outlined:"",rounded:"",placeholder:"Search Raw Materials",dense:""},{append:a(()=>[s("div",null,[e(Y,{name:"search"})])]),default:a(()=>[c.value?(h(),q("div",Je,[e(L,null,{default:a(()=>[e(ie,{separator:""},{default:a(()=>{var t;return[(t=w.value)!=null&&t.length?(h(!0),q(U,{key:1},O(w.value,m=>(h(),A(W,{onClick:_=>r(m),key:m.id,clickable:""},{default:a(()=>[e(S,null,{default:a(()=>[e(P,null,{default:a(()=>[k(Q(m.name),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128)):(h(),A(W,{key:0},{default:a(()=>[k(" No record found. ")]),_:1}))]}),_:1})]),_:1})])):xe("",!0)]),_:1},8,["modelValue"])]),s("div",null,[Xe,e(z,{modelValue:l.raw_materials_code,"onUpdate:modelValue":o[1]||(o[1]=t=>l.raw_materials_code=t),readonly:"",dense:"",outlined:""},null,8,["modelValue"])]),s("div",null,[Ze,e(z,{modelValue:l.raw_materials_name,"onUpdate:modelValue":o[2]||(o[2]=t=>l.raw_materials_name=t),readonly:"",dense:"",outlined:""},null,8,["modelValue"])]),s("div",null,[ea,e(z,{modelValue:l.category,"onUpdate:modelValue":o[3]||(o[3]=t=>l.category=t),readonly:"",dense:"",outlined:""},null,8,["modelValue"])]),s("div",null,[aa,e(z,{modelValue:l.total_quantity,"onUpdate:modelValue":o[4]||(o[4]=t=>l.total_quantity=t),type:"number",outlined:"",suffix:l.unit||"",dense:"",rules:[t=>t&&t.length>0||"Total quantity is required"]},null,8,["modelValue","suffix","rules"])])]),_:1}),e(pe,{class:"row q-ma-md",align:"right"},{default:a(()=>[e(D,{class:"glossy",color:"grey-9",label:"Dismiss",onClick:i}),e(D,{class:"glossy",color:"teal",label:"Create",onClick:u,disable:!R.value},null,8,["disable"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};var la=H(ta,[["__scopeId","data-v-e1e644a2"]]);const Ie=n=>(J("data-v-7969abbc"),n=n(),X(),n),oa=Ie(()=>s("div",{class:"text-h5 q-mb-xs"},"Confirm Deletion",-1)),ra=Ie(()=>s("p",{class:"text-body2 q-mb-none"}," Are you sure you want to delete this item? This action cannot be undone. ",-1)),sa={__name:"RawMaterialsTableDelete",props:["delete"],setup(n){const V=re(),b=n,w=async()=>{console.log("clickkkd");try{await V.deleteWarehouseRawMaterials(b.delete.row.id),ee.create({type:"negative",icon:"warning",message:`Raw Materials ${b.delete.row.name}  successfully deleted`,timeout:1e3,position:"top"}),d.value=!1}catch(x){console.error(x.message)}},d=M(!1),c=()=>{d.value=!0};return(x,R)=>(h(),q(U,null,[e(D,{onClick:c,color:"negative",icon:"delete",size:"sm",flat:"",round:"",dense:"",align:"center"},{default:a(()=>[e(ke,{class:"bg-negative",delay:200},{default:a(()=>[k("Delete")]),_:1})]),_:1}),e(G,{modelValue:d.value,"onUpdate:modelValue":R[0]||(R[0]=p=>d.value=p)},{default:a(()=>[e(L,null,{default:a(()=>[e(I,{class:"q-pa-md q-rounded q-elevate-2 bg-white text-grey-9"},{default:a(()=>[oa,ra]),_:1}),e(Ae,{class:"q-mb-md"}),e(I,null,{default:a(()=>[e(pe,{align:"right",class:"q-pt-none"},{default:a(()=>[me(e(D,{flat:"",dense:"",label:"Cancel",color:"primary",class:"q-mr-sm"},null,512),[[fe]]),e(D,{dense:"",label:"Delete",color:"negative",onClick:w,class:"q-btn-rounded q-px-lg"})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};var na=H(sa,[["__scopeId","data-v-7969abbc"]]);const ia=n=>(J("data-v-656550b2"),n=n(),X(),n),ua=ia(()=>s("div",{class:"text-h6"},"Create Warehouse Raw Materials",-1)),da={__name:"RawMaterialsCreateAll",setup(n){const V=M(!1),b=async()=>{V.value=!0},w=E(),d=qe(),c=N(()=>d.rawMaterials);console.log("rawMaterialsData",c.value);const x=re(),R=async()=>{if(be.show(),await d.fetchRawMaterials(),!d.rawMaterials.length){ee.create({type:"warning",message:"No raw materials found!"});return}be.hide()},p=()=>{d.rawMaterials=[],V.value=!1},C=async()=>{try{const i=c.value.map(r=>({raw_material_id:r.id,total_quantity:0,warehouse_id:w.params.warehouse_id}));await x.createMultipleWarehouseRawMaterials(i),console.log("materialsToSave",i),ee.create({type:"positive",message:"All raw materials added to warehouse!"}),p()}catch(i){console.error("Error adding all raw materials:",i),ee.create({type:"negative",message:"Failed to add all raw materials!"})}};return(i,r)=>(h(),q("div",null,[e(D,{class:"bg-gradient text-white q-pa-sm",icon:"add_circle",label:"Create All",onClick:b}),e(G,{modelValue:V.value,"onUpdate:modelValue":r[0]||(r[0]=l=>V.value=l)},{default:a(()=>[e(L,{style:{width:"700px","max-width":"80vw"}},{default:a(()=>[e(I,{class:"row items-center text-white bg-gradient"},{default:a(()=>[ua,e(ge),me(e(D,{icon:"close",flat:"",dense:"",round:""},null,512),[[fe]])]),_:1}),e(I,null,{default:a(()=>[e(D,{class:"bg-gradient text-white q-pa-sm",icon:"add_circle",label:"Fetch All",onClick:R})]),_:1}),e(I,null,{default:a(()=>[e(ie,{dense:"",separator:"",class:"box"},{default:a(()=>[e(W,null,{default:a(()=>[e(S,null,{default:a(()=>[e(P,{class:"text-overline"},{default:a(()=>[k(" Code")]),_:1})]),_:1}),e(S,null,{default:a(()=>[e(P,{class:"text-overline"},{default:a(()=>[k(" Name")]),_:1})]),_:1}),e(S,null,{default:a(()=>[e(P,{class:"text-overline"},{default:a(()=>[k(" Category")]),_:1})]),_:1}),e(S,{side:""},{default:a(()=>[e(P,{class:"text-overline"},{default:a(()=>[k("Unit")]),_:1})]),_:1})]),_:1}),(h(!0),q(U,null,O(c.value,(l,g)=>(h(),A(W,{key:g},{default:a(()=>[e(S,null,{default:a(()=>[e(P,{class:"text-subtitle1"},{default:a(()=>[k(Q(l.code),1)]),_:2},1024)]),_:2},1024),e(S,null,{default:a(()=>[e(P,{class:"text-subtitle1",align:"left"},{default:a(()=>[k(Q(l.name),1)]),_:2},1024)]),_:2},1024),e(S,null,{default:a(()=>[e(P,{class:"text-subtitle1"},{default:a(()=>[k(Q(l.category),1)]),_:2},1024)]),_:2},1024),e(S,{side:""},{default:a(()=>[e(P,{class:"text-subtitle1"},{default:a(()=>[k(Q(l.unit),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}),e(pe,{class:"row q-ma-md",align:"right"},{default:a(()=>[e(D,{class:"glossy",color:"grey-9",label:"Dismiss",onClick:p}),e(D,{class:"glossy",color:"teal",label:"Create",onClick:C})]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}};var ca=H(da,[["__scopeId","data-v-656550b2"]]);const Ue=n=>(J("data-v-33b05e1b"),n=n(),X(),n),ma={class:"row justify-between"},pa={class:"row q-gutter-x-sm"},_a={key:0,class:"spinner-wrapper"},ga={key:1},fa={key:0,class:"data-error"},va=Ue(()=>s("div",{class:"q-ml-sm text-h6"},"No data available",-1)),ha=Ue(()=>s("div",{class:"text-white"},"Edit Available Stocks",-1)),wa={class:"row justify-center q-gutter-x-md"},ya={__name:"RawMaterialsTable",setup(n){const b=E().params.warehouse_id,w=re(),d=M(""),c=M(!0),x=M([]),R=M(!1),p=M({rowsPerPage:0}),C=N(()=>w.warehouseRawMaterials),i=N(()=>d.value?C.value.filter(o=>o.name.toLowerCase().includes(d.value.toLowerCase())):C.value);ue(async()=>{console.log("props.warehouseId in onMounted:",b),b&&await r(b)});const r=async o=>{try{c.value=!0;const t=await w.fetchWarehouseRawMaterials(o);C.value=t,C.value.length||(R.value=!0),console.log("Warehouse Raw Materials",C.value)}catch(t){console.log("Error fetching branch product:",t),R.value=!0}finally{c.value=!1}};async function l(o,t){try{const m=await Ve.put("/api/update-warehouse-rawMaterials/"+o.id,{total_quantity:parseInt(t)});if(m.status===200){const _=x.value.findIndex(B=>B.id==o.id);x.value[_]=parseInt(t),ee.create({type:"positive",message:m.data.message,timout:1e3,position:"top"})}}catch(m){console.error("Error updating price:",m)}}_e(d,async o=>{c.value=!0,await new Promise(t=>setTimeout(t,1e3)),c.value=!1,R.value=i.value.length===0});const g=o=>{const t=o.total_quantity,m=o.raw_materials.unit;if(console.log("unit test",m),m==="Grams"&&t<1e3)return"bg-red";let _;return t>=1e3?_=t/1e3:_=t,_<5?_<=2?"bg-red":(_<=3,"bg-warning"):"bg-positive"},u=o=>{var B;const t=Number(o==null?void 0:o.total_quantity)||0,m=((B=o==null?void 0:o.raw_materials)==null?void 0:B.unit)||"units";console.log("totalQuantity:",t),console.log("unit:",m);const _=T=>{const F=Number(T);return Number.isInteger(F)?F:F.toFixed(2)};if(t>1e3){const T=t/1e3;if(T>=25){const F=T/25;return`${_(F)} sacks`}return`${_(T)} kilos`}return`${_(t)} ${m}`},f=[{name:"code",label:"Raw Materials Code",align:"center",field:o=>{var t,m;return(m=(t=o==null?void 0:o.raw_materials)==null?void 0:t.code)!=null?m:"No Code"},format:o=>`${o}`,sortable:!0},{name:"name",label:"Raw Materials Name",align:"center",field:o=>{var t,m;return(m=(t=o==null?void 0:o.raw_materials)==null?void 0:t.name)!=null?m:"No Code"},format:o=>`${o}`,sortable:!0},{name:"total_quantity",label:"Available Stocks",align:"center",field:"total_quantity",sortable:!0},{name:"action",label:"Action",align:"center",sortable:!0}];return(o,t)=>(h(),q(U,null,[s("div",ma,[s("div",null,[e(z,{class:"q-pb-lg q-pl-md",modelValue:d.value,"onUpdate:modelValue":t[0]||(t[0]=m=>d.value=m),outlined:"",placeholder:"Search",debounce:"1000",style:{width:"450px","max-width":"5000px","min-width":"100px"},flat:"",dense:"",rounded:""},{append:a(()=>[e(Y,{name:"search"})]),_:1},8,["modelValue"])]),s("div",pa,[s("div",null,[e(la)]),s("div",null,[e(ca)])])]),c.value?(h(),q("div",_a,[e($e,{size:"50px",color:"primary"})])):(h(),q("div",ga,[i.value.length===0?(h(),q("div",fa,[e(Y,{name:"warning",color:"warning",size:"4em"}),va])):(h(),A(oe,{key:1,class:"table-container sticky-header",filter:d.value,flat:"",columns:f,rows:i.value,"row-key":"name",pagination:p.value,"onUpdate:pagination":t[1]||(t[1]=m=>p.value=m),"rows-per-page-options":[0],"hide-bottom":"",style:{height:"375px"}},{"body-cell-total_quantity":a(m=>[e(K,{props:m},{default:a(()=>[e(j,{square:"",class:Ce(["text-white cursor-pointer",g(m.row)])},{default:a(()=>[k(Q(u(m.row))+" ",1),e(ke,{class:"bg-blue-grey-8",offset:[10,10]},{default:a(()=>[ha]),_:1}),e(We,{"onUpdate:modelValue":[_=>l(m.row,_),_=>m.row.total_quantity=_],modelValue:m.row.total_quantity,"auto-save":""},{default:a(_=>[e(z,{modelValue:_.value,"onUpdate:modelValue":B=>_.value=B,dense:"",suffix:m.row.raw_materials.unit,mask:"########",autofocus:"",counter:"",onKeyup:Fe(_.set,["enter"])},null,8,["modelValue","onUpdate:modelValue","suffix","onKeyup"])]),_:2},1032,["onUpdate:modelValue","modelValue"])]),_:2},1032,["class"])]),_:2},1032,["props"])]),"body-cell-action":a(m=>[e(K,{props:m},{default:a(()=>[s("div",wa,[e(na,{delete:m},null,8,["delete"])])]),_:2},1032,["props"])]),_:1},8,["filter","rows","pagination"]))]))],64))}};var ba=H(ya,[["__scopeId","data-v-33b05e1b"]]);const xa={class:"q-gutter-sm"},Ca={class:"q-gutter-x-sm"},Ra={__name:"WarehouseRawMaterialsPage",setup(n){return(V,b)=>(h(),q("div",xa,[s("div",Ca,[e(j,{label:"Good",class:"text-white",color:"positive"}),e(j,{label:"Warning",class:"text-white",color:"warning"}),e(j,{label:"Danger",class:"text-white",color:"red"})]),s("div",null,[e(ba)])]))}},Ma={__name:"BranchRawMaterials",props:{branchReport:Object,getRawMaterialBadgeColor:Function,getBadgeCategoryColor:Function,formatTotalQuantity:Function,capitalizeFirstLetter:Function},setup(n){Pe(),console.log("branchReportss",n.branchReport),M(!1),M(!0);const b=M([{name:"raw_material",label:"Raw Materials Name",align:"left",field:w=>{var d;return((d=w.raw_material)==null?void 0:d.name)||"No record"}},{name:"code",label:"Code",align:"left",field:w=>{var d;return((d=w.raw_material)==null?void 0:d.code)||"No record"}},{name:"category",label:"Category",align:"left",field:w=>{var d;return((d=w.raw_material)==null?void 0:d.category)||"No record"}},{name:"total_quantity",label:"Available Stocks",align:"center",field:"total_quantity"}]);return(w,d)=>(h(),A(oe,{rows:n.branchReport.reports,columns:b.value,"row-key":"id",flat:"",bordered:"",pagination:w.pagination,"onUpdate:pagination":d[0]||(d[0]=c=>w.pagination=c),"rows-per-page-options":[0],"hide-bottom":"",class:"q-mt-md sticky-header3",style:{height:"450px"}},{"body-cell-total_quantity":a(c=>[e(K,{props:c},{default:a(()=>[e(j,{square:"",class:Ce(["text-white cursor-pointer",n.getRawMaterialBadgeColor(c.row)])},{default:a(()=>[k(Q(n.formatTotalQuantity(c.row)),1)]),_:2},1032,["class"])]),_:2},1032,["props"])]),"body-cell-category":a(c=>[e(K,{key:"name",props:c},{default:a(()=>[e(j,{color:n.getBadgeCategoryColor(c.row.raw_material.category)},{default:a(()=>[k(Q(c.row.raw_material.category),1)]),_:2},1032,["color"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","pagination"]))}},$a={class:"row justify-between"},ka={class:"text-h6"},qa=s("div",{class:"text-h6",align:"center"},"Premix",-1),Va=s("div",{class:"text-h6",align:"center"},"Ingredients List",-1),Qa={class:"text-grey-7 q-mt-xs"},Sa=s("div",{class:"text-h6 text-weight-regular"}," Do you want to receive the premix? ",-1),Pa={__name:"TransactionView",props:{report:{type:Object,required:!0}},emits:["update-history"],setup(n,{emit:V}){var ne,ve,he,we,ye;const b=Ee(),w=N(()=>b.user);console.log("userData in RawMaterialsTable:",w.value);const d=((ve=(ne=w.value)==null?void 0:ne.data)==null?void 0:ve.employee_id)||"";console.log("employeeId in PremixPage:",d);const c=De();N(()=>c.branchPremix),Qe();const x=M(!1),R=M(!1),p=n;console.log("props",p.report);const C=p.report.branch_premix.branch_id;console.log("branchId",C);const i=()=>{x.value=!0},r=y=>{const v=$=>$?$.charAt(0).toUpperCase()+$.slice(1).toLowerCase():"";return`${v(y.firstname||"No Firstname")} ${y.middlename?v(y.middlename).charAt(0)+".":""} ${v(y.lastname||"No Lastname")}`},l=[{label:"Pending",value:"pending"},{label:"Declined",value:"declined"},{label:"Confirmed",value:"confirmed"},{label:"Process",value:"process"},{label:"Completed",value:"completed"},{label:"To Deliver",value:"to deliver"},{label:"To Receive",value:"to receive"},{label:"Received",value:"received"}],g=N(()=>{var y;return(y=p.report.history)!=null&&y.length?l.filter(v=>p.report.history.some($=>$.status===v.value)):[]}),u=y=>{const v=p.report.history.find($=>$.status===y);return v?y==="received"?`Received by: ${r(v.employee)}`:y==="pending"?`Requested by: ${r(v.employee)}`:`Handled by: ${r(v.employee)}`:"No handler"},f=y=>{const v=Number(y);return isNaN(v)?"":(v%1===0,v.toString())},o=(y,v)=>{if(v==="Pcs")return`${y} pcs`;if(v==="Grams"){if(y>=1e3){let $=y/1e3;return`${$%1===0?$.toString():$.toString().replace(/^0+/,"")} kgs`}return`${y} g`}return`${y} ${v}`},t=((ye=(we=(he=p.report)==null?void 0:he.branch_premix)==null?void 0:we.branch_recipe)==null?void 0:ye.ingredient_groups)||"Undefined";console.log("ingrdientsData",t);const m=N(()=>t.map(y=>{const v=parseFloat(y.quantity)*parseFloat(p.report.quantity);return{...y,totalQuantity:v,formattedQuantity:o(v,y.ingredient.unit)}}));console.log("report to proceed",p.report);const _=N(()=>{var y,v;return((v=(y=p.report.history)==null?void 0:y[p.report.history.length-1])==null?void 0:v.status)||null});console.log("lastStatus",_.value);const B=N(()=>g.value.findIndex(y=>y.value===_.value)+1),T=y=>{var v;return(v=p.report.history)==null?void 0:v.some($=>$.status===y)},F=y=>({pending:"warning",declined:"red-6",confirmed:"green",process:"primary",completed:"dark","to deliver":"brown-9","to receive":"amber-10",received:"secondary"})[y]||"grey",de=async()=>{const y={request_premix_id:p.report.id,branch_premix_id:p.report.branch_premix_id,branch_id:p.report.branch_premix.branch_id,employee_id:d,status:"receive",notes:"Received Premix",quantity:p.report.quantity,warehouse_id:p.report.warehouse_id,ingredients:m.value.map(v=>({ingredients_id:v.ingredient.id,total_quantity:v.totalQuantity,unit:v.ingredient.unit}))};console.log("payload",y),await c.receivePremix(y),await c.fetchRequestBranchPremix(C),x.value=!1};return(y,v)=>(h(),q(U,null,[s("div",null,[e(D,{color:"accent",icon:"visibility",size:"md",flat:"",round:"",dense:"",onClick:i})]),e(G,{modelValue:x.value,"onUpdate:modelValue":v[2]||(v[2]=$=>x.value=$)},{default:a(()=>[e(L,{style:{width:"700px","max-width":"80vw"}},{default:a(()=>[e(I,null,{default:a(()=>[s("div",$a,[s("div",ka,Q(n.report.name),1),e(D,{class:"close-btn",color:"grey-8",flat:"",round:"",dense:"",icon:"close",onClick:v[0]||(v[0]=$=>x.value=!1)})])]),_:1}),e(I,null,{default:a(()=>[s("div",null,"Baker: "+Q(r(n.report.employee)),1),s("div",null," Branch: "+Q(n.report.branch_premix.branch_recipe.branch.name),1),s("div",null,[k(" Status: "),e(j,{color:F(n.report.status),outlined:""},{default:a(()=>[k(Q(n.report.status),1)]),_:1},8,["color"])])]),_:1}),e(I,{class:"q-gutter-y-md"},{default:a(()=>[s("div",null,[qa,e(ie,{dense:"",separator:"",class:"box"},{default:a(()=>[e(W,null,{default:a(()=>[e(S,null,{default:a(()=>[e(P,{class:"text-overline"},{default:a(()=>[k("Premix Name")]),_:1})]),_:1}),e(S,{side:""},{default:a(()=>[e(P,{class:"text-overline"},{default:a(()=>[k("Request Quantity / kgs")]),_:1})]),_:1})]),_:1}),e(W,null,{default:a(()=>[e(S,null,{default:a(()=>[e(P,{class:"text-h6"},{default:a(()=>[k(Q(n.report.name),1)]),_:1})]),_:1}),e(S,{side:""},{default:a(()=>[e(P,{class:"text-h6"},{default:a(()=>[k(Q(f(n.report.quantity)),1)]),_:1})]),_:1})]),_:1})]),_:1})]),s("div",null,[Va,e(ie,{dense:"",separator:"",class:"box"},{default:a(()=>[e(W,null,{default:a(()=>[e(S,null,{default:a(()=>[e(P,{class:"text-overline"},{default:a(()=>[k(" Code")]),_:1})]),_:1}),e(S,null,{default:a(()=>[e(P,{class:"text-overline"},{default:a(()=>[k(" Name")]),_:1})]),_:1}),e(S,{side:""},{default:a(()=>[e(P,{class:"text-overline"},{default:a(()=>[k("Quantity")]),_:1})]),_:1})]),_:1}),(h(!0),q(U,null,O(ae(t),($,Z)=>(h(),A(W,{key:Z},{default:a(()=>[e(S,null,{default:a(()=>[e(P,{class:"text-subtitle1"},{default:a(()=>[k(Q($.ingredient.code),1)]),_:2},1024)]),_:2},1024),e(S,null,{default:a(()=>[e(P,{class:"text-subtitle1",align:"left"},{default:a(()=>[k(Q($.ingredient.name),1)]),_:2},1024)]),_:2},1024),e(S,{side:""},{default:a(()=>[e(P,{class:"text-subtitle1"},{default:a(()=>[k(Q(o($.quantity*n.report.quantity,$.ingredient.unit)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})])]),_:1}),e(je,{modelValue:B.value,"onUpdate:modelValue":v[1]||(v[1]=$=>B.value=$),animated:"",class:"q-pa-lg"},{default:a(()=>[(h(!0),q(U,null,O(g.value,($,Z)=>(h(),A(Ke,{key:Z,name:Z+1,title:$.label,color:F($.value),done:T($.value),icon:T($.value)?"check":"radio_button_unchecked",class:"custom-step"},{default:a(()=>[s("div",Qa,Q(u($.value)),1)]),_:2},1032,["name","title","color","done","icon"]))),128))]),_:1},8,["modelValue"]),_.value==="to receive"?(h(),A(I,{key:0,class:"text-center q-gutter-md"},{default:a(()=>[Sa,e(D,{color:"amber-10",label:"Yes",icon:"check",onClick:de,loading:R.value},null,8,["loading"])]),_:1})):xe("",!0)]),_:1})]),_:1},8,["modelValue"])],64))}};const Da=n=>(J("data-v-a70b2fce"),n=n(),X(),n),Na={key:0,class:"spinner-wrapper"},Ia={key:1},Ua={key:0,class:"data-error"},Ba=Da(()=>s("div",{class:"q-ml-sm text-h6"},"No data available",-1)),Ta={__name:"BranchTransaction",props:{branchId:Object},setup(n){const V=E();N(()=>V.params.warehouse_id||null);const b=De(),w=N(()=>b.branchPremix);console.log("premixDatas",w.value);const d=M([]),c=M(""),x=M(!0),R=n,p=M(!1),C=M({page:1,rowsPerPage:0,rowsNumber:0}),i=R.branchId,r=async(t,m=0,_=5,B="")=>{try{p.value=!0,await b.fetchRequestBranchPremix(t,m,_,B),console.log("Fetch premix data",w.value);const{data:T,current_page:F,per_page:de,total:ne}=w.value;d.value=T,C.value.page=F,console.log("pagination.value.page",C.value.page),C.value.rowsPerPage=de,console.log("pagination.value.rowsPerPage",C.value.rowsPerPage),C.value.rowsNumber=ne,console.log("pagination.value.rowsNumber",C.value.rowsNumber)}catch(T){console.log("error",T)}finally{p.value=!1}};ue(async()=>{i&&await r(i),console.log("premixdatas",w.value)});const l=t=>{r(i,t.pagination.page,t.pagination.rowsPerPage)};_e(c,async t=>{x.value=!0,await r(i,C.value.page,C.value.rowsPerPage,t),x.value=!1});const g=t=>Ne.formatDate(t,"MMM D, YYYY - hh:mm A"),u=t=>t.charAt(0).toUpperCase()+t.slice(1).toLowerCase(),f=t=>{switch(t){case"pending":return"warning";case"declined":return"red-6";case"confirmed":return"green";case"process":return"primary";case"completed":return"dark";case"to deliver":return"brown-9";case"to receive":return"amber-10";case"received":return"secondary";default:return"grey"}},o=[{name:"name",label:"Transactions Name",align:"left",field:t=>t.name,format:t=>`${t}`,sortable:!0},{name:"date",align:"center",label:"Created Date",field:"created_at",format:t=>g(t),sortable:!0},{name:"updated_at",align:"center",label:"Updated Date",field:"updated_at",format:t=>g(t),sortable:!0},{name:"status",align:"center",label:"Status",field:"status",sortable:!0},{name:"view",align:"right",label:"View",field:"view",sortable:!0}];return(t,m)=>(h(),q(U,null,[s("div",null,[e(z,{rounded:"",outlined:"",dense:"",debounce:"300",modelValue:c.value,"onUpdate:modelValue":m[0]||(m[0]=_=>c.value=_),placeholder:"Search",style:{width:"500px","max-width":"1500px","min-width":"100px"}},null,8,["modelValue"])]),p.value?(h(),q("div",Na,[e($e,{size:"50px",color:"primary"})])):(h(),q("div",Ia,[d.value.length===0?(h(),q("div",Ua,[e(Y,{name:"warning",color:"warning",size:"4em"}),Ba])):(h(),A(oe,{key:1,bordered:"",class:"q-mt-md",flat:"",columns:o,rows:d.value,pagination:C.value,"onUpdate:pagination":m[1]||(m[1]=_=>C.value=_),"rows-per-page-options":[5,7,10,0],"row-key":"id",onRequest:l,loading:p.value},{"body-cell-status":a(_=>[e(K,{props:_},{default:a(()=>[e(j,{outlined:"",color:f(_.row.status)},{default:a(()=>[k(Q(u(_.row.status)),1)]),_:2},1032,["color"])]),_:2},1032,["props"])]),"body-cell-view":a(_=>[e(K,{props:_},{default:a(()=>[s("div",null,[e(Pa,{report:_.row,onUpdateHistory:t.updateReportHistory},null,8,["report","onUpdateHistory"])])]),_:2},1032,["props"])]),_:1},8,["rows","pagination","loading"]))]))],64))}};var Aa=H(Ta,[["__scopeId","data-v-a70b2fce"]]);const Fa={class:"row justify-between"},La={class:"text-h6"},za={__name:"DialogPage",props:{branchReport:Object,capitalizeFirstLetter:Function,getRawMaterialBadgeColor:Function,getBadgeCategoryColor:Function,formatTotalQuantity:Function},setup(n){const{dialogRef:V,onDialogHide:b,onDialogOK:w,onDialogCancel:d}=Pe(),x=n.branchReport.branch_id,R=M("branchRawMaterials"),p=M(!1),C=M(!0);return(i,r)=>(h(),A(G,{ref_key:"dialogRef",ref:V,onHide:ae(b),modelValue:p.value,"onUpdate:modelValue":r[2]||(r[2]=l=>p.value=l),maximized:C.value,"transition-show":"slide-up","transition-hide":"slide-down"},{default:a(()=>[e(L,null,{default:a(()=>[e(I,null,{default:a(()=>[s("div",Fa,[s("div",La,Q(`${n.capitalizeFirstLetter(n.branchReport.branch_name)}  Branch`),1),s("div",null,[e(D,{round:"",dense:"",flat:"",icon:"close",onClick:ae(d)},null,8,["onClick"])])]),s("div",null,[e(Re,{modelValue:R.value,"onUpdate:modelValue":r[0]||(r[0]=l=>R.value=l),align:"justify","narrow-indicator":"",class:"q-mb-lg"},{default:a(()=>[e(te,{class:"text-purple",name:"branchRawMaterials",label:"Branch Raw Materials"}),e(te,{class:"text-orange",name:"branchPremixTransactions",label:"Branch Premix Transactions"})]),_:1},8,["modelValue"]),s("div",null,[e(Me,{modelValue:R.value,"onUpdate:modelValue":r[1]||(r[1]=l=>R.value=l),animated:"","transition-prev":"scale","transition-next":"scale"},{default:a(()=>[e(le,{name:"branchRawMaterials"},{default:a(()=>[e(Ma,{branchReport:n.branchReport,getRawMaterialBadgeColor:n.getRawMaterialBadgeColor,getBadgeCategoryColor:n.getBadgeCategoryColor,formatTotalQuantity:n.formatTotalQuantity,capitalizeFirstLetter:n.capitalizeFirstLetter},null,8,["branchReport","getRawMaterialBadgeColor","getBadgeCategoryColor","formatTotalQuantity","capitalizeFirstLetter"])]),_:1}),e(le,{name:"branchPremixTransactions"},{default:a(()=>[e(Aa,{branchId:ae(x)},null,8,["branchId"])]),_:1})]),_:1},8,["modelValue"])])])]),_:1})]),_:1})]),_:1},8,["onHide","modelValue","maximized"]))}};const Be=n=>(J("data-v-8e017a4c"),n=n(),X(),n),Wa={class:"q-pa-md elegant-container"},ja={key:0,class:"skeleton-wrapper row q-col-gutter-md"},Ka={key:1,class:"data-error"},Ea=Be(()=>s("div",null,"No data available",-1)),Ha={key:2,class:"q-pa-md row q-col-gutter-md"},Ya=Be(()=>s("img",{src:"https://cdn.quasar.dev/img/mountains.jpg"},null,-1)),Oa={class:"q-mt-lg"},Ga={class:"text-h6 text-weight-medium elegant-name text-capitalize"},Ja={__name:"BranchCard",props:["branchRawMaterialsReport"],setup(n){const V=E(),b=Se(),w=Qe(),d=N(()=>b.warehouseBranchReports),c=M(!1),x=N(()=>V.params.warehouse_id||null),R=M(!1),p=g=>{w.dialog({component:za,componentProps:{branchReport:g,getRawMaterialBadgeColor:C,getBadgeCategoryColor:r,formatTotalQuantity:l,capitalizeFirstLetter:i}})},C=g=>{const u=g.quantity;if(g.raw_material.unit==="Grams"&&u<1e3)return"bg-red";let o;return u>=1e3?o=u/1e3:o=u,o<5?o<=2?"bg-red":(o<=3,"bg-warning"):"bg-positive"},i=g=>g?g.split(" ").map(u=>u.charAt(0).toUpperCase()+u.slice(1).toLowerCase()).join(" "):"",r=g=>{switch(g){case"Ingredients":return"teal";case"Packaging Materials":return"brown-6";default:return"grey"}},l=g=>{const u=g.quantity,f=g.raw_material.unit;if(u>1e3){const o=(u/1e3).toFixed(2);return o.endsWith(".00")?`${Math.round(u/1e3)} kilos`:`${o} kilos`}else return u>1?`${u} ${f}`:`${u} ${f}`};return _e(x,async g=>{if(g)try{c.value=!0,await b.fetchWarehouseByBranchID(g),R.value=d.value.length===0}catch(u){console.error("Error fetching warehouse data:",u),R.value=!0}finally{c.value=!1}},{immediate:!0}),(g,u)=>(h(),q("div",Wa,[c.value?(h(),q("div",ja,[(h(),q(U,null,O(8,f=>s("div",{class:"col-xs-12 col-sm-6 col-md-4 col-lg-3",key:f},[e(L,{class:"user-card skeleton-card"},{default:a(()=>[e(ce,{height:"200px",class:"q-mb-md"}),e(I,{class:"text-center"},{default:a(()=>[e(ce,{type:"text",width:"60%",class:"q-mt-lg"}),e(ce,{type:"text",width:"40%",class:"q-mt-sm"})]),_:1})]),_:1})])),64))])):R.value?(h(),q("div",Ka,[e(Y,{name:"error",size:"50px",color:"negative"}),Ea])):(h(),q("div",Ha,[(h(!0),q(U,null,O(d.value,f=>(h(),q("div",{key:f.branch_id,class:"col-xs-12 col-sm-6 col-md-4 col-lg-3"},[e(L,{class:"user-card",onClick:o=>p(f)},{default:a(()=>[Ya,e(I,{class:"text-center"},{default:a(()=>[s("div",Oa,[s("div",Ga,Q(i(f.branch_name)),1)])]),_:2},1024)]),_:2},1032,["onClick"])]))),128))]))]))}};var Xa=H(Ja,[["__scopeId","data-v-8e017a4c"]]);const Za={class:"row justify-between"},et=s("span",{class:"text-caption"},"Supplier's Company Name: ",-1),at={class:"text-caption text-weight-medium"},tt={class:"text-subtitle1"},lt=s("span",{class:"text-caption"}," Supplier's Name: ",-1),ot={class:"text-caption text-weight-medium"},rt={__name:"HistoryView",props:["report"],setup(n){var C;const V=n,b=M(!1),w=()=>{b.value=!0},d=((C=V==null?void 0:V.report)==null?void 0:C.warehouse_added_stocks)||"Undefined";function c(i,r){const l=i.toLowerCase();return["grams","liters"].includes(l)||r===1?l:l+"s"}function x(i,r){if(!r||i===void 0)return"Undefined";r=r.toLowerCase(),r==="grams"&&i>=1e3&&(i=i/1e3,r="kilo"),r==="kilo"&&i>=25&&(i=i/25,r="sack");const l=c(r,i);return`${i} ${l}`}const R=i=>i?i.split(" ").map(r=>r.charAt(0).toUpperCase()+r.slice(1).toLowerCase()).join(" "):"",p=[{name:"code",label:"Raw Materials Code",align:"left",field:i=>{var r;return((r=i==null?void 0:i.raw_materials)==null?void 0:r.code)||"Undefined"}},{name:"rawMaterialsName",label:"Raw Materials Name",align:"left",field:i=>{var r;return((r=i==null?void 0:i.raw_materials)==null?void 0:r.name)||"Undefined"}},{name:"quantityWithUnit",label:"Quantity",align:"left",field:i=>{var g,u,f;const r=(g=i==null?void 0:i.quantity)!=null?g:0,l=(f=(u=i==null?void 0:i.raw_materials)==null?void 0:u.unit)!=null?f:"Undefined";return x(r,l)}}];return(i,r)=>(h(),q(U,null,[e(D,{color:"accent",icon:"visibility",size:"md",flat:"",round:"",dense:"",onClick:w}),e(G,{modelValue:b.value,"onUpdate:modelValue":r[1]||(r[1]=l=>b.value=l)},{default:a(()=>[e(L,{style:{width:"700px","max-width":"80vw"}},{default:a(()=>[e(I,null,{default:a(()=>{var l,g;return[s("div",Za,[s("div",null,[et,s("span",at,Q(R((l=n.report)==null?void 0:l.supplier_company_name)||"Undefined"),1),s("div",tt,[lt,s("span",ot,Q(R((g=n.report)==null?void 0:g.supplier_name)||"Undefined"),1)])]),e(D,{class:"close-btn",color:"grey-8",flat:"",round:"",dense:"",icon:"close",onClick:r[0]||(r[0]=u=>b.value=!1)})])]}),_:1}),e(I,null,{default:a(()=>[e(oe,{rows:ae(d),columns:p,flat:"",bordered:""},null,8,["rows"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}},st=s("div",null,null,-1),nt={__name:"TablePage",setup(n){const V=E(),b=re(),w=N(()=>b.historyRawMaterials),d=M([]),c=V.params.warehouse_id||"",x=M({page:1,rowsPerPage:0,rowsNumber:0}),R=M(!0),p=async(u,f=0,o=5)=>{try{R.value=!0,await b.fetchWarehouseAddedStocks(u,f,o),console.log("historyRawMaterials",w.value);const{data:t,current_page:m,per_page:_,total:B}=w.value;d.value=t,console.log("historyRawMaterialsData.value",d.value),x.value.page=m,x.value.rowsPerPage=_,x.value.rowsNumber=B}catch(t){console.log(t)}finally{R.value=!1}};ue(async()=>{c&&await p(c)});const C=u=>{console.log("props",u),p(c,u.pagination.page,u.pagination.rowsPerPage)},i=u=>Ne.formatDate(u,"MMM DD, YYYY || hh:mm A"),r=u=>{const f=_=>_?_.charAt(0).toUpperCase()+_.slice(1).toLowerCase():"",o=u.firstname?f(u.firstname):"No Firstname",t=u.middlename?f(u.middlename).charAt(0)+".":"",m=u.lastname?f(u.lastname):"No Lastname";return`${o} ${t} ${m}`.trim()},l=u=>u?u.split(" ").map(f=>f.charAt(0).toUpperCase()+f.slice(1).toLowerCase()).join(" "):"",g=[{name:"created_at",label:"Date",align:"left",field:u=>i(u.created_at)||"Not Available"},{name:"supplier_company_name",label:"Supplier's Company Name",align:"center",field:u=>l(u.supplier_company_name)||"Not Available"},{name:"supplier_name",label:"Supplier's Name",align:"center",field:u=>l(u.supplier_name)||"Not Available"},{name:"addedBy",label:"Added By:",align:"center",field:u=>r(u.employee)||"Not Available"},{name:"action",label:"Action",align:"left",field:"action"}];return(u,f)=>(h(),q(U,null,[st,s("div",null,[e(oe,{flat:"",rows:d.value,columns:g,"row-key":"id",bordered:"",loading:R.value,pagination:x.value,"onUpdate:pagination":f[0]||(f[0]=o=>x.value=o),"rows-per-page-options":[5,7,10,0],onRequest:C},{"body-cell-action":a(o=>[e(K,{props:o},{default:a(()=>[e(rt,{report:o.row},null,8,["report"])]),_:2},1032,["props"])]),loading:a(()=>[e(Ye,{showing:""},{default:a(()=>[e(He,{size:"50px",color:"indigo-8"})]),_:1})]),_:1},8,["rows","loading","pagination"])])],64))}},it=s("div",{class:"text-h6"},"Raw Materials Transactions",-1),ut={__name:"TransactionsWarehouse",setup(n){return(V,b)=>(h(),q(U,null,[it,e(nt)],64))}};const dt={class:"elegant-container q-gutter-md"},ct={class:"text-h6 row justify-between"},mt={class:"q-gutter-sm"},pt={class:"tab-container"},_t={__name:"WarehouseIdPage",setup(n){const V=E(),b=Le(),w=Se(),d=M("");N(()=>w.warehouse);const c=N(()=>V.params.warehouse_id||"Unknown Warehouse"),x=M("warehouseRawMaterials"),R=async r=>(await Ve.get(`/api/warehouse/${r}`)).data,p=async()=>{try{const r=await R(c.value);r&&r.name?d.value=r.name:console.error("Warehouse name data is missing",r)}catch(r){console.error("Error fetching warehouse data:",r)}};ue(()=>{p()});const C=r=>r?r.split(" ").map(l=>l.charAt(0).toUpperCase()+l.slice(1).toLowerCase()).join(" "):"",i=()=>{Loading.show(),b.push("/admin/warehouse").finally(()=>{Loading.hide()})};return(r,l)=>(h(),A(ze,{padding:""},{default:a(()=>[s("div",dt,[s("div",ct,[s("div",null,[e(D,{outline:"",flat:"",icon:"arrow_back",to:"/admin/warehouse",onClick:i}),e(ge)]),s("div",null,[e(Y,{name:"factory"}),k(" "+Q(C(d.value)),1)])]),s("div",mt,[s("div",pt,[e(Re,{modelValue:x.value,"onUpdate:modelValue":l[0]||(l[0]=g=>x.value=g),dense:"",class:"bg-grey-2 text-grey-7 tabs-as-cards","active-color":"red-6","indicator-color":"transparent",align:"justify"},{default:a(()=>[e(te,{name:"warehouseRawMaterials",label:"Warehouse Raw Materials"}),e(te,{name:"branchRawMaterials",label:"Branch Raw Materials"}),e(te,{name:"transactions",label:"Transactions"})]),_:1},8,["modelValue"])]),e(L,{class:"q-mt-sm"},{default:a(()=>[e(Me,{modelValue:x.value,"onUpdate:modelValue":l[1]||(l[1]=g=>x.value=g),animated:""},{default:a(()=>[e(le,{name:"warehouseRawMaterials"},{default:a(()=>[e(Ra)]),_:1}),e(le,{name:"branchRawMaterials"},{default:a(()=>[e(Xa)]),_:1}),e(le,{name:"transactions"},{default:a(()=>[e(ut)]),_:1})]),_:1},8,["modelValue"])]),_:1})])])]),_:1}))}};var Xt=H(_t,[["__scopeId","data-v-4421da2e"]]);export{Xt as default};
