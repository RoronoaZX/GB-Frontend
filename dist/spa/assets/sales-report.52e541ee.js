import{d as R,N as i}from"./index.6ac3ccc3.js";import{api as r}from"./axios.1ab015cf.js";const T=R("salesReports",{state:()=>({salesReport:[],branchPendingSalesReport:[],products:[],branchProducts:[],breadProducts:[],selectaProducts:[],softdrinksProducts:[],cakeProducts:[],othersProducts:[],reports:[],user:{},employeeInShift:[],breadReports:[],selectaReports:[],softdrinksReports:[],cakeReports:[],otherProductsReports:[],withReceiptExpensesReports:[],withOutReceiptExpensesReport:[],employeeCreditReports:[],denominationReports:{oneThousandBills:0,fiveHundredBills:0,twoHundredBills:0,oneHundredBills:0,fiftyBills:0,twentyBills:0,twentyCoins:0,tenCoins:0,fiveCoins:0,oneCoins:0,twentyFiveCents:0},productsTotalAmount:0,expensesTotalAmount:0,employeeCreditTotalAmount:0,denominationTotal:0,charges:0,overTotal:0,isSubmitting:!1}),actions:{logout(){this.$reset()},setUser(t){this.user=t},removeBread(t){this.breadReports.splice(t,1),this.updateProductsTotalAmount(),this.calculateCharges(this.denominationTotal)},removeSelecta(t){this.selectaReports.splice(t,1),this.updateProductsTotalAmount(),this.calculateCharges(this.denominationTotal)},removeSoftdrink(t){this.softdrinksReports.splice(t,1),this.updateProductsTotalAmount(),this.calculateCharges(this.denominationTotal)},removeCake(t){this.cakeReports.splice(t,1),this.updateProductsTotalAmount(),this.calculateCharges(this.denominationTotal)},removeOtherProducts(t){this.otherProductsReports.splice(t,1),this.updateProductsTotalAmount(),this.calculateCharges(this.denominationTotal)},removeEmployeeCreditReport(t){this.employeeCreditReports.splice(t,1),this.updateExpensesTotalAmount(),this.calculateCharges(this.denominationTotal)},removeWithReceiptExpenses(t){this.withReceiptExpensesReports.splice(t,1),this.updateProductsTotalAmount(),this.calculateCharges(this.denominationTotal)},removeExpenses(t){this.withOutReceiptExpensesReport.splice(t,1),this.updateProductsTotalAmount(),this.calculateCharges(this.denominationTotal)},filterBreadproducts(){this.breadProducts=this.branchProducts.filter(t=>t.category==="Bread")},filterSelectaproducts(){this.selectaProducts=this.branchProducts.filter(t=>t.category==="Selecta")},filterSoftdrinksproducts(){this.softdrinksProducts=this.branchProducts.filter(t=>t.category==="Softdrinks")},filterOthersproducts(){this.othersProducts=this.branchProducts.filter(t=>t.category==="Others")},updateBreadReport(t){if(this.isSubmitting)return;const e=this.breadReports.findIndex(s=>s.name===t.name);e!==-1?this.breadReports.splice(e,1,t):this.breadReports.push(t)},updateSelectaReport(t){if(this.isSubmitting)return;const e=this.selectaReports.findIndex(s=>s.name===t.name);e!==-1?this.selectaReports.splice(e,1,t):this.selectaReports.push(t)},updateSoftdrinksReport(t){if(this.isSubmitting)return;const e=this.softdrinksReports.findIndex(s=>s.name===t.name);e!==-1?this.softdrinksReports.splice(e,1,t):this.softdrinksReports.push(t)},updateCakeReport(t){if(this.isSubmitting)return;const e=this.cakeReports.findIndex(s=>s.name===t.name);e!==-1?this.cakeReports.splice(e,1,t):this.cakeReports.push(t)},updateOtherProductsReport(t){if(this.isSubmitting)return;const e=this.otherProductsReports.findIndex(s=>s.name===t.name);e!==-1?this.otherProductsReports.splice(e,1,t):this.otherProductsReports.push(t)},updateEmployeeCreditReports(t){this.isSubmitting||(this.employeeCreditReports.push(t),this.updateExpensesTotalAmount(),this.calculateCharges(this.denominationTotal))},updateWithReceiptExpensesReport(t){console.log("report to with receipt data expense in store",t),this.withReceiptExpensesReports.push(t),this.updateExpensesTotalAmount()},updateWithOutReceiptExpensesReport(t){this.withOutReceiptExpensesReport.push(t),this.updateExpensesTotalAmount(),this.calculateCharges(this.denominationTotal)},getDenominationData(t){this.isSubmitting||(this.denominationReports={...t})},updateDenominationTotal(t){this.denominationTotal=t},calculateCharges(t){const e=this.breadTotalAmount+this.selectaTotalAmount+this.softdrinksTotalAmount+this.otherProductsTotalAmount+this.cakeTotalAmount-this.creditExpensesTotal;console.log("Total Sales Amount:",e);const s=e+this.breadNegativeTotal+this.selectaNegativeTotal+this.softdrinksNegativeTotal+this.otherProductsNegativeTotal;t<s?(this.charges=s-t,this.overTotal=0):(this.charges=0,this.overTotal=t-s),console.log("Chargessss:",this.charges),console.log("Charges total:",this.overTotal)},updateProductsTotalAmount(){this.productsTotalAmount=this.breadTotalAmount+this.selectaTotalAmount+this.softdrinksTotalAmount+this.cakeTotalAmount+this.otherProductsTotalAmount},updateExpensesTotalAmount(){this.expensesTotalAmount=this.expensesSumAmount},async searchBranchProducts(t,e){console.log("productSearch",t),console.log("branchId",e);try{const s=await r.post("/api/search-products",{keyword:t,branch_id:e});this.products=s.data,console.log("search Products",s.data)}catch(s){console.error("Error fetching products",s)}},async fetchBranchProducts(t){console.log("Branch ID",t);const e=await r.get(`/api/branches/${t}/products`);this.branchProducts=e.data,this.filterBreadproducts(),this.filterSelectaproducts(),this.filterSoftdrinksproducts(),this.filterOthersproducts()},async fetchBranchPendingSalesReport(t){console.log("Branch IDsssss",t);try{const e=await r.get(`/api/branches/${t}/pending-branch-sales-report`);this.branchPendingSalesReport=e.data,console.log("branchPendingSalesReport",e.data)}catch(e){console.log("Error fetching pending sales report",e)}},async fetchSalesReports(t,e,s){try{const o=await r.get(`/api/branches/${t}/branch-sales-report`,{params:{page:e,per_page:s}});console.log("sales reportssss",o.data),this.salesReport=o.data}catch(o){console.log(o)}},async confirmProductsReport(t){console.log("Payloadssss data:",t);try{const e=await r.post("/api/confirm-product-sales-report",t);console.log("ressssssss",e.data),this.removePendingProductItem({sales_report_id:e.data.sales_report_id,type:e.data.type,product_id:e.data.product_id}),this.updateNestedProductStatus(e.data.sales_report_id,e.data.type,e.data.product_id,e.data.status),console.log("salesReportsssss",this.salesReport),i.create({message:e.data.message||"Product Confirmed Successfully",color:"positive"}),console.log("response.data",e.data)}catch(e){console.log(e),i.create({message:e.response.data.message,color:"negative"})}},async declineProductsReport(t){console.log("Payload data:",t);try{const e=await r.post("/api/decline-product-sales-report",t);console.log("asdfafsdf",e.data),this.removePendingProductItem({sales_report_id:e.data.sales_report_id,type:e.data.type,product_id:e.data.product_id}),this.updateNestedProductStatus(e.data.sales_report_id,e.data.type,e.data.product_id,e.data.status),i.create({message:"Product Declined Successfully",color:"positive"}),console.log("response.data",e.data)}catch(e){console.log(e)}},removePendingProductItem({sales_report_id:t,type:e,product_id:s}){const o=this.branchPendingSalesReport.find(d=>d.sales_report_id===t);if(!o)return;const a={bread:"bread",selecta:"selecta",softdrinks:"softdrinks",other:"others"}[e];if(!a||!Array.isArray(o[a]))return;const c=o[a].findIndex(d=>d.id===s);c!==-1&&o[a].splice(c,1),this.cleanupEmptySalesReport(t)},cleanupEmptySalesReport(t){const e=this.branchPendingSalesReport.findIndex(n=>n.sales_report_id===t);if(e===-1)return;const s=this.branchPendingSalesReport[e];s.bread.length===0&&s.selecta.length===0&&s.softdrinks.length===0&&s.others.length===0&&this.branchPendingSalesReport.splice(e,1)},updateNestedProductStatus(t,e,s,o){var a,c;const n={bread:"bread_reports",selecta:"selecta_reports",softdrinks:"softdrinks_reports",other:"other_products_reports"}[e];if(!!n){if(!this.salesReport||!this.salesReport.data){console.error("salesReport.data is undefined");return}for(const d of this.salesReport.data)for(const m of["AM","PM"]){const u=(a=d[m])==null?void 0:a.sales_reports;if(!u)continue;const h=u.find(p=>p.id===t);if(!h)continue;const l=(c=h[n])==null?void 0:c.find(p=>p.id===s);if(l){l.status=o,console.log("Updated product status:",l);return}}console.warn("Product not found for update:",{salesReportId:t,type:e,productId:s})}},async adminSubmitReports(t){console.log("data.data",t),console.log("data.user_id",t.user_id),console.log("data.branch_id",t.branch_id),console.log("data.created_at",t.created_at),this.creditTotalAmount;const e={user_id:t.user_id,employee_in_shift:this.employeeInShift,branch_id:t.branch_id,created_at:t.created_at,breadReports:this.breadReports,selectaReports:this.selectaReports,softdrinksReports:this.softdrinksReports,otherProductsReports:this.otherProductsReports,cakeReports:this.cakeReports,withOutReceiptExpensesReport:this.withOutReceiptExpensesReport,denominationReports:this.denominationReports,creditReports:this.employeeCreditReports,denomination_total:this.denominationTotal,expenses_total:this.expensesSumAmount,products_total_sales:this.totalSalesAmount,charges_amount:this.charges,over_total:this.overTotal,credit_total:this.creditTotalAmount};console.log("Payload data:",e);try{const s=await r.post("/api/admin-sales-report",e);i.create({type:"positive",message:"Report submitted successfully"}),this.breadReports=[],this.employeeInShift=[],this.selectaReports=[],this.softdrinksReports=[],this.otherProductsReports=[],this.withOutReceiptExpensesReport=[],this.denominationReports=[],this.employeeCreditReports=[],this.cakeReports=[],this.denominationTotal=0,this.expensesTotalAmount=0,this.productsTotalAmount=0,this.charges=0,this.overTotal=0,console.log("Sales Reports Data",s)}catch(s){console.error("Error submitting data:",s),i.create({type:"negative",message:"Error submitting report"})}},async submitSalesReports(){var e,s;this.creditTotalAmount;const t={user_id:this.user.data.id,employee_in_shift:this.employeeInShift,branch_id:(s=(e=this.user)==null?void 0:e.device)==null?void 0:s.reference_id,breadReports:this.breadReports,selectaReports:this.selectaReports,softdrinksReports:this.softdrinksReports,otherProductsReports:this.otherProductsReports,cakeReports:this.cakeReports,withOutReceiptExpensesReport:this.withOutReceiptExpensesReport,denominationReports:this.denominationReports,creditReports:this.employeeCreditReports,denomination_total:this.denominationTotal,expenses_total:this.expensesSumAmount,products_total_sales:this.totalSalesAmount,charges_amount:this.charges,over_total:this.overTotal,credit_total:this.creditTotalAmount};console.log("Payload data:",t);try{const o=await r.post("/api/sales-report",t);console.log("Data submitted successfully"),i.create({type:"positive",message:"Report submitted successfully"}),this.breadReports=[],this.employeeInShift=[],this.selectaReports=[],this.softdrinksReports=[],this.otherProductsReports=[],this.withOutReceiptExpensesReport=[],this.denominationReports=[],this.employeeCreditReports=[],this.cakeReports=[],this.denominationTotal=0,this.expensesTotalAmount=0,this.productsTotalAmount=0,this.charges=0,this.overTotal=0,console.log("Sales Reports Data",o)}catch(o){console.error("Error submitting data:",o),i.create({type:"negative",message:"Error submitting report"})}}},getters:{breadTotalAmount:t=>t.breadReports.reduce((e,s)=>{const o=Number(s.sales||0);return o>0?e+o:e},0),breadNegativeTotal:t=>t.breadReports.reduce((e,s)=>{const o=Number(s.sales||0);return o<0?e+Math.abs(o):e},0),negativeBread:t=>t.breadReports.filter(e=>Number(e.sales||0)<0),selectaTotalAmount:t=>t.selectaReports.reduce((e,s)=>{const o=Number(s.sales||0);return o>0?e+o:e},0),selectaNegativeTotal:t=>t.selectaReports.reduce((e,s)=>{const o=Number(s.sales||0);return o<0?e+Math.abs(o):e},0),negativeSelecta:t=>t.selectaReports.filter(e=>Number(e.sales||0)<0),softdrinksTotalAmount:t=>t.softdrinksReports.reduce((e,s)=>{const o=Number(s.sales||0);return o>0?e+o:e},0),softdrinksNegativeTotal:t=>t.softdrinksReports.reduce((e,s)=>{const o=Number(s.sales||0);return o<0?e+Math.abs(o):e},0),negativeSoftdrinks:t=>t.softdrinksReports.filter(e=>Number(e.sales||0)<0),otherProductsTotalAmount:t=>t.otherProductsReports.reduce((e,s)=>{const o=Number(s.sales||0);return o>0?e+o:e},0),otherProductsNegativeTotal:t=>t.otherProductsReports.reduce((e,s)=>{const o=Number(s.sales||0);return o<0?e+Math.abs(o):e},0),negativeOtherProducts:t=>t.otherProductsReports.filter(e=>Number(e.sales||0)<0),cakeTotalAmount:t=>t.cakeReports.filter(e=>e.sales_status==="sold").reduce((e,s)=>e+Number(s.price),0),expensesSumAmount:t=>t.withOutReceiptExpensesReport.reduce((e,s)=>e+s.amount,0),creditTotalAmount:t=>t.employeeCreditReports.reduce((e,s)=>e+s.total_amount,0),creditExpensesTotal:t=>t.expensesSumAmount+t.creditTotalAmount,getDenominationTotal:t=>t.denominationTotal,getCharges:t=>t.charges,totalSalesAmount:t=>t.breadTotalAmount+t.selectaTotalAmount+t.softdrinksTotalAmount+t.otherProductsTotalAmount+t.cakeTotalAmount}});export{T as u};
