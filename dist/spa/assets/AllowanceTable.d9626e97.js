import{c as P,r as u,t as H,o as d,a3 as N,f as o,M as k,w as n,Q as q,I as E,ae as O,K as w,e as b,L as z,bc as G,a0 as h,a4 as D,a5 as B,$ as C,bd as W,J as g,aJ as X,a2 as Y,O as K,R,z as Z,u as ee,bb as ae,N as U}from"./index.3a3e1599.js";import{b as oe,Q as F,a as te}from"./QTable.0e6f65ea.js";import{Q as le}from"./QTr.6185202a.js";import{Q as T}from"./QTooltip.f57d05cb.js";import{Q as ne}from"./QPopupEdit.f935c711.js";import{Q as se}from"./QSpinnerIos.3ccbb94f.js";import{Q as re}from"./QInnerLoading.67b3bbfb.js";import{Q as ie}from"./QPage.ed9e78c9.js";import{u as J}from"./AllowanceTable.vue_vue_type_style_index_0_scoped_true_lang.03c96f8d.js";import{Q as de}from"./QSpace.baee2f69.js";import{Q as L,a as ue}from"./QItem.519b456c.js";import{Q as me}from"./QList.c54c0620.js";import{C as ce}from"./ClosePopup.120fb979.js";import{u as pe}from"./employee.a09f40f9.js";import{_ as M}from"./plugin-vue_export-helper.21dcd24c.js";import"./QVirtualScroll.e0b3f530.js";import"./use-virtual-scroll.7de15ce7.js";import"./QSelect.010d2813.js";import"./QItemLabel.681d6913.js";import"./QChip.13398464.js";import"./QMenu.691ea12c.js";import"./position-engine.bd1d251b.js";import"./selection.0e35061f.js";import"./axios.c34fa188.js";const fe=m=>(K("data-v-3a6fe252"),m=m(),R(),m),ge=fe(()=>g("div",{class:"text-h5 q-mr-md"},"\u{1F4BC} Add Employee Allowance",-1)),ye={key:0,class:"custom-list z-top"},ve={class:"q-gutter-md"},_e={__name:"AddAllowance",emits:["created"],setup(m,{emit:A}){const x=A,i=pe(),y=P(()=>i.employees),p=J();P(()=>p.allowances);const c=u(""),f=u(!1),Q=u(!1),V=u(!1),v=()=>{f.value=!0},I=async()=>{c.value.trim()&&(V.value=!0,await i.searchEmployee(c.value),V.value=!1)},S=t=>{console.log("Selected Employee:",t),s.employee_id=t.id,s.employee_name=`${t.firstname} ${t.middlename?t.middlename.charAt(0)+".":""} ${t.lastname}`,s.employee_position=t.position,c.value="",console.log("Filled Designation Data:",s)},s=H({employee_id:"",employee_name:"",employee_position:"",amount:""}),$=()=>{s.employee_id="",s.employee_name="",s.employee_position="",s.amount=""},a=async()=>{Q.value=!0;try{const t=await p.createEmployeeAllowance(s);console.log("data to be save",t),x("created"),f.value=!1,$()}catch(t){console.log(t)}finally{Q.value=!1}};return(t,e)=>(d(),N("div",null,[o(k,{padding:"sm md",label:"Add Allowance",icon:"add_circle",size:"md",class:"gradient-btn text-white",onClick:v}),o(Y,{modelValue:f.value,"onUpdate:modelValue":e[4]||(e[4]=l=>f.value=l),persistent:"",position:"right","backdrop-filter":"blur(4px) saturate(150%)"},{default:n(()=>[o(q,{style:{width:"500px","max-width":"80vw"}},{default:n(()=>[o(E,{class:"row items-center q-px-md q-py-sm gradient-btn text-white"},{default:n(()=>[ge,o(de),O(o(k,{icon:"arrow_forward_ios",flat:"",dense:"",round:""},null,512),[[ce]])]),_:1}),o(E,null,{default:n(()=>[o(w,{modelValue:c.value,"onUpdate:modelValue":[e[0]||(e[0]=l=>c.value=l),I],label:"Search Employee",outlined:"",dense:"",rounded:"",debounce:"500",placeholder:"Enter name"},{append:n(()=>[V.value?(d(),b(G,{key:1,color:"grey",size:"sm"})):(d(),b(z,{key:0,name:"search"}))]),default:n(()=>[c.value?(d(),N("div",ye,[o(q,null,{default:n(()=>[o(me,{separator:""},{default:n(()=>{var l;return[(l=y.value)!=null&&l.length?(d(!0),N(D,{key:1},B(y.value,r=>(d(),b(L,{onClick:_=>S(r),key:r.id,clickable:""},{default:n(()=>[o(ue,null,{default:n(()=>[h(C(`${r.firstname} ${r.middlename?r.middlename.charAt(0)+".":""} ${r.lastname}`),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128)):(d(),b(L,{key:0},{default:n(()=>[h(" No Employee Record ")]),_:1}))]}),_:1})]),_:1})])):W("",!0)]),_:1},8,["modelValue"])]),_:1}),o(E,null,{default:n(()=>[g("div",ve,[o(w,{modelValue:s.employee_name,"onUpdate:modelValue":e[1]||(e[1]=l=>s.employee_name=l),outlined:"",dense:"",readonly:"",label:"Name"},null,8,["modelValue"]),o(w,{modelValue:s.employee_position,"onUpdate:modelValue":e[2]||(e[2]=l=>s.employee_position=l),outlined:"",dense:"",readonly:"",label:"Position"},null,8,["modelValue"])])]),_:1}),o(E,null,{default:n(()=>[o(w,{modelValue:s.amount,"onUpdate:modelValue":e[3]||(e[3]=l=>s.amount=l),outlined:"",dense:"",label:"Allowance amount"},null,8,["modelValue"])]),_:1}),o(X,null,{default:n(()=>[o(k,{size:"md",padding:"xs md",label:"save","icon-right":"send",class:"gradient-btn text-white",onClick:a,loading:Q.value},null,8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}};var we=M(_e,[["__scopeId","data-v-3a6fe252"]]);const be=m=>(K("data-v-57811535"),m=m(),R(),m),he={class:"row justify-between q-mb-md",align:"right"},Ae=be(()=>g("div",{class:"text-h6 text-primary text-center q-mb-xs"}," Edit Amount ",-1)),Qe={class:"text-subtitle2 q-mb-sm"},Ve={__name:"AllowanceTable",setup(m){const A=J(),x=P(()=>A.allowances),i=u({page:1,rowsPerPage:0,rowsNumber:0}),y=u([]),p=u(!1),c=u(!1),f=u("");u(!1);function Q(a){if(a==null||a==="")return"";const t=parseFloat(a);return isNaN(t)?"":Number.isInteger(t)?String(parseInt(t)):String(t)}async function V(a,t){console.log("updateteAmount",a,t),p.value=!0;try{await A.updateAmount(a,t),U.create({message:"Amount updated successfully",color:"positive",position:"top",timeout:2e3})}catch(e){console.error("Error updating amount:",e),U.create({message:"Failed to update amount",color:"negative",position:"top",timeout:2e3})}finally{p.value=!1}}Z(async()=>{await v()});const v=async(a=1,t=7,e="")=>{try{p.value=!0,await A.fetchEmployeeAllowance(a,t,e),console.log("allowance",x.value);const{data:l,current_page:r,per_page:_,total:j}=x.value;y.value=l,console.log("employeeAllowance",y.value),i.value.page=r,i.value.rowsPerPage=_,i.value.rowsNumber=j}catch(l){console.log("Error fetching allowance",l)}finally{p.value=!1}},I=a=>{console.log("handle request",a),v(a.pagination.page,a.pagination.rowsPerPage,a.filter)};ee(f,async a=>{c.value=!0,await v(i.value.page,i.value.rowsPerPage,a),c.value=!1});const S=a=>{const t=_=>_?_.charAt(0).toUpperCase()+_.slice(1).toLowerCase():"",e=a.firstname?t(a.firstname):"No Firstname",l=a.middlename?t(a.middlename).charAt(0)+".":"",r=a.lastname?t(a.lastname):"No Lastname";return`${e} ${l} ${r}`.trim()},s=a=>new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(a),$=[{name:"name",required:!0,label:"Name",align:"center",field:a=>S(a.employee)},{name:"amount",required:!0,label:"Amount",align:"center",field:a=>s(a.amount)}];return(a,t)=>(d(),b(ie,{class:"q-my-md"},{default:n(()=>[g("div",he,[g("div",null,[o(we,{onCreated:v})]),o(w,{modelValue:f.value,"onUpdate:modelValue":t[0]||(t[0]=e=>f.value=e),outlined:"",dense:"",debounce:"300",flat:"",label:"Search",style:{width:"300px"}},{append:n(()=>[g("div",null,[o(z,{name:"search"})])]),_:1},8,["modelValue"])]),o(te,{flat:"",bordered:"",rows:y.value,columns:$,"row-key":"name",pagination:i.value,"onUpdate:pagination":t[1]||(t[1]=e=>i.value=e),"rows-per-page-options":[5,7,10,0],onRequest:I,loading:p.value},{header:n(e=>[o(le,{props:e,class:"gradient-header text-white text-weight-bold"},{default:n(()=>[(d(!0),N(D,null,B(e.cols,l=>(d(),b(oe,{key:l.name,props:e,class:"text-center text-subtitle2"},{default:n(()=>[h(C(l.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),"body-cell-amount":n(e=>[o(F,{props:e,class:"cursor-pointer"},{default:n(()=>[g("span",null,[h(C(e.row.amount?s(e.row.amount):" - - ")+" ",1),o(T,{class:"bg-blue-grey-8"},{default:n(()=>[h("Edit Amount")]),_:1})]),o(ne,{"onUpdate:modelValue":[l=>V(e.row,l),l=>e.row.amount=l],modelValue:e.row.amount,buttons:"","label-set":"Save","label-cancel":"Close"},{default:n(l=>[Ae,g("div",Qe," Name: "+C(S(e.row.employee)),1),o(w,{modelValue:l.value,"onUpdate:modelValue":[r=>l.value=r,r=>l.value=r],"model-value":Q(l.value),type:"text",autofocus:"",counter:"",onKeyup:ae(l.set,["enter"])},null,8,["modelValue","onUpdate:modelValue","model-value","onKeyup"])]),_:2},1032,["onUpdate:modelValue","modelValue"])]),_:2},1032,["props"])]),"body-cell-actions":n(e=>[o(F,{props:e},{default:n(()=>[o(k,{color:"positive",icon:"edit",size:"sm",flat:"",round:"",dense:""},{default:n(()=>[o(T,{class:"bg-positive",delay:200},{default:n(()=>[h("Edit")]),_:1})]),_:1})]),_:2},1032,["props"])]),loading:n(()=>[o(re,{showing:""},{default:n(()=>[o(se,{size:"50px",color:"grey-10"})]),_:1})]),_:1},8,["rows","pagination","loading"])]),_:1}))}};var Ge=M(Ve,[["__scopeId","data-v-57811535"]]);export{Ge as default};
