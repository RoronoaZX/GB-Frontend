import{Q as J}from"./QDate.ce3ba5a2.js";import{d as se,r as v,N as M,t as ne,u as re,o as H,a3 as I,f as e,w as t,a2 as K,Q as B,ae as N,M as k,I as L,J as r,L as O,$,aI as ie,K as P,P as R,bz as de,e as V,a0 as q,a1 as T,O as ce,R as ue,c as W,z as me,bo as ye,be as pe,a5 as fe,bg as ve,a4 as he}from"./index.dd60800d.js";import{Q as ge,a as U,b as Q}from"./QMenu.27698ebc.js";import{Q as j}from"./QList.977e1cc1.js";import{Q as _e,a as Y}from"./QSelect.2bdbddfb.js";import{Q as be}from"./QScrollArea.475be8f9.js";import{Q as He}from"./QPage.868ea0cf.js";import{C as E}from"./ClosePopup.75cec4cf.js";import{api as z}from"./axios.1416c428.js";import{Q as xe}from"./QPopupProxy.705baa08.js";import{Q as we}from"./QForm.4e527ca1.js";import{_ as F}from"./plugin-vue_export-helper.21dcd24c.js";import"./use-render-cache.3aae9b27.js";import"./date.5f84254c.js";import"./selection.c6ebf0a3.js";import"./position-engine.16226377.js";import"./QChip.589677fc.js";import"./use-virtual-scroll.3b99f7a6.js";import"./rtl.276c3f1b.js";import"./QResizeObserver.a5f3abca.js";import"./QScrollObserver.314133f4.js";import"./TouchPan.e8650ac0.js";import"./touch.9135741d.js";const A=se("holidays",()=>{const h=v([]),g=v(null);return{holiday:h,holidays:g,createHoliday:async n=>{try{const u=await z.post("/api/holiday",n);M.create({type:"positive",message:`${n.name||"Holiday"} created successfully.`,position:"top"})}catch(u){M.create({type:"negative",message:u.response.data.message})}},fetchHolidays:async({year:n,month:u})=>{try{const m=await z.get("/api/holiday",{params:{year:n,month:u}});g.value=m.data}catch(m){console.error("Error fetching holidays:",m),g.value=[]}},updateHoliday:async(n,u,m)=>{var x,a;try{const s=await z.put(`/api/holiday/${n}`,u),y=m.name!==s.data.name,w=m.date!==s.data.date;let d="";y&&(d+=`Holiday name changed from "${m.name||"N/A"}" to "${s.data.name||"N/A"}".`),w&&(d+=w&&d?" ":"",d+=`Holiday date changed from "${m.date||"N/A"}" to "${s.data.date||"N/A"}".`),d||(d=`${u.name||"Holiday"} updated successfully.`),M.create({type:"positive",message:d,timeout:2e3,position:"top"})}catch(s){const y=((a=(x=s.response)==null?void 0:x.data)==null?void 0:a.message)||s.message||"Failed to update holiday!";M.create({type:"negative",message:y,timeout:2e3,position:"top"})}},deleteHoliday:async n=>{console.log("holiday delete id",n);try{await z.delete(`/api/holiday/${n}`)}catch(u){console.log("Delete Holiday Error: ",u)}}}});const De={class:"text-center q-mb-xl"},qe={class:"text-h4 text-weight-bold text-grey-9 q-mt-md"},Se={class:"text-subtitle1 text-grey-7 q-mt-sm"},$e={class:"row items-center justify-end"},ke={class:"row q-gutter-md justify-center q-pt-sm"},Ve={__name:"HolidaysDialog",props:{editMode:{type:Boolean,default:!1},holidayToEdit:{type:Object,default:()=>({})},currentYear:{type:Number,default:new Date().getFullYear()},currentMonth:{type:Number,default:new Date().getMonth()+1}},emits:["refreshHolidays"],setup(h,{expose:g,emit:_}){const i=h;console.log("props holiday to edit: ",i.holidayToEdit,i.currentYear,i.currentMonth);const S=_,f=v(!1),n=A(),u=i.holidayToEdit;i.currentYear,i.currentMonth;const m=()=>{f.value=!0},x={id:null,name:"",date:"",type:null},a=ne({...x}),s=["Regular Holiday","Special (Non-Working) Holiday"],y=()=>{Object.assign(a,x)};re(()=>i.holidayToEdit,d=>{i.editMode&&d?Object.assign(a,d):y()},{immediate:!0});const w=async()=>{R.show();try{i.editMode?await n.updateHoliday(a.id,a,u):await n.createHoliday(a),S("refreshHolidays"),y(),f.value=!1}catch(d){console.error("Error saving holiday:",d)}finally{R.hide()}};return g({openDialog:m}),(d,b)=>(H(),I("div",null,[e(K,{modelValue:f.value,"onUpdate:modelValue":b[4]||(b[4]=p=>f.value=p),persistent:""},{default:t(()=>[e(B,{class:"holiday-card"},{default:t(()=>[N(e(k,{icon:"close",flat:"",round:"",dense:"",class:"close-btn"},null,512),[[E]]),e(L,{class:""},{default:t(()=>[r("div",De,[e(O,{name:"celebration",color:"primary",size:"3.5rem"}),r("div",qe,$(h.editMode?"Edit Holiday":"Holiday Management"),1),r("div",Se,$(h.editMode?"Update holiday details.":"Add holiday details with ease."),1)]),e(we,{onSubmit:ie(w,["prevent"]),onReset:y,class:"q-gutter-y-md"},{default:t(()=>[e(P,{outlined:"",modelValue:a.name,"onUpdate:modelValue":b[0]||(b[0]=p=>a.name=p),label:"Holiday Name *","lazy-rules":"",rules:[p=>!!p||"Holiday name is required"],"bg-color":"grey-2"},null,8,["modelValue","rules"]),e(P,{outlined:"",modelValue:a.date,"onUpdate:modelValue":b[2]||(b[2]=p=>a.date=p),label:"Holiday Date *",mask:"date",hint:"yyyy/mm/dd","bg-color":"grey-2"},{append:t(()=>[e(O,{name:"event",class:"cursor-pointer"},{default:t(()=>[e(xe,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:t(()=>[e(J,{modelValue:a.date,"onUpdate:modelValue":b[1]||(b[1]=p=>a.date=p),color:"primary"},{default:t(()=>[r("div",$e,[N(e(k,{label:"Close",color:"primary",flat:""},null,512),[[E]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(_e,{outlined:"",modelValue:a.type,"onUpdate:modelValue":b[3]||(b[3]=p=>a.type=p),options:s,label:"Holiday Type *",behavior:"menu",rules:[p=>!!p||"Holiday type is required"],"bg-color":"grey-2"},null,8,["modelValue","rules"]),r("div",ke,[e(k,{label:"Reset",type:"reset",color:"grey-8",flat:"",class:"q-px-xl q-py-sm form-btn"}),e(k,{label:"Save Holiday",type:"submit",color:"primary",unelevated:"",class:"q-px-xl q-py-sm form-btn save-btn"})])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}};var Ce=F(Ve,[["__scopeId","data-v-42a038a2"]]);const Qe=de('<span class="IconContainer" data-v-075f712a><svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 448 512" fill="rgb(17, 17, 17)" class="holiday-calendar-star-icon" data-v-075f712a><path d="M128 0v48H64C28.7 48 0 76.7 0 112v352c0 35.3 28.7 64 64 64h320c35.3 0 64-28.7 64-64V112c0-35.3-28.7-64-64-64H320V0c0-13.3-10.7-24-24-24s-24 10.7-24 24V48H176V0c0-13.3-10.7-24-24-24s-24 10.7-24 24zM384 160H64v288c0 8.8 7.2 16 16 16h288c8.8 0 16-7.2 16-16V160zm-68.7 82.7L258.9 308c-3.5 3.5-9.4 3.5-12.9 0l-37.5-37.5c-3.5-3.5-3.5-9.4 0-12.9s9.4-3.5 12.9 0L245.4 282l67.9-67.9c3.5-3.5 9.4-3.5 12.9 0s3.5 9.4 0 12.9z" data-v-075f712a></path><path fill="rgb(255, 208, 0)" d="M224 288l-25.1 48.9-54.2 7.9 39.2 38.3-9.3 54 48.4-25.4 48.4 25.4-9.3-54 39.2-38.3-54.2-7.9L224 288z" data-v-075f712a></path></svg></span><span class="text" data-v-075f712a>Set Holidays</span>',2),Me=[Qe],Ie={__name:"HolidayButton",emits:["set-holidays"],setup(h,{emit:g}){const _=g,i=()=>{_("set-holidays")};return(S,f)=>(H(),I("button",{class:"CartBtn",onClick:i},Me))}};var Ne=F(Ie,[["__scopeId","data-v-075f712a"]]);const Ee=h=>(ce("data-v-2b9830c3"),h=h(),ue(),h),ze=Ee(()=>r("div",{class:"text-h5 q-mb-xs"},"Confirm Deletion",-1)),Be={class:"text-body2 q-mb-none"},Le={class:"text-weight-bold"},Re={__name:"HolidayDeleteDialog",emits:["refreshHolidays"],setup(h,{expose:g,emit:_}){const i=A(),S=_,f=v(!1),n=v(null),u=a=>{n.value=a,f.value=!0},m=()=>{f.value=!1},x=async()=>{console.log("delete....");const a=n.value.id;R.show();try{await i.deleteHoliday(a),S("refreshHolidays"),m(),M.create({type:"positive",message:`${n.value.name} holiday deleted successfully!`,position:"top",timeout:2e3})}catch(s){console.log("delete holiday error: ",s)}finally{R.hide()}};return g({openDialog:u,closeDialog:m}),(a,s)=>(H(),V(K,{modelValue:f.value,"onUpdate:modelValue":s[0]||(s[0]=y=>f.value=y)},{default:t(()=>[e(B,null,{default:t(()=>[e(L,{class:"q-pa-md q-rounded q-elevate-2 bg-white text-grey-9"},{default:t(()=>[ze,r("p",Be,[q(" Are you sure you want to delete holiday "),r("span",Le,$(n.value.name),1),q("? This action cannot be undone. ")])]),_:1}),e(T,{class:"q-mb-md"}),e(L,{align:"right",class:"q-pt-none"},{default:t(()=>[N(e(k,{flat:"",dense:"",label:"Cancel",color:"primary",class:"q-mr-sm"},null,512),[[E]]),e(k,{dense:"",label:"Delete",color:"negative",onClick:x,class:"q-btn-rounded q-px-lg"})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}};var Ue=F(Re,[["__scopeId","data-v-2b9830c3"]]);const Ye={class:"q-mb-md"},Oe={class:"row q-col-gutter-md"},Te={class:"col-12 col-md-6"},Fe={class:"col-12 col-md-6"},Ae={key:0,class:"flex flex-center column q-pa-md",style:{"min-height":"250px"}},Pe=r("div",{class:"text-h6 text-grey-7 q-mt-md"},"Loading Holidays...",-1),We={key:0,class:"flex flex-center column q-pa-md",style:{"min-height":"250px"}},je=r("div",{class:"text-h6 text-grey-7 q-mb-xs"}," No holidays for this month ",-1),Je={class:"text-subtitle2 text-grey-6 text-center"},Ke=r("br",null,null,-1),Ge=r("br",null,null,-1),Xe={class:"text-grey-7 q-mx-sm",align:"right"},Ze={class:"text-weight-light"},wt={__name:"HolidaysPage",setup(h){const g=A(),_=v([]),i=v(!1),S=v(null),f=v(null),n=v(null),u=v(!0),m=v(new Date().toISOString().substr(0,10)),x=v([]),a=new Date,s=v(`${a.getFullYear()}/${String(a.getMonth()+1).padStart(2,"0")}`),y=W(()=>s.value?parseInt(s.value.split("/")[0],10):new Date().getFullYear()),w=W(()=>s.value?parseInt(s.value.split("/")[1],10):new Date().getMonth()+1),d=async(c,o)=>{u.value=!0;try{await g.fetchHolidays({year:c,month:o});const l=g.holidays.map(D=>{const C=new Date(D.date);if(isNaN(C.getTime()))return console.warn(`Invalid date encountered for holiday ID ${D.id}: ${D.date}`),{...D,date:D.date,monthYear:"Invalid Date",dayOfWeek:"Invalid Day"};const ae=C.toISOString().split("T")[0],oe=C.toLocaleString("en-US",{month:"long",day:"numeric",year:"numeric"}),le=C.toLocaleString("en-US",{weekday:"long"});return{...D,date:ae,day:String(C.getDate()),monthYear:oe,dayOfWeek:le}});_.value=l,x.value=_.value.map(D=>D.date)}catch(l){console.error("Error fetching holidays:",l)}finally{u.value=!1}},b=({year:c,month:o})=>{const l=String(o).padStart(2,"0");s.value=`${c}/${l}`,d(c,o)};me(()=>{const[c,o]=s.value.split("/");d(parseInt(c),parseInt(o))});const p=()=>{i.value=!1,S.value=null,f.value.openDialog()},G=c=>{i.value=!0,S.value={...c},f.value.openDialog()},X=c=>{n.value.openDialog(c)},Z=c=>c==="Regular Holiday"?"holiday--regular-card":c==="Special (Non-Working) Holiday"?"holiday--special-card":"",ee=c=>{const o=_.value.find(l=>l.date===c);return o?o.type==="Regular Holiday"?"deep-purple-4":o.type==="Special (Non-Working) Holiday"?"amber-5":"primary":"primary"},te=c=>new Date(y.value,c-1,1).toLocaleString("en-US",{month:"long"});return(c,o)=>(H(),V(He,{class:"q-pa-md",style:{"background-color":"#f7f9fc"}},{default:t(()=>[r("div",Ye,[e(Ne,{year:y.value,month:w.value,onClick:o[0]||(o[0]=l=>p())},null,8,["year","month"])]),r("div",Oe,[r("div",Te,[e(B,{flat:"",class:"calendar-card"},{default:t(()=>[e(L,null,{default:t(()=>[e(J,{modelValue:m.value,"onUpdate:modelValue":o[1]||(o[1]=l=>m.value=l),"year-month":s.value,"onUpdate:yearMonth":o[2]||(o[2]=l=>s.value=l),events:x.value,"event-color":ee,"event-style":"filled",minimal:"",flat:"",class:"full-width","text-color":"dark",onNavigation:b},null,8,["modelValue","year-month","events"])]),_:1})]),_:1})]),r("div",Fe,[e(be,{style:{height:"320px"},class:"q-pa-sm"},{default:t(()=>[u.value?(H(),I("div",Ae,[e(ye,{color:"primary",size:"3em",thickness:10}),Pe])):(H(),V(j,{key:1},{default:t(()=>[_.value.length===0?(H(),I("div",We,[e(O,{name:"sentiment_very_dissatisfied",color:"grey-5",size:"80px",class:"q-mb-sm"}),je,r("div",Je,[q(" It looks like there are no holidays recorded for "),Ke,q(" "+$(te(w.value))+" "+$(y.value)+". ",1),Ge,q(" You can try Browse other months or add a new holiday! ")]),e(k,{label:"Add New Holiday",color:"primary",flat:"",icon:"add_circle_outline",class:"q-mt-md",onClick:o[3]||(o[3]=l=>p())})])):pe("",!0),(H(!0),I(he,null,fe(_.value,l=>(H(),V(B,{key:l.id,class:ve([Z(l.type),"q-mb-sm holiday-card"]),flat:""},{default:t(()=>[r("div",Xe,[e(k,{icon:"more_horiz",round:"",flat:"",dense:""},{default:t(()=>[e(ge,null,{default:t(()=>[e(j,{style:{"min-width":"100px"}},{default:t(()=>[N((H(),V(U,{clickable:""},{default:t(()=>[e(Q,{onClick:D=>G(l),align:"center"},{default:t(()=>[q(" Edit ")]),_:2},1032,["onClick"])]),_:2},1024)),[[E]]),N((H(),V(U,{clickable:""},{default:t(()=>[e(Q,{onClick:D=>X(l),align:"center"},{default:t(()=>[q(" Delete ")]),_:2},1032,["onClick"])]),_:2},1024)),[[E]])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),e(U,{class:"q-py-md items-center"},{default:t(()=>[e(Q,{side:"",class:"type-section"},{default:t(()=>[r("div",Ze,$(l.type),1)]),_:2},1024),e(T,{vertical:"",class:"holiday-separator"}),e(Q,{class:"q-ml-md"},{default:t(()=>[e(Y,{class:"text-grey-7 text-weight-bold date-info"},{default:t(()=>[q($(l.monthYear),1)]),_:2},1024),e(Y,{caption:"",class:"day-of-week"},{default:t(()=>[q($(l.dayOfWeek),1)]),_:2},1024)]),_:2},1024),e(T,{vertical:"",class:"holiday-separator"}),e(Q,{class:"q-ml-sm"},{default:t(()=>[e(Y,{class:"text-blue-grey-7 text-weight-bold date-name"},{default:t(()=>[q($(l.name),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["class"]))),128))]),_:1}))]),_:1})])]),r("div",null,[e(Ce,{ref_key:"holidayDialogRef",ref:f,"edit-mode":i.value,"holiday-to-edit":S.value,"current-year":y.value,"current-month":w.value,onRefreshHolidays:o[4]||(o[4]=l=>d(y.value,w.value))},null,8,["edit-mode","holiday-to-edit","current-year","current-month"]),e(Ue,{ref_key:"deleteDialogRef",ref:n,onRefreshHolidays:o[5]||(o[5]=l=>d(y.value,w.value))},null,512)])]),_:1}))}};export{wt as default};
