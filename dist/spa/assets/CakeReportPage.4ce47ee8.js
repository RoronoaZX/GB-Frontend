import{r as M,o as k,a3 as N,f as a,M as f,w as r,Q,I as y,J as e,$ as c,a1 as P,aJ as q,a2 as S,K as A,ae as Y,a4 as L,N as x,O as z,R as B,c as j,z as E,e as I,L as J,a5 as O,a0 as T}from"./index.a4e8ffb6.js";import{Q as H}from"./QChip.e6f31ed3.js";import{Q as K}from"./QScrollArea.22c3fd98.js";import{Q as G}from"./QPage.a8f530bf.js";import{q as $}from"./date.76e72277.js";import{u as F}from"./cake-maker-report.897ae137.js";import{C as W}from"./ClosePopup.d5d8284a.js";import{_ as X}from"./plugin-vue_export-helper.21dcd24c.js";import"./QResizeObserver.ad820cac.js";import"./QScrollObserver.7fec1387.js";import"./TouchPan.2e2d1bc5.js";import"./touch.9135741d.js";import"./selection.a8cd4ad9.js";import"./axios.82e5ba61.js";const _=n=>(z("data-v-d86de9bc"),n=n(),B(),n),Z={class:"row justify-between"},ee={class:"text-h6"},te={class:"row q-gutter-x-sm"},ae=_(()=>e("div",{class:"text-subtitle2"},"Date:",-1)),oe={class:"text-body1 text-weight-light"},se={class:"row q-gutter-x-sm"},re=_(()=>e("div",{class:"text-subtitle2"},"Branch:",-1)),le={class:"text-body1 text-weight-light"},ie={class:"row q-gutter-x-sm"},ne=_(()=>e("div",{class:"text-subtitle2"},"Cake Maker:",-1)),ce={class:"text-body1 text-weight-light"},de={class:"row q-mt-sm item-start q-gutter-x-xl"},me={class:"row q-gutter-x-sm text-overline"},ue=_(()=>e("div",null,"Price:",-1)),pe={class:"text-weight-light"},fe={class:"row q-gutter-x-sm text-overline"},_e=_(()=>e("div",null,"Layer /s:",-1)),he={class:"text-weight-light"},ve=_(()=>e("div",{class:"text-h6"},"Decline Report",-1)),ge={__name:"CakeReportView",props:{report:{type:Object,required:!0}},setup(n){const h=F(),m=M(!1),u=n,p=M(""),v=M(!1),C=()=>{m.value=!0},b=()=>{v.value=!0},w=t=>{const s=V=>V?V.charAt(0).toUpperCase()+V.slice(1).toLowerCase():"",i=t.firstname?s(t.firstname):"No Firstname",g=t.middlename?s(t.middlename).charAt(0)+".":"",U=t.lastname?s(t.lastname):"No Lastname";return`${i} ${g} ${U}`},D=t=>$.formatDate(t,"MMMM D, YYYY || hh:mm A"),o=t=>new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(t),d=t=>t.split(" ").map(s=>s.charAt(0).toUpperCase()+s.slice(1)).join(" "),l=async()=>{console.log("report id",u.report.id);try{const t=await h.confirmReports(u.report.id);console.log("Report Confirmed",t),x.create({type:"positive",message:"Report confirmed"})}catch(t){console.log(t),x.create({type:"negative",message:"Failed to confirm"})}},R=async()=>{try{if(!p.value.trim()){x.create({type:"warning",message:"Remark cannot be empty"});return}await h.declineReport(u.report.id,p.value),x.create({type:"positive",message:"Report declined successfully"}),v.value=!1,m.value=!1}catch(t){console.log("Error decline report",t)}};return(t,s)=>(k(),N(L,null,[a(f,{color:"accent",icon:"visibility",size:"md",flat:"",round:"",dense:"",onClick:C}),a(S,{modelValue:m.value,"onUpdate:modelValue":s[1]||(s[1]=i=>m.value=i)},{default:r(()=>[a(Q,{style:{width:"700px","max-width":"80vw"}},{default:r(()=>[a(y,null,{default:r(()=>[e("div",Z,[e("div",ee,c(d(n.report.name)),1),e("div",null,[a(f,{class:"close-btn",color:"grey-8",flat:"",round:"",dense:"",icon:"close",onClick:s[0]||(s[0]=i=>m.value=!1)})])])]),_:1}),a(P),a(y,null,{default:r(()=>{var i,g;return[e("div",te,[ae,e("div",oe,c(D(n.report.created_at)),1)]),e("div",se,[re,e("div",le,c(d((g=(i=n.report)==null?void 0:i.branch)==null?void 0:g.name)||"No data"),1)]),e("div",ie,[ne,e("div",ce,c(w(n.report.user.employee)),1)]),e("div",de,[e("div",me,[ue,e("div",pe,c(o(n.report.price)),1)]),e("div",fe,[_e,e("div",he,c(n.report.layers),1)])])]}),_:1}),a(q,{align:"right"},{default:r(()=>[a(f,{label:"Decline",color:"negative",onClick:b}),a(f,{label:"Confirm",color:"positive",onClick:l})]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(S,{modelValue:t.remarkDiaalog,"onUpdate:modelValue":s[3]||(s[3]=i=>t.remarkDiaalog=i)},{default:r(()=>[a(Q,null,{default:r(()=>[a(y,null,{default:r(()=>[ve]),_:1}),a(y,null,{default:r(()=>[a(A,{modelValue:p.value,"onUpdate:modelValue":s[2]||(s[2]=i=>p.value=i),placeholder:"Enter your remark",label:"Remark",type:"textarea",filled:"","lazy-rules":"",rules:[i=>!!i||"Remark is required"]},null,8,["modelValue","rules"])]),_:1}),a(q,{align:"right"},{default:r(()=>[Y(a(f,{flat:"",label:"Cancel",color:"primary"},null,512),[[W]]),a(f,{flat:"",label:"Confirm",color:"negative",onClick:R})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};var ye=X(ge,[["__scopeId","data-v-d86de9bc"]]);const xe={class:"q-gutter-md"},ke={class:"row justify-between q-ma-md"},Ce={class:"text-subtitle1"},be={class:"text-subtitle1"},we={class:"text-h6"},Pe={__name:"CakeReportPage",setup(n){const h=F(),m=j(()=>h.pendingReports);console.log("pendong report",m.value);const u=localStorage.getItem("branch_id");console.log("branch IDss",u);const p=o=>$.formatDate(o,"MMMM D, YYYY"),v=o=>$.formatDate(o,"hh:mm A"),C=o=>{const d=s=>s?s.charAt(0).toUpperCase()+s.slice(1).toLowerCase():"",l=o.firstname?d(o.firstname):"No Firstname",R=o.middlename?d(o.middlename).charAt(0)+".":"",t=o.lastname?d(o.lastname):"No Lastname";return`${l} ${R} ${t}`},b=o=>o.charAt(0).toUpperCase()+o.slice(1).toLowerCase();E(async()=>{u&&await w(u)});const w=async o=>{await h.fetchCakePendingReport(o)},D=o=>{switch(o){case"pending":return"orange";case"declined":return"negative";case"confirmed":return"green";default:return"grey"}};return(o,d)=>(k(),I(G,{padding:""},{default:r(()=>[e("div",xe,[e("div",null,[a(A,{rounded:"",outlined:"",dense:"",debounce:"300",modelValue:o.filter,"onUpdate:modelValue":d[0]||(d[0]=l=>o.filter=l),placeholder:"Search",style:{width:"500px"}},{append:r(()=>[a(J,{name:"search"})]),_:1},8,["modelValue"])]),a(K,{style:{height:"450px","max-width":"1500px"}},{default:r(()=>[(k(!0),N(L,null,O(m.value,l=>(k(),I(Q,{key:l},{default:r(()=>[e("div",ke,[e("div",null,[e("div",Ce,c(p(l.created_at)),1),e("div",be,c(v(l.created_at)),1)]),e("div",we,c(C(l.user.employee))+" - "+c(b(l.name)),1),e("div",null,[a(H,{color:D(l.confirmation_status)},{default:r(()=>[T(c(l.confirmation_status),1)]),_:2},1032,["color"])]),e("div",null,[a(ye,{report:l},null,8,["report"])])])]),_:2},1024))),128))]),_:1})])]),_:1}))}};export{Pe as default};
