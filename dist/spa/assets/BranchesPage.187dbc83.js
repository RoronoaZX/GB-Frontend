import{Q as J}from"./QBadge.a3bd3eb6.js";import{r as v,c as W,t as re,z as ie,o as h,a3 as x,f as e,M as V,w as o,Q as j,I as U,ae as M,a1 as te,J as s,K as Q,e as S,L as H,bc as de,a0 as N,a4 as O,a5 as ue,$ as L,bd as ce,aJ as oe,a2 as le,N as ge,O as Y,R as Z,H as be,u as ye,aI as we,P as ne}from"./index.7640e4cf.js";import{Q as qe}from"./QPage.88a071ab.js";import{Q as me}from"./QSpace.0007135a.js";import{Q as pe,a as G,b as he}from"./QList.23e25756.js";import{Q as X}from"./QSelect.b9e84c2a.js";import{C as R}from"./ClosePopup.7ab7b337.js";import{u as ee}from"./branch.cc74c894.js";import{u as se}from"./warehouse.d8e53a13.js";import{u as _e}from"./employee.aa880d45.js";import{_ as K}from"./plugin-vue_export-helper.21dcd24c.js";import{Q as $e}from"./QSpinnerDots.29ccc382.js";import{Q as z,a as Ce}from"./QTable.00529ccc.js";import{Q as ve}from"./QTooltip.02333757.js";import"./use-virtual-scroll.47f9879f.js";import"./rtl.1813a5ba.js";import"./QChip.e4b8526a.js";import"./QMenu.106ae137.js";import"./selection.21d0b633.js";import"./axios.eaed252d.js";import"./QVirtualScroll.37625985.js";const xe=p=>(Y("data-v-7928110c"),p=p(),Z(),p),Ve=xe(()=>s("div",{class:"text-h5 q-mr-md"},"\u{1F3EA} Add New Branch",-1)),ke={class:"q-mt-lg q-animated q-animate-bounce"},Be={class:"q-mt-lg q-animated q-animate-bounce"},Se={class:"q-mt-lg q-animated q-animate-bounce"},Ne={key:0,class:"custom-list z-top"},De={class:"q-mt-lg q-animated q-animate-bounce"},Qe={class:"row q-mt-lg q-gutter-x-sm justify-between"},Ee={class:"col-6 q-animated q-animate-bounce"},Fe={class:"col-5 q-animated q-animate-bounce"},Le={__name:"BranchesCreateComponent",setup(p){const k=_e(),f=v(!1),F=ee(),$=()=>{f.value=!0},C=se(),_=v([]),n=v([]),q=v(!1),y=["Open","Open soon","Close"],D=v(!1),g=v(null),w=v(null),E=v(!1),P=W(()=>k.employee),T=async()=>{w.value.trim()&&(D.value=!0,await k.searchCertainEmployee(w.value),D.value=!1,E.value=!0)},a=u=>{console.log("Selected Employee:",u),t.employee_id=u.id,t.employee_name=`${u.firstname} ${u.middlename?u.middlename.charAt(0)+".":""} ${u.lastname}`,w.value=`${u.firstname} ${u.middlename?u.middlename.charAt(0)+".":""} ${u.lastname}`,E.value=!1,console.log("Filled addNewBranchForm Data:",t)},m=u=>{const i=ae=>ae?ae.charAt(0).toUpperCase()+ae.slice(1).toLowerCase():"",l=u.firstname?i(u.firstname):"No Firstname",b=u.middlename?i(u.middlename).charAt(0)+".":"",A=u.lastname?i(u.lastname):"No Lastname";return`${l} ${b} ${A}`},t=re({name:"",location:"",employee_id:"",employee_name:"",phone:"",status:""});ie(async()=>{q.value=!0;try{const u=await C.fetchWarehouses();_.value=C.warehouses.map(i=>({label:i.name,value:i.id})),n.value=_.value}catch(u){console.error("Error fetching warehouse data:",u)}finally{q.value=!1}});const d=(u,i)=>{i(()=>{const l=u.toLowerCase();n.value=u===""?_.value:_.value.filter(b=>b.label.toLowerCase().includes(l))})},c=async()=>{var u,i,l;try{q.value=!0;const b={...t,warehouse_id:((u=g.value)==null?void 0:u.value)||null};console.log("brabrbbar",b);const A=await F.createBranches(b);console.log(A),f.value=!1,B()}catch(b){console.error("Error creating branch:",b);const A=((l=(i=b.response)==null?void 0:i.data)==null?void 0:l.message)||b.message||"Failed to create branch. Please try again.";f.value=!0,ge.create({color:"negative",icon:"warning",message:A})}finally{q.value=!1}},B=()=>{t.name="",t.location="",t.employee_id="",t.employee_name="",w.value=null,g.value=null,t.phone="",t.status=""};return(u,i)=>(h(),x(O,null,[e(V,{class:"text-dark q-pa-sm",outline:"",dense:"",elevated:"",icon:"add_circle",label:"Add Store Branch",onClick:$,style:{"background-color":"#ef4444"}}),e(le,{modelValue:f.value,"onUpdate:modelValue":i[7]||(i[7]=l=>f.value=l),persistent:"","transition-show":"jump-up","transition-hide":"jump-down"},{default:o(()=>[e(j,{class:"my-card q-pa-none",style:{width:"420px","border-radius":"16px","box-shadow":"0 12px 24px rgba(0, 0, 0, 0.2)"}},{default:o(()=>[e(U,{class:"row items-center q-px-md q-py-sm bg-gradient text-white"},{default:o(()=>[Ve,e(me),M(e(V,{icon:"close",flat:"",dense:"",round:""},null,512),[[R]])]),_:1}),e(te,{class:"separator-gradient"}),e(U,{class:"q-px-xl q-pt-none q-pb-lg"},{default:o(()=>[s("div",ke,[e(Q,{class:"text-capitalize",modelValue:t.name,"onUpdate:modelValue":i[0]||(i[0]=l=>t.name=l),outlined:"",dense:"",label:"Branch Name",rules:[l=>l&&l.length>0||"Name is required"]},null,8,["modelValue","rules"])]),s("div",Be,[e(Q,{class:"text-capitalize",modelValue:t.location,"onUpdate:modelValue":i[1]||(i[1]=l=>t.location=l),outlined:"",dense:"",label:"Location",rules:[l=>l&&l.length>0||"Label is required"]},null,8,["modelValue","rules"])]),s("div",Se,[s("div",null,[e(Q,{modelValue:w.value,"onUpdate:modelValue":[i[2]||(i[2]=l=>w.value=l),T],label:"Search Employee",outlined:"",dense:"",debounce:"500",placeholder:"Enter name or position",onFocus:i[3]||(i[3]=l=>E.value=!0)},{append:o(()=>[D.value?(h(),S(de,{key:1,color:"grey",size:"sm"})):(h(),S(H,{key:0,name:"search"}))]),default:o(()=>[E.value&&w.value?(h(),x("div",Ne,[e(j,null,{default:o(()=>[e(pe,{separator:""},{default:o(()=>{var l;return[(l=P.value)!=null&&l.length?(h(!0),x(O,{key:1},ue(P.value,b=>(h(),S(G,{onClick:A=>a(b),key:b.id,clickable:""},{default:o(()=>[e(he,null,{default:o(()=>[N(L(m(b)),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128)):(h(),S(G,{key:0},{default:o(()=>[N(" No Employee Record ")]),_:1}))]}),_:1})]),_:1})])):ce("",!0)]),_:1},8,["modelValue"])])]),s("div",De,[e(X,{modelValue:g.value,"onUpdate:modelValue":i[4]||(i[4]=l=>g.value=l),clearable:"","use-input":"","input-debounce":"0",options:n.value,"hide-dropdown-icon":"","stack-label":"",outlined:"",dense:"",label:"Warehouse",onFilter:d,behavior:"menu"},null,8,["modelValue","options"])]),s("div",Qe,[s("div",Ee,[e(Q,{modelValue:t.phone,"onUpdate:modelValue":i[5]||(i[5]=l=>t.phone=l),outlined:"",dense:"",mask:"(+63) ### - ### - ####",placeholder:"(+63) ### - ### - ####",label:"Phone Number",rules:[l=>l&&l.length>0||"Phone number is required"]},null,8,["modelValue","rules"])]),s("div",Fe,[e(X,{modelValue:t.status,"onUpdate:modelValue":i[6]||(i[6]=l=>t.status=l),outlined:"",dense:"",label:"Status",options:y,"hide-dropdown-icon":"",behavior:"menu",rules:[l=>l&&l.length>0||"Status is required"]},null,8,["modelValue","rules"])])])]),_:1}),e(oe,{class:"row q-px-lg q-py-sm q-pt-none",align:"right"},{default:o(()=>[M(e(V,{class:"glossy",color:"grey-9",label:"Dismiss"},null,512),[[R]]),e(V,{class:"glossy",color:"teal",label:"Create",onClick:c,loading:q.value},null,8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};var Ue=K(Le,[["__scopeId","data-v-7928110c"]]);const I=p=>(Y("data-v-6815e1b4"),p=p(),Z(),p),Ie=I(()=>s("div",{class:"text-h5 q-mr-md"},"\u{1F3EA} Edit Branch",-1)),Pe={class:"q-mt-lg q-animated q-animate-bounce"},Ae=I(()=>s("div",null,"Name of Branch",-1)),ze={class:"q-mt-lg q-animated q-animate-bounce"},Oe=I(()=>s("div",null,"Location",-1)),Te={class:"q-mt-lg q-animated q-animate-bounce"},We=I(()=>s("div",null,"Person In-charge",-1)),je={key:0,class:"custom-list z-top"},Me={class:"q-mt-lg q-animated q-animate-bounce"},Re=I(()=>s("div",null,"Under Warehouse",-1)),Ke={class:"row q-gutter-x-sm justify-between q-mt-sm"},Je={class:"col-6 q-animated q-animate-bounce"},He=I(()=>s("div",null,"Phone Number",-1)),Ge={class:"col-5 q-animated q-animate-bounce"},Xe=I(()=>s("div",null,"Status",-1)),Ye={__name:"BranchesEditComponent",props:["edit"],setup(p){const k=_e(),f=ee(),F=se(),$=W(()=>F.warehouses),C=p,_=v(!1);v([]);let n=C.edit.row;const q=["Open","Open soon","Close"],y=v(null),D=v(!1),g=v(!1),w=W(()=>k.employee),E=async()=>{y.value.trim()&&(D.value=!0,await k.searchCertainEmployee(y.value),D.value=!1,g.value=!0)},P=r=>{console.log("Selected Employee:",r),a.employee_id=r.id,a.employee_name=`${r.firstname} ${r.middlename?r.middlename.charAt(0)+".":""} ${r.lastname}`,y.value=`${r.firstname} ${r.middlename?r.middlename.charAt(0)+".":""} ${r.lastname}`,g.value=!1,console.log("Filled editBranchesForm Data:",a)},T=()=>{var r,d;console.log("Edit Row Data:",n),g.value=!1,a.name=n.name,a.location=n.location,a.employee_id=n.employee_id,a.employee_name=n.employees?m(n.employees):"No Person in Charge",y.value=n.employees?m(n.employees):"No Person in Charge",a.warehouse_id=n!=null&&n.warehouse_id?n.warehouse_id:(r=n==null?void 0:n.warehouse)!=null&&r.id?(d=n==null?void 0:n.warehouse)==null?void 0:d.id:"",a.phone=n.phone,a.status=n.status,_.value=!0,console.log("Edit Data:",a)},a=re({name:"",location:"",person_incharge:"",employee_id:"",employee_name:"",warehouse_id:null,phone:"",status:null}),m=r=>{const d=i=>i?i.charAt(0).toUpperCase()+i.slice(1).toLowerCase():"",c=r.firstname?d(r.firstname):"No Firstname",B=r.middlename?d(r.middlename).charAt(0)+".":"",u=r.lastname?d(r.lastname):"No Lastname";return`${c} ${B} ${u}`},t=async()=>{console.log("editRow.id",n.id),console.log("editBranchesForm",a);try{await f.updateBranches(n.id,a),_.value=!1}catch(r){console.error("Error updating branch:",r)}};return(r,d)=>(h(),x(O,null,[e(V,{onClick:T,color:"positive",icon:"edit",size:"sm",flat:"",round:"",dense:""},{default:o(()=>[e(ve,{class:"bg-positive",delay:200},{default:o(()=>[N("Edit")]),_:1})]),_:1}),e(le,{modelValue:_.value,"onUpdate:modelValue":d[7]||(d[7]=c=>_.value=c),persistent:"","transition-show":"jump-up","transition-hide":"jump-down"},{default:o(()=>[e(j,{class:"my-card q-pa-none",style:{width:"420px","border-radius":"16px","box-shadow":"0 12px 24px rgba(0, 0, 0, 0.2)"}},{default:o(()=>[e(U,{class:"row items-center q-px-md q-py-sm bg-gradient text-white"},{default:o(()=>[Ie,e(me),M(e(V,{icon:"close",flat:"",dense:"",round:""},null,512),[[R]])]),_:1}),e(te,{class:"separator-gradient"}),e(U,{class:"q-px-xl q-pt-none q-pb-lg"},{default:o(()=>[s("div",Pe,[Ae,e(Q,{modelValue:a.name,"onUpdate:modelValue":d[0]||(d[0]=c=>a.name=c),outlined:"",dense:""},null,8,["modelValue"])]),s("div",ze,[Oe,e(Q,{modelValue:a.location,"onUpdate:modelValue":d[1]||(d[1]=c=>a.location=c),outlined:"",dense:""},null,8,["modelValue"])]),s("div",Te,[We,s("div",null,[e(Q,{modelValue:y.value,"onUpdate:modelValue":[d[2]||(d[2]=c=>y.value=c),E],label:"Search Employee",outlined:"",dense:"",debounce:"500",placeholder:"Enter name or position",onFocus:d[3]||(d[3]=c=>g.value=!0)},{append:o(()=>[D.value?(h(),S(de,{key:1,color:"grey",size:"sm"})):(h(),S(H,{key:0,name:"search"}))]),default:o(()=>[g.value&&y.value?(h(),x("div",je,[e(j,null,{default:o(()=>[e(pe,{separator:""},{default:o(()=>{var c;return[(c=w.value)!=null&&c.length?(h(!0),x(O,{key:1},ue(w.value,B=>(h(),S(G,{onClick:u=>P(B),key:B.id,clickable:""},{default:o(()=>[e(he,null,{default:o(()=>[N(L(`${B.firstname} ${B.middlename?B.middlename.charAt(0)+".":""} ${B.lastname}`),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128)):(h(),S(G,{key:0},{default:o(()=>[N(" No Employee Record ")]),_:1}))]}),_:1})]),_:1})])):ce("",!0)]),_:1},8,["modelValue"])])]),s("div",Me,[Re,e(X,{modelValue:a.warehouse_id,"onUpdate:modelValue":d[4]||(d[4]=c=>a.warehouse_id=c),"use-input":"","input-debounce":"0",options:$.value,"stack-label":"",outlined:"",dense:"","emit-value":"","map-options":"","option-label":"name","option-value":"id"},null,8,["modelValue","options"])]),s("div",Ke,[s("div",Je,[He,e(Q,{modelValue:a.phone,"onUpdate:modelValue":d[5]||(d[5]=c=>a.phone=c),outlined:"",dense:"",mask:"(+63) ### - ### - ####",placeholder:"(+63) ### - ### - ####",rules:[c=>c&&c.length>0]},null,8,["modelValue","rules"])]),s("div",Ge,[Xe,e(X,{modelValue:a.status,"onUpdate:modelValue":d[6]||(d[6]=c=>a.status=c),outlined:"",dense:"",options:q},null,8,["modelValue"])])])]),_:1}),e(oe,{class:"row q-px-lg q-py-sm q-pt-none",align:"right"},{default:o(()=>[M(e(V,{class:"glossy",color:"grey-9",label:"Dismiss"},null,512),[[R]]),e(V,{class:"glossy",color:"teal",label:"Save",onClick:t})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};var Ze=K(Ye,[["__scopeId","data-v-6815e1b4"]]);const fe=p=>(Y("data-v-df6f3850"),p=p(),Z(),p),ea=fe(()=>s("div",{class:"text-h5 q-mb-xs"},"Confirm Deletion",-1)),aa=fe(()=>s("p",{class:"text-body2 q-mb-none"}," Are you sure you want to delete this item? This action cannot be undone. ",-1)),ta={__name:"BranchesDeleteComponent",props:["delete"],setup(p){const k=ee(),f=v(!1),F=()=>{f.value=!0},$=p,C=async()=>{try{await k.deleteBranches($.delete.row.id)}catch(_){console.error(_.message)}f.value=!1};return(_,n)=>(h(),x(O,null,[e(V,{onClick:F,color:"negative",icon:"delete",size:"sm",flat:"",round:"",dense:""},{default:o(()=>[e(ve,{class:"bg-negative",delay:200},{default:o(()=>[N("Delete")]),_:1})]),_:1}),e(le,{modelValue:f.value,"onUpdate:modelValue":n[0]||(n[0]=q=>f.value=q)},{default:o(()=>[e(j,{class:"q-pa-md q-rounded q-elevate-2 bg-white text-grey-9"},{default:o(()=>[e(U,{class:"q-pt-none q-pb-sm"},{default:o(()=>[ea,aa]),_:1}),e(te,{class:"q-mb-md"}),e(oe,{align:"right",class:"q-pt-none"},{default:o(()=>[M(e(V,{flat:"",dense:"",label:"Cancel",color:"primary",class:"q-mr-sm"},null,512),[[R]]),e(V,{dense:"",label:"Delete",color:"negative",onClick:C,class:"q-btn-rounded q-px-lg"})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};var oa=K(ta,[["__scopeId","data-v-df6f3850"]]);const la=p=>(Y("data-v-4b6ba1f6"),p=p(),Z(),p),sa={key:0,class:"spinner-wrapper"},na={key:1},ra={key:0,class:"data-error"},ia=la(()=>s("div",{class:"q-ml-sm text-h6"},"No data available",-1)),da=["onClick"],ua={class:"row justify-center q-gutter-x-md"},ca={__name:"BranchesTableComponent",setup(p){const k=be(),f=ee(),F=se(),$=v(""),C=W(()=>f.branches);console.log("branchesRow",C.value);const _=v(!0),n=v(!1),q=v({rowsPerPage:0}),y=W(()=>{if(!$.value)return C.value;const a=$.value.toLowerCase();return C.value.filter(m=>{var d;const t=m.name?m.name.toLowerCase():"",r=(d=m==null?void 0:m.warehouse)!=null&&d.name?m.warehouse.name.toLowerCase():"";return t.includes(a)||r.includes(a)})});ie(async()=>{await F.fetchWarehouses(),await D()});const D=async()=>{_.value=!0;try{const a=await f.fetchBranches();console.log("branches data",a),n.value=C.value.length===0}catch{n.value=!0}finally{_.value=!1}};ye($,async a=>{_.value=!0,await new Promise(m=>setTimeout(m,1e3)),_.value=!1,n.value=y.value.length===0});const g=a=>a?a.split(" ").map(m=>m.charAt(0).toUpperCase()+m.slice(1).toLowerCase()).join(" "):"",w=a=>{const m=c=>c?c.charAt(0).toUpperCase()+c.slice(1).toLowerCase():"",t=a.firstname?m(a.firstname):"No Firstname",r=a.middlename?m(a.middlename).charAt(0)+".":"",d=a.lastname?m(a.lastname):"No Lastname";return`${t} ${r} ${d}`},E=[{name:"branch_name",label:"Name of Branch",align:"left",field:a=>a.name,format:a=>`${a}`,sortable:!0},{name:"warehouse",label:"Warehouse",align:"left",field:a=>a!=null&&a.warehouse?a.warehouse:"No warehouse ",sortable:!0},{name:"location",label:"Location",align:"left",field:"location"},{name:"personIncharge",label:"Person In-charge",align:"left",field:a=>w(a)},{name:"phone",label:"Phone",align:"center",field:"phone"},{name:"status",label:"Status",align:"center",field:"status"},{name:"action",label:"Action",align:"center",field:"action"}],P=a=>{switch(a){case"Open":return"info";case"Open soon":return"warning";case"Close":return"accent";default:return"grey"}},T=async a=>{console.log("brach",a),ne.show();try{await k.push({name:"BranchDetail",params:{branch_id:a.id}})}finally{ne.hide()}};return(a,m)=>(h(),x(O,null,[s("div",null,[e(Q,{class:"q-pb-lg q-pl-sm dynamic-width",modelValue:$.value,"onUpdate:modelValue":m[0]||(m[0]=t=>$.value=t),outlined:"",placeholder:"Search",debounced:"1000",flat:"",dense:"",rounded:""},{append:o(()=>[e(H,{name:"search"})]),_:1},8,["modelValue"])]),_.value?(h(),x("div",sa,[e($e,{size:"50px",color:"primary"})])):(h(),x("div",na,[y.value.length===0?(h(),x("div",ra,[e(H,{name:"warning",color:"warning",size:"4em"}),ia])):(h(),S(Ce,{key:1,class:"table-container elegant-container sticky-header","virtual-scroll-sticky-size-start":48,flat:"",style:{height:"500px"},columns:E,rows:y.value,"row-key":"name",pagination:q.value,"onUpdate:pagination":m[1]||(m[1]=t=>q.value=t),"rows-per-page-options":[0],"hide-bottom":""},{"body-cell-branch_name":o(t=>[e(z,{key:"name",props:t},{default:o(()=>[s("a",{onClick:we(r=>T(t.row),["prevent"]),class:"branch-link"},L(g(t.row.name)),9,da)]),_:2},1032,["props"])]),"body-cell-warehouse":o(t=>[e(z,{props:t},{default:o(()=>{var r;return[N(L(g((r=t.row.warehouse)==null?void 0:r.name)),1)]}),_:2},1032,["props"])]),"body-cell-location":o(t=>[e(z,{props:t},{default:o(()=>[N(L(g(t.row.location)),1)]),_:2},1032,["props"])]),"body-cell-status":o(t=>[e(z,{key:"name",props:t},{default:o(()=>[e(J,{outline:"",color:P(t.row.status)},{default:o(()=>[N(L(t.row.status),1)]),_:2},1032,["color"])]),_:2},1032,["props"])]),"body-cell-personIncharge":o(t=>[e(z,{props:t},{default:o(()=>[N(L(w(t.row.employees)),1)]),_:2},1032,["props"])]),"body-cell-action":o(t=>[e(z,{props:t},{default:o(()=>[s("div",ua,[e(Ze,{edit:t},null,8,["edit"]),e(oa,{delete:t},null,8,["delete"])])]),_:2},1032,["props"])]),_:1},8,["rows","pagination"]))]))],64))}};var ma=K(ca,[["__scopeId","data-v-4b6ba1f6"]]);const pa={class:"text-h6 text-dark"},ha={class:"q-gutter-x-sm"},_a={__name:"BranchesPage",setup(p){return(k,f)=>(h(),S(qe,{class:"elegant-container",flat:""},{default:o(()=>[e(U,{class:"row justify-between"},{default:o(()=>[s("div",pa,[s("div",ha,[e(J,{outline:"",label:"Open",color:"info"}),e(J,{outline:"",label:"Open Soon",color:"warning"}),e(J,{outline:"",label:"Close",color:"accent"})])]),s("div",null,[e(Ue)])]),_:1}),e(U,null,{default:o(()=>[s("div",null,[e(ma)])]),_:1})]),_:1}))}};var Ia=K(_a,[["__scopeId","data-v-cf3d1d4c"]]);export{Ia as default};
