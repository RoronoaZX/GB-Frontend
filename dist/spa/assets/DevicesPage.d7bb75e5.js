import{d as ve,r as p,N as I,P as N,c as E,t as Z,u as ee,o as d,a3 as D,f as e,M as V,w as t,Q as C,I as k,ae as F,J as n,K as q,b6 as K,e as x,L as M,bc as J,a0 as Q,bd as U,a4 as T,a5 as G,$ as H,aJ as te,a2 as R,O,R as W,a1 as me,z as pe}from"./index.eeb23a93.js";import{Q as _e}from"./QPage.5494ba20.js";import{Q as ae}from"./QSpace.6bc88e6c.js";import{Q as X,a as P,b as Y}from"./QList.e2ca191a.js";import{C as B}from"./ClosePopup.2ac291ee.js";import{api as L}from"./axios.ac6f7ff9.js";import{u as ge}from"./branch.5adc8d97.js";import{u as fe}from"./warehouse.a5844c9d.js";import{_ as z}from"./plugin-vue_export-helper.21dcd24c.js";import{Q as he}from"./QSpinnerDots.eebe5101.js";import{Q as ye,a as be}from"./QTable.c8a05d19.js";import{Q as le}from"./QTooltip.58d3a21c.js";import"./employee.81065c6c.js";import"./QVirtualScroll.f6079854.js";import"./use-virtual-scroll.7fb3ee8a.js";import"./rtl.2c991024.js";import"./QSelect.9dd238e1.js";import"./QChip.2398fbc0.js";import"./QMenu.b76d6847.js";import"./selection.1805a0a4.js";const j=ve("devices",()=>{const i=p(null),v=p([]);return{device:i,devices:v,fetchDevices:async()=>{try{const o=await L.get("/api/device");v.value=o.data}catch(o){console.log("error fetchig  device",o),I.create({type:"negative",message:"Failed to fetch devices",setTimeout:1e3})}},createDevices:async o=>(N.show(),console.log("Data parameters being sent:",o),o),updateDevice:async(o,y)=>{N.show();try{const u=await L.put(`/api/device/${o}`,y),c=v.value.findIndex(a=>a.id===o);c!==-1&&(v.value[c]=u.data),I.create({type:"positive",message:"Device updated successfully",setTimeout:1e3})}catch(u){console.log("update device error",u),I.create({type:"negative",message:"Failed to update device",setTimeout:1e3})}finally{N.hide()}},deleteDevice:async o=>{N.show();try{const y=await L.delete(`/api/device/${o}`);v.value=v.value.filter(u=>u.id!==o),I.create({type:"positive",message:"Device deleted successfully"})}catch{I.create({type:"negative",message:"Failed to delete device"})}finally{N.hide()}}}});const S=i=>(O("data-v-25e18a02"),i=i(),W(),i),De=S(()=>n("div",{class:"text-h5 q-mr-md"},"\u{1F4F1} Add Device",-1)),we={class:"q-mt-lg"},qe=S(()=>n("div",null,"UUID",-1)),Ve={class:"q-mt-md"},xe=S(()=>n("div",null,"Name",-1)),ke={class:"q-mt-md"},$e=S(()=>n("div",null,"Model",-1)),Se={class:"q-mt-md"},Ue=S(()=>n("div",null,"OS Version",-1)),Qe={class:"q-gutter-x-lg"},Ce={key:0,class:"q-mt-md"},Ie=S(()=>n("div",null,"Designation Branch",-1)),Ne={key:0,class:"custom-list z-top"},Fe={key:1,class:"q-mt-md"},Te=S(()=>n("div",null,"Warehouse",-1)),Be={key:0,class:"custom-list z-top"},ze={__name:"AddDevice",setup(i){const v=j(),_=ge(),m=fe(),g=E(()=>_.branch),f=E(()=>m.warehouse),o=p(!1),y=p(!1),u=p(""),c=p(""),a=p(!1),s=p(!1),h=p(null),b=Z({uuid:"",name:"",model:"",os_version:"",reference_id:"",designation:""});ee(h,w=>{b.designation=w});const se=()=>{o.value=!0},ne=async()=>{u.value.trim()&&await _.search(u.value)},ie=w=>{b.reference_id=w.id,u.value=w.name,a.value=!1},de=async()=>{c.value.trim()&&await m.search(c.value)},re=w=>{b.reference_id=w.id,c.value=w.name,a.value=!1},ue=async()=>{console.log("deviceForm",b);try{y.value=!0;const w=await v.createDevices(b);console.log("reponse",w),o.value=!1}catch(w){console.log(w)}finally{y.value=!1}};return(w,r)=>(d(),D("div",null,[e(V,{outline:"",icon:"add_circle",label:"Add Device",onClick:se,style:{"background-color":"#ef4444"}}),e(R,{modelValue:o.value,"onUpdate:modelValue":r[10]||(r[10]=l=>o.value=l),persistent:"","transition-show":"jump-up","transition-hide":"jump-down"},{default:t(()=>[e(C,{class:"my-card q-pa-none",style:{width:"420px","border-radius":"16px","box-shadow":"0 12px 24px rgba(0, 0, 0, 0.2)"}},{default:t(()=>[e(k,{class:"row items-center q-px-md q-py-sm bg-gradient text-white"},{default:t(()=>[De,e(ae),F(e(V,{icon:"close",flat:"",dense:"",round:""},null,512),[[B]])]),_:1}),e(k,{class:"q-px-xl q-pt-none q-pb-lg"},{default:t(()=>[n("div",we,[qe,e(q,{modelValue:b.uuid,"onUpdate:modelValue":r[0]||(r[0]=l=>b.uuid=l),outlined:"",dense:"",rules:[l=>l&&l.length>0||"Device UUID is required"]},null,8,["modelValue","rules"])]),n("div",Ve,[xe,e(q,{class:"text-capitalize",modelValue:b.name,"onUpdate:modelValue":r[1]||(r[1]=l=>b.name=l),outlined:"",dense:"",rules:[l=>l&&l.length>0||"Device Name is required"]},null,8,["modelValue","rules"])]),n("div",ke,[$e,e(q,{modelValue:b.model,"onUpdate:modelValue":r[2]||(r[2]=l=>b.model=l),outlined:"",dense:"",rules:[l=>l&&l.length>0||"Device Model is required"]},null,8,["modelValue","rules"])]),n("div",Se,[Ue,e(q,{modelValue:b.os_version,"onUpdate:modelValue":r[3]||(r[3]=l=>b.os_version=l),outlined:"",dense:"",rules:[l=>l&&l.length>0||"Device OS Version is required"]},null,8,["modelValue","rules"])]),n("div",Qe,[e(K,{"keep-color":"",modelValue:h.value,"onUpdate:modelValue":r[4]||(r[4]=l=>h.value=l),label:"Branch",color:"red","true-value":"branch","false-value":null},null,8,["modelValue"]),e(K,{"keep-color":"",modelValue:h.value,"onUpdate:modelValue":r[5]||(r[5]=l=>h.value=l),label:"Warehouse",color:"blue-grey-10","true-value":"warehouse","false-value":null},null,8,["modelValue"])]),h.value==="branch"?(d(),D("div",Ce,[Ie,e(q,{modelValue:u.value,"onUpdate:modelValue":[r[6]||(r[6]=l=>u.value=l),ne],outlined:"",dense:"",debounce:"500",onFocus:r[7]||(r[7]=l=>a.value=!0)},{append:t(()=>[s.value?(d(),x(J,{key:1,color:"grey",size:"sm"})):(d(),x(M,{key:0,name:"search"}))]),default:t(()=>[a.value&&u.value?(d(),D("div",Ne,[e(C,null,{default:t(()=>[e(X,{separator:""},{default:t(()=>{var l;return[(l=g.value)!=null&&l.length?U("",!0):(d(),x(P,{key:0},{default:t(()=>[Q("No Branch Record")]),_:1})),(d(!0),D(T,null,G(g.value,$=>(d(),x(P,{key:$.id,clickable:"",onClick:ce=>ie($)},{default:t(()=>[e(Y,null,{default:t(()=>[Q(H($.name),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]}),_:1})]),_:1})])):U("",!0)]),_:1},8,["modelValue"])])):U("",!0),h.value==="warehouse"?(d(),D("div",Fe,[Te,e(q,{modelValue:c.value,"onUpdate:modelValue":[r[8]||(r[8]=l=>c.value=l),de],outlined:"",dense:"",debounce:"500",onFocus:r[9]||(r[9]=l=>a.value=!0)},{append:t(()=>[s.value?(d(),x(J,{key:1,color:"grey",size:"sm"})):(d(),x(M,{key:0,name:"search"}))]),default:t(()=>[a.value&&c.value?(d(),D("div",Be,[e(C,null,{default:t(()=>[e(X,{separator:""},{default:t(()=>{var l;return[(l=f.value)!=null&&l.length?U("",!0):(d(),x(P,{key:0},{default:t(()=>[Q("No Warehouse Record")]),_:1})),(d(!0),D(T,null,G(f.value,$=>(d(),x(P,{key:$.id,onClick:ce=>re($),clickable:""},{default:t(()=>[e(Y,null,{default:t(()=>[Q(H($.name),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]}),_:1})]),_:1})])):U("",!0)]),_:1},8,["modelValue"])])):U("",!0)]),_:1}),e(te,{class:"row q-px-lg q-py-sm q-pt-none",align:"right"},{default:t(()=>[F(e(V,{class:"btn-cancel glossy",color:"negative",label:"Dismiss"},null,512),[[B]]),e(V,{class:"btn-create glossy",color:"positive",label:"Create",onClick:ue})]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}};var Ae=z(ze,[["__scopeId","data-v-25e18a02"]]);const oe=i=>(O("data-v-1abbd28a"),i=i(),W(),i),Pe=oe(()=>n("div",{class:"text-h5 q-mb-xs"},"Confirm Deletion",-1)),Ee=oe(()=>n("p",{class:"text-body2 q-mb-none"}," Are you sure you want to delete this item? This action cannot be undone. ",-1)),Me={__name:"DeviceDelete",props:["delete"],emits:["device-deleted"],setup(i,{emit:v}){const _=j(),m=i,g=v,f=p(!1),o=()=>{f.value=!0},y=async()=>{try{await _.deleteDevice(m.delete.row.id),f.value=!1,g("device-deleted")}catch(u){console.error("Error deleting item:",u)}f.value=!1};return(u,c)=>(d(),D(T,null,[e(V,{color:"negative",icon:"delete",size:"sm",flat:"",round:"",dense:"",onClick:o},{default:t(()=>[e(le,{class:"bg-negative",delay:200},{default:t(()=>[Q("Delete")]),_:1})]),_:1}),e(R,{modelValue:f.value,"onUpdate:modelValue":c[0]||(c[0]=a=>f.value=a)},{default:t(()=>[e(C,{class:"q-pa-md q-rounded q-elevate-2 bg-white text-grey-9"},{default:t(()=>[e(k,{class:"q-pt-none q-pb-sm"},{default:t(()=>[Pe,Ee]),_:1}),e(me,{class:"q-mb-md"}),e(k,{align:"right",class:"q-pt-none"},{default:t(()=>[F(e(V,{flat:"",dense:"",label:"Cancel",color:"primary",class:"q-mr-sm"},null,512),[[B]]),e(V,{dense:"",label:"Delete",color:"negative",onClick:y,class:"q-btn-rounded q-px-lg"})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};var Oe=z(Me,[["__scopeId","data-v-1abbd28a"]]);const A=i=>(O("data-v-1abd83be"),i=i(),W(),i),We=A(()=>n("div",{class:"text-h5 q-mr-md"},"\u{1F4F1} Edit Device",-1)),je={class:"q-mt-lg q-animated q-animate-bounce"},Le=A(()=>n("div",null,"UUID",-1)),Re={class:"q-mt-md q-animated q-animate-bounce"},Ke=A(()=>n("div",null,"Name",-1)),Je={class:"q-mt-md q-animated q-animate-bounce"},Ge=A(()=>n("div",null,"Model",-1)),He={class:"q-mt-md q-animated q-animate-bounce"},Xe=A(()=>n("div",null,"OS Version",-1)),Ye={__name:"DeviceEdit",props:["edit"],emits:["device-updated"],setup(i,{emit:v}){const _=j(),m=p(!1);p(!0);const g=i,f=v,o=Z({uuid:"",name:"",model:"",os_version:""}),y=()=>{Object.assign(o,g.edit.row),m.value=!0},u=async()=>{try{const c={...g.edit.row,...o};await _.updateDevice(g.edit.row.id,c),m.value=!1,f("device-updated")}catch(c){console.log("error update device",c)}};return(c,a)=>(d(),D(T,null,[e(V,{color:"positive",icon:"edit",size:"sm",flat:"",round:"",dense:"",onClick:y},{default:t(()=>[e(le,{class:"bg-positive",delay:200},{default:t(()=>[Q("Edit")]),_:1})]),_:1}),e(R,{modelValue:m.value,"onUpdate:modelValue":a[4]||(a[4]=s=>m.value=s),persistent:"","transition-show":"jump-up","transition-hide":"jump-down"},{default:t(()=>[e(C,{class:"my-card q-pa-none",style:{width:"420px","border-radius":"16px","box-shadow":"0 12px 24px rgba(0, 0, 0, 0.2)"}},{default:t(()=>[e(k,{class:"row items-center q-px-md q-py-sm bg-gradient text-white"},{default:t(()=>[We,e(ae),F(e(V,{icon:"close",flat:"",dense:"",round:""},null,512),[[B]])]),_:1}),e(k,{class:"q-px-xl q-pt-none q-pb-lg"},{default:t(()=>[n("div",je,[Le,e(q,{modelValue:o.uuid,"onUpdate:modelValue":a[0]||(a[0]=s=>o.uuid=s),outlined:"",dense:"",rules:[s=>s&&s.length>0||"Device UUID is required"]},null,8,["modelValue","rules"])]),n("div",Re,[Ke,e(q,{modelValue:o.name,"onUpdate:modelValue":a[1]||(a[1]=s=>o.name=s),outlined:"",dense:"",rules:[s=>s&&s.length>0||"Device Name is required"]},null,8,["modelValue","rules"])]),n("div",Je,[Ge,e(q,{modelValue:o.model,"onUpdate:modelValue":a[2]||(a[2]=s=>o.model=s),outlined:"",dense:"",rules:[s=>s&&s.length>0||"Device Model is required"]},null,8,["modelValue","rules"])]),n("div",He,[Xe,e(q,{modelValue:o.os_version,"onUpdate:modelValue":a[3]||(a[3]=s=>o.os_version=s),outlined:"",dense:"",rules:[s=>s&&s.length>0||"Device OS Version is required"]},null,8,["modelValue","rules"])])]),_:1}),e(te,{class:"row q-px-lg q-py-sm q-pt-none",align:"right"},{default:t(()=>[F(e(V,{class:"btn-cancel glossy",color:"negative",label:"Dismiss"},null,512),[[B]]),e(V,{class:"btn-create glossy",color:"positive",label:"Save",onClick:u})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};var Ze=z(Ye,[["__scopeId","data-v-1abd83be"]]);const et=i=>(O("data-v-88baa852"),i=i(),W(),i),tt={key:0,class:"spinner-wrapper"},at={key:1},lt={key:0,class:"data-error"},ot=et(()=>n("div",{class:"q-ml-sm text-h6"},"No data available",-1)),st={class:"row justify-center q-gutter-x-md"},nt={__name:"DeviceTable",setup(i){const v=j(),_=p(""),m=p(!0),g=E(()=>v.devices),f=p(!1),o=p({rowPerPage:0}),y=E(()=>_.value?g.value.filter(a=>(a.name||"").toLowerCase().includes(_.value.toLowerCase())):g.value);pe(async()=>{const a=await u();console.log("response device",a)});const u=async()=>{try{m.value=!0;const a=await v.fetchDevices();g.value.length||(f.value=!0),console.log("device fetch:",g.value)}catch(a){console.log("error fetching device",a),f.value=!0}finally{m.value=!1}};ee(_,async a=>{m.value=!0,await new Promise(s=>setTimeout(s,1e3)),m.value=!1,f.value=y.value.length===0});const c=[{name:"name",label:"Name",align:"center",field:"name",format:a=>`${a}`,sortable:!0},{name:"model",label:"Model",align:"center",field:"model"},{name:"os_version",label:"OS Version",align:"center",field:"os_version"},{name:"uuid",label:"UUID",align:"center",field:"uuid"},{name:"designation",label:"Designation",align:"center",field:a=>a.branch?a.branch.name:a.warehouse?a.warehouse.name:"N/A"},{name:"action",label:"Action",align:"center",field:"action"}];return(a,s)=>(d(),D(T,null,[n("div",null,[e(q,{modelValue:_.value,"onUpdate:modelValue":s[0]||(s[0]=h=>_.value=h),class:"q-pb-lg q-pl-sm dynamic-width",outlined:"",placeholder:"search",flat:"",rounded:"",dense:"",debounce:"100"},{append:t(()=>[e(M,{name:"search"})]),_:1},8,["modelValue"])]),m.value?(d(),D("div",tt,[e(he,{size:"50px",color:"primary"})])):(d(),D("div",at,[y.value.length===0?(d(),D("div",lt,[e(M,{name:"warning",color:"warning",size:"4em"}),ot])):(d(),x(be,{key:1,class:"table-container elegant-container sticky-header",filter:_.value,"virtual-scroll-sticky-size-start":48,flat:"",style:{height:"400px"},columns:c,rows:g.value,"row-key":"name","virtual-scroll":"",pagination:o.value,"onUpdate:pagination":s[1]||(s[1]=h=>o.value=h),"rows-per-page-options":[0],"hide-bottom":""},{"body-cell-action":t(h=>[e(ye,{props:h},{default:t(()=>[n("div",st,[e(Ze,{edit:h,onDeviceUpdated:u},null,8,["edit"]),e(Oe,{delete:h,onDeviceDeleted:u},null,8,["delete"])])]),_:2},1032,["props"])]),_:1},8,["filter","rows","pagination"]))]))],64))}};var it=z(nt,[["__scopeId","data-v-88baa852"]]);const dt={align:"right"},rt={__name:"DevicesPage",setup(i){return(v,_)=>(d(),x(_e,null,{default:t(()=>[e(C,{class:"elegant-container",flat:""},{default:t(()=>[e(k,null,{default:t(()=>[n("div",dt,[e(Ae)])]),_:1}),e(k,null,{default:t(()=>[e(it)]),_:1})]),_:1})]),_:1}))}};var Qt=z(rt,[["__scopeId","data-v-bc8265ea"]]);export{Qt as default};
