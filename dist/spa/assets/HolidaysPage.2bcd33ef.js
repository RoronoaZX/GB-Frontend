import{c,g as It,aP as Ot,a8 as Nt,aa as jt,by as Tt,r as q,b4 as Ft,u as se,j as i,at as ve,k as Bt,l as Qt,bz as Et,G as rt,M as N,d as Rt,N as fe,t as At,o as z,a3 as ye,f as u,w as g,a2 as mt,Q as He,ae as he,I as qe,J as k,L as Ae,$ as U,aI as zt,K as st,P as Me,bA as Lt,e as ie,a0 as L,a1 as ze,O as Ut,R as Pt,z as Wt,aK as it,bc as Jt,bd as Kt,a5 as Gt,a4 as Xt}from"./index.e5795df4.js";import{u as Zt}from"./use-render-cache.3aae9b27.js";import{t as ea,a as ut,f as ta,g as aa,j as Be,_ as la}from"./date.f66dc3ea.js";import{p as ee}from"./selection.f114dc12.js";import{Q as oa,a as Qe,b as me}from"./QMenu.6ef38b83.js";import{Q as dt}from"./QList.0a117bee.js";import{Q as na,a as Ee}from"./QSelect.7cf2275b.js";import{Q as ra}from"./QScrollArea.9533213a.js";import{Q as sa}from"./QPage.fff4e795.js";import{C as ge}from"./ClosePopup.1e023d57.js";import{api as we}from"./axios.f42c3627.js";import{Q as ia}from"./QPopupProxy.023013dd.js";import{Q as ua}from"./QForm.23a3bd83.js";import{_ as Le}from"./plugin-vue_export-helper.21dcd24c.js";import"./position-engine.9614e285.js";import"./QChip.5d2a10d5.js";import"./use-virtual-scroll.8c1ede6a.js";import"./rtl.276c3f1b.js";import"./QResizeObserver.b8b8bf95.js";import"./QScrollObserver.43d81205.js";import"./TouchPan.70c892cd.js";import"./touch.9135741d.js";const da=["gregorian","persian"],ct={mask:{type:String},locale:Object,calendar:{type:String,validator:l=>da.includes(l),default:"gregorian"},landscape:Boolean,color:String,textColor:String,square:Boolean,flat:Boolean,bordered:Boolean,readonly:Boolean,disable:Boolean},ca=["update:modelValue"];function J(l){return l.year+"/"+ee(l.month)+"/"+ee(l.day)}function va(l,I){const M=c(()=>l.disable!==!0&&l.readonly!==!0),w=c(()=>M.value===!0?0:-1),S=c(()=>{const m=[];return l.color!==void 0&&m.push(`bg-${l.color}`),l.textColor!==void 0&&m.push(`text-${l.textColor}`),m.join(" ")});function V(){return l.locale!==void 0?{...I.lang.date,...l.locale}:I.lang.date}function h(m){const H=new Date,Y=m===!0?null:0;if(l.calendar==="persian"){const v=ea(H);return{year:v.jy,month:v.jm,day:v.jd}}return{year:H.getFullYear(),month:H.getMonth()+1,day:H.getDate(),hour:Y,minute:Y,second:Y,millisecond:Y}}return{editable:M,tabindex:w,headerClass:S,getLocale:V,getCurrentDate:h}}const Z=20,ma=["Calendar","Years","Months"],vt=l=>ma.includes(l),Re=l=>/^-?[\d]+\/[0-1]\d$/.test(l),re=" \u2014 ";function K(l){return l.year+"/"+ee(l.month)}var ft=It({name:"QDate",props:{...ct,...Ot,...Nt,modelValue:{required:!0,validator:l=>typeof l=="string"||Array.isArray(l)===!0||Object(l)===l||l===null},multiple:Boolean,range:Boolean,title:String,subtitle:String,mask:{...ct.mask,default:"YYYY/MM/DD"},defaultYearMonth:{type:String,validator:Re},yearsInMonthView:Boolean,events:[Array,Function],eventColor:[String,Function],emitImmediately:Boolean,options:[Array,Function],navigationMinYearMonth:{type:String,validator:Re},navigationMaxYearMonth:{type:String,validator:Re},noUnset:Boolean,firstDayOfWeek:[String,Number],todayBtn:Boolean,minimal:Boolean,defaultView:{type:String,default:"Calendar",validator:vt}},emits:[...ca,"rangeStart","rangeEnd","navigation"],setup(l,{slots:I,emit:M}){const{proxy:w}=Qt(),{$q:S}=w,V=jt(l,S),{getCache:h}=Zt(),{tabindex:m,headerClass:H,getLocale:Y,getCurrentDate:v}=va(l,S);let x;const O=Tt(l),E=Et(O),$=q(null),C=q(Ze()),f=q(Y()),Ce=c(()=>Ze()),ke=c(()=>Y()),R=c(()=>v()),s=q(et(C.value,f.value)),_=q(l.defaultView),b=c(()=>S.lang.rtl===!0?"right":"left"),y=q(b.value),B=q(b.value),P=s.value.year,te=q(P-P%Z-(P<0?Z:0)),j=q(null),Se=c(()=>{const e=l.landscape===!0?"landscape":"portrait";return`q-date q-date--${e} q-date--${e}-${l.minimal===!0?"minimal":"standard"}`+(V.value===!0?" q-date--dark q-dark":"")+(l.bordered===!0?" q-date--bordered":"")+(l.square===!0?" q-date--square no-border-radius":"")+(l.flat===!0?" q-date--flat no-shadow":"")+(l.disable===!0?" disabled":l.readonly===!0?" q-date--readonly":"")}),G=c(()=>l.color||"primary"),ae=c(()=>l.textColor||"white"),_e=c(()=>l.emitImmediately===!0&&l.multiple!==!0&&l.range!==!0),Ve=c(()=>Array.isArray(l.modelValue)===!0?l.modelValue:l.modelValue!==null&&l.modelValue!==void 0?[l.modelValue]:[]),A=c(()=>Ve.value.filter(e=>typeof e=="string").map(e=>Oe(e,C.value,f.value)).filter(e=>e.dateHash!==null&&e.day!==null&&e.month!==null&&e.year!==null)),le=c(()=>{const e=t=>Oe(t,C.value,f.value);return Ve.value.filter(t=>Ft(t)===!0&&t.from!==void 0&&t.to!==void 0).map(t=>({from:e(t.from),to:e(t.to)})).filter(t=>t.from.dateHash!==null&&t.to.dateHash!==null&&t.from.dateHash<t.to.dateHash)}),pe=c(()=>l.calendar!=="persian"?e=>new Date(e.year,e.month-1,e.day):e=>{const t=ut(e.year,e.month,e.day);return new Date(t.gy,t.gm-1,t.gd)}),$e=c(()=>l.calendar==="persian"?J:(e,t,a)=>ta(new Date(e.year,e.month-1,e.day,e.hour,e.minute,e.second,e.millisecond),t===void 0?C.value:t,a===void 0?f.value:a,e.year,e.timezoneOffset)),ue=c(()=>A.value.length+le.value.reduce((e,t)=>e+1+aa(pe.value(t.to),pe.value(t.from)),0)),Pe=c(()=>{if(l.title!==void 0&&l.title!==null&&l.title.length!==0)return l.title;if(j.value!==null){const a=j.value.init,o=pe.value(a);return f.value.daysShort[o.getDay()]+", "+f.value.monthsShort[a.month-1]+" "+a.day+re+"?"}if(ue.value===0)return re;if(ue.value>1)return`${ue.value} ${f.value.pluralDay}`;const e=A.value[0],t=pe.value(e);return isNaN(t.valueOf())===!0?re:f.value.headerTitle!==void 0?f.value.headerTitle(t,e):f.value.daysShort[t.getDay()]+", "+f.value.monthsShort[e.month-1]+" "+e.day}),yt=c(()=>A.value.concat(le.value.map(t=>t.from)).sort((t,a)=>t.year-a.year||t.month-a.month)[0]),ht=c(()=>A.value.concat(le.value.map(t=>t.to)).sort((t,a)=>a.year-t.year||a.month-t.month)[0]),We=c(()=>{if(l.subtitle!==void 0&&l.subtitle!==null&&l.subtitle.length!==0)return l.subtitle;if(ue.value===0)return re;if(ue.value>1){const e=yt.value,t=ht.value,a=f.value.monthsShort;return a[e.month-1]+(e.year!==t.year?" "+e.year+re+a[t.month-1]+" ":e.month!==t.month?re+a[t.month-1]:"")+" "+t.year}return A.value[0].year}),be=c(()=>{const e=[S.iconSet.datetime.arrowLeft,S.iconSet.datetime.arrowRight];return S.lang.rtl===!0?e.reverse():e}),Je=c(()=>l.firstDayOfWeek!==void 0?Number(l.firstDayOfWeek):f.value.firstDayOfWeek),gt=c(()=>{const e=f.value.daysShort,t=Je.value;return t>0?e.slice(t,7).concat(e.slice(0,t)):e}),W=c(()=>{const e=s.value;return l.calendar!=="persian"?new Date(e.year,e.month,0).getDate():Be(e.year,e.month)}),_t=c(()=>typeof l.eventColor=="function"?l.eventColor:()=>l.eventColor),T=c(()=>{if(l.navigationMinYearMonth===void 0)return null;const e=l.navigationMinYearMonth.split("/");return{year:parseInt(e[0],10),month:parseInt(e[1],10)}}),F=c(()=>{if(l.navigationMaxYearMonth===void 0)return null;const e=l.navigationMaxYearMonth.split("/");return{year:parseInt(e[0],10),month:parseInt(e[1],10)}}),Ye=c(()=>{const e={month:{prev:!0,next:!0},year:{prev:!0,next:!0}};return T.value!==null&&T.value.year>=s.value.year&&(e.year.prev=!1,T.value.year===s.value.year&&T.value.month>=s.value.month&&(e.month.prev=!1)),F.value!==null&&F.value.year<=s.value.year&&(e.year.next=!1,F.value.year===s.value.year&&F.value.month<=s.value.month&&(e.month.next=!1)),e}),xe=c(()=>{const e={};return A.value.forEach(t=>{const a=K(t);e[a]===void 0&&(e[a]=[]),e[a].push(t.day)}),e}),Ke=c(()=>{const e={};return le.value.forEach(t=>{const a=K(t.from),o=K(t.to);if(e[a]===void 0&&(e[a]=[]),e[a].push({from:t.from.day,to:a===o?t.to.day:void 0,range:t}),a<o){let n;const{year:p,month:r}=t.from,d=r<12?{year:p,month:r+1}:{year:p+1,month:1};for(;(n=K(d))<=o;)e[n]===void 0&&(e[n]=[]),e[n].push({from:void 0,to:n===o?t.to.day:void 0,range:t}),d.month++,d.month>12&&(d.year++,d.month=1)}}),e}),de=c(()=>{if(j.value===null)return;const{init:e,initHash:t,final:a,finalHash:o}=j.value,[n,p]=t<=o?[e,a]:[a,e],r=K(n),d=K(p);if(r!==Q.value&&d!==Q.value)return;const D={};return r===Q.value?(D.from=n.day,D.includeFrom=!0):D.from=1,d===Q.value?(D.to=p.day,D.includeTo=!0):D.to=W.value,D}),Q=c(()=>K(s.value)),pt=c(()=>{const e={};if(l.options===void 0){for(let a=1;a<=W.value;a++)e[a]=!0;return e}const t=typeof l.options=="function"?l.options:a=>l.options.includes(a);for(let a=1;a<=W.value;a++){const o=Q.value+"/"+ee(a);e[a]=t(o)}return e}),bt=c(()=>{const e={};if(l.events===void 0)for(let t=1;t<=W.value;t++)e[t]=!1;else{const t=typeof l.events=="function"?l.events:a=>l.events.includes(a);for(let a=1;a<=W.value;a++){const o=Q.value+"/"+ee(a);e[a]=t(o)===!0&&_t.value(o)}}return e}),xt=c(()=>{let e,t;const{year:a,month:o}=s.value;if(l.calendar!=="persian")e=new Date(a,o-1,1),t=new Date(a,o-1,0).getDate();else{const n=ut(a,o,1);e=new Date(n.gy,n.gm-1,n.gd);let p=o-1,r=a;p===0&&(p=12,r--),t=Be(r,p)}return{days:e.getDay()-Je.value-1,endDay:t}}),Ge=c(()=>{const e=[],{days:t,endDay:a}=xt.value,o=t<0?t+7:t;if(o<6)for(let r=a-o;r<=a;r++)e.push({i:r,fill:!0});const n=e.length;for(let r=1;r<=W.value;r++){const d={i:r,event:bt.value[r],classes:[]};pt.value[r]===!0&&(d.in=!0,d.flat=!0),e.push(d)}if(xe.value[Q.value]!==void 0&&xe.value[Q.value].forEach(r=>{const d=n+r-1;Object.assign(e[d],{selected:!0,unelevated:!0,flat:!1,color:G.value,textColor:ae.value})}),Ke.value[Q.value]!==void 0&&Ke.value[Q.value].forEach(r=>{if(r.from!==void 0){const d=n+r.from-1,D=n+(r.to||W.value)-1;for(let ce=d;ce<=D;ce++)Object.assign(e[ce],{range:r.range,unelevated:!0,color:G.value,textColor:ae.value});Object.assign(e[d],{rangeFrom:!0,flat:!1}),r.to!==void 0&&Object.assign(e[D],{rangeTo:!0,flat:!1})}else if(r.to!==void 0){const d=n+r.to-1;for(let D=n;D<=d;D++)Object.assign(e[D],{range:r.range,unelevated:!0,color:G.value,textColor:ae.value});Object.assign(e[d],{flat:!1,rangeTo:!0})}else{const d=n+W.value-1;for(let D=n;D<=d;D++)Object.assign(e[D],{range:r.range,unelevated:!0,color:G.value,textColor:ae.value})}}),de.value!==void 0){const r=n+de.value.from-1,d=n+de.value.to-1;for(let D=r;D<=d;D++)e[D].color=G.value,e[D].editRange=!0;de.value.includeFrom===!0&&(e[r].editRangeFrom=!0),de.value.includeTo===!0&&(e[d].editRangeTo=!0)}s.value.year===R.value.year&&s.value.month===R.value.month&&(e[n+R.value.day-1].today=!0);const p=e.length%7;if(p>0){const r=7-p;for(let d=1;d<=r;d++)e.push({i:d,fill:!0})}return e.forEach(r=>{let d="q-date__calendar-item ";r.fill===!0?d+="q-date__calendar-item--fill":(d+=`q-date__calendar-item--${r.in===!0?"in":"out"}`,r.range!==void 0&&(d+=` q-date__range${r.rangeTo===!0?"-to":r.rangeFrom===!0?"-from":""}`),r.editRange===!0&&(d+=` q-date__edit-range${r.editRangeFrom===!0?"-from":""}${r.editRangeTo===!0?"-to":""}`),(r.range!==void 0||r.editRange===!0)&&(d+=` text-${r.color}`)),r.classes=d}),e}),Dt=c(()=>l.disable===!0?{"aria-disabled":"true"}:{});se(()=>l.modelValue,e=>{if(x===e)x=0;else{const t=et(C.value,f.value);oe(t.year,t.month,t)}}),se(_,()=>{$.value!==null&&w.$el.contains(document.activeElement)===!0&&$.value.focus()}),se(()=>s.value.year+"|"+s.value.month,()=>{M("navigation",{year:s.value.year,month:s.value.month})}),se(Ce,e=>{nt(e,f.value,"mask"),C.value=e}),se(ke,e=>{nt(C.value,e,"locale"),f.value=e});function Xe(){const{year:e,month:t,day:a}=R.value,o={...s.value,year:e,month:t,day:a},n=xe.value[K(o)];(n===void 0||n.includes(o.day)===!1)&&je(o),Ie(o.year,o.month)}function wt(e){vt(e)===!0&&(_.value=e)}function Ht(e,t){["month","year"].includes(e)&&(e==="month"?at:Ne)(t===!0?-1:1)}function Ie(e,t){_.value="Calendar",oe(e,t)}function qt(e,t){if(l.range===!1||!e){j.value=null;return}const a=Object.assign({...s.value},e),o=t!==void 0?Object.assign({...s.value},t):a;j.value={init:a,initHash:J(a),final:o,finalHash:J(o)},Ie(a.year,a.month)}function Ze(){return l.calendar==="persian"?"YYYY/MM/DD":l.mask}function Oe(e,t,a){return la(e,t,a,l.calendar,{hour:0,minute:0,second:0,millisecond:0})}function et(e,t){const a=Array.isArray(l.modelValue)===!0?l.modelValue:l.modelValue?[l.modelValue]:[];if(a.length===0)return tt();const o=a[a.length-1],n=Oe(o.from!==void 0?o.from:o,e,t);return n.dateHash===null?tt():n}function tt(){let e,t;if(l.defaultYearMonth!==void 0){const a=l.defaultYearMonth.split("/");e=parseInt(a[0],10),t=parseInt(a[1],10)}else{const a=R.value!==void 0?R.value:v();e=a.year,t=a.month}return{year:e,month:t,day:1,hour:0,minute:0,second:0,millisecond:0,dateHash:e+"/"+ee(t)+"/01"}}function at(e){let t=s.value.year,a=Number(s.value.month)+e;a===13?(a=1,t++):a===0&&(a=12,t--),oe(t,a),_e.value===!0&&De("month")}function Ne(e){const t=Number(s.value.year)+e;oe(t,s.value.month),_e.value===!0&&De("year")}function Mt(e){oe(e,s.value.month),_.value=l.defaultView==="Years"?"Months":"Calendar",_e.value===!0&&De("year")}function Ct(e){oe(s.value.year,e),_.value="Calendar",_e.value===!0&&De("month")}function kt(e,t){const a=xe.value[t];(a!==void 0&&a.includes(e.day)===!0?Te:je)(e)}function X(e){return{year:e.year,month:e.month,day:e.day}}function oe(e,t,a){if(T.value!==null&&e<=T.value.year&&((t<T.value.month||e<T.value.year)&&(t=T.value.month),e=T.value.year),F.value!==null&&e>=F.value.year&&((t>F.value.month||e>F.value.year)&&(t=F.value.month),e=F.value.year),a!==void 0){const{hour:n,minute:p,second:r,millisecond:d,timezoneOffset:D,timeHash:ce}=a;Object.assign(s.value,{hour:n,minute:p,second:r,millisecond:d,timezoneOffset:D,timeHash:ce})}const o=e+"/"+ee(t)+"/01";o!==s.value.dateHash&&(y.value=s.value.dateHash<o==(S.lang.rtl!==!0)?"left":"right",e!==s.value.year&&(B.value=y.value),rt(()=>{te.value=e-e%Z-(e<0?Z:0),Object.assign(s.value,{year:e,month:t,day:1,dateHash:o})}))}function lt(e,t,a){const o=e!==null&&e.length===1&&l.multiple===!1?e[0]:e;x=o;const{reason:n,details:p}=ot(t,a);M("update:modelValue",o,n,p)}function De(e){const t=A.value[0]!==void 0&&A.value[0].dateHash!==null?{...A.value[0]}:{...s.value};rt(()=>{t.year=s.value.year,t.month=s.value.month;const a=l.calendar!=="persian"?new Date(t.year,t.month,0).getDate():Be(t.year,t.month);t.day=Math.min(Math.max(1,t.day),a);const o=ne(t);x=o;const{details:n}=ot("",t);M("update:modelValue",o,e,n)})}function ot(e,t){return t.from!==void 0?{reason:`${e}-range`,details:{...X(t.target),from:X(t.from),to:X(t.to)}}:{reason:`${e}-day`,details:X(t)}}function ne(e,t,a){return e.from!==void 0?{from:$e.value(e.from,t,a),to:$e.value(e.to,t,a)}:$e.value(e,t,a)}function je(e){let t;if(l.multiple===!0)if(e.from!==void 0){const a=J(e.from),o=J(e.to),n=A.value.filter(r=>r.dateHash<a||r.dateHash>o),p=le.value.filter(({from:r,to:d})=>d.dateHash<a||r.dateHash>o);t=n.concat(p).concat(e).map(r=>ne(r))}else{const a=Ve.value.slice();a.push(ne(e)),t=a}else t=ne(e);lt(t,"add",e)}function Te(e){if(l.noUnset===!0)return;let t=null;if(l.multiple===!0&&Array.isArray(l.modelValue)===!0){const a=ne(e);e.from!==void 0?t=l.modelValue.filter(o=>o.from!==void 0?o.from!==a.from&&o.to!==a.to:!0):t=l.modelValue.filter(o=>o!==a),t.length===0&&(t=null)}lt(t,"remove",e)}function nt(e,t,a){const o=A.value.concat(le.value).map(n=>ne(n,e,t)).filter(n=>n.from!==void 0?n.from.dateHash!==null&&n.to.dateHash!==null:n.dateHash!==null);M("update:modelValue",(l.multiple===!0?o:o[0])||null,a)}function St(){if(l.minimal!==!0)return i("div",{class:"q-date__header "+H.value},[i("div",{class:"relative-position"},[i(ve,{name:"q-transition--fade"},()=>i("div",{key:"h-yr-"+We.value,class:"q-date__header-subtitle q-date__header-link "+(_.value==="Years"?"q-date__header-link--active":"cursor-pointer"),tabindex:m.value,...h("vY",{onClick(){_.value="Years"},onKeyup(e){e.keyCode===13&&(_.value="Years")}})},[We.value]))]),i("div",{class:"q-date__header-title relative-position flex no-wrap"},[i("div",{class:"relative-position col"},[i(ve,{name:"q-transition--fade"},()=>i("div",{key:"h-sub"+Pe.value,class:"q-date__header-title-label q-date__header-link "+(_.value==="Calendar"?"q-date__header-link--active":"cursor-pointer"),tabindex:m.value,...h("vC",{onClick(){_.value="Calendar"},onKeyup(e){e.keyCode===13&&(_.value="Calendar")}})},[Pe.value]))]),l.todayBtn===!0?i(N,{class:"q-date__header-today self-start",icon:S.iconSet.datetime.today,flat:!0,size:"sm",round:!0,tabindex:m.value,onClick:Xe}):null])])}function Fe({label:e,type:t,key:a,dir:o,goTo:n,boundaries:p,cls:r}){return[i("div",{class:"row items-center q-date__arrow"},[i(N,{round:!0,dense:!0,size:"sm",flat:!0,icon:be.value[0],tabindex:m.value,disable:p.prev===!1,...h("go-#"+t,{onClick(){n(-1)}})})]),i("div",{class:"relative-position overflow-hidden flex flex-center"+r},[i(ve,{name:"q-transition--jump-"+o},()=>i("div",{key:a},[i(N,{flat:!0,dense:!0,noCaps:!0,label:e,tabindex:m.value,...h("view#"+t,{onClick:()=>{_.value=t}})})]))]),i("div",{class:"row items-center q-date__arrow"},[i(N,{round:!0,dense:!0,size:"sm",flat:!0,icon:be.value[1],tabindex:m.value,disable:p.next===!1,...h("go+#"+t,{onClick(){n(1)}})})])]}const Vt={Calendar:()=>[i("div",{key:"calendar-view",class:"q-date__view q-date__calendar"},[i("div",{class:"q-date__navigation row items-center no-wrap"},Fe({label:f.value.months[s.value.month-1],type:"Months",key:s.value.month,dir:y.value,goTo:at,boundaries:Ye.value.month,cls:" col"}).concat(Fe({label:s.value.year,type:"Years",key:s.value.year,dir:B.value,goTo:Ne,boundaries:Ye.value.year,cls:""}))),i("div",{class:"q-date__calendar-weekdays row items-center no-wrap"},gt.value.map(e=>i("div",{class:"q-date__calendar-item"},[i("div",e)]))),i("div",{class:"q-date__calendar-days-container relative-position overflow-hidden"},[i(ve,{name:"q-transition--slide-"+y.value},()=>i("div",{key:Q.value,class:"q-date__calendar-days fit"},Ge.value.map(e=>i("div",{class:e.classes},[e.in===!0?i(N,{class:e.today===!0?"q-date__today":"",dense:!0,flat:e.flat,unelevated:e.unelevated,color:e.color,textColor:e.textColor,label:e.i,tabindex:m.value,...h("day#"+e.i,{onClick:()=>{$t(e.i)},onMouseover:()=>{Yt(e.i)}})},e.event!==!1?()=>i("div",{class:"q-date__event bg-"+e.event}):null):i("div",""+e.i)]))))])])],Months(){const e=s.value.year===R.value.year,t=o=>T.value!==null&&s.value.year===T.value.year&&T.value.month>o||F.value!==null&&s.value.year===F.value.year&&F.value.month<o,a=f.value.monthsShort.map((o,n)=>{const p=s.value.month===n+1;return i("div",{class:"q-date__months-item flex flex-center"},[i(N,{class:e===!0&&R.value.month===n+1?"q-date__today":null,flat:p!==!0,label:o,unelevated:p,color:p===!0?G.value:null,textColor:p===!0?ae.value:null,tabindex:m.value,disable:t(n+1),...h("month#"+n,{onClick:()=>{Ct(n+1)}})})])});return l.yearsInMonthView===!0&&a.unshift(i("div",{class:"row no-wrap full-width"},[Fe({label:s.value.year,type:"Years",key:s.value.year,dir:B.value,goTo:Ne,boundaries:Ye.value.year,cls:" col"})])),i("div",{key:"months-view",class:"q-date__view q-date__months flex flex-center"},a)},Years(){const e=te.value,t=e+Z,a=[],o=n=>T.value!==null&&T.value.year>n||F.value!==null&&F.value.year<n;for(let n=e;n<=t;n++){const p=s.value.year===n;a.push(i("div",{class:"q-date__years-item flex flex-center"},[i(N,{key:"yr"+n,class:R.value.year===n?"q-date__today":null,flat:!p,label:n,dense:!0,unelevated:p,color:p===!0?G.value:null,textColor:p===!0?ae.value:null,tabindex:m.value,disable:o(n),...h("yr#"+n,{onClick:()=>{Mt(n)}})})]))}return i("div",{class:"q-date__view q-date__years flex flex-center"},[i("div",{class:"col-auto"},[i(N,{round:!0,dense:!0,flat:!0,icon:be.value[0],tabindex:m.value,disable:o(e),...h("y-",{onClick:()=>{te.value-=Z}})})]),i("div",{class:"q-date__years-content col self-stretch row items-center"},a),i("div",{class:"col-auto"},[i(N,{round:!0,dense:!0,flat:!0,icon:be.value[1],tabindex:m.value,disable:o(t),...h("y+",{onClick:()=>{te.value+=Z}})})])])}};function $t(e){const t={...s.value,day:e};if(l.range===!1){kt(t,Q.value);return}if(j.value===null){const a=Ge.value.find(n=>n.fill!==!0&&n.i===e);if(l.noUnset!==!0&&a.range!==void 0){Te({target:t,from:a.range.from,to:a.range.to});return}if(a.selected===!0){Te(t);return}const o=J(t);j.value={init:t,initHash:o,final:t,finalHash:o},M("rangeStart",X(t))}else{const a=j.value.initHash,o=J(t),n=a<=o?{from:j.value.init,to:t}:{from:t,to:j.value.init};j.value=null,je(a===o?t:{target:t,...n}),M("rangeEnd",{from:X(n.from),to:X(n.to)})}}function Yt(e){if(j.value!==null){const t={...s.value,day:e};Object.assign(j.value,{final:t,finalHash:J(t)})}}return Object.assign(w,{setToday:Xe,setView:wt,offsetCalendar:Ht,setCalendarTo:Ie,setEditingRange:qt}),()=>{const e=[i("div",{class:"q-date__content col relative-position"},[i(ve,{name:"q-transition--fade"},Vt[_.value])])],t=Bt(I.default);return t!==void 0&&e.push(i("div",{class:"q-date__actions"},t)),l.name!==void 0&&l.disable!==!0&&E(e,"push"),i("div",{class:Se.value,...Dt.value},[St(),i("div",{ref:$,class:"q-date__main col column",tabindex:-1},e)])}}});const Ue=Rt("holidays",()=>{const l=q([]),I=q(null);return{holiday:l,holidays:I,createHoliday:async h=>{try{const m=await we.post("/api/holiday",h);fe.create({type:"positive",message:`${h.name||"Holiday"} created successfully.`,position:"top"})}catch(m){fe.create({type:"negative",message:m.response.data.message})}},fetchHolidays:async({year:h,month:m})=>{try{const H=await we.get("/api/holiday",{params:{year:h,month:m}});I.value=H.data}catch(H){console.error("Error fetching holidays:",H),I.value=[]}},updateHoliday:async(h,m,H)=>{var Y,v;try{const x=await we.put(`/api/holiday/${h}`,m),O=H.name!==x.data.name,E=H.date!==x.data.date;let $="";O&&($+=`Holiday name changed from "${H.name||"N/A"}" to "${x.data.name||"N/A"}".`),E&&($+=E&&$?" ":"",$+=`Holiday date changed from "${H.date||"N/A"}" to "${x.data.date||"N/A"}".`),$||($=`${m.name||"Holiday"} updated successfully.`),fe.create({type:"positive",message:$,timeout:2e3,position:"top"})}catch(x){const O=((v=(Y=x.response)==null?void 0:Y.data)==null?void 0:v.message)||x.message||"Failed to update holiday!";fe.create({type:"negative",message:O,timeout:2e3,position:"top"})}},deleteHoliday:async h=>{console.log("holiday delete id",h);try{await we.delete(`/api/holiday/${h}`)}catch(m){console.log("Delete Holiday Error: ",m)}}}});const fa={class:"text-center q-mb-xl"},ya={class:"text-h4 text-weight-bold text-grey-9 q-mt-md"},ha={class:"text-subtitle1 text-grey-7 q-mt-sm"},ga={class:"row items-center justify-end"},_a={class:"row q-gutter-md justify-center q-pt-sm"},pa={__name:"HolidaysDialog",props:{editMode:{type:Boolean,default:!1},holidayToEdit:{type:Object,default:()=>({})},currentYear:{type:Number,default:new Date().getFullYear()},currentMonth:{type:Number,default:new Date().getMonth()+1}},emits:["refreshHolidays"],setup(l,{expose:I,emit:M}){const w=l;console.log("props holiday to edit: ",w.holidayToEdit,w.currentYear,w.currentMonth);const S=M,V=q(!1),h=Ue(),m=w.holidayToEdit;w.currentYear,w.currentMonth;const H=()=>{V.value=!0},Y={id:null,name:"",date:"",type:null},v=At({...Y}),x=["Regular Holiday","Special (Non-Working) Holiday"],O=()=>{Object.assign(v,Y)};se(()=>w.holidayToEdit,$=>{w.editMode&&$?Object.assign(v,$):O()},{immediate:!0});const E=async()=>{Me.show();try{w.editMode?await h.updateHoliday(v.id,v,m):await h.createHoliday(v),S("refreshHolidays"),O(),V.value=!1}catch($){console.error("Error saving holiday:",$)}finally{Me.hide()}};return I({openDialog:H}),($,C)=>(z(),ye("div",null,[u(mt,{modelValue:V.value,"onUpdate:modelValue":C[4]||(C[4]=f=>V.value=f),persistent:""},{default:g(()=>[u(He,{class:"holiday-card"},{default:g(()=>[he(u(N,{icon:"close",flat:"",round:"",dense:"",class:"close-btn"},null,512),[[ge]]),u(qe,{class:""},{default:g(()=>[k("div",fa,[u(Ae,{name:"celebration",color:"primary",size:"3.5rem"}),k("div",ya,U(l.editMode?"Edit Holiday":"Holiday Management"),1),k("div",ha,U(l.editMode?"Update holiday details.":"Add holiday details with ease."),1)]),u(ua,{onSubmit:zt(E,["prevent"]),onReset:O,class:"q-gutter-y-md"},{default:g(()=>[u(st,{outlined:"",modelValue:v.name,"onUpdate:modelValue":C[0]||(C[0]=f=>v.name=f),label:"Holiday Name *","lazy-rules":"",rules:[f=>!!f||"Holiday name is required"],"bg-color":"grey-2"},null,8,["modelValue","rules"]),u(st,{outlined:"",modelValue:v.date,"onUpdate:modelValue":C[2]||(C[2]=f=>v.date=f),label:"Holiday Date *",mask:"date",hint:"yyyy/mm/dd","bg-color":"grey-2"},{append:g(()=>[u(Ae,{name:"event",class:"cursor-pointer"},{default:g(()=>[u(ia,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:g(()=>[u(ft,{modelValue:v.date,"onUpdate:modelValue":C[1]||(C[1]=f=>v.date=f),color:"primary"},{default:g(()=>[k("div",ga,[he(u(N,{label:"Close",color:"primary",flat:""},null,512),[[ge]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),u(na,{outlined:"",modelValue:v.type,"onUpdate:modelValue":C[3]||(C[3]=f=>v.type=f),options:x,label:"Holiday Type *",behavior:"menu",rules:[f=>!!f||"Holiday type is required"],"bg-color":"grey-2"},null,8,["modelValue","rules"]),k("div",_a,[u(N,{label:"Reset",type:"reset",color:"grey-8",flat:"",class:"q-px-xl q-py-sm form-btn"}),u(N,{label:"Save Holiday",type:"submit",color:"primary",unelevated:"",class:"q-px-xl q-py-sm form-btn save-btn"})])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}};var ba=Le(pa,[["__scopeId","data-v-42a038a2"]]);const xa=Lt('<span class="IconContainer" data-v-075f712a><svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 448 512" fill="rgb(17, 17, 17)" class="holiday-calendar-star-icon" data-v-075f712a><path d="M128 0v48H64C28.7 48 0 76.7 0 112v352c0 35.3 28.7 64 64 64h320c35.3 0 64-28.7 64-64V112c0-35.3-28.7-64-64-64H320V0c0-13.3-10.7-24-24-24s-24 10.7-24 24V48H176V0c0-13.3-10.7-24-24-24s-24 10.7-24 24zM384 160H64v288c0 8.8 7.2 16 16 16h288c8.8 0 16-7.2 16-16V160zm-68.7 82.7L258.9 308c-3.5 3.5-9.4 3.5-12.9 0l-37.5-37.5c-3.5-3.5-3.5-9.4 0-12.9s9.4-3.5 12.9 0L245.4 282l67.9-67.9c3.5-3.5 9.4-3.5 12.9 0s3.5 9.4 0 12.9z" data-v-075f712a></path><path fill="rgb(255, 208, 0)" d="M224 288l-25.1 48.9-54.2 7.9 39.2 38.3-9.3 54 48.4-25.4 48.4 25.4-9.3-54 39.2-38.3-54.2-7.9L224 288z" data-v-075f712a></path></svg></span><span class="text" data-v-075f712a>Set Holidays</span>',2),Da=[xa],wa={__name:"HolidayButton",emits:["set-holidays"],setup(l,{emit:I}){const M=I,w=()=>{M("set-holidays")};return(S,V)=>(z(),ye("button",{class:"CartBtn",onClick:w},Da))}};var Ha=Le(wa,[["__scopeId","data-v-075f712a"]]);const qa=l=>(Ut("data-v-2b9830c3"),l=l(),Pt(),l),Ma=qa(()=>k("div",{class:"text-h5 q-mb-xs"},"Confirm Deletion",-1)),Ca={class:"text-body2 q-mb-none"},ka={class:"text-weight-bold"},Sa={__name:"HolidayDeleteDialog",emits:["refreshHolidays"],setup(l,{expose:I,emit:M}){const w=Ue(),S=M,V=q(!1),h=q(null),m=v=>{h.value=v,V.value=!0},H=()=>{V.value=!1},Y=async()=>{console.log("delete....");const v=h.value.id;Me.show();try{await w.deleteHoliday(v),S("refreshHolidays"),H(),fe.create({type:"positive",message:`${h.value.name} holiday deleted successfully!`,position:"top",timeout:2e3})}catch(x){console.log("delete holiday error: ",x)}finally{Me.hide()}};return I({openDialog:m,closeDialog:H}),(v,x)=>(z(),ie(mt,{modelValue:V.value,"onUpdate:modelValue":x[0]||(x[0]=O=>V.value=O)},{default:g(()=>[u(He,null,{default:g(()=>[u(qe,{class:"q-pa-md q-rounded q-elevate-2 bg-white text-grey-9"},{default:g(()=>[Ma,k("p",Ca,[L(" Are you sure you want to delete holiday "),k("span",ka,U(h.value.name),1),L("? This action cannot be undone. ")])]),_:1}),u(ze,{class:"q-mb-md"}),u(qe,{align:"right",class:"q-pt-none"},{default:g(()=>[he(u(N,{flat:"",dense:"",label:"Cancel",color:"primary",class:"q-mr-sm"},null,512),[[ge]]),u(N,{dense:"",label:"Delete",color:"negative",onClick:Y,class:"q-btn-rounded q-px-lg"})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}};var Va=Le(Sa,[["__scopeId","data-v-2b9830c3"]]);const $a={class:"q-mb-md"},Ya={class:"row q-col-gutter-md"},Ia={class:"col-12 col-md-6"},Oa={class:"col-12 col-md-6"},Na={key:0,class:"flex flex-center column q-pa-md",style:{"min-height":"250px"}},ja=k("div",{class:"text-h6 text-grey-7 q-mt-md"},"Loading Holidays...",-1),Ta={key:0,class:"flex flex-center column q-pa-md",style:{"min-height":"250px"}},Fa=k("div",{class:"text-h6 text-grey-7 q-mb-xs"}," No holidays for this month ",-1),Ba={class:"text-subtitle2 text-grey-6 text-center"},Qa=k("br",null,null,-1),Ea=k("br",null,null,-1),Ra={class:"text-grey-7 q-mx-sm",align:"right"},Aa={class:"text-weight-light"},vl={__name:"HolidaysPage",setup(l){const I=Ue(),M=q([]),w=q(!1),S=q(null),V=q(null),h=q(null),m=q(!0),H=q(new Date().toISOString().substr(0,10)),Y=new Date,v=q(`${Y.getFullYear()}/${String(Y.getMonth()+1).padStart(2,"0")}`),x=c(()=>v.value?parseInt(v.value.split("/")[0],10):new Date().getFullYear()),O=c(()=>v.value?parseInt(v.value.split("/")[1],10):new Date().getMonth()+1),E=async(_,b)=>{m.value=!0;try{await I.fetchHolidays({year:_,month:b});const y=I.holidays.map(B=>{const P=new Date(B.date);if(isNaN(P.getTime()))return console.warn(`Invalid date encountered for holiday ID ${B.id}: ${B.date}`),{...B,date:B.date,monthYear:"Invalid Date",dayOfWeek:"Invalid Day"};const te=P.toISOString().split("T")[0],j=P.toLocaleString("en-US",{month:"long",day:"numeric",year:"numeric"}),Se=P.toLocaleString("en-US",{weekday:"long"});return{...B,date:te,day:String(P.getDate()),monthYear:j,dayOfWeek:Se}});M.value=y}catch(y){console.error("Error fetching holidays:",y)}finally{m.value=!1}},$=({year:_,month:b})=>{const y=String(b).padStart(2,"0");v.value=`${_}/${y}`,E(_,b)};Wt(()=>{const[_,b]=v.value.split("/");E(parseInt(_),parseInt(b))});const C=()=>{w.value=!1,S.value=null,V.value.openDialog()},f=_=>{w.value=!0,S.value={..._},V.value.openDialog()},Ce=_=>{h.value.openDialog(_)},ke=_=>_==="Regular Holiday"?"holiday--regular-card":_==="Special (Non-Working) Holiday"?"holiday--special-card":"",R=_=>{const b=M.value.find(y=>y.date===_);return b?b.type==="Regular Holiday"?"holiday--regular-day":b.type==="Special (Non-Working) Holiday"?"holiday--special-day":"":""},s=_=>new Date(x.value,_-1,1).toLocaleString("en-US",{month:"long"});return(_,b)=>(z(),ie(sa,{class:"q-pa-md",style:{"background-color":"#f7f9fc"}},{default:g(()=>[k("div",$a,[u(Ha,{year:x.value,month:O.value,onClick:b[0]||(b[0]=y=>C())},null,8,["year","month"])]),k("div",Ya,[k("div",Ia,[u(He,{flat:"",class:"calendar-card"},{default:g(()=>[u(qe,null,{default:g(()=>[u(ft,{modelValue:H.value,"onUpdate:modelValue":b[1]||(b[1]=y=>H.value=y),"year-month":v.value,"onUpdate:yearMonth":b[2]||(b[2]=y=>v.value=y),minimal:"",flat:"",class:"full-width","text-color":"dark",onNavigation:$},{day:g(({scope:y})=>[k("div",{class:it(["q-date__day flex flex-center",R(`${y.year}-${String(y.month).padStart(2,"0")}-${String(y.day).padStart(2,"0")}`)])},U(y.day),3)]),_:1},8,["modelValue","year-month"])]),_:1})]),_:1})]),k("div",Oa,[u(ra,{style:{height:"320px"},class:"q-pa-sm"},{default:g(()=>[m.value?(z(),ye("div",Na,[u(Jt,{color:"primary",size:"3em",thickness:10}),ja])):(z(),ie(dt,{key:1},{default:g(()=>[M.value.length===0?(z(),ye("div",Ta,[u(Ae,{name:"sentiment_very_dissatisfied",color:"grey-5",size:"80px",class:"q-mb-sm"}),Fa,k("div",Ba,[L(" It looks like there are no holidays recorded for "),Qa,L(" "+U(s(O.value))+" "+U(x.value)+". ",1),Ea,L(" You can try Browse other months or add a new holiday! ")]),u(N,{label:"Add New Holiday",color:"primary",flat:"",icon:"add_circle_outline",class:"q-mt-md",onClick:b[3]||(b[3]=y=>C())})])):Kt("",!0),(z(!0),ye(Xt,null,Gt(M.value,y=>(z(),ie(He,{key:y.id,class:it([ke(y.type),"q-mb-sm holiday-card"]),flat:""},{default:g(()=>[k("div",Ra,[u(N,{icon:"more_horiz",round:"",flat:"",dense:""},{default:g(()=>[u(oa,null,{default:g(()=>[u(dt,{style:{"min-width":"100px"}},{default:g(()=>[he((z(),ie(Qe,{clickable:""},{default:g(()=>[u(me,{onClick:B=>f(y),align:"center"},{default:g(()=>[L(" Edit ")]),_:2},1032,["onClick"])]),_:2},1024)),[[ge]]),he((z(),ie(Qe,{clickable:""},{default:g(()=>[u(me,{onClick:B=>Ce(y),align:"center"},{default:g(()=>[L(" Delete ")]),_:2},1032,["onClick"])]),_:2},1024)),[[ge]])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),u(Qe,{class:"q-py-md items-center"},{default:g(()=>[u(me,{side:"",class:"type-section"},{default:g(()=>[k("div",Aa,U(y.type),1)]),_:2},1024),u(ze,{vertical:"",class:"holiday-separator"}),u(me,{class:"q-ml-md"},{default:g(()=>[u(Ee,{class:"text-grey-7 text-weight-bold date-info"},{default:g(()=>[L(U(y.monthYear),1)]),_:2},1024),u(Ee,{caption:"",class:"day-of-week"},{default:g(()=>[L(U(y.dayOfWeek),1)]),_:2},1024)]),_:2},1024),u(ze,{vertical:"",class:"holiday-separator"}),u(me,{class:"q-ml-sm"},{default:g(()=>[u(Ee,{class:"text-blue-grey-7 text-weight-bold date-name"},{default:g(()=>[L(U(y.name),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["class"]))),128))]),_:1}))]),_:1})])]),k("div",null,[u(ba,{ref_key:"holidayDialogRef",ref:V,"edit-mode":w.value,"holiday-to-edit":S.value,"current-year":x.value,"current-month":O.value,onRefreshHolidays:b[4]||(b[4]=y=>E(x.value,O.value))},null,8,["edit-mode","holiday-to-edit","current-year","current-month"]),u(Va,{ref_key:"deleteDialogRef",ref:h,onRefreshHolidays:b[5]||(b[5]=y=>E(x.value,O.value))},null,512)])]),_:1}))}};export{vl as default};
