import{Q as J}from"./QDate.462a8759.js";import{d as se,r as g,N as M,t as ne,u as ie,o as H,a3 as I,f as e,w as t,a2 as G,Q as L,ae as N,M as k,I as R,J as n,L as O,$ as D,aI as re,K as P,P as U,by as de,e as V,a0 as w,a1 as T,O as ce,R as ue,c as W,z as ye,aK as j,bo as me,bc as pe,a5 as fe,a4 as he}from"./index.bfa1ad11.js";import{Q as ge,a as Y,b as C}from"./QMenu.b3926462.js";import{Q as K}from"./QList.26c65195.js";import{Q as ve,a as z}from"./QSelect.c096725f.js";import{Q as _e}from"./QScrollArea.82472f1b.js";import{Q as xe}from"./QPage.bb2201c9.js";import{C as E}from"./ClosePopup.7753a883.js";import{api as B}from"./axios.4ee75996.js";import{Q as He}from"./QPopupProxy.4d8f3250.js";import{Q as be}from"./QForm.3d0fce65.js";import{_ as F}from"./plugin-vue_export-helper.21dcd24c.js";import"./use-render-cache.3aae9b27.js";import"./date.fc328e76.js";import"./selection.2edcf7e4.js";import"./position-engine.557a8702.js";import"./QChip.b55c274e.js";import"./use-virtual-scroll.a7e71d3b.js";import"./rtl.276c3f1b.js";import"./QResizeObserver.ca157f6e.js";import"./QScrollObserver.51c80f9d.js";import"./TouchPan.bb57051e.js";import"./touch.9135741d.js";const A=se("holidays",()=>{const v=g([]),_=g(null);return{holiday:v,holidays:_,createHoliday:async i=>{try{const c=await B.post("/api/holiday",i);M.create({type:"positive",message:`${i.name||"Holiday"} created successfully.`,position:"top"})}catch(c){M.create({type:"negative",message:c.response.data.message})}},fetchHolidays:async({year:i,month:c})=>{try{const u=await B.get("/api/holiday",{params:{year:i,month:c}});_.value=u.data}catch(u){console.error("Error fetching holidays:",u),_.value=[]}},updateHoliday:async(i,c,u)=>{var b,a;try{const s=await B.put(`/api/holiday/${i}`,c),m=u.name!==s.data.name,q=u.date!==s.data.date;let p="";m&&(p+=`Holiday name changed from "${u.name||"N/A"}" to "${s.data.name||"N/A"}".`),q&&(p+=q&&p?" ":"",p+=`Holiday date changed from "${u.date||"N/A"}" to "${s.data.date||"N/A"}".`),p||(p=`${c.name||"Holiday"} updated successfully.`),M.create({type:"positive",message:p,timeout:2e3,position:"top"})}catch(s){const m=((a=(b=s.response)==null?void 0:b.data)==null?void 0:a.message)||s.message||"Failed to update holiday!";M.create({type:"negative",message:m,timeout:2e3,position:"top"})}},deleteHoliday:async i=>{console.log("holiday delete id",i);try{await B.delete(`/api/holiday/${i}`)}catch(c){console.log("Delete Holiday Error: ",c)}}}});const we={class:"text-center q-mb-xl"},De={class:"text-h4 text-weight-bold text-grey-9 q-mt-md"},Se={class:"text-subtitle1 text-grey-7 q-mt-sm"},qe={class:"row items-center justify-end"},$e={class:"row q-gutter-md justify-center q-pt-sm"},ke={__name:"HolidaysDialog",props:{editMode:{type:Boolean,default:!1},holidayToEdit:{type:Object,default:()=>({})},currentYear:{type:Number,default:new Date().getFullYear()},currentMonth:{type:Number,default:new Date().getMonth()+1}},emits:["refreshHolidays"],setup(v,{expose:_,emit:x}){const r=v;console.log("props holiday to edit: ",r.holidayToEdit,r.currentYear,r.currentMonth);const S=x,y=g(!1),i=A(),c=r.holidayToEdit;r.currentYear,r.currentMonth;const u=()=>{y.value=!0},b={id:null,name:"",date:"",type:null},a=ne({...b}),s=["Regular Holiday","Special (Non-Working) Holiday"],m=()=>{Object.assign(a,b)};ie(()=>r.holidayToEdit,p=>{r.editMode&&p?Object.assign(a,p):m()},{immediate:!0});const q=async()=>{U.show();try{r.editMode?await i.updateHoliday(a.id,a,c):await i.createHoliday(a),S("refreshHolidays"),m(),y.value=!1}catch(p){console.error("Error saving holiday:",p)}finally{U.hide()}};return _({openDialog:u}),(p,h)=>(H(),I("div",null,[e(G,{modelValue:y.value,"onUpdate:modelValue":h[4]||(h[4]=f=>y.value=f),persistent:""},{default:t(()=>[e(L,{class:"holiday-card"},{default:t(()=>[N(e(k,{icon:"close",flat:"",round:"",dense:"",class:"close-btn"},null,512),[[E]]),e(R,{class:""},{default:t(()=>[n("div",we,[e(O,{name:"celebration",color:"primary",size:"3.5rem"}),n("div",De,D(v.editMode?"Edit Holiday":"Holiday Management"),1),n("div",Se,D(v.editMode?"Update holiday details.":"Add holiday details with ease."),1)]),e(be,{onSubmit:re(q,["prevent"]),onReset:m,class:"q-gutter-y-md"},{default:t(()=>[e(P,{outlined:"",modelValue:a.name,"onUpdate:modelValue":h[0]||(h[0]=f=>a.name=f),label:"Holiday Name *","lazy-rules":"",rules:[f=>!!f||"Holiday name is required"],"bg-color":"grey-2"},null,8,["modelValue","rules"]),e(P,{outlined:"",modelValue:a.date,"onUpdate:modelValue":h[2]||(h[2]=f=>a.date=f),label:"Holiday Date *",mask:"date",hint:"yyyy/mm/dd","bg-color":"grey-2"},{append:t(()=>[e(O,{name:"event",class:"cursor-pointer"},{default:t(()=>[e(He,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:t(()=>[e(J,{modelValue:a.date,"onUpdate:modelValue":h[1]||(h[1]=f=>a.date=f),color:"primary"},{default:t(()=>[n("div",qe,[N(e(k,{label:"Close",color:"primary",flat:""},null,512),[[E]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(ve,{outlined:"",modelValue:a.type,"onUpdate:modelValue":h[3]||(h[3]=f=>a.type=f),options:s,label:"Holiday Type *",behavior:"menu",rules:[f=>!!f||"Holiday type is required"],"bg-color":"grey-2"},null,8,["modelValue","rules"]),n("div",$e,[e(k,{label:"Reset",type:"reset",color:"grey-8",flat:"",class:"q-px-xl q-py-sm form-btn"}),e(k,{label:"Save Holiday",type:"submit",color:"primary",unelevated:"",class:"q-px-xl q-py-sm form-btn save-btn"})])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}};var Ve=F(ke,[["__scopeId","data-v-42a038a2"]]);const Qe=de('<span class="IconContainer" data-v-075f712a><svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 448 512" fill="rgb(17, 17, 17)" class="holiday-calendar-star-icon" data-v-075f712a><path d="M128 0v48H64C28.7 48 0 76.7 0 112v352c0 35.3 28.7 64 64 64h320c35.3 0 64-28.7 64-64V112c0-35.3-28.7-64-64-64H320V0c0-13.3-10.7-24-24-24s-24 10.7-24 24V48H176V0c0-13.3-10.7-24-24-24s-24 10.7-24 24zM384 160H64v288c0 8.8 7.2 16 16 16h288c8.8 0 16-7.2 16-16V160zm-68.7 82.7L258.9 308c-3.5 3.5-9.4 3.5-12.9 0l-37.5-37.5c-3.5-3.5-3.5-9.4 0-12.9s9.4-3.5 12.9 0L245.4 282l67.9-67.9c3.5-3.5 9.4-3.5 12.9 0s3.5 9.4 0 12.9z" data-v-075f712a></path><path fill="rgb(255, 208, 0)" d="M224 288l-25.1 48.9-54.2 7.9 39.2 38.3-9.3 54 48.4-25.4 48.4 25.4-9.3-54 39.2-38.3-54.2-7.9L224 288z" data-v-075f712a></path></svg></span><span class="text" data-v-075f712a>Set Holidays</span>',2),Ce=[Qe],Me={__name:"HolidayButton",emits:["set-holidays"],setup(v,{emit:_}){const x=_,r=()=>{x("set-holidays")};return(S,y)=>(H(),I("button",{class:"CartBtn",onClick:r},Ce))}};var Ie=F(Me,[["__scopeId","data-v-075f712a"]]);const Ne=v=>(ce("data-v-2b9830c3"),v=v(),ue(),v),Ee=Ne(()=>n("div",{class:"text-h5 q-mb-xs"},"Confirm Deletion",-1)),Be={class:"text-body2 q-mb-none"},Le={class:"text-weight-bold"},Re={__name:"HolidayDeleteDialog",emits:["refreshHolidays"],setup(v,{expose:_,emit:x}){const r=A(),S=x,y=g(!1),i=g(null),c=a=>{i.value=a,y.value=!0},u=()=>{y.value=!1},b=async()=>{console.log("delete....");const a=i.value.id;U.show();try{await r.deleteHoliday(a),S("refreshHolidays"),u(),M.create({type:"positive",message:`${i.value.name} holiday deleted successfully!`,position:"top",timeout:2e3})}catch(s){console.log("delete holiday error: ",s)}finally{U.hide()}};return _({openDialog:c,closeDialog:u}),(a,s)=>(H(),V(G,{modelValue:y.value,"onUpdate:modelValue":s[0]||(s[0]=m=>y.value=m)},{default:t(()=>[e(L,null,{default:t(()=>[e(R,{class:"q-pa-md q-rounded q-elevate-2 bg-white text-grey-9"},{default:t(()=>[Ee,n("p",Be,[w(" Are you sure you want to delete holiday "),n("span",Le,D(i.value.name),1),w("? This action cannot be undone. ")])]),_:1}),e(T,{class:"q-mb-md"}),e(R,{align:"right",class:"q-pt-none"},{default:t(()=>[N(e(k,{flat:"",dense:"",label:"Cancel",color:"primary",class:"q-mr-sm"},null,512),[[E]]),e(k,{dense:"",label:"Delete",color:"negative",onClick:b,class:"q-btn-rounded q-px-lg"})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}};var Ue=F(Re,[["__scopeId","data-v-2b9830c3"]]);const Ye={class:"q-mb-md"},ze={class:"row q-col-gutter-md"},Oe={class:"col-12 col-md-6"},Te={class:"col-12 col-md-6"},Fe={key:0,class:"flex flex-center column q-pa-md",style:{"min-height":"250px"}},Ae=n("div",{class:"text-h6 text-grey-7 q-mt-md"},"Loading Holidays...",-1),Pe={key:0,class:"flex flex-center column q-pa-md",style:{"min-height":"250px"}},We=n("div",{class:"text-h6 text-grey-7 q-mb-xs"}," No holidays for this month ",-1),je={class:"text-subtitle2 text-grey-6 text-center"},Ke=n("br",null,null,-1),Je=n("br",null,null,-1),Ge={class:"text-grey-7 q-mx-sm",align:"right"},Xe={class:"text-weight-light"},bt={__name:"HolidaysPage",setup(v){const _=A(),x=g([]),r=g(!1),S=g(null),y=g(null),i=g(null),c=g(!0),u=g(new Date().toISOString().substr(0,10)),b=new Date,a=g(`${b.getFullYear()}/${String(b.getMonth()+1).padStart(2,"0")}`),s=W(()=>a.value?parseInt(a.value.split("/")[0],10):new Date().getFullYear()),m=W(()=>a.value?parseInt(a.value.split("/")[1],10):new Date().getMonth()+1),q=async(d,l)=>{c.value=!0;try{await _.fetchHolidays({year:d,month:l});const o=_.holidays.map($=>{const Q=new Date($.date);if(isNaN(Q.getTime()))return console.warn(`Invalid date encountered for holiday ID ${$.id}: ${$.date}`),{...$,date:$.date,monthYear:"Invalid Date",dayOfWeek:"Invalid Day"};const ae=Q.toISOString().split("T")[0],oe=Q.toLocaleString("en-US",{month:"long",day:"numeric",year:"numeric"}),le=Q.toLocaleString("en-US",{weekday:"long"});return{...$,date:ae,day:String(Q.getDate()),monthYear:oe,dayOfWeek:le}});x.value=o}catch(o){console.error("Error fetching holidays:",o)}finally{c.value=!1}},p=({year:d,month:l})=>{const o=String(l).padStart(2,"0");a.value=`${d}/${o}`,q(d,l)};ye(()=>{const[d,l]=a.value.split("/");q(parseInt(d),parseInt(l))});const h=()=>{r.value=!1,S.value=null,y.value.openDialog()},f=d=>{r.value=!0,S.value={...d},y.value.openDialog()},X=d=>{i.value.openDialog(d)},Z=d=>d==="Regular Holiday"?"holiday--regular-card":d==="Special (Non-Working) Holiday"?"holiday--special-card":"",ee=d=>{const l=x.value.find(o=>o.date===d);return l?l.type==="Regular Holiday"?"holiday--regular-day":l.type==="Special (Non-Working) Holiday"?"holiday--special-day":"":""},te=d=>new Date(s.value,d-1,1).toLocaleString("en-US",{month:"long"});return(d,l)=>(H(),V(xe,{class:"q-pa-md",style:{"background-color":"#f7f9fc"}},{default:t(()=>[n("div",Ye,[e(Ie,{year:s.value,month:m.value,onClick:l[0]||(l[0]=o=>h())},null,8,["year","month"])]),n("div",ze,[n("div",Oe,[e(L,{flat:"",class:"calendar-card"},{default:t(()=>[e(R,null,{default:t(()=>[e(J,{modelValue:u.value,"onUpdate:modelValue":l[1]||(l[1]=o=>u.value=o),"year-month":a.value,"onUpdate:yearMonth":l[2]||(l[2]=o=>a.value=o),minimal:"",flat:"",class:"full-width","text-color":"dark",onNavigation:p},{day:t(({scope:o})=>[n("div",{class:j(["q-date__day flex flex-center",ee(`${o.year}-${String(o.month).padStart(2,"0")}-${String(o.day).padStart(2,"0")}`)])},D(o.day),3)]),_:1},8,["modelValue","year-month"])]),_:1})]),_:1})]),n("div",Te,[e(_e,{style:{height:"320px"},class:"q-pa-sm"},{default:t(()=>[c.value?(H(),I("div",Fe,[e(me,{color:"primary",size:"3em",thickness:10}),Ae])):(H(),V(K,{key:1},{default:t(()=>[x.value.length===0?(H(),I("div",Pe,[e(O,{name:"sentiment_very_dissatisfied",color:"grey-5",size:"80px",class:"q-mb-sm"}),We,n("div",je,[w(" It looks like there are no holidays recorded for "),Ke,w(" "+D(te(m.value))+" "+D(s.value)+". ",1),Je,w(" You can try Browse other months or add a new holiday! ")]),e(k,{label:"Add New Holiday",color:"primary",flat:"",icon:"add_circle_outline",class:"q-mt-md",onClick:l[3]||(l[3]=o=>h())})])):pe("",!0),(H(!0),I(he,null,fe(x.value,o=>(H(),V(L,{key:o.id,class:j([Z(o.type),"q-mb-sm holiday-card"]),flat:""},{default:t(()=>[n("div",Ge,[e(k,{icon:"more_horiz",round:"",flat:"",dense:""},{default:t(()=>[e(ge,null,{default:t(()=>[e(K,{style:{"min-width":"100px"}},{default:t(()=>[N((H(),V(Y,{clickable:""},{default:t(()=>[e(C,{onClick:$=>f(o),align:"center"},{default:t(()=>[w(" Edit ")]),_:2},1032,["onClick"])]),_:2},1024)),[[E]]),N((H(),V(Y,{clickable:""},{default:t(()=>[e(C,{onClick:$=>X(o),align:"center"},{default:t(()=>[w(" Delete ")]),_:2},1032,["onClick"])]),_:2},1024)),[[E]])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),e(Y,{class:"q-py-md items-center"},{default:t(()=>[e(C,{side:"",class:"type-section"},{default:t(()=>[n("div",Xe,D(o.type),1)]),_:2},1024),e(T,{vertical:"",class:"holiday-separator"}),e(C,{class:"q-ml-md"},{default:t(()=>[e(z,{class:"text-grey-7 text-weight-bold date-info"},{default:t(()=>[w(D(o.monthYear),1)]),_:2},1024),e(z,{caption:"",class:"day-of-week"},{default:t(()=>[w(D(o.dayOfWeek),1)]),_:2},1024)]),_:2},1024),e(T,{vertical:"",class:"holiday-separator"}),e(C,{class:"q-ml-sm"},{default:t(()=>[e(z,{class:"text-blue-grey-7 text-weight-bold date-name"},{default:t(()=>[w(D(o.name),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["class"]))),128))]),_:1}))]),_:1})])]),n("div",null,[e(Ve,{ref_key:"holidayDialogRef",ref:y,"edit-mode":r.value,"holiday-to-edit":S.value,"current-year":s.value,"current-month":m.value,onRefreshHolidays:l[4]||(l[4]=o=>q(s.value,m.value))},null,8,["edit-mode","holiday-to-edit","current-year","current-month"]),e(Ue,{ref_key:"deleteDialogRef",ref:i,onRefreshHolidays:l[5]||(l[5]=o=>q(s.value,m.value))},null,512)])]),_:1}))}};export{bt as default};
