import{r as o,h as k,H as q,o as Q,c as V,w as r,Q as P,e as t,I as _,J as i,K as f,L,M,P as h,N as b,O as C,R as B}from"./index.6cf65197.js";import{Q as N}from"./QForm.e88c582e.js";import{_ as A}from"./GB_LOGO.b766a815.js";import{u as E}from"./use-quasar.ad37d7f7.js";import{api as R}from"./axios.03a68e3a.js";import{_ as U}from"./plugin-vue_export-helper.21dcd24c.js";const y=d=>(C("data-v-854cc0aa"),d=d(),B(),d),$=y(()=>i("div",{class:"text-h5 text-red-6 q-mb-sm"},[i("img",{src:A,class:"logo"})],-1)),j=y(()=>i("div",{class:"text-caption text-grey-8 q-mb-sm"}," Please log in to continuesss. ",-1)),D={class:"q-gutter-y-sm"},F={class:"q-my-md text-center"},H={__name:"LoginPage",setup(d){const w=o("f2edb9c41f6b7d1b147016a56f9d30b71ee02de8eb7375c737ec910a2be5dc29"),c=o(!0),n=o(""),u=o(""),x=o(!1),I=k(()=>n.value!==""&&u.value!=="");E();const l=q(),v=o(""),S=async()=>{var m,a;h.show();try{const e=await R.post("/api/login",{uuid:w.value,email:n.value,password:u.value});console.log("user:",e.data),localStorage.setItem("activeMenuItem","dashboard"),localStorage.setItem("token",e.data.token),localStorage.setItem("role",e.data.role),localStorage.setItem("uuid",e.data.device.uuid),localStorage.setItem("branch_id",e.data.device.branch_id);const s=e.data.role,p=localStorage.getItem("activeMenuItem");if(s==="Admin"||s==="Super Admin"){let g;p?(g=`/admin/${p}`,v.value=p):(g="/admin/dashboard",localStorage.setItem("activeMenuItem","dashboard"),v.value="dashboard"),await l.push(g),b.create({type:"positive",message:e.data.message||"Login successful!",setTimeout:5e3})}else s==="Baker"?await l.push("/branch/baker"):s==="Cake Maker"?await l.push("/branch/cake_maker/raw_materials"):s==="Cashier"?await l.push("/branch/sales_lady/products"):s==="Scaler"&&await l.push("/warehouse")}catch(e){console.error("Error during login:",e);const s=((a=(m=e.response)==null?void 0:m.data)==null?void 0:a.message)||"Login failed. Incorrect email & password.";b.create({type:"negative",message:s})}finally{h.hide()}};return(m,a)=>(Q(),V(P,{class:"my-card q-pa-md q-ma-lg",style:{width:"430px","max-width":"90%",height:"500px","border-radius":"16px","box-shadow":"0 4px 12px rgba(0, 0, 0, 0.1)",display:"flex","flex-direction":"column","justify-content":"space-between"}},{default:r(()=>[t(_,{class:"q-pa-sm text-center"},{default:r(()=>[$,j]),_:1}),t(_,{class:"q-mt-sm flex-grow-1"},{default:r(()=>[t(N,{onSubmit:S},{default:r(()=>[i("div",D,[t(f,{modelValue:n.value,"onUpdate:modelValue":a[0]||(a[0]=e=>n.value=e),outlined:"",placeholder:"Email",dense:"",autofocus:"",required:"",class:"input-dynamic"},null,8,["modelValue"]),t(f,{modelValue:u.value,"onUpdate:modelValue":a[2]||(a[2]=e=>u.value=e),outlined:"",placeholder:"Password",type:c.value?"password":"text",dense:"",required:"",class:"input-dynamic"},{append:r(()=>[t(L,{name:c.value?"visibility_off":"visibility",onClick:a[1]||(a[1]=e=>c.value=!c.value),class:"cursor-pointer",style:{color:"#9e9e9e"}},null,8,["name"])]),_:1},8,["modelValue","type"])]),i("div",F,[t(M,{type:"submit",color:"red-6",label:"Login",class:"q-mt-sm",dense:"",loading:x.value,disable:!I.value,style:{width:"100%","max-width":"350px","border-radius":"8px"}},null,8,["loading","disable"])])]),_:1})]),_:1})]),_:1}))}};var W=U(H,[["__scopeId","data-v-854cc0aa"]]);export{W as default};
