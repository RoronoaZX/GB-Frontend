import{d as Y,r as b,N as V,P as $,c as M,t as R,o as g,a2 as q,f as e,M as y,w as a,Q,I as w,ad as U,J as n,K as D,e as S,L as O,bb as Z,$ as F,a3 as A,a4 as ee,_ as te,bc as ae,aI as K,a1 as j,O as B,R as E,a0 as le,z as oe,u as se}from"./index.782b37a7.js";import{Q as ne}from"./QPage.52edbe9d.js";import{Q as J}from"./QSpace.83f07de6.js";import{Q as ie,a as L,b as de}from"./QList.b2323d49.js";import{C as I}from"./ClosePopup.02ad7db9.js";import{api as T}from"./axios.a69f9a91.js";import{u as re}from"./branch.52cc77ef.js";import{_ as C}from"./plugin-vue_export-helper.21dcd24c.js";import{Q as ce}from"./QSpinnerDots.85ad147e.js";import{Q as ue}from"./QTd.4cd3be71.js";import{Q as me}from"./QTable.372abecc.js";import{Q as G}from"./QTooltip.14472590.js";import"./warehouse.931e97bd.js";import"./employee.5806576a.js";import"./QVirtualScroll.44d1d69a.js";import"./use-virtual-scroll.c02ee7a9.js";import"./QSelect.dfcf9d2f.js";import"./QChip.75d9ba19.js";import"./QMenu.6a7eea7c.js";import"./selection.c8b99c33.js";const P=Y("devices",()=>{const d=b(null),u=b([]),r=async()=>{try{const t=await T.get("/api/device");u.value=t.data}catch(t){console.log("error fetchig  device",t),V.create({type:"negative",message:"Failed to fetch devices",setTimeout:1e3})}};return{device:d,devices:u,fetchDevices:r,createDevices:async t=>{$.show(),console.log("Data parameters being sent:",t);try{const c=await T.post("/api/device",t);r(),V.create({type:"positive",message:"Device created successfully",setTimeout:1e3})}catch(c){console.error("error device",c),V.create({type:"negative",message:"Failed to create device",setTimeout:1e3})}finally{$.hide()}},updateDevice:async(t,c)=>{$.show();try{const p=await T.put(`/api/device/${t}`,c),f=u.value.findIndex(l=>l.id===t);f!==-1&&(u.value[f]=p.data),V.create({type:"positive",message:"Device updated successfully",setTimeout:1e3})}catch(p){console.log("update device error",p),V.create({type:"negative",message:"Failed to update device",setTimeout:1e3})}finally{$.hide()}},deleteDevice:async t=>{$.show();try{const c=await T.delete(`/api/device/${t}`);u.value=u.value.filter(p=>p.id!==t),V.create({type:"positive",message:"Device deleted successfully"})}catch{V.create({type:"negative",message:"Failed to delete device"})}finally{$.hide()}}}});const k=d=>(B("data-v-974b0062"),d=d(),E(),d),ve=k(()=>n("div",{class:"text-h5 q-mr-md"},"\u{1F4F1} Add Device",-1)),pe={class:"q-mt-lg q-animated q-animate-bounce"},_e=k(()=>n("div",null,"UUID",-1)),ge={class:"q-mt-md q-animated q-animate-bounce"},fe=k(()=>n("div",null,"Name",-1)),he={class:"q-mt-md q-animated q-animate-bounce"},be=k(()=>n("div",null,"Model",-1)),ye={class:"q-mt-md q-animated q-animate-bounce"},De=k(()=>n("div",null,"OS Version",-1)),qe={class:"q-mt-md q-animated q-animate-bounce"},we=k(()=>n("div",null,"Designation Branch",-1)),xe={key:0,class:"custom-list z-top"},Ve={__name:"AddDevice",setup(d){const u=P(),r=re(),m=M(()=>r.branch),v=b(!1),_=b(!1),t=b(""),c=b(!1),p=b(!1),f=()=>{v.value=!0},l=async()=>{t.value.trim()&&await r.search(t.value)},o=x=>{console.log("selected branch:",x),i.branch_id=x.id,i.branch_name=x.name,t.value=x.name,c.value=!1,console.log("Filled addNewBranchForm Data:",i)},i=R({uuid:"",name:"",model:"",os_version:"",branch_id:"",branch_name:""}),W=async()=>{console.log("device sent:",i),_.value=!0;try{await u.createDevices(i),v.value=!1,X()}catch(x){console.log(x)}finally{_.value=!1}},X=()=>{i.uuid="",i.name="",i.model="",i.os_version=""};return(x,h)=>(g(),q("div",null,[e(y,{outline:"",icon:"add_circle",label:"Add Device",onClick:f,style:{"background-color":"#ef4444"}}),e(j,{modelValue:v.value,"onUpdate:modelValue":h[6]||(h[6]=s=>v.value=s),persistent:"","transition-show":"jump-up","transition-hide":"jump-down"},{default:a(()=>[e(Q,{class:"my-card q-pa-none",style:{width:"420px","border-radius":"16px","box-shadow":"0 12px 24px rgba(0, 0, 0, 0.2)"}},{default:a(()=>[e(w,{class:"row items-center q-px-md q-py-sm bg-gradient text-white"},{default:a(()=>[ve,e(J),U(e(y,{icon:"close",flat:"",dense:"",round:""},null,512),[[I]])]),_:1}),e(w,{class:"q-px-xl q-pt-none q-pb-lg"},{default:a(()=>[n("div",pe,[_e,e(D,{modelValue:i.uuid,"onUpdate:modelValue":h[0]||(h[0]=s=>i.uuid=s),outlined:"",dense:"",rules:[s=>s&&s.length>0||"Device UUID is required"]},null,8,["modelValue","rules"])]),n("div",ge,[fe,e(D,{class:"text-capitalize",modelValue:i.name,"onUpdate:modelValue":h[1]||(h[1]=s=>i.name=s),outlined:"",dense:"",rules:[s=>s&&s.length>0||"Device Name is required"]},null,8,["modelValue","rules"])]),n("div",he,[be,e(D,{modelValue:i.model,"onUpdate:modelValue":h[2]||(h[2]=s=>i.model=s),outlined:"",dense:"",rules:[s=>s&&s.length>0||"Device Model is required"]},null,8,["modelValue","rules"])]),n("div",ye,[De,e(D,{modelValue:i.os_version,"onUpdate:modelValue":h[3]||(h[3]=s=>i.os_version=s),outlined:"",dense:"",rules:[s=>s&&s.length>0||"Device OS Version is required"]},null,8,["modelValue","rules"])]),n("div",qe,[we,e(D,{modelValue:t.value,"onUpdate:modelValue":[h[4]||(h[4]=s=>t.value=s),l],outlined:"",dense:"",debounce:"500",onFocus:h[5]||(h[5]=s=>c.value=!0)},{append:a(()=>[p.value?(g(),S(Z,{key:1,color:"grey",size:"sm"})):(g(),S(O,{key:0,name:"search"}))]),default:a(()=>[c.value&&t.value?(g(),q("div",xe,[e(Q,null,{default:a(()=>[e(ie,{separator:""},{default:a(()=>{var s;return[(s=m.value)!=null&&s.length?(g(!0),q(A,{key:1},ee(m.value,z=>(g(),S(L,{onClick:Ye=>o(z),key:z.id,clickable:""},{default:a(()=>[e(de,null,{default:a(()=>[F(te(z.name),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128)):(g(),S(L,{key:0},{default:a(()=>[F(" No Employee Record ")]),_:1}))]}),_:1})]),_:1})])):ae("",!0)]),_:1},8,["modelValue"])])]),_:1}),e(K,{class:"row q-px-lg q-py-sm q-pt-none",align:"right"},{default:a(()=>[U(e(y,{class:"btn-cancel glossy",color:"negative",label:"Dismiss"},null,512),[[I]]),e(y,{class:"btn-create glossy",color:"positive",label:"Create",onClick:W})]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}};var $e=C(Ve,[["__scopeId","data-v-974b0062"]]);const H=d=>(B("data-v-1abbd28a"),d=d(),E(),d),Se=H(()=>n("div",{class:"text-h5 q-mb-xs"},"Confirm Deletion",-1)),ke=H(()=>n("p",{class:"text-body2 q-mb-none"}," Are you sure you want to delete this item? This action cannot be undone. ",-1)),Qe={__name:"DeviceDelete",props:["delete"],emits:["device-deleted"],setup(d,{emit:u}){const r=P(),m=d,v=u,_=b(!1),t=()=>{_.value=!0},c=async()=>{try{await r.deleteDevice(m.delete.row.id),_.value=!1,v("device-deleted")}catch(p){console.error("Error deleting item:",p)}_.value=!1};return(p,f)=>(g(),q(A,null,[e(y,{color:"negative",icon:"delete",size:"sm",flat:"",round:"",dense:"",onClick:t},{default:a(()=>[e(G,{class:"bg-negative",delay:200},{default:a(()=>[F("Delete")]),_:1})]),_:1}),e(j,{modelValue:_.value,"onUpdate:modelValue":f[0]||(f[0]=l=>_.value=l)},{default:a(()=>[e(Q,{class:"q-pa-md q-rounded q-elevate-2 bg-white text-grey-9"},{default:a(()=>[e(w,{class:"q-pt-none q-pb-sm"},{default:a(()=>[Se,ke]),_:1}),e(le,{class:"q-mb-md"}),e(w,{align:"right",class:"q-pt-none"},{default:a(()=>[U(e(y,{flat:"",dense:"",label:"Cancel",color:"primary",class:"q-mr-sm"},null,512),[[I]]),e(y,{dense:"",label:"Delete",color:"negative",onClick:c,class:"q-btn-rounded q-px-lg"})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};var Ue=C(Qe,[["__scopeId","data-v-1abbd28a"]]);const N=d=>(B("data-v-1abd83be"),d=d(),E(),d),Ie=N(()=>n("div",{class:"text-h5 q-mr-md"},"\u{1F4F1} Edit Device",-1)),Ce={class:"q-mt-lg q-animated q-animate-bounce"},Ne=N(()=>n("div",null,"UUID",-1)),Te={class:"q-mt-md q-animated q-animate-bounce"},Fe=N(()=>n("div",null,"Name",-1)),Ae={class:"q-mt-md q-animated q-animate-bounce"},Be=N(()=>n("div",null,"Model",-1)),Ee={class:"q-mt-md q-animated q-animate-bounce"},Pe=N(()=>n("div",null,"OS Version",-1)),ze={__name:"DeviceEdit",props:["edit"],emits:["device-updated"],setup(d,{emit:u}){const r=P(),m=b(!1);b(!0);const v=d,_=u,t=R({uuid:"",name:"",model:"",os_version:""}),c=()=>{Object.assign(t,v.edit.row),m.value=!0},p=async()=>{try{const f={...v.edit.row,...t};await r.updateDevice(v.edit.row.id,f),m.value=!1,_("device-updated")}catch(f){console.log("error update device",f)}};return(f,l)=>(g(),q(A,null,[e(y,{color:"positive",icon:"edit",size:"sm",flat:"",round:"",dense:"",onClick:c},{default:a(()=>[e(G,{class:"bg-positive",delay:200},{default:a(()=>[F("Edit")]),_:1})]),_:1}),e(j,{modelValue:m.value,"onUpdate:modelValue":l[4]||(l[4]=o=>m.value=o),persistent:"","transition-show":"jump-up","transition-hide":"jump-down"},{default:a(()=>[e(Q,{class:"my-card q-pa-none",style:{width:"420px","border-radius":"16px","box-shadow":"0 12px 24px rgba(0, 0, 0, 0.2)"}},{default:a(()=>[e(w,{class:"row items-center q-px-md q-py-sm bg-gradient text-white"},{default:a(()=>[Ie,e(J),U(e(y,{icon:"close",flat:"",dense:"",round:""},null,512),[[I]])]),_:1}),e(w,{class:"q-px-xl q-pt-none q-pb-lg"},{default:a(()=>[n("div",Ce,[Ne,e(D,{modelValue:t.uuid,"onUpdate:modelValue":l[0]||(l[0]=o=>t.uuid=o),outlined:"",dense:"",rules:[o=>o&&o.length>0||"Device UUID is required"]},null,8,["modelValue","rules"])]),n("div",Te,[Fe,e(D,{modelValue:t.name,"onUpdate:modelValue":l[1]||(l[1]=o=>t.name=o),outlined:"",dense:"",rules:[o=>o&&o.length>0||"Device Name is required"]},null,8,["modelValue","rules"])]),n("div",Ae,[Be,e(D,{modelValue:t.model,"onUpdate:modelValue":l[2]||(l[2]=o=>t.model=o),outlined:"",dense:"",rules:[o=>o&&o.length>0||"Device Model is required"]},null,8,["modelValue","rules"])]),n("div",Ee,[Pe,e(D,{modelValue:t.os_version,"onUpdate:modelValue":l[3]||(l[3]=o=>t.os_version=o),outlined:"",dense:"",rules:[o=>o&&o.length>0||"Device OS Version is required"]},null,8,["modelValue","rules"])])]),_:1}),e(K,{class:"row q-px-lg q-py-sm q-pt-none",align:"right"},{default:a(()=>[U(e(y,{class:"btn-cancel glossy",color:"negative",label:"Dismiss"},null,512),[[I]]),e(y,{class:"btn-create glossy",color:"positive",label:"Save",onClick:p})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};var Me=C(ze,[["__scopeId","data-v-1abd83be"]]);const Oe=d=>(B("data-v-3b94b6f1"),d=d(),E(),d),je={key:0,class:"spinner-wrapper"},Le={key:1},Re={key:0,class:"data-error"},Ke=Oe(()=>n("div",{class:"q-ml-sm text-h6"},"No data available",-1)),Je={class:"row justify-center q-gutter-x-md"},Ge={__name:"DeviceTable",setup(d){const u=P(),r=b(""),m=b(!0),v=M(()=>u.devices),_=b(!1),t=b({rowPerPage:0}),c=M(()=>r.value?v.value.filter(l=>(l.name||"").toLowerCase().includes(r.value.toLowerCase())):v.value);oe(async()=>{const l=await p();console.log("response device",l)});const p=async()=>{try{m.value=!0;const l=await u.fetchDevices();v.value.length||(_.value=!0),console.log("device fetch:",l)}catch(l){console.log("error fetching device",l),_.value=!0}finally{m.value=!1}};se(r,async l=>{m.value=!0,await new Promise(o=>setTimeout(o,1e3)),m.value=!1,_.value=c.value.length===0});const f=[{name:"name",label:"Name",align:"center",field:"name",format:l=>`${l}`,sortable:!0},{name:"model",label:"Model",align:"center",field:"model"},{name:"os_version",label:"OS Version",align:"center",field:"os_version"},{name:"uuid",label:"UUID",align:"center",field:"uuid"},{name:"branch_name",label:"Branch Name",align:"center",field:l=>l.branch?l.branch.name:"N/A"},{name:"action",label:"Action",align:"center",field:"action"}];return(l,o)=>(g(),q(A,null,[n("div",null,[e(D,{modelValue:r.value,"onUpdate:modelValue":o[0]||(o[0]=i=>r.value=i),class:"q-pb-lg q-pl-sm dynamic-width",outlined:"",placeholder:"search",flat:"",rounded:"",dense:"",debounce:"100"},{append:a(()=>[e(O,{name:"search"})]),_:1},8,["modelValue"])]),m.value?(g(),q("div",je,[e(ce,{size:"50px",color:"primary"})])):(g(),q("div",Le,[c.value.length===0?(g(),q("div",Re,[e(O,{name:"warning",color:"warning",size:"4em"}),Ke])):(g(),S(me,{key:1,class:"table-container elegant-container sticky-header",filter:r.value,"virtual-scroll-sticky-size-start":48,flat:"",style:{height:"400px"},columns:f,rows:v.value,"row-key":"name","virtual-scroll":"",pagination:t.value,"onUpdate:pagination":o[1]||(o[1]=i=>t.value=i),"rows-per-page-options":[0],"hide-bottom":""},{"body-cell-action":a(i=>[e(ue,{props:i},{default:a(()=>[n("div",Je,[e(Me,{edit:i,onDeviceUpdated:p},null,8,["edit"]),e(Ue,{delete:i,onDeviceDeleted:p},null,8,["delete"])])]),_:2},1032,["props"])]),_:1},8,["filter","rows","pagination"]))]))],64))}};var He=C(Ge,[["__scopeId","data-v-3b94b6f1"]]);const We={align:"right"},Xe={__name:"DevicesPage",setup(d){return(u,r)=>(g(),S(ne,null,{default:a(()=>[e(Q,{class:"elegant-container",flat:""},{default:a(()=>[e(w,null,{default:a(()=>[n("div",We,[e($e)])]),_:1}),e(w,null,{default:a(()=>[e(He)]),_:1})]),_:1})]),_:1}))}};var bt=C(Xe,[["__scopeId","data-v-bc8265ea"]]);export{bt as default};
