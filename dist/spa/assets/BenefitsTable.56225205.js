import{c as K,r as y,t as ee,o as p,a3 as $,f as o,M as q,w as s,Q as z,I as U,ae as te,K as b,e as Q,L as G,bc as ae,a0 as g,a4 as J,a5 as O,$ as f,bd as le,J as i,aJ as oe,a2 as se,O as j,R as W,z as ne,u as ie,bb as F,N as P}from"./index.640cd289.js";import{b as de,Q as B,a as re}from"./QTable.ba0bced2.js";import{Q as ue}from"./QTr.a5d1b416.js";import{Q as k}from"./QTooltip.0d3a1191.js";import{Q as M}from"./QPopupEdit.faf73d5d.js";import{Q as me}from"./QSpinnerIos.a50eb171.js";import{Q as ce}from"./QInnerLoading.b228a7cb.js";import{Q as pe}from"./QPage.a9499a63.js";import{Q as fe}from"./QSpace.ae23c79c.js";import{Q as R,a as ve}from"./QItem.87841ee7.js";import{Q as ge}from"./QList.37d86745.js";import{C as ye}from"./ClosePopup.f9b47438.js";import{u as X}from"./BenefitsTable.vue_vue_type_style_index_0_scoped_true_lang.c75b17c5.js";import{u as _e}from"./employee.0172f9cf.js";import{_ as Y}from"./plugin-vue_export-helper.21dcd24c.js";import{api as A}from"./axios.1b168828.js";import"./QVirtualScroll.63871001.js";import"./use-virtual-scroll.696c357e.js";import"./QSelect.c500afc7.js";import"./QItemLabel.2cf58cf5.js";import"./QChip.85660784.js";import"./QMenu.da23ba2c.js";import"./position-engine.0e326f2d.js";import"./selection.d4d4e593.js";const L=v=>(j("data-v-3205aee1"),v=v(),W(),v),he=L(()=>i("div",{class:"text-h5 q-mr-md"},"\u{1F4BC} Add Employee Deductions",-1)),be={key:0,class:"custom-list z-top"},we={class:"row q-gutter-md text-subtitle1"},Se=L(()=>i("div",null,"Name:",-1)),Ve={class:"text-weight-medium"},xe={class:"row q-gutter-md text-subtitle1"},Qe=L(()=>i("div",null,"Position:",-1)),Ie={class:"text-weight-medium"},Ce={class:"q-gutter-y-md"},Pe={__name:"AddDeduction",emits:["created"],setup(v,{emit:E}){const I=_e(),w=K(()=>I.employees),c=X();K(()=>c.benefits);const m=y(""),u=y(!1),S=y(!1),_=y(!1),D=()=>{_.value=!0},H=E,N=async()=>{m.value.trim()&&(S.value=!0,await I.searchEmployee(m.value),S.value=!1)},V=r=>{console.log("Selected Employee:",r),n.employee_id=r.id,n.employee_name=`${r.firstname} ${r.middlename?r.middlename.charAt(0)+".":""} ${r.lastname} `,n.employee_position=r.position,m.value="",console.log("Filled Designation Data:",n)},n=ee({employee_id:"",employee_name:"",employee_position:"",sss:"",hdmf:"",phic:""}),x=()=>{n.employee_id="",n.employee_name="",n.employee_position="",n.sss="",n.hdmf="",n.phic=""},h=async()=>{console.log("deductionssss:",n),u.value=!0;try{const r=await c.createEmployeeBenefit(n);console.log("deduction",r),H("created"),_.value=!1,x()}catch(r){console.log("error",r)}finally{u.value=!1}};return(r,e)=>(p(),$("div",null,[o(q,{padding:"sm md",label:"Add Benefits",icon:"add_circle",size:"md",class:"gradient-btn text-white",onClick:D}),o(se,{modelValue:_.value,"onUpdate:modelValue":e[4]||(e[4]=l=>_.value=l),persistent:"",position:"right","backdrop-filter":"blur(4px) saturate(150%)"},{default:s(()=>[o(z,{style:{width:"500px","max-width":"80vw"}},{default:s(()=>[o(U,{class:"row items-center q-px-md q-py-sm gradient-btn text-white"},{default:s(()=>[he,o(fe),te(o(q,{icon:"arrow_forward_ios",flat:"",dense:"",round:""},null,512),[[ye]])]),_:1}),o(U,null,{default:s(()=>[o(b,{modelValue:m.value,"onUpdate:modelValue":[e[0]||(e[0]=l=>m.value=l),N],label:"Search Employee",outlined:"",rounded:"",dense:"",debounce:"500",placeholder:"Enter name"},{append:s(()=>[S.value?(p(),Q(ae,{key:1,color:"grey",size:"sm"})):(p(),Q(G,{key:0,name:"search"}))]),default:s(()=>[m.value?(p(),$("div",be,[o(z,null,{default:s(()=>[o(ge,{separator:""},{default:s(()=>{var l;return[(l=w.value)!=null&&l.length?(p(!0),$(J,{key:1},O(w.value,t=>(p(),Q(R,{onClick:a=>V(t),key:t.id,clickable:""},{default:s(()=>[o(ve,null,{default:s(()=>[g(f(`${t.firstname} ${t.middlename?t.middlename.charAt(0)+".":""} ${t.lastname}`),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128)):(p(),Q(R,{key:0},{default:s(()=>[g(" No employee record ")]),_:1}))]}),_:1})]),_:1})])):le("",!0)]),_:1},8,["modelValue"])]),_:1}),o(U,null,{default:s(()=>[i("div",we,[Se,i("div",Ve,f(n.employee_name?n.employee_name:"-------"),1)]),i("div",xe,[Qe,i("div",Ie,f(n.employee_position?n.employee_position:"-------"),1)])]),_:1}),o(U,null,{default:s(()=>[i("div",Ce,[i("div",null,[o(b,{modelValue:n.sss,"onUpdate:modelValue":e[1]||(e[1]=l=>n.sss=l),outlined:"",label:"SSS (Social Security System )"},null,8,["modelValue"])]),i("div",null,[o(b,{modelValue:n.hdmf,"onUpdate:modelValue":e[2]||(e[2]=l=>n.hdmf=l),outlined:"",label:"HDMF (Pag-IBIG Fund)"},null,8,["modelValue"])]),i("div",null,[o(b,{modelValue:n.phic,"onUpdate:modelValue":e[3]||(e[3]=l=>n.phic=l),outlined:"",label:"PHIC (Philippine Health Insurance Corporation)"},null,8,["modelValue"])])])]),_:1}),o(oe,null,{default:s(()=>[o(q,{size:"md",padding:"xs md",label:"save","icon-right":"send",class:"gradient-btn text-white",onClick:h,loading:u.value},null,8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}};var Ee=Y(Pe,[["__scopeId","data-v-3205aee1"]]);const T=v=>(j("data-v-f998e26c"),v=v(),W(),v),Ue={class:"row justify-between q-mb-md",align:"right"},$e={class:"row q-gutter-md"},De=T(()=>i("div",{class:"text-h6 text-center q-mb-xs"},"Edit SSS",-1)),He={class:"text-subtitle2 q-mb-sm"},Ne=T(()=>i("div",{class:"text-h6 text-center q-mb-xs"},"Edit HDMF",-1)),qe={class:"text-subtitle2 q-mb-sm"},Fe=T(()=>i("div",{class:"text-h6 text-center q-mb-xs"},"Edit PHIC",-1)),Be={class:"text-subtitle2 q-mb-sm"},ke={__name:"BenefitsTable",setup(v){const E=X(),I=K(()=>E.benefits),w=y([]),c=y({page:1,rowsPerPage:0,rowsNumber:0}),m=y(""),u=y(!1),S=y(!1);function _(e){if(e==null||e==="")return"";const l=parseFloat(e);return isNaN(l)?"":Number.isInteger(l)?String(parseInt(l)):String(l)}async function D(e,l){console.log("Updating SSS for",e,"to",l);try{u.value=!0,await A.put("/api/update-employee-sss-benefit/"+e.id,{sss:l}),P.create({message:"SSS updated successfully",color:"positive",position:"top",timeout:2e3})}catch(t){console.error("Error updating SSS:",t),P.create({message:"Error updating SSS",color:"negative",position:"top",timeout:2e3})}finally{u.value=!1}}async function H(e,l){console.log("Updating HDMF for",e,"to",l);try{u.value=!0,await A.put("/api/update-employee-hdmf-benefit/"+e.id,{hdmf:l}),P.create({message:"HDMF updated successfully",color:"positive",position:"top",timeout:2e3})}catch(t){console.error("ERROR updating HDMF:",t)}finally{u.value=!1}}async function N(e,l){console.log("Updating PHIC for",e,"to",l);try{u.value=!0,await A.put("/api/update-employee-phic-benefit/"+e.id,{phic:l}),P.create({message:" PHIC updated successfully",color:"positive",position:"top",timeout:2e3})}catch(t){console.error("Error updating PHIC:",t),P.create({message:"Error updating PHIC",color:"negative",position:"top",timeout:2e3})}finally{u.value=!1}}ne(async()=>{await V()});const V=async(e=1,l=7,t="")=>{try{u.value=!0,I.value=await E.fetchEmployeeBenefit(e,l,t);const{data:a,current_page:d,per_page:C,total:Z}=I.value;w.value=a,console.log("employee benefit",w.value),c.value.page=d,c.value.rowsPerPage=C,c.value.rowsNumber=Z,console.log("benefit",w.value)}catch(a){console.log("error fetching",a)}finally{u.value=!1}},n=e=>{console.log("handle benefits request",e),V(e.pagination.page,e.pagination.rowsPerPage,e.filter)};ie(m,async e=>{S.value=!0,await V(c.value.page,c.value.rowsPerPage,e),S.value=!1});const x=e=>{const l=C=>C?C.charAt(0).toUpperCase()+C.slice(1).toLowerCase():"",t=e.firstname?l(e.firstname):"No Firstname",a=e.middlename?l(e.middlename).charAt(0)+".":"",d=e.lastname?l(e.lastname):"No Lastname";return`${t} ${a} ${d}`.trim()},h=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(e),r=[{name:"name",required:!0,label:"Name",align:"left",field:e=>x(e.employee)},{name:"sss",label:"Social Security System (SSS)",align:"center",field:e=>h(e.sss)},{name:"hdmf",label:"Pag-IBIG Fund (HDMF)",align:"center",field:e=>h(e.hdmf)},{name:"phic",label:"Phil - Health (PHIC)",align:"center",field:e=>h(e.phic)}];return(e,l)=>(p(),Q(pe,{class:"q-my-md"},{default:s(()=>[i("div",Ue,[i("div",$e,[i("div",null,[o(Ee,{onCreated:V})])]),o(b,{modelValue:m.value,"onUpdate:modelValue":l[0]||(l[0]=t=>m.value=t),outlined:"",dense:"",debounce:"300",flat:"",label:"Search",style:{width:"300px"}},{append:s(()=>[i("div",null,[o(G,{name:"search"})])]),_:1},8,["modelValue"])]),o(re,{rows:w.value,columns:r,"row-key":"name",pagination:c.value,"onUpdate:pagination":l[1]||(l[1]=t=>c.value=t),"rows-per-page-options":[5,7,10,0],onRequest:n,loading:u.value,filter:m.value},{header:s(t=>[o(ue,{props:t,class:"gradient-header text-white text-weight-bold"},{default:s(()=>[(p(!0),$(J,null,O(t.cols,a=>(p(),Q(de,{key:a.name,props:t,class:"text-center text-subtitle2"},{default:s(()=>[g(f(a.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),"body-cell-sss":s(t=>[o(B,{props:t},{default:s(()=>[i("span",null,[g(f(t.row.sss?h(t.row.sss):" - - ")+" ",1),o(k,{class:"bg-blue-grey-8"},{default:s(()=>[g("Edit SSS")]),_:1})]),o(M,{"onUpdate:modelValue":[a=>D(t.row,a),a=>t.row.sss=a],modelValue:t.row.sss,buttons:"","label-set":"Save","label-cancel":"Close"},{default:s(a=>[De,i("div",He," Name: "+f(x(t.row.employee)),1),o(b,{modelValue:a.value,"onUpdate:modelValue":[d=>a.value=d,d=>a.value=d],"model-value":_(a.value),type:"text",autofocus:"",counter:"",onKeyup:F(a.set,["enter"])},null,8,["modelValue","onUpdate:modelValue","model-value","onKeyup"])]),_:2},1032,["onUpdate:modelValue","modelValue"])]),_:2},1032,["props"])]),"body-cell-hdmf":s(t=>[o(B,{props:t},{default:s(()=>[i("span",null,[g(f(t.row.hdmf?h(t.row.hdmf):" - - -")+" ",1),o(k,{class:"bg-blue-grey-8"},{default:s(()=>[g("Edit HDMF")]),_:1})]),o(M,{"onUpdate:modelValue":[a=>H(t.row,a),a=>t.row.hdmf=a],modelValue:t.row.hdmf,buttons:"","label-set":"Save","label-cancel":"Close"},{default:s(a=>[Ne,i("div",qe," Name: "+f(x(t.row.employee)),1),o(b,{modelValue:a.value,"onUpdate:modelValue":[d=>a.value=d,d=>a.value=d],"model-value":_(a.value),type:"text",autofocus:"",counter:"",onKeyup:F(a.set,["enter"])},null,8,["modelValue","onUpdate:modelValue","model-value","onKeyup"])]),_:2},1032,["onUpdate:modelValue","modelValue"])]),_:2},1032,["props"])]),"body-cell-phic":s(t=>[o(B,{props:t},{default:s(()=>[i("span",null,[g(f(t.row.phic?h(t.row.phic):" - - - ")+" ",1),o(k,{class:"bg-blue-grey-8"},{default:s(()=>[g("Edit PHIC")]),_:1})]),o(M,{"onUpdate:modelValue":[a=>N(t.row,a),a=>t.row.phic=a],modelValue:t.row.phic,buttons:"","label-save":"Save","label-cancel":"Close"},{default:s(a=>[Fe,i("div",Be," Name: "+f(x(t.row.employee)),1),o(b,{modelValue:a.value,"onUpdate:modelValue":[d=>a.value=d,d=>a.value=d],"model-value":_(a.value),type:"text",autofocus:"",counter:"",onKeyup:F(a.set,["enter"])},null,8,["modelValue","onUpdate:modelValue","model-value","onKeyup"])]),_:2},1032,["onUpdate:modelValue","modelValue"])]),_:2},1032,["props"])]),loading:s(()=>[o(ce,{showing:""},{default:s(()=>[o(me,{size:"50px",color:"grey-10"})]),_:1})]),_:1},8,["rows","pagination","loading","filter"])]),_:1}))}};var rt=Y(ke,[["__scopeId","data-v-f998e26c"]]);export{rt as default};
