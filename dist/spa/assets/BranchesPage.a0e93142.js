import{Q as J}from"./QBadge.2dc625c4.js";import{r as m,c as W,t as ie,z as de,o as c,a3 as V,f as a,M as $,w as o,Q as j,I,ae as M,a1 as oe,J as s,K as S,e as C,L as H,bo as ue,a0 as k,a4 as T,a5 as ce,$ as F,be as me,aJ as te,a2 as le,N as ye,O as Y,R as Z,H as we,u as qe,aI as xe,aK as z,P as re}from"./index.ca72f247.js";import{Q as Ve}from"./QPage.c5c8524f.js";import{Q as pe}from"./QSpace.888473d1.js";import{a as G,b as he}from"./QMenu.a8d5f7aa.js";import{Q as _e}from"./QList.7330d34c.js";import{Q as X}from"./QSelect.a1c4ed00.js";import{C as K}from"./ClosePopup.77864f63.js";import{u as ee}from"./branch.603580a4.js";import{u as se}from"./warehouse.89a20565.js";import{u as ve}from"./employee.0c9aaa4c.js";import{_ as R}from"./plugin-vue_export-helper.21dcd24c.js";import{Q as $e}from"./QSpinnerDots.f3b67178.js";import{Q as A,a as Ce}from"./QTable.6ef48ae6.js";import{Q as fe}from"./QTooltip.3e12865c.js";import{t as ge}from"./typography-format.6bffeec7.js";import{b as ke}from"./badge-color.f568cd69.js";import"./position-engine.a63ef796.js";import"./selection.66bddd9a.js";import"./QChip.ead5e565.js";import"./use-virtual-scroll.645c1690.js";import"./rtl.276c3f1b.js";import"./axios.0019c736.js";import"./QVirtualScroll.eb023b79.js";import"./date.7612c2b8.js";const Be=u=>(Y("data-v-e7a94c60"),u=u(),Z(),u),Se=Be(()=>s("div",{class:"text-h5 q-mr-md"},"\u{1F3EA} Add New Branch",-1)),De={class:"q-mt-lg q-animated q-animate-bounce"},Qe={class:"q-mt-lg q-animated q-animate-bounce"},Ne={class:"q-mt-lg q-animated q-animate-bounce"},Ee={key:0,class:"custom-list z-top"},Fe={class:"q-mt-lg q-animated q-animate-bounce"},Ie={class:"row q-mt-lg q-gutter-x-sm justify-between"},Pe={class:"col-6 q-animated q-animate-bounce"},Ue={class:"col-5 q-animated q-animate-bounce"},Le={__name:"BranchesCreateComponent",setup(u){const f=ve(),p=m(!1),N=ee(),E=()=>{p.value=!0},B=se(),q=m([]),h=m([]),g=m(!1),v=["Open","Open soon","Close"],x=m(!1),w=m(null),b=m(null),D=m(!1),U=W(()=>f.employee),O=async()=>{b.value.trim()&&(x.value=!0,await f.searchPersonInCharge(b.value),x.value=!1,D.value=!0)},t=i=>{console.log("Selected Employee:",i),e.employee_id=i.id,e.employee_name=`${i.firstname} ${i.middlename?i.middlename.charAt(0)+".":""} ${i.lastname}`,b.value=`${i.firstname} ${i.middlename?i.middlename.charAt(0)+".":""} ${i.lastname}`,D.value=!1,console.log("Filled addNewBranchForm Data:",e)},_=i=>{const r=ae=>ae?ae.charAt(0).toUpperCase()+ae.slice(1).toLowerCase():"",l=i.firstname?r(i.firstname):"No Firstname",y=i.middlename?r(i.middlename).charAt(0)+".":"",L=i.lastname?r(i.lastname):"No Lastname";return`${l} ${y} ${L}`},e=ie({name:"",location:"",employee_id:"",employee_name:"",phone:"",status:""});de(async()=>{g.value=!0;try{const i=await B.fetchWarehouses();q.value=B.warehouses.map(r=>({label:r.name,value:r.id})),h.value=q.value}catch(i){console.error("Error fetching warehouse data:",i)}finally{g.value=!1}});const n=(i,r)=>{r(()=>{const l=i.toLowerCase();h.value=i===""?q.value:q.value.filter(y=>y.label.toLowerCase().includes(l))})},Q=async()=>{var i,r,l;try{g.value=!0;const y={...e,warehouse_id:((i=w.value)==null?void 0:i.value)||null};console.log("brabrbbar",y);const L=await N.createBranches(y);console.log(L),p.value=!1,ne()}catch(y){console.error("Error creating branch:",y);const L=((l=(r=y.response)==null?void 0:r.data)==null?void 0:l.message)||y.message||"Failed to create branch. Please try again.";p.value=!0,ye.create({color:"negative",icon:"warning",message:L})}finally{g.value=!1}},ne=()=>{e.name="",e.location="",e.employee_id="",e.employee_name="",b.value=null,w.value=null,e.phone="",e.status=""};return(i,r)=>(c(),V(T,null,[a($,{class:"text-dark q-pa-sm",outline:"",dense:"",elevated:"",icon:"add_circle",label:"Add Store Branch",onClick:E,style:{"background-color":"#ef4444"}}),a(le,{modelValue:p.value,"onUpdate:modelValue":r[7]||(r[7]=l=>p.value=l),persistent:"","transition-show":"jump-up","transition-hide":"jump-down"},{default:o(()=>[a(j,{class:"my-card q-pa-none",style:{width:"420px","border-radius":"16px","box-shadow":"0 12px 24px rgba(0, 0, 0, 0.2)"}},{default:o(()=>[a(I,{class:"row items-center q-px-md q-py-sm bg-gradient text-white"},{default:o(()=>[Se,a(pe),M(a($,{icon:"close",flat:"",dense:"",round:""},null,512),[[K]])]),_:1}),a(oe,{class:"separator-gradient"}),a(I,{class:"q-px-xl q-pt-none q-pb-lg"},{default:o(()=>[s("div",De,[a(S,{class:"text-capitalize",modelValue:e.name,"onUpdate:modelValue":r[0]||(r[0]=l=>e.name=l),outlined:"",dense:"",label:"Branch Name",rules:[l=>l&&l.length>0||"Name is required"]},null,8,["modelValue","rules"])]),s("div",Qe,[a(S,{class:"text-capitalize",modelValue:e.location,"onUpdate:modelValue":r[1]||(r[1]=l=>e.location=l),outlined:"",dense:"",label:"Location",rules:[l=>l&&l.length>0||"Label is required"]},null,8,["modelValue","rules"])]),s("div",Ne,[s("div",null,[a(S,{modelValue:b.value,"onUpdate:modelValue":[r[2]||(r[2]=l=>b.value=l),O],label:"Search Employee",outlined:"",dense:"",debounce:"500",placeholder:"Enter name or position",onFocus:r[3]||(r[3]=l=>D.value=!0)},{append:o(()=>[x.value?(c(),C(ue,{key:1,color:"grey",size:"sm"})):(c(),C(H,{key:0,name:"search"}))]),default:o(()=>[D.value&&b.value?(c(),V("div",Ee,[a(j,null,{default:o(()=>[a(_e,{separator:""},{default:o(()=>{var l;return[(l=U.value)!=null&&l.length?(c(!0),V(T,{key:1},ce(U.value,y=>(c(),C(G,{onClick:L=>t(y),key:y.id,clickable:""},{default:o(()=>[a(he,null,{default:o(()=>[k(F(_(y)),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128)):(c(),C(G,{key:0},{default:o(()=>[k(" No Employee Record ")]),_:1}))]}),_:1})]),_:1})])):me("",!0)]),_:1},8,["modelValue"])])]),s("div",Fe,[a(X,{modelValue:w.value,"onUpdate:modelValue":r[4]||(r[4]=l=>w.value=l),clearable:"","use-input":"","input-debounce":"0",options:h.value,"hide-dropdown-icon":"","stack-label":"",outlined:"",dense:"",label:"Warehouse",onFilter:n,behavior:"menu"},null,8,["modelValue","options"])]),s("div",Ie,[s("div",Pe,[a(S,{modelValue:e.phone,"onUpdate:modelValue":r[5]||(r[5]=l=>e.phone=l),outlined:"",dense:"",mask:"(+63) ### - ### - ####",placeholder:"(+63) ### - ### - ####",label:"Phone Number",rules:[l=>l&&l.length>0||"Phone number is required"]},null,8,["modelValue","rules"])]),s("div",Ue,[a(X,{modelValue:e.status,"onUpdate:modelValue":r[6]||(r[6]=l=>e.status=l),outlined:"",dense:"",label:"Status",options:v,"hide-dropdown-icon":"",behavior:"menu",rules:[l=>l&&l.length>0||"Status is required"]},null,8,["modelValue","rules"])])])]),_:1}),a(te,{class:"row q-px-lg q-py-sm q-pt-none",align:"right"},{default:o(()=>[M(a($,{class:"glossy",color:"grey-9",label:"Dismiss"},null,512),[[K]]),a($,{class:"glossy",color:"teal",label:"Create",onClick:Q,loading:g.value},null,8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};var ze=R(Le,[["__scopeId","data-v-e7a94c60"]]);const P=u=>(Y("data-v-57acffea"),u=u(),Z(),u),Ae=P(()=>s("div",{class:"text-h5 q-mr-md"},"\u{1F3EA} Edit Branch",-1)),Te={class:"q-mt-lg q-animated q-animate-bounce"},Oe=P(()=>s("div",null,"Name of Branch",-1)),We={class:"q-mt-lg q-animated q-animate-bounce"},je=P(()=>s("div",null,"Location",-1)),Me={class:"q-mt-lg q-animated q-animate-bounce"},Ke=P(()=>s("div",null,"Person In-charge",-1)),Re={key:0,class:"custom-list z-top"},Je={class:"q-mt-lg q-animated q-animate-bounce"},He=P(()=>s("div",null,"Under Warehouse",-1)),Ge={class:"row q-gutter-x-sm justify-between q-mt-sm"},Xe={class:"col-6 q-animated q-animate-bounce"},Ye=P(()=>s("div",null,"Phone Number",-1)),Ze={class:"col-5 q-animated q-animate-bounce"},ea=P(()=>s("div",null,"Status",-1)),aa={__name:"BranchesEditComponent",props:["edit"],setup(u){const{formatFullname:f}=ge(),p=ve(),N=ee(),E=se(),B=W(()=>E.warehouses),q=u,h=m(!1);m([]);const g=["Open","Open soon","Close"],v=m(null),x=m(!1),w=m(!1),b=W(()=>p.employee),D=async()=>{v.value.trim()&&(x.value=!0,await p.searchPersonInCharge(v.value),x.value=!1,w.value=!0)},U=e=>{console.log("Selected Employee:",e),t.employee_id=e.id,t.employee_name=`${e.firstname} ${e.middlename?e.middlename.charAt(0)+".":""} ${e.lastname}`,v.value=`${e.firstname} ${e.middlename?e.middlename.charAt(0)+".":""} ${e.lastname}`,w.value=!1,console.log("Filled editBranchesForm Data:",t)},O=()=>{var d,n;const e=q.edit.row;console.log("Edit Row Data:",e),w.value=!1,t.name=e.name,t.location=e.location,t.employee_id=e.employee_id,t.employee_name=e.employees?f(e.employees):"No Person in Charge",v.value=e.employees?f(e.employees):"No Person in Charge",t.warehouse_id=e!=null&&e.warehouse_id?e.warehouse_id:(d=e==null?void 0:e.warehouse)!=null&&d.id?(n=e==null?void 0:e.warehouse)==null?void 0:n.id:"",t.phone=e.phone,t.status=e.status,h.value=!0,console.log("Edit Data:",t)},t=ie({name:"",location:"",person_incharge:"",employee_id:"",employee_name:"",warehouse_id:null,phone:"",status:null}),_=async()=>{console.log("editBranchesForm",t);try{await N.updateBranches(q.edit.row.id,t),h.value=!1}catch(e){console.error("Error updating branch:",e)}};return(e,d)=>(c(),V(T,null,[a($,{onClick:O,color:"positive",icon:"edit",size:"sm",flat:"",round:"",dense:""},{default:o(()=>[a(fe,{class:"bg-positive",delay:200},{default:o(()=>[k("Edit")]),_:1})]),_:1}),a(le,{modelValue:h.value,"onUpdate:modelValue":d[7]||(d[7]=n=>h.value=n),persistent:"","transition-show":"jump-up","transition-hide":"jump-down"},{default:o(()=>[a(j,{class:"my-card q-pa-none",style:{width:"420px","border-radius":"16px","box-shadow":"0 12px 24px rgba(0, 0, 0, 0.2)"}},{default:o(()=>[a(I,{class:"row items-center q-px-md q-py-sm bg-gradient text-white"},{default:o(()=>[Ae,a(pe),M(a($,{icon:"close",flat:"",dense:"",round:""},null,512),[[K]])]),_:1}),a(oe,{class:"separator-gradient"}),a(I,{class:"q-px-xl q-pt-none q-pb-lg"},{default:o(()=>[s("div",Te,[Oe,a(S,{modelValue:t.name,"onUpdate:modelValue":d[0]||(d[0]=n=>t.name=n),outlined:"",dense:""},null,8,["modelValue"])]),s("div",We,[je,a(S,{modelValue:t.location,"onUpdate:modelValue":d[1]||(d[1]=n=>t.location=n),outlined:"",dense:""},null,8,["modelValue"])]),s("div",Me,[Ke,s("div",null,[a(S,{modelValue:v.value,"onUpdate:modelValue":[d[2]||(d[2]=n=>v.value=n),D],label:"Search Employee",outlined:"",dense:"",debounce:"500",placeholder:"Enter name or position",onFocus:d[3]||(d[3]=n=>w.value=!0)},{append:o(()=>[x.value?(c(),C(ue,{key:1,color:"grey",size:"sm"})):(c(),C(H,{key:0,name:"search"}))]),default:o(()=>[w.value&&v.value?(c(),V("div",Re,[a(j,null,{default:o(()=>[a(_e,{separator:""},{default:o(()=>{var n;return[(n=b.value)!=null&&n.length?(c(!0),V(T,{key:1},ce(b.value,Q=>(c(),C(G,{onClick:ne=>U(Q),key:Q.id,clickable:""},{default:o(()=>[a(he,null,{default:o(()=>[k(F(`${Q.firstname} ${Q.middlename?Q.middlename.charAt(0)+".":""} ${Q.lastname}`),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128)):(c(),C(G,{key:0},{default:o(()=>[k(" No Employee Record ")]),_:1}))]}),_:1})]),_:1})])):me("",!0)]),_:1},8,["modelValue"])])]),s("div",Je,[He,a(X,{modelValue:t.warehouse_id,"onUpdate:modelValue":d[4]||(d[4]=n=>t.warehouse_id=n),"use-input":"","input-debounce":"0",options:B.value,"stack-label":"",outlined:"",dense:"","emit-value":"","map-options":"","option-label":"name","option-value":"id"},null,8,["modelValue","options"])]),s("div",Ge,[s("div",Xe,[Ye,a(S,{modelValue:t.phone,"onUpdate:modelValue":d[5]||(d[5]=n=>t.phone=n),outlined:"",dense:"",mask:"(+63) ### - ### - ####",placeholder:"(+63) ### - ### - ####",rules:[n=>n&&n.length>0]},null,8,["modelValue","rules"])]),s("div",Ze,[ea,a(X,{modelValue:t.status,"onUpdate:modelValue":d[6]||(d[6]=n=>t.status=n),outlined:"",dense:"",options:g},null,8,["modelValue"])])])]),_:1}),a(te,{class:"row q-px-lg q-py-sm q-pt-none",align:"right"},{default:o(()=>[M(a($,{class:"glossy",color:"grey-9",label:"Dismiss"},null,512),[[K]]),a($,{class:"glossy",color:"teal",label:"Save",onClick:_})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};var oa=R(aa,[["__scopeId","data-v-57acffea"]]);const be=u=>(Y("data-v-df6f3850"),u=u(),Z(),u),ta=be(()=>s("div",{class:"text-h5 q-mb-xs"},"Confirm Deletion",-1)),la=be(()=>s("p",{class:"text-body2 q-mb-none"}," Are you sure you want to delete this item? This action cannot be undone. ",-1)),sa={__name:"BranchesDeleteComponent",props:["delete"],setup(u){const f=ee(),p=m(!1),N=()=>{p.value=!0},E=u,B=async()=>{try{await f.deleteBranches(E.delete.row.id)}catch(q){console.error(q.message)}p.value=!1};return(q,h)=>(c(),V(T,null,[a($,{onClick:N,color:"negative",icon:"delete",size:"sm",flat:"",round:"",dense:""},{default:o(()=>[a(fe,{class:"bg-negative",delay:200},{default:o(()=>[k("Delete")]),_:1})]),_:1}),a(le,{modelValue:p.value,"onUpdate:modelValue":h[0]||(h[0]=g=>p.value=g)},{default:o(()=>[a(j,{class:"q-pa-md q-rounded q-elevate-2 bg-white text-grey-9"},{default:o(()=>[a(I,{class:"q-pt-none q-pb-sm"},{default:o(()=>[ta,la]),_:1}),a(oe,{class:"q-mb-md"}),a(te,{align:"right",class:"q-pt-none"},{default:o(()=>[M(a($,{flat:"",dense:"",label:"Cancel",color:"primary",class:"q-mr-sm"},null,512),[[K]]),a($,{dense:"",label:"Delete",color:"negative",onClick:B,class:"q-btn-rounded q-px-lg"})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};var na=R(sa,[["__scopeId","data-v-df6f3850"]]);const ra=u=>(Y("data-v-efcf8ca0"),u=u(),Z(),u),ia={key:0,class:"spinner-wrapper"},da={key:1},ua={key:0,class:"data-error"},ca=ra(()=>s("div",{class:"q-ml-sm text-h6"},"No data available",-1)),ma=["onClick"],pa={class:"row justify-center q-gutter-x-md"},ha={__name:"BranchesTableComponent",setup(u){const{capitalizeFirstLetter:f,formatFullname:p}=ge(),{getBranchBadgeStatusColor:N}=ke(),E=we(),B=ee(),q=se(),h=m(""),g=W(()=>B.branches),v=m(!0),x=m(!1),w=m({rowsPerPage:0}),b=W(()=>{if(!h.value)return g.value;const t=h.value.toLowerCase();return g.value.filter(_=>{var n;const e=_.name?_.name.toLowerCase():"",d=(n=_==null?void 0:_.warehouse)!=null&&n.name?_.warehouse.name.toLowerCase():"";return e.includes(t)||d.includes(t)})});de(async()=>{await q.fetchWarehouses(),await D()});const D=async()=>{v.value=!0;try{const t=await B.fetchBranches();console.log("branches data",t),x.value=g.value.length===0,console.log("branchesRow",g.value)}catch{x.value=!0}finally{v.value=!1}};qe(h,async t=>{v.value=!0,await new Promise(_=>setTimeout(_,1e3)),v.value=!1,x.value=b.value.length===0});const U=[{name:"branch_name",label:"Name of Branch",align:"left",field:t=>t.name,format:t=>`${t}`,sortable:!0},{name:"warehouse",label:"Warehouse",align:"left",field:t=>f(t!=null&&t.warehouse?t.warehouse:"No warehouse "),sortable:!0},{name:"location",label:"Location",align:"left",field:"location"},{name:"personIncharge",label:"Person In-charge",align:"left",field:t=>p(t)},{name:"phone",label:"Phone",align:"center",field:"phone"},{name:"status",label:"Status",align:"center",field:"status"},{name:"action",label:"Action",align:"center",field:"action"}],O=async t=>{console.log("brach",t),re.show();try{await E.push({name:"BranchDetail",params:{branch_id:t.id}})}finally{re.hide()}};return(t,_)=>(c(),V(T,null,[s("div",null,[a(S,{class:"q-pb-lg q-pl-sm dynamic-width",modelValue:h.value,"onUpdate:modelValue":_[0]||(_[0]=e=>h.value=e),outlined:"",placeholder:"Search",debounced:"1000",flat:"",dense:"",rounded:""},{append:o(()=>[a(H,{name:"search"})]),_:1},8,["modelValue"])]),v.value?(c(),V("div",ia,[a($e,{size:"50px",color:"primary"})])):(c(),V("div",da,[b.value.length===0?(c(),V("div",ua,[a(H,{name:"warning",color:"warning",size:"4em"}),ca])):(c(),C(Ce,{key:1,class:"table-container elegant-container sticky-header","virtual-scroll-sticky-size-start":48,flat:"",style:{height:"500px"},columns:U,rows:b.value,"row-key":"name",pagination:w.value,"onUpdate:pagination":_[1]||(_[1]=e=>w.value=e),"rows-per-page-options":[0],"hide-bottom":""},{"body-cell-branch_name":o(e=>[a(A,{key:"name",props:e},{default:o(()=>[s("a",{onClick:xe(d=>O(e.row),["prevent"]),class:"branch-link"},F(z(f)(e.row.name)),9,ma)]),_:2},1032,["props"])]),"body-cell-warehouse":o(e=>[a(A,{props:e},{default:o(()=>{var d;return[k(F(z(f)((d=e.row.warehouse)==null?void 0:d.name)),1)]}),_:2},1032,["props"])]),"body-cell-location":o(e=>[a(A,{props:e},{default:o(()=>[k(F(z(f)(e.row.location)),1)]),_:2},1032,["props"])]),"body-cell-status":o(e=>[a(A,{key:"name",props:e},{default:o(()=>[a(J,{outline:"",color:z(N)(e.row.status)},{default:o(()=>[k(F(z(f)(e.row.status)||"-"),1)]),_:2},1032,["color"])]),_:2},1032,["props"])]),"body-cell-personIncharge":o(e=>[a(A,{props:e},{default:o(()=>[k(F(z(p)(e.row.employees)),1)]),_:2},1032,["props"])]),"body-cell-action":o(e=>[a(A,{props:e},{default:o(()=>[s("div",pa,[a(oa,{edit:e},null,8,["edit"]),a(na,{delete:e},null,8,["delete"])])]),_:2},1032,["props"])]),_:1},8,["rows","pagination"]))]))],64))}};var _a=R(ha,[["__scopeId","data-v-efcf8ca0"]]);const va={class:"text-h6 text-dark"},fa={class:"q-gutter-x-sm"},ga={__name:"BranchesPage",setup(u){return(f,p)=>(c(),C(Ve,{class:"elegant-container",flat:""},{default:o(()=>[a(I,{class:"row justify-between"},{default:o(()=>[s("div",va,[s("div",fa,[a(J,{outline:"",label:"Open",color:"info"}),a(J,{outline:"",label:"Open Soon",color:"warning"}),a(J,{outline:"",label:"Close",color:"accent"})])]),s("div",null,[a(ze)])]),_:1}),a(I,null,{default:o(()=>[s("div",null,[a(_a)])]),_:1})]),_:1}))}};var ja=R(ga,[["__scopeId","data-v-2b0481bd"]]);export{ja as default};
