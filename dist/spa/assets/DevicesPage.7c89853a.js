import{d as ue,r as g,N as S,P as Q,c as M,u as Z,t as ee,o as d,a2 as b,f as e,M as q,w as a,Q as I,I as k,ad as N,J as n,K as D,b5 as K,e as V,L as O,bb as J,$ as C,a3 as F,a4 as G,_ as H,bc as A,aI as ae,a1 as R,O as W,R as j,a0 as ce,z as me}from"./index.90e14ade.js";import{Q as ve}from"./QPage.b58e5763.js";import{Q as te}from"./QSpace.df1b0d53.js";import{Q as X,a as E,b as Y}from"./QList.f5d06b33.js";import{C as T}from"./ClosePopup.a7ee5f13.js";import{api as P}from"./axios.5df481c6.js";import{u as pe}from"./branch.7257c2ec.js";import{u as _e}from"./warehouse.e23cd065.js";import{_ as B}from"./plugin-vue_export-helper.21dcd24c.js";import{Q as ge}from"./QSpinnerDots.5ad650c9.js";import{Q as fe,a as he}from"./QTable.73a7d3d9.js";import{Q as le}from"./QTooltip.ee5c219f.js";import"./employee.07f743e5.js";import"./QVirtualScroll.fa89f4f2.js";import"./use-virtual-scroll.15feeafd.js";import"./rtl.afc00592.js";import"./QSelect.1159fbbe.js";import"./QChip.0c55697e.js";import"./QMenu.c7ee5ea4.js";import"./selection.197c480b.js";const L=ue("devices",()=>{const i=g(null),m=g([]),v=async()=>{try{const o=await P.get("/api/device");m.value=o.data}catch(o){console.log("error fetchig  device",o),S.create({type:"negative",message:"Failed to fetch devices",setTimeout:1e3})}};return{device:i,devices:m,fetchDevices:v,createDevices:async o=>{Q.show(),console.log("Data parameters being sent:",o);try{const c=await P.post("/api/device",o);v(),S.create({type:"positive",message:"Device created successfully",setTimeout:1e3})}catch(c){console.error("error device",c),S.create({type:"negative",message:"Failed to create device",setTimeout:1e3})}finally{Q.hide()}},updateDevice:async(o,c)=>{Q.show();try{const u=await P.put(`/api/device/${o}`,c),h=m.value.findIndex(t=>t.id===o);h!==-1&&(m.value[h]=u.data),S.create({type:"positive",message:"Device updated successfully",setTimeout:1e3})}catch(u){console.log("update device error",u),S.create({type:"negative",message:"Failed to update device",setTimeout:1e3})}finally{Q.hide()}},deleteDevice:async o=>{Q.show();try{const c=await P.delete(`/api/device/${o}`);m.value=m.value.filter(u=>u.id!==o),S.create({type:"positive",message:"Device deleted successfully"})}catch{S.create({type:"negative",message:"Failed to delete device"})}finally{Q.hide()}}}});const U=i=>(W("data-v-5517b6a8"),i=i(),j(),i),ye=U(()=>n("div",{class:"text-h5 q-mr-md"},"\u{1F4F1} Add Device",-1)),be={class:"q-mt-lg q-animated q-animate-bounce"},De=U(()=>n("div",null,"UUID",-1)),qe={class:"q-mt-md q-animated q-animate-bounce"},we=U(()=>n("div",null,"Name",-1)),Ve={class:"q-mt-md q-animated q-animate-bounce"},xe=U(()=>n("div",null,"Model",-1)),ke={class:"q-mt-md q-animated q-animate-bounce"},$e=U(()=>n("div",null,"OS Version",-1)),Se={class:"q-gutter-x-lg"},Ue={key:0,class:"q-mt-md q-animated q-animate-bounce"},Qe=U(()=>n("div",null,"Designation Branch",-1)),Ce={key:0,class:"custom-list z-top"},Ie={key:1,class:"q-mt-md q-animated q-animate-bounce"},Ne=U(()=>n("div",null,"Warehouse",-1)),Fe={key:0,class:"custom-list z-top"},Te={__name:"AddDevice",setup(i){L();const m=pe(),v=M(()=>m.branch),p=_e(),f=M(()=>p.warehouse);console.log("warehouse",f.value);const _=g(!1);g(!1);const o=g(""),c=g(""),u=g(!1),h=g(!1),t=g(null);Z(t,w=>{y.designation=w});const s=()=>{_.value=!0},x=async()=>{o.value.trim()&&await m.search(o.value)},se=w=>{console.log("selected branch:",w),y.reference_id=w.id,o.value=w.name,u.value=!1,console.log("Filled addNewBranchForm Data:",y)},ne=async()=>{c.value.trim()&&await p.search(c.value)},ie=w=>{console.log("selected branch:",w),y.reference_id=w.id,c.value=w.name,u.value=!1,console.log("Filled addNewBranchForm Data:",y)},y=ee({uuid:"",name:"",model:"",os_version:"",reference_id:"",designation:""}),de=async()=>{console.log("device sent:",y)};return(w,r)=>(d(),b("div",null,[e(q,{outline:"",icon:"add_circle",label:"Add Device",onClick:s,style:{"background-color":"#ef4444"}}),e(R,{modelValue:_.value,"onUpdate:modelValue":r[10]||(r[10]=l=>_.value=l),persistent:"","transition-show":"jump-up","transition-hide":"jump-down"},{default:a(()=>[e(I,{class:"my-card q-pa-none",style:{width:"420px","border-radius":"16px","box-shadow":"0 12px 24px rgba(0, 0, 0, 0.2)"}},{default:a(()=>[e(k,{class:"row items-center q-px-md q-py-sm bg-gradient text-white"},{default:a(()=>[ye,e(te),N(e(q,{icon:"close",flat:"",dense:"",round:""},null,512),[[T]])]),_:1}),e(k,{class:"q-px-xl q-pt-none q-pb-lg"},{default:a(()=>[n("div",be,[De,e(D,{modelValue:y.uuid,"onUpdate:modelValue":r[0]||(r[0]=l=>y.uuid=l),outlined:"",dense:"",rules:[l=>l&&l.length>0||"Device UUID is required"]},null,8,["modelValue","rules"])]),n("div",qe,[we,e(D,{class:"text-capitalize",modelValue:y.name,"onUpdate:modelValue":r[1]||(r[1]=l=>y.name=l),outlined:"",dense:"",rules:[l=>l&&l.length>0||"Device Name is required"]},null,8,["modelValue","rules"])]),n("div",Ve,[xe,e(D,{modelValue:y.model,"onUpdate:modelValue":r[2]||(r[2]=l=>y.model=l),outlined:"",dense:"",rules:[l=>l&&l.length>0||"Device Model is required"]},null,8,["modelValue","rules"])]),n("div",ke,[$e,e(D,{modelValue:y.os_version,"onUpdate:modelValue":r[3]||(r[3]=l=>y.os_version=l),outlined:"",dense:"",rules:[l=>l&&l.length>0||"Device OS Version is required"]},null,8,["modelValue","rules"])]),n("div",Se,[e(K,{"keep-color":"",modelValue:t.value,"onUpdate:modelValue":r[4]||(r[4]=l=>t.value=l),label:"Branch",color:"red","true-value":"branch","false-value":null,"indeterminate-value":"false"},null,8,["modelValue"]),e(K,{"keep-color":"",modelValue:t.value,"onUpdate:modelValue":r[5]||(r[5]=l=>t.value=l),label:"Warehouse",color:"blue-grey-10","true-value":"warehouse","false-value":null,"indeterminate-value":"false"},null,8,["modelValue"])]),t.value==="branch"?(d(),b("div",Ue,[Qe,e(D,{modelValue:o.value,"onUpdate:modelValue":[r[6]||(r[6]=l=>o.value=l),x],outlined:"",dense:"",debounce:"500",onFocus:r[7]||(r[7]=l=>u.value=!0)},{append:a(()=>[h.value?(d(),V(J,{key:1,color:"grey",size:"sm"})):(d(),V(O,{key:0,name:"search"}))]),default:a(()=>[u.value&&o.value?(d(),b("div",Ce,[e(I,null,{default:a(()=>[e(X,{separator:""},{default:a(()=>{var l;return[(l=v.value)!=null&&l.length?(d(!0),b(F,{key:1},G(v.value,$=>(d(),V(E,{onClick:re=>se($),key:$.id,clickable:""},{default:a(()=>[e(Y,null,{default:a(()=>[C(H($.name),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128)):(d(),V(E,{key:0},{default:a(()=>[C("No Employee Record")]),_:1}))]}),_:1})]),_:1})])):A("",!0)]),_:1},8,["modelValue"])])):A("",!0),t.value==="warehouse"?(d(),b("div",Ie,[Ne,e(D,{modelValue:c.value,"onUpdate:modelValue":[r[8]||(r[8]=l=>c.value=l),ne],outlined:"",dense:"",debounce:"500",onFocus:r[9]||(r[9]=l=>u.value=!0)},{append:a(()=>[h.value?(d(),V(J,{key:1,color:"grey",size:"sm"})):(d(),V(O,{key:0,name:"search"}))]),default:a(()=>[u.value&&c.value?(d(),b("div",Fe,[e(I,null,{default:a(()=>[e(X,{separator:""},{default:a(()=>{var l;return[(l=f.value)!=null&&l.length?(d(!0),b(F,{key:1},G(f.value,$=>(d(),V(E,{key:$.id,onClick:re=>ie($),clickable:""},{default:a(()=>[e(Y,null,{default:a(()=>[C(H($.name),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128)):(d(),V(E,{key:0},{default:a(()=>[C("No Warehouse Record")]),_:1}))]}),_:1})]),_:1})])):A("",!0)]),_:1},8,["modelValue"])])):A("",!0)]),_:1}),e(ae,{class:"row q-px-lg q-py-sm q-pt-none",align:"right"},{default:a(()=>[N(e(q,{class:"btn-cancel glossy",color:"negative",label:"Dismiss"},null,512),[[T]]),e(q,{class:"btn-create glossy",color:"positive",label:"Create",onClick:de})]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}};var Be=B(Te,[["__scopeId","data-v-5517b6a8"]]);const oe=i=>(W("data-v-1abbd28a"),i=i(),j(),i),ze=oe(()=>n("div",{class:"text-h5 q-mb-xs"},"Confirm Deletion",-1)),Ae=oe(()=>n("p",{class:"text-body2 q-mb-none"}," Are you sure you want to delete this item? This action cannot be undone. ",-1)),Ee={__name:"DeviceDelete",props:["delete"],emits:["device-deleted"],setup(i,{emit:m}){const v=L(),p=i,f=m,_=g(!1),o=()=>{_.value=!0},c=async()=>{try{await v.deleteDevice(p.delete.row.id),_.value=!1,f("device-deleted")}catch(u){console.error("Error deleting item:",u)}_.value=!1};return(u,h)=>(d(),b(F,null,[e(q,{color:"negative",icon:"delete",size:"sm",flat:"",round:"",dense:"",onClick:o},{default:a(()=>[e(le,{class:"bg-negative",delay:200},{default:a(()=>[C("Delete")]),_:1})]),_:1}),e(R,{modelValue:_.value,"onUpdate:modelValue":h[0]||(h[0]=t=>_.value=t)},{default:a(()=>[e(I,{class:"q-pa-md q-rounded q-elevate-2 bg-white text-grey-9"},{default:a(()=>[e(k,{class:"q-pt-none q-pb-sm"},{default:a(()=>[ze,Ae]),_:1}),e(ce,{class:"q-mb-md"}),e(k,{align:"right",class:"q-pt-none"},{default:a(()=>[N(e(q,{flat:"",dense:"",label:"Cancel",color:"primary",class:"q-mr-sm"},null,512),[[T]]),e(q,{dense:"",label:"Delete",color:"negative",onClick:c,class:"q-btn-rounded q-px-lg"})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};var Pe=B(Ee,[["__scopeId","data-v-1abbd28a"]]);const z=i=>(W("data-v-1abd83be"),i=i(),j(),i),Me=z(()=>n("div",{class:"text-h5 q-mr-md"},"\u{1F4F1} Edit Device",-1)),Oe={class:"q-mt-lg q-animated q-animate-bounce"},We=z(()=>n("div",null,"UUID",-1)),je={class:"q-mt-md q-animated q-animate-bounce"},Le=z(()=>n("div",null,"Name",-1)),Re={class:"q-mt-md q-animated q-animate-bounce"},Ke=z(()=>n("div",null,"Model",-1)),Je={class:"q-mt-md q-animated q-animate-bounce"},Ge=z(()=>n("div",null,"OS Version",-1)),He={__name:"DeviceEdit",props:["edit"],emits:["device-updated"],setup(i,{emit:m}){const v=L(),p=g(!1);g(!0);const f=i,_=m,o=ee({uuid:"",name:"",model:"",os_version:""}),c=()=>{Object.assign(o,f.edit.row),p.value=!0},u=async()=>{try{const h={...f.edit.row,...o};await v.updateDevice(f.edit.row.id,h),p.value=!1,_("device-updated")}catch(h){console.log("error update device",h)}};return(h,t)=>(d(),b(F,null,[e(q,{color:"positive",icon:"edit",size:"sm",flat:"",round:"",dense:"",onClick:c},{default:a(()=>[e(le,{class:"bg-positive",delay:200},{default:a(()=>[C("Edit")]),_:1})]),_:1}),e(R,{modelValue:p.value,"onUpdate:modelValue":t[4]||(t[4]=s=>p.value=s),persistent:"","transition-show":"jump-up","transition-hide":"jump-down"},{default:a(()=>[e(I,{class:"my-card q-pa-none",style:{width:"420px","border-radius":"16px","box-shadow":"0 12px 24px rgba(0, 0, 0, 0.2)"}},{default:a(()=>[e(k,{class:"row items-center q-px-md q-py-sm bg-gradient text-white"},{default:a(()=>[Me,e(te),N(e(q,{icon:"close",flat:"",dense:"",round:""},null,512),[[T]])]),_:1}),e(k,{class:"q-px-xl q-pt-none q-pb-lg"},{default:a(()=>[n("div",Oe,[We,e(D,{modelValue:o.uuid,"onUpdate:modelValue":t[0]||(t[0]=s=>o.uuid=s),outlined:"",dense:"",rules:[s=>s&&s.length>0||"Device UUID is required"]},null,8,["modelValue","rules"])]),n("div",je,[Le,e(D,{modelValue:o.name,"onUpdate:modelValue":t[1]||(t[1]=s=>o.name=s),outlined:"",dense:"",rules:[s=>s&&s.length>0||"Device Name is required"]},null,8,["modelValue","rules"])]),n("div",Re,[Ke,e(D,{modelValue:o.model,"onUpdate:modelValue":t[2]||(t[2]=s=>o.model=s),outlined:"",dense:"",rules:[s=>s&&s.length>0||"Device Model is required"]},null,8,["modelValue","rules"])]),n("div",Je,[Ge,e(D,{modelValue:o.os_version,"onUpdate:modelValue":t[3]||(t[3]=s=>o.os_version=s),outlined:"",dense:"",rules:[s=>s&&s.length>0||"Device OS Version is required"]},null,8,["modelValue","rules"])])]),_:1}),e(ae,{class:"row q-px-lg q-py-sm q-pt-none",align:"right"},{default:a(()=>[N(e(q,{class:"btn-cancel glossy",color:"negative",label:"Dismiss"},null,512),[[T]]),e(q,{class:"btn-create glossy",color:"positive",label:"Save",onClick:u})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};var Xe=B(He,[["__scopeId","data-v-1abd83be"]]);const Ye=i=>(W("data-v-3b94b6f1"),i=i(),j(),i),Ze={key:0,class:"spinner-wrapper"},ea={key:1},aa={key:0,class:"data-error"},ta=Ye(()=>n("div",{class:"q-ml-sm text-h6"},"No data available",-1)),la={class:"row justify-center q-gutter-x-md"},oa={__name:"DeviceTable",setup(i){const m=L(),v=g(""),p=g(!0),f=M(()=>m.devices),_=g(!1),o=g({rowPerPage:0}),c=M(()=>v.value?f.value.filter(t=>(t.name||"").toLowerCase().includes(v.value.toLowerCase())):f.value);me(async()=>{const t=await u();console.log("response device",t)});const u=async()=>{try{p.value=!0;const t=await m.fetchDevices();f.value.length||(_.value=!0),console.log("device fetch:",t)}catch(t){console.log("error fetching device",t),_.value=!0}finally{p.value=!1}};Z(v,async t=>{p.value=!0,await new Promise(s=>setTimeout(s,1e3)),p.value=!1,_.value=c.value.length===0});const h=[{name:"name",label:"Name",align:"center",field:"name",format:t=>`${t}`,sortable:!0},{name:"model",label:"Model",align:"center",field:"model"},{name:"os_version",label:"OS Version",align:"center",field:"os_version"},{name:"uuid",label:"UUID",align:"center",field:"uuid"},{name:"branch_name",label:"Branch Name",align:"center",field:t=>t.branch?t.branch.name:"N/A"},{name:"action",label:"Action",align:"center",field:"action"}];return(t,s)=>(d(),b(F,null,[n("div",null,[e(D,{modelValue:v.value,"onUpdate:modelValue":s[0]||(s[0]=x=>v.value=x),class:"q-pb-lg q-pl-sm dynamic-width",outlined:"",placeholder:"search",flat:"",rounded:"",dense:"",debounce:"100"},{append:a(()=>[e(O,{name:"search"})]),_:1},8,["modelValue"])]),p.value?(d(),b("div",Ze,[e(ge,{size:"50px",color:"primary"})])):(d(),b("div",ea,[c.value.length===0?(d(),b("div",aa,[e(O,{name:"warning",color:"warning",size:"4em"}),ta])):(d(),V(he,{key:1,class:"table-container elegant-container sticky-header",filter:v.value,"virtual-scroll-sticky-size-start":48,flat:"",style:{height:"400px"},columns:h,rows:f.value,"row-key":"name","virtual-scroll":"",pagination:o.value,"onUpdate:pagination":s[1]||(s[1]=x=>o.value=x),"rows-per-page-options":[0],"hide-bottom":""},{"body-cell-action":a(x=>[e(fe,{props:x},{default:a(()=>[n("div",la,[e(Xe,{edit:x,onDeviceUpdated:u},null,8,["edit"]),e(Pe,{delete:x,onDeviceDeleted:u},null,8,["delete"])])]),_:2},1032,["props"])]),_:1},8,["filter","rows","pagination"]))]))],64))}};var sa=B(oa,[["__scopeId","data-v-3b94b6f1"]]);const na={align:"right"},ia={__name:"DevicesPage",setup(i){return(m,v)=>(d(),V(ve,null,{default:a(()=>[e(I,{class:"elegant-container",flat:""},{default:a(()=>[e(k,null,{default:a(()=>[n("div",na,[e(Be)])]),_:1}),e(k,null,{default:a(()=>[e(sa)]),_:1})]),_:1})]),_:1}))}};var Sa=B(ia,[["__scopeId","data-v-bc8265ea"]]);export{Sa as default};
