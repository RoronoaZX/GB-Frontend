import{r as u,c as w,u as D,z as N,o as n,a3 as h,J as c,f as o,w as l,e as x,L as $,bc as C,K as z,aK as F,a0 as Q,$ as P,bd as T,Q as K,I as b}from"./index.fd0a6a0f.js";import{Q as y}from"./QBadge.04d3b468.js";import{Q as L}from"./QChip.5f7da547.js";import{Q as j,a as E}from"./QTable.0bcfe0f0.js";import{Q as G}from"./QBanner.402cc600.js";import{u as U}from"./baker-report.419d86f3.js";import{_ as W}from"./plugin-vue_export-helper.21dcd24c.js";import"./QVirtualScroll.1edb3d5f.js";import"./QList.9fd6410d.js";import"./use-virtual-scroll.898135f8.js";import"./QSelect.89cadb1b.js";import"./QMenu.82e2653d.js";import"./selection.405dc259.js";import"./axios.57f358d3.js";const A={class:"q-gutter-md"},J={class:"table-container"},H={key:0,class:"loading-overlay row justify-center items-center"},O={key:1,class:"q-pa-md q-gutter-md row justify-center"},X={__name:"RawMaterialsTable",setup(q){var M,R;const m=u({rowsPerPage:0}),r=u(""),_=u(!1),d=u(!0),g=U(),k=w(()=>g.user);console.log("userData in RawMaterialsTable:",k.value);const p=((R=(M=k.value)==null?void 0:M.device)==null?void 0:R.reference_id)||"";console.log("branchId in RawMaterialsTable:",p);const i=w(()=>g.rawmaterials),f=u(!1);D(r,async a=>{_.value=!0,await new Promise(e=>setTimeout(e,1e3)),_.value=!1,f.value=!d.value&&v.value.length===0,console.log("Filtered Rows:",v.value)}),N(async()=>{console.log("props.branchId in onMounted:",p),p&&await B(p)});const B=async a=>{console.log("Fetching products for branch ID:",a);try{d.value=!0;const e=await g.fetchBranchRawMaterials(a);i.value=e,i.value.length||(f.value=!0),console.log("Branch Raw Materials",i.value)}catch(e){console.log("Error fetching branch product:",e),f.value=!0}finally{d.value=!1}},v=w(()=>{if(!r.value)return i.value;const a=r.value.toLowerCase();return i.value.filter(e=>e.ingredients.code.toLowerCase().includes(a))}),S=[{name:"code",label:"Code",align:"center",field:a=>{var e,t;return(t=(e=a==null?void 0:a.ingredients)==null?void 0:e.code)!=null?t:"No Code"},format:a=>`${a}`,sortable:!0},{name:"total_quantity",align:"center",label:"Available Stocks",field:"total_quantity",sortable:!0}],I=a=>{const e=a.total_quantity;if(a.ingredients.unit==="Grams"&&e<1e3)return"bg-red";let s;return e>=1e3?s=e/1e3:s=e,s<5?s<=2?"bg-red":(s<=3,"bg-warning"):"bg-positive"},V=a=>{const e=a.total_quantity,t=a.ingredients.unit;if(e>1e3){const s=(e/1e3).toFixed(2);return s.endsWith(".00")?`${Math.round(e/1e3)} kilos`:`${s} kilos`}else return e>1?`${e} ${t}`:`${e} ${t}`};return(a,e)=>(n(),h("div",A,[c("div",null,[o(z,{rounded:"",outlined:"",dense:"",debounce:"300",modelValue:r.value,"onUpdate:modelValue":e[0]||(e[0]=t=>r.value=t),placeholder:"Search",style:{width:"500px","max-width":"1500px","min-width":"100px"}},{append:l(()=>[_.value?(n(),x(C,{key:1})):(n(),x($,{key:0,name:"search"}))]),_:1},8,["modelValue"])]),c("div",J,[o(E,{class:"sticky-header",filter:r.value,"virtual-scroll-sticky-size-start":48,flat:"",style:{height:"350px"},columns:S,rows:v.value,"row-key":"name","virtual-scroll":"",pagination:m.value,"onUpdate:pagination":e[1]||(e[1]=t=>m.value=t),"rows-per-page-options":[0],"hide-bottom":""},{"body-cell-total_quantity":l(t=>[o(j,{props:t},{default:l(()=>[o(L,{square:"",class:F(["text-white",I(t.row)])},{default:l(()=>[Q(P(V(t.row)),1)]),_:2},1032,["class"])]),_:2},1032,["props"])]),_:1},8,["filter","rows","pagination"]),d.value?(n(),h("div",H,[o(C,{size:"50px"})])):T("",!0),f.value?(n(),h("div",O,[o(G,{class:"bg-grey-1",dense:""},{default:l(()=>[Q(" No data available ")]),_:1})])):T("",!0)])]))}};var Y=W(X,[["__scopeId","data-v-33746c25"]]);const Z={class:"text-h6 text-white"},ee={class:"q-gutter-x-sm"},_e={__name:"RawMaterialsPage",setup(q){return(m,r)=>(n(),x(K,{flat:""},{default:l(()=>[o(b,{style:{"background-color":"#ef4444"}},{default:l(()=>[c("div",Z,[o($,{name:"fa-solid fa-layer-group"}),Q(" Raw Materials ")])]),_:1}),o(b,null,{default:l(()=>[c("div",ee,[o(y,{label:"Good",class:"text-white",color:"positive"}),o(y,{label:"Warning",class:"text-white",color:"warning"}),o(y,{label:"Danger",class:"text-white",color:"red"})])]),_:1}),o(b,null,{default:l(()=>[c("div",null,[o(Y)])]),_:1})]),_:1}))}};export{_e as default};
