import{be as E,c as I,r as q,t as Be,o as f,a3 as M,f as e,M as T,w as a,Q as F,I as B,ae as ue,J as l,K as W,L as K,e as P,a0 as y,a4 as N,a5 as H,$ as V,bd as xe,aJ as ce,a2 as Z,O as re,R as oe,a1 as Pe,N as G,P as be,z as se,u as de,aK as Re,bb as Ne,bf as te,H as Ue}from"./index.9b38bd76.js";import{Q as me}from"./QSpace.11b99d1b.js";import{Q as Ce,a as J,b as Me,c as X}from"./QTabPanels.20d34d4f.js";import{Q as Fe}from"./QPage.587c06eb.js";import{Q as j}from"./QBadge.43dd1e1d.js";import{Q as Le}from"./QSpinnerDots.ec6ca63d.js";import{Q as ke}from"./QTooltip.8e04d2e6.js";import{Q as ze}from"./QPopupEdit.e583f0f6.js";import{Q as O,a as _e}from"./QTable.5bd67064.js";import{Q as le,a as A,b as S}from"./QList.e3794630.js";import{Q as D}from"./rtl.35c1fbd1.js";import{C as pe}from"./ClosePopup.114ba7c5.js";import"./branch-product.ae897ee2.js";import{u as ne}from"./warehouse-rawMaterials.ab0f46b6.js";import{u as qe}from"./raw-material.982c78ed.js";import{_ as ee}from"./plugin-vue_export-helper.21dcd24c.js";import{api as $e}from"./axios.9ae20ed7.js";import{Q as ie}from"./QSkeleton.6c9bfdb9.js";import{u as Ve}from"./use-quasar.6b964233.js";import{u as Qe}from"./warehouse.dc6dadcb.js";import{u as Se}from"./use-dialog-plugin-component.f76768ed.js";import{u as fe}from"./premix.7a638a32.js";import{q as We}from"./date.66895901.js";import{Q as Ae,a as je}from"./QStepper.99304226.js";import{u as Ke}from"./baker-report.cc593aff.js";import"./QResizeObserver.e4ddd9ae.js";import"./use-panel.594ec10e.js";import"./touch.9135741d.js";import"./selection.3d089072.js";import"./QMenu.3416801c.js";import"./QVirtualScroll.3618d137.js";import"./use-virtual-scroll.709cbaa8.js";import"./QSelect.005914a8.js";import"./QChip.79c4366f.js";import"./product.6ef2125c.js";import"./QSlideTransition.0938e139.js";const ae=o=>(re("data-v-6d7559b4"),o=o(),oe(),o),Ee=ae(()=>l("div",{class:"text-h6"},"Create Warehouse Raw Materials",-1)),He={class:"q-mb-lg"},Oe={key:0,class:"custom-list z-top"},Ye=ae(()=>l("div",null,"Raw Materials Code",-1)),Ge=ae(()=>l("div",null,"Raw Materials Name",-1)),Je=ae(()=>l("div",null,"Category",-1)),Xe=ae(()=>l("div",null,"Quantity",-1)),Ze={__name:"RawMaterialsCreate",setup(o){const k=E(),v=qe(),g=I(()=>v.rawMaterials),n=ne(),u=q(""),b=async()=>{v.searchRawMaterials(u.value)},x=I(()=>r.total_quantity!==""),c=q(!1),Q=()=>{c.value=!0},$=()=>{i(),c.value=!1},m=h=>{r.raw_material_id=h.id,r.raw_materials_name=h.name,r.raw_materials_code=h.code,r.category=h.category,r.unit=h.unit,u.value=""},r=Be({raw_material_id:"",raw_materials_name:"",raw_materials_code:"",total_quantity:"",category:"",unit:"",warehouse_id:k.params.warehouse_id}),i=()=>{r.raw_material_id="",r.raw_materials_name="",r.raw_materials_code="",r.total_quantity="",r.raw_material_id="",r.category="",r.unit=""},R=async()=>{try{const{product_name:h,...t}=r;await n.createWarehouseRawMaterials(t),console.log("data to send",t),c.value=!1}catch(h){console.log(h)}};return(h,t)=>(f(),M(N,null,[e(T,{class:"bg-gradient text-white q-pa-sm",icon:"add_circle",label:"Create One",onClick:Q}),e(Z,{modelValue:c.value,"onUpdate:modelValue":t[5]||(t[5]=s=>c.value=s),persistent:""},{default:a(()=>[e(F,{class:"my-card",style:{width:"400px","max-width":"500px","min-width":"100px"}},{default:a(()=>[e(B,{class:"row items-center text-white bg-gradient"},{default:a(()=>[Ee,e(me),ue(e(T,{icon:"close",flat:"",dense:"",round:""},null,512),[[pe]])]),_:1}),e(B,{class:"q-ma-md q-gutter-y-sm"},{default:a(()=>[l("div",He,[e(W,{modelValue:u.value,"onUpdate:modelValue":[t[0]||(t[0]=s=>u.value=s),b],debounce:"1000",outlined:"",rounded:"",placeholder:"Search Raw Materials",dense:""},{append:a(()=>[l("div",null,[e(K,{name:"search"})])]),default:a(()=>[u.value?(f(),M("div",Oe,[e(F,null,{default:a(()=>[e(le,{separator:""},{default:a(()=>{var s;return[(s=g.value)!=null&&s.length?(f(!0),M(N,{key:1},H(g.value,_=>(f(),P(A,{onClick:C=>m(_),key:_.id,clickable:""},{default:a(()=>[e(S,null,{default:a(()=>[e(D,null,{default:a(()=>[y(V(_.name),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128)):(f(),P(A,{key:0},{default:a(()=>[y(" No record found. ")]),_:1}))]}),_:1})]),_:1})])):xe("",!0)]),_:1},8,["modelValue"])]),l("div",null,[Ye,e(W,{modelValue:r.raw_materials_code,"onUpdate:modelValue":t[1]||(t[1]=s=>r.raw_materials_code=s),readonly:"",dense:"",outlined:""},null,8,["modelValue"])]),l("div",null,[Ge,e(W,{modelValue:r.raw_materials_name,"onUpdate:modelValue":t[2]||(t[2]=s=>r.raw_materials_name=s),readonly:"",dense:"",outlined:""},null,8,["modelValue"])]),l("div",null,[Je,e(W,{modelValue:r.category,"onUpdate:modelValue":t[3]||(t[3]=s=>r.category=s),readonly:"",dense:"",outlined:""},null,8,["modelValue"])]),l("div",null,[Xe,e(W,{modelValue:r.total_quantity,"onUpdate:modelValue":t[4]||(t[4]=s=>r.total_quantity=s),type:"number",outlined:"",suffix:r.unit||"",dense:"",rules:[s=>s&&s.length>0||"Total quantity is required"]},null,8,["modelValue","suffix","rules"])])]),_:1}),e(ce,{class:"row q-ma-md",align:"right"},{default:a(()=>[e(T,{class:"glossy",color:"grey-9",label:"Dismiss",onClick:$}),e(T,{class:"glossy",color:"teal",label:"Create",onClick:R,disable:!x.value},null,8,["disable"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};var ea=ee(Ze,[["__scopeId","data-v-6d7559b4"]]);const De=o=>(re("data-v-46834346"),o=o(),oe(),o),aa=De(()=>l("div",{class:"text-h5 q-mb-xs"},"Confirm Deletion",-1)),ta=De(()=>l("p",{class:"text-body2 q-mb-none"}," Are you sure you want to delete this item? This action cannot be undone. ",-1)),la={__name:"RawMaterialsTableDelete",props:["delete"],setup(o){const k=ne(),v=o,g=async()=>{console.log("clickkkd");try{await k.deleteWarehouseRawMaterials(v.delete.row.id),G.create({type:"negative",icon:"warning",message:`Raw Materials ${v.delete.row.name}  successfully deleted`,timeout:1e3,position:"top"}),n.value=!1}catch(b){console.error(b.message)}},n=q(!1),u=()=>{n.value=!0};return(b,x)=>(f(),M(N,null,[e(T,{onClick:u,color:"negative",icon:"delete",size:"sm",flat:"",round:"",dense:"",align:"center"},{default:a(()=>[e(ke,{class:"bg-negative",delay:200},{default:a(()=>[y("Delete")]),_:1})]),_:1}),e(Z,{modelValue:n.value,"onUpdate:modelValue":x[0]||(x[0]=c=>n.value=c)},{default:a(()=>[e(F,null,{default:a(()=>[e(B,{class:"q-pa-md q-rounded q-elevate-2 bg-white text-grey-9"},{default:a(()=>[aa,ta]),_:1}),e(Pe,{class:"q-mb-md"}),e(B,null,{default:a(()=>[e(ce,{align:"right",class:"q-pt-none"},{default:a(()=>[ue(e(T,{flat:"",dense:"",label:"Cancel",color:"primary",class:"q-mr-sm"},null,512),[[pe]]),e(T,{dense:"",label:"Delete",color:"negative",onClick:g,class:"q-btn-rounded q-px-lg"})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};var ra=ee(la,[["__scopeId","data-v-46834346"]]);const oa=o=>(re("data-v-272d4a61"),o=o(),oe(),o),sa=oa(()=>l("div",{class:"text-h6"},"Create Warehouse Raw Materials",-1)),na={__name:"RawMaterialsCreateAll",setup(o){const k=q(!1),v=async()=>{k.value=!0},g=E(),n=qe(),u=I(()=>n.rawMaterials);console.log("rawMaterialsData",u.value);const b=ne(),x=async()=>{if(be.show(),await n.fetchRawMaterials(),!n.rawMaterials.length){G.create({type:"warning",message:"No raw materials found!"});return}be.hide()},c=()=>{n.rawMaterials=[],k.value=!1},Q=async()=>{try{const $=u.value.map(m=>({raw_material_id:m.id,total_quantity:0,warehouse_id:g.params.warehouse_id}));await b.createMultipleWarehouseRawMaterials($),console.log("materialsToSave",$),G.create({type:"positive",message:"All raw materials added to warehouse!"}),c()}catch($){console.error("Error adding all raw materials:",$),G.create({type:"negative",message:"Failed to add all raw materials!"})}};return($,m)=>(f(),M("div",null,[e(T,{class:"bg-gradient text-white q-pa-sm",icon:"add_circle",label:"Create All",onClick:v}),e(Z,{modelValue:k.value,"onUpdate:modelValue":m[0]||(m[0]=r=>k.value=r)},{default:a(()=>[e(F,{style:{width:"700px","max-width":"80vw"}},{default:a(()=>[e(B,{class:"row items-center text-white bg-gradient"},{default:a(()=>[sa,e(me),ue(e(T,{icon:"close",flat:"",dense:"",round:""},null,512),[[pe]])]),_:1}),e(B,null,{default:a(()=>[e(T,{class:"bg-gradient text-white q-pa-sm",icon:"add_circle",label:"Fetch All",onClick:x})]),_:1}),e(B,null,{default:a(()=>[e(le,{dense:"",separator:"",class:"box"},{default:a(()=>[e(A,null,{default:a(()=>[e(S,null,{default:a(()=>[e(D,{class:"text-overline"},{default:a(()=>[y(" Code")]),_:1})]),_:1}),e(S,null,{default:a(()=>[e(D,{class:"text-overline"},{default:a(()=>[y(" Name")]),_:1})]),_:1}),e(S,null,{default:a(()=>[e(D,{class:"text-overline"},{default:a(()=>[y(" Category")]),_:1})]),_:1}),e(S,{side:""},{default:a(()=>[e(D,{class:"text-overline"},{default:a(()=>[y("Unit")]),_:1})]),_:1})]),_:1}),(f(!0),M(N,null,H(u.value,(r,i)=>(f(),P(A,{key:i},{default:a(()=>[e(S,null,{default:a(()=>[e(D,{class:"text-subtitle1"},{default:a(()=>[y(V(r.code),1)]),_:2},1024)]),_:2},1024),e(S,null,{default:a(()=>[e(D,{class:"text-subtitle1",align:"left"},{default:a(()=>[y(V(r.name),1)]),_:2},1024)]),_:2},1024),e(S,null,{default:a(()=>[e(D,{class:"text-subtitle1"},{default:a(()=>[y(V(r.category),1)]),_:2},1024)]),_:2},1024),e(S,{side:""},{default:a(()=>[e(D,{class:"text-subtitle1"},{default:a(()=>[y(V(r.unit),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}),e(ce,{class:"row q-ma-md",align:"right"},{default:a(()=>[e(T,{class:"glossy",color:"grey-9",label:"Dismiss",onClick:c}),e(T,{class:"glossy",color:"teal",label:"Create",onClick:Q})]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}};var ia=ee(na,[["__scopeId","data-v-272d4a61"]]);const Ie=o=>(re("data-v-c80566ac"),o=o(),oe(),o),ua={class:"row justify-between"},ca={class:"row q-gutter-x-sm"},da={key:0,class:"spinner-wrapper"},ma={key:1},_a={key:0,class:"data-error"},pa=Ie(()=>l("div",{class:"q-ml-sm text-h6"},"No data available",-1)),fa=Ie(()=>l("div",{class:"text-white"},"Edit Available Stocks",-1)),ga={class:"row justify-center q-gutter-x-md"},ha={__name:"RawMaterialsTable",setup(o){const v=E().params.warehouse_id,g=ne(),n=q(""),u=q(!0),b=q([]),x=q(!1),c=q({rowsPerPage:0}),Q=I(()=>g.warehouseRawMaterials),$=I(()=>n.value?Q.value.filter(t=>t.name.toLowerCase().includes(n.value.toLowerCase())):Q.value);se(async()=>{console.log("props.warehouseId in onMounted:",v),v&&await m(v)});const m=async t=>{try{u.value=!0;const s=await g.fetchWarehouseRawMaterials(t);Q.value=s,Q.value.length||(x.value=!0),console.log("Warehouse Raw Materials",Q.value)}catch(s){console.log("Error fetching branch product:",s),x.value=!0}finally{u.value=!1}};async function r(t,s){try{const _=await $e.put("/api/update-warehouse-rawMaterials/"+t.id,{total_quantity:parseInt(s)});if(_.status===200){const C=b.value.findIndex(U=>U.id==t.id);b.value[C]=parseInt(s),G.create({type:"positive",message:_.data.message,timout:1e3,position:"top"})}}catch(_){console.error("Error updating price:",_)}}de(n,async t=>{u.value=!0,await new Promise(s=>setTimeout(s,1e3)),u.value=!1,x.value=$.value.length===0});const i=t=>{const s=t.total_quantity,_=t.raw_materials.unit;if(console.log("unit test",_),_==="Grams"&&s<1e3)return"bg-red";let C;return s>=1e3?C=s/1e3:C=s,C<5?C<=2?"bg-red":(C<=3,"bg-warning"):"bg-positive"},R=t=>{var U;const s=Number(t==null?void 0:t.total_quantity)||0,_=((U=t==null?void 0:t.raw_materials)==null?void 0:U.unit)||"units";console.log("totalQuantity:",s),console.log("unit:",_);const C=L=>{const z=Number(L);return Number.isInteger(z)?z:z.toFixed(2)};if(s>1e3){const L=s/1e3;if(L>=25){const z=L/25;return`${C(z)} sacks`}return`${C(L)} kilos`}return`${C(s)} ${_}`},h=[{name:"code",label:"Raw Materials Code",align:"center",field:t=>{var s,_;return(_=(s=t==null?void 0:t.raw_materials)==null?void 0:s.code)!=null?_:"No Code"},format:t=>`${t}`,sortable:!0},{name:"name",label:"Raw Materials Name",align:"center",field:t=>{var s,_;return(_=(s=t==null?void 0:t.raw_materials)==null?void 0:s.name)!=null?_:"No Code"},format:t=>`${t}`,sortable:!0},{name:"total_quantity",label:"Available Stocks",align:"center",field:"total_quantity",sortable:!0},{name:"action",label:"Action",align:"center",sortable:!0}];return(t,s)=>(f(),M(N,null,[l("div",ua,[l("div",null,[e(W,{class:"q-pb-lg q-pl-md",modelValue:n.value,"onUpdate:modelValue":s[0]||(s[0]=_=>n.value=_),outlined:"",placeholder:"Search",debounce:"1000",style:{width:"450px","max-width":"5000px","min-width":"100px"},flat:"",dense:"",rounded:""},{append:a(()=>[e(K,{name:"search"})]),_:1},8,["modelValue"])]),l("div",ca,[l("div",null,[e(ea)]),l("div",null,[e(ia)])])]),u.value?(f(),M("div",da,[e(Le,{size:"50px",color:"primary"})])):(f(),M("div",ma,[$.value.length===0?(f(),M("div",_a,[e(K,{name:"warning",color:"warning",size:"4em"}),pa])):(f(),P(_e,{key:1,class:"table-container sticky-header",filter:n.value,"virtual-scroll-sticky-size-start":48,flat:"",columns:h,rows:$.value,"row-key":"name","virtual-scroll":"",pagination:c.value,"onUpdate:pagination":s[1]||(s[1]=_=>c.value=_),"rows-per-page-options":[0],"hide-bottom":"",style:{height:"340px"}},{"body-cell-total_quantity":a(_=>[e(O,{props:_},{default:a(()=>[e(j,{square:"",class:Re(["text-white cursor-pointer",i(_.row)])},{default:a(()=>[y(V(R(_.row))+" ",1),e(ke,{class:"bg-blue-grey-8",offset:[10,10]},{default:a(()=>[fa]),_:1}),e(ze,{"onUpdate:modelValue":[C=>r(_.row,C),C=>_.row.total_quantity=C],modelValue:_.row.total_quantity,"auto-save":""},{default:a(C=>[e(W,{modelValue:C.value,"onUpdate:modelValue":U=>C.value=U,dense:"",suffix:_.row.raw_materials.unit,mask:"########",autofocus:"",counter:"",onKeyup:Ne(C.set,["enter"])},null,8,["modelValue","onUpdate:modelValue","suffix","onKeyup"])]),_:2},1032,["onUpdate:modelValue","modelValue"])]),_:2},1032,["class"])]),_:2},1032,["props"])]),"body-cell-action":a(_=>[e(O,{props:_},{default:a(()=>[l("div",ga,[e(ra,{delete:_},null,8,["delete"])])]),_:2},1032,["props"])]),_:1},8,["filter","rows","pagination"]))]))],64))}};var va=ee(ha,[["__scopeId","data-v-c80566ac"]]);const wa={class:"q-gutter-sm"},ya={class:"q-gutter-x-sm"},ba={__name:"WarehouseRawMaterialsPage",setup(o){return(k,v)=>(f(),M("div",wa,[l("div",ya,[e(j,{label:"Good",class:"text-white",color:"positive"}),e(j,{label:"Warning",class:"text-white",color:"warning"}),e(j,{label:"Danger",class:"text-white",color:"red"})]),l("div",null,[e(va)])]))}},xa={__name:"BranchRawMaterials",props:{branchReport:Object,getRawMaterialBadgeColor:Function,getBadgeCategoryColor:Function,formatTotalQuantity:Function,capitalizeFirstLetter:Function},setup(o){Se(),console.log("branchReportss",o.branchReport),q(!1),q(!0);const v=q([{name:"raw_material",label:"Raw Materials Name",align:"left",field:g=>{var n;return((n=g.raw_material)==null?void 0:n.name)||"No record"}},{name:"code",label:"Code",align:"left",field:g=>{var n;return((n=g.raw_material)==null?void 0:n.code)||"No record"}},{name:"category",label:"Category",align:"left",field:g=>{var n;return((n=g.raw_material)==null?void 0:n.category)||"No record"}},{name:"total_quantity",label:"Available Stocks",align:"center",field:"total_quantity"}]);return(g,n)=>(f(),P(_e,{rows:o.branchReport.reports,columns:v.value,"row-key":"id",flat:"",bordered:"","virtual-scroll":"",pagination:g.pagination,"onUpdate:pagination":n[0]||(n[0]=u=>g.pagination=u),"rows-per-page-options":[0],"hide-bottom":"",class:"q-mt-md"},{"body-cell-total_quantity":a(u=>[e(O,{props:u},{default:a(()=>[e(j,{square:"",class:Re(["text-white cursor-pointer",o.getRawMaterialBadgeColor(u.row)])},{default:a(()=>[y(V(o.formatTotalQuantity(u.row)),1)]),_:2},1032,["class"])]),_:2},1032,["props"])]),"body-cell-category":a(u=>[e(O,{key:"name",props:u},{default:a(()=>[e(j,{color:o.getBadgeCategoryColor(u.row.raw_material.category)},{default:a(()=>[y(V(u.row.raw_material.category),1)]),_:2},1032,["color"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","pagination"]))}},Ra={class:"row justify-between"},Ca={class:"text-h6"},Ma=l("div",{class:"text-h6",align:"center"},"Premix",-1),ka=l("div",{class:"text-h6",align:"center"},"Ingredients List",-1),qa={class:"text-grey-7 q-mt-xs"},$a=l("div",{class:"text-h6 text-weight-regular"}," Do you want to receive the premix? ",-1),Va={__name:"TransactionView",props:{report:{type:Object,required:!0}},emits:["update-history"],setup(o,{emit:k}){var ge,he,ve,we,ye;const v=Ke(),g=I(()=>v.user);console.log("userData in RawMaterialsTable:",g.value);const n=((he=(ge=g.value)==null?void 0:ge.data)==null?void 0:he.employee_id)||"";console.log("employeeId in PremixPage:",n);const u=fe();I(()=>u.branchPremix),Ve();const b=q(!1),x=q(!1),c=o;console.log("props",c.report);const Q=c.report.branch_premix.branch_id;console.log("branchId",Q);const $=()=>{b.value=!0},m=p=>{const d=w=>w?w.charAt(0).toUpperCase()+w.slice(1).toLowerCase():"";return`${d(p.firstname||"No Firstname")} ${p.middlename?d(p.middlename).charAt(0)+".":""} ${d(p.lastname||"No Lastname")}`},r=[{label:"Pending",value:"pending"},{label:"Declined",value:"declined"},{label:"Confirmed",value:"confirmed"},{label:"Process",value:"process"},{label:"Completed",value:"completed"},{label:"To Deliver",value:"to deliver"},{label:"To Receive",value:"to receive"},{label:"Received",value:"received"}],i=I(()=>{var p;return(p=c.report.history)!=null&&p.length?r.filter(d=>c.report.history.some(w=>w.status===d.value)):[]}),R=p=>{const d=c.report.history.find(w=>w.status===p);return d?p==="received"?`Received by: ${m(d.employee)}`:p==="pending"?`Requested by: ${m(d.employee)}`:`Handled by: ${m(d.employee)}`:"No handler"},h=p=>{const d=Number(p);return isNaN(d)?"":(d%1===0,d.toString())},t=(p,d)=>{if(d==="Pcs")return`${p} pcs`;if(d==="Grams"){if(p>=1e3){let w=p/1e3;return`${w%1===0?w.toString():w.toString().replace(/^0+/,"")} kgs`}return`${p} g`}return`${p} ${d}`},s=((ye=(we=(ve=c.report)==null?void 0:ve.branch_premix)==null?void 0:we.branch_recipe)==null?void 0:ye.ingredient_groups)||"Undefined";console.log("ingrdientsData",s);const _=I(()=>s.map(p=>{const d=parseFloat(p.quantity)*parseFloat(c.report.quantity);return{...p,totalQuantity:d,formattedQuantity:t(d,p.ingredient.unit)}}));console.log("report to proceed",c.report);const C=I(()=>{var p,d;return((d=(p=c.report.history)==null?void 0:p[c.report.history.length-1])==null?void 0:d.status)||null});console.log("lastStatus",C.value);const U=I(()=>i.value.findIndex(p=>p.value===C.value)+1),L=p=>{var d;return(d=c.report.history)==null?void 0:d.some(w=>w.status===p)},z=p=>({pending:"warning",declined:"red-6",confirmed:"green",process:"primary",completed:"dark","to deliver":"brown-9","to receive":"amber-10",received:"secondary"})[p]||"grey",Te=async()=>{const p={request_premix_id:c.report.id,branch_premix_id:c.report.branch_premix_id,branch_id:c.report.branch_premix.branch_id,employee_id:n,status:"receive",notes:"Received Premix",quantity:c.report.quantity,warehouse_id:c.report.warehouse_id,ingredients:_.value.map(d=>({ingredients_id:d.ingredient.id,total_quantity:d.totalQuantity,unit:d.ingredient.unit}))};console.log("payload",p),await u.receivePremix(p),await u.fetchRequestBranchPremix(Q),b.value=!1};return(p,d)=>(f(),M(N,null,[l("div",null,[e(T,{color:"accent",icon:"visibility",size:"md",flat:"",round:"",dense:"",onClick:$})]),e(Z,{modelValue:b.value,"onUpdate:modelValue":d[2]||(d[2]=w=>b.value=w)},{default:a(()=>[e(F,{style:{width:"700px","max-width":"80vw"}},{default:a(()=>[e(B,null,{default:a(()=>[l("div",Ra,[l("div",Ca,V(o.report.name),1),e(T,{class:"close-btn",color:"grey-8",flat:"",round:"",dense:"",icon:"close",onClick:d[0]||(d[0]=w=>b.value=!1)})])]),_:1}),e(B,null,{default:a(()=>[l("div",null,"Baker: "+V(m(o.report.employee)),1),l("div",null," Branch: "+V(o.report.branch_premix.branch_recipe.branch.name),1),l("div",null,[y(" Status: "),e(j,{color:z(o.report.status),outlined:""},{default:a(()=>[y(V(o.report.status),1)]),_:1},8,["color"])])]),_:1}),e(B,{class:"q-gutter-y-md"},{default:a(()=>[l("div",null,[Ma,e(le,{dense:"",separator:"",class:"box"},{default:a(()=>[e(A,null,{default:a(()=>[e(S,null,{default:a(()=>[e(D,{class:"text-overline"},{default:a(()=>[y("Premix Name")]),_:1})]),_:1}),e(S,{side:""},{default:a(()=>[e(D,{class:"text-overline"},{default:a(()=>[y("Request Quantity / kgs")]),_:1})]),_:1})]),_:1}),e(A,null,{default:a(()=>[e(S,null,{default:a(()=>[e(D,{class:"text-h6"},{default:a(()=>[y(V(o.report.name),1)]),_:1})]),_:1}),e(S,{side:""},{default:a(()=>[e(D,{class:"text-h6"},{default:a(()=>[y(V(h(o.report.quantity)),1)]),_:1})]),_:1})]),_:1})]),_:1})]),l("div",null,[ka,e(le,{dense:"",separator:"",class:"box"},{default:a(()=>[e(A,null,{default:a(()=>[e(S,null,{default:a(()=>[e(D,{class:"text-overline"},{default:a(()=>[y(" Code")]),_:1})]),_:1}),e(S,null,{default:a(()=>[e(D,{class:"text-overline"},{default:a(()=>[y(" Name")]),_:1})]),_:1}),e(S,{side:""},{default:a(()=>[e(D,{class:"text-overline"},{default:a(()=>[y("Quantity")]),_:1})]),_:1})]),_:1}),(f(!0),M(N,null,H(te(s),(w,Y)=>(f(),P(A,{key:Y},{default:a(()=>[e(S,null,{default:a(()=>[e(D,{class:"text-subtitle1"},{default:a(()=>[y(V(w.ingredient.code),1)]),_:2},1024)]),_:2},1024),e(S,null,{default:a(()=>[e(D,{class:"text-subtitle1",align:"left"},{default:a(()=>[y(V(w.ingredient.name),1)]),_:2},1024)]),_:2},1024),e(S,{side:""},{default:a(()=>[e(D,{class:"text-subtitle1"},{default:a(()=>[y(V(t(w.quantity*o.report.quantity,w.ingredient.unit)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})])]),_:1}),e(Ae,{modelValue:U.value,"onUpdate:modelValue":d[1]||(d[1]=w=>U.value=w),animated:"",class:"q-pa-lg"},{default:a(()=>[(f(!0),M(N,null,H(i.value,(w,Y)=>(f(),P(je,{key:Y,name:Y+1,title:w.label,color:z(w.value),done:L(w.value),icon:L(w.value)?"check":"radio_button_unchecked",class:"custom-step"},{default:a(()=>[l("div",qa,V(R(w.value)),1)]),_:2},1032,["name","title","color","done","icon"]))),128))]),_:1},8,["modelValue"]),C.value==="to receive"?(f(),P(B,{key:0,class:"text-center q-gutter-md"},{default:a(()=>[$a,e(T,{color:"amber-10",label:"Yes",icon:"check",onClick:Te,loading:x.value},null,8,["loading"])]),_:1})):xe("",!0)]),_:1})]),_:1},8,["modelValue"])],64))}},Qa={__name:"BranchTransaction",props:{branchId:Object},setup(o){const k=E();I(()=>k.params.warehouse_id||null);const v=fe(),g=I(()=>v.branchPremix);console.log("premixDatas",g.value);const n=q(""),u=q(!0),x=o.branchId;se(async()=>{x&&await c(),console.log("premixdatas",g.value)});const c=async()=>{await v.fetchRequestBranchPremix(x)};de(n,()=>{u.value=!0,setTimeout(()=>{u.value=!1})});const Q=i=>We.formatDate(i,"MMM D, YYYY - hh:mm A"),$=i=>i.charAt(0).toUpperCase()+i.slice(1).toLowerCase(),m=i=>{switch(i){case"pending":return"warning";case"declined":return"red-6";case"confirmed":return"green";case"process":return"primary";case"completed":return"dark";case"to deliver":return"brown-9";case"to receive":return"amber-10";case"received":return"secondary";default:return"grey"}},r=[{name:"name",label:"Transactions Name",align:"left",field:i=>i.name,format:i=>`${i}`,sortable:!0},{name:"date",align:"center",label:"Created Date",field:"created_at",format:i=>Q(i),sortable:!0},{name:"updated_at",align:"center",label:"Updated Date",field:"updated_at",format:i=>Q(i),sortable:!0},{name:"status",align:"center",label:"Status",field:"status",sortable:!0},{name:"view",align:"right",label:"View",field:"view",sortable:!0}];return(i,R)=>(f(),M(N,null,[l("div",null,[e(W,{rounded:"",outlined:"",dense:"",debounce:"300",modelValue:n.value,"onUpdate:modelValue":R[0]||(R[0]=h=>n.value=h),placeholder:"Search",style:{width:"500px","max-width":"1500px","min-width":"100px"}},{append:a(()=>[u.value?(f(),P(K,{key:1,thickness:2,color:"teal",size:"1em"})):(f(),P(K,{key:0,name:"search"}))]),_:1},8,["modelValue"])]),l("div",null,[e(_e,{filter:n.value,flat:"",columns:r,rows:g.value,"row-key":"name"},{"body-cell-status":a(h=>[e(O,{props:h},{default:a(()=>[e(j,{outlined:"",color:m(h.row.status)},{default:a(()=>[y(V($(h.row.status)),1)]),_:2},1032,["color"])]),_:2},1032,["props"])]),"body-cell-view":a(h=>[e(O,{props:h},{default:a(()=>[l("div",null,[e(Va,{report:h.row,onUpdateHistory:i.updateReportHistory},null,8,["report","onUpdateHistory"])])]),_:2},1032,["props"])]),_:1},8,["filter","rows"])])],64))}},Sa={class:"row justify-between"},Da={class:"text-h6"},Ia={__name:"DialogPage",props:{branchReport:Object,capitalizeFirstLetter:Function,getRawMaterialBadgeColor:Function,getBadgeCategoryColor:Function,formatTotalQuantity:Function},setup(o){const{dialogRef:k,onDialogHide:v,onDialogOK:g,onDialogCancel:n}=Se(),b=o.branchReport.branch_id,x=q("branchRawMaterials"),c=q(!1),Q=q(!0);return($,m)=>(f(),P(Z,{ref_key:"dialogRef",ref:k,onHide:te(v),modelValue:c.value,"onUpdate:modelValue":m[2]||(m[2]=r=>c.value=r),maximized:Q.value,"transition-show":"slide-up","transition-hide":"slide-down"},{default:a(()=>[e(F,null,{default:a(()=>[e(B,null,{default:a(()=>[l("div",Sa,[l("div",Da,V(o.capitalizeFirstLetter(o.branchReport.branch_name)),1),l("div",null,[e(T,{round:"",dense:"",flat:"",icon:"close",onClick:te(n)},null,8,["onClick"])])]),l("div",null,[e(Ce,{modelValue:x.value,"onUpdate:modelValue":m[0]||(m[0]=r=>x.value=r),align:"justify","narrow-indicator":"",class:"q-mb-lg"},{default:a(()=>[e(J,{class:"text-purple",name:"branchRawMaterials",label:"Branch Raw Materials"}),e(J,{class:"text-orange",name:"branchPremixTransactions",label:"Branch Premix Transactions"})]),_:1},8,["modelValue"]),l("div",null,[e(Me,{modelValue:x.value,"onUpdate:modelValue":m[1]||(m[1]=r=>x.value=r),animated:"","transition-prev":"scale","transition-next":"scale"},{default:a(()=>[e(X,{name:"branchRawMaterials"},{default:a(()=>[e(xa,{branchReport:o.branchReport,getRawMaterialBadgeColor:o.getRawMaterialBadgeColor,getBadgeCategoryColor:o.getBadgeCategoryColor,formatTotalQuantity:o.formatTotalQuantity,capitalizeFirstLetter:o.capitalizeFirstLetter},null,8,["branchReport","getRawMaterialBadgeColor","getBadgeCategoryColor","formatTotalQuantity","capitalizeFirstLetter"])]),_:1}),e(X,{name:"branchPremixTransactions"},{default:a(()=>[e(Qa,{branchId:te(b)},null,8,["branchId"])]),_:1})]),_:1},8,["modelValue"])])])]),_:1})]),_:1})]),_:1},8,["onHide","modelValue","maximized"]))}},Ta={class:"q-pa-md elegant-container"},Ba={key:0,class:"skeleton-wrapper row q-col-gutter-md"},Pa={key:1,class:"data-error"},Na=l("div",null,"No data available",-1),Ua={key:2,class:"q-pa-md row q-col-gutter-md"},Fa=l("img",{src:"https://cdn.quasar.dev/img/mountains.jpg"},null,-1),La={class:"q-mt-lg"},za={class:"text-h6 text-weight-medium elegant-name text-capitalize"},Wa={__name:"BranchCard",props:["branchRawMaterialsReport"],setup(o){const k=E(),v=Qe(),g=Ve(),n=I(()=>v.warehouseBranchReports),u=q(!1),b=I(()=>k.params.warehouse_id||null),x=q(!1),c=i=>{g.dialog({component:Ia,componentProps:{branchReport:i,getRawMaterialBadgeColor:Q,getBadgeCategoryColor:m,formatTotalQuantity:r,capitalizeFirstLetter:$}})},Q=i=>{const R=i.quantity;if(i.raw_material.unit==="Grams"&&R<1e3)return"bg-red";let t;return R>=1e3?t=R/1e3:t=R,t<5?t<=2?"bg-red":(t<=3,"bg-warning"):"bg-positive"},$=i=>i?i.split(" ").map(R=>R.charAt(0).toUpperCase()+R.slice(1).toLowerCase()).join(" "):"",m=i=>{switch(i){case"Ingredients":return"teal";case"Packaging Materials":return"brown-6";default:return"grey"}},r=i=>{const R=i.quantity,h=i.raw_material.unit;if(R>1e3){const t=(R/1e3).toFixed(2);return t.endsWith(".00")?`${Math.round(R/1e3)} kilos`:`${t} kilos`}else return R>1?`${R} ${h}`:`${R} ${h}`};return de(b,async i=>{if(i)try{u.value=!0,await v.fetchWarehouseByBranchID(i),x.value=n.value.length===0}catch(R){console.error("Error fetching warehouse data:",R),x.value=!0}finally{u.value=!1}},{immediate:!0}),(i,R)=>(f(),M("div",Ta,[u.value?(f(),M("div",Ba,[(f(),M(N,null,H(8,h=>l("div",{class:"col-xs-12 col-sm-6 col-md-4 col-lg-3",key:h},[e(F,{class:"user-card skeleton-card"},{default:a(()=>[e(ie,{height:"200px",class:"q-mb-md"}),e(B,{class:"text-center"},{default:a(()=>[e(ie,{type:"text",width:"60%",class:"q-mt-lg"}),e(ie,{type:"text",width:"40%",class:"q-mt-sm"})]),_:1})]),_:1})])),64))])):x.value?(f(),M("div",Pa,[e(K,{name:"error",size:"50px",color:"negative"}),Na])):(f(),M("div",Ua,[(f(!0),M(N,null,H(n.value,h=>(f(),M("div",{key:h.branch_id,class:"col-xs-12 col-sm-6 col-md-4 col-lg-3"},[e(F,{class:"user-card",onClick:t=>c(h)},{default:a(()=>[Fa,e(B,{class:"text-center"},{default:a(()=>[l("div",La,[l("div",za,V($(h.branch_name)),1)])]),_:2},1024)]),_:2},1032,["onClick"])]))),128))]))]))}},Aa={__name:"TablePage",setup(o){const k=E(),v=fe(),g=I(()=>k.params.warehouse_id||null),n=async()=>{await v.fetchRequestBranchPremix(g.value)};return se(async()=>{g.value&&await n()}),(u,b)=>(f(),M("div",null,"This is a table"))}},ja=l("div",{class:"text-h6"},"Premix / Raw Materials Transactions",-1),Ka={__name:"TransactionsWarehouse",setup(o){return(k,v)=>(f(),M(N,null,[ja,e(Aa)],64))}};const Ea={class:"elegant-container q-gutter-md"},Ha={class:"text-h6 row justify-between"},Oa={class:"q-gutter-sm"},Ya={class:"tab-container"},Ga={__name:"WarehouseIdPage",setup(o){const k=E(),v=Ue(),g=Qe(),n=q("");I(()=>g.warehouse);const u=I(()=>k.params.warehouse_id||"Unknown Warehouse"),b=q("warehouseRawMaterials"),x=async m=>(await $e.get(`/api/warehouse/${m}`)).data,c=async()=>{try{const m=await x(u.value);m&&m.name?n.value=m.name:console.error("Warehouse name data is missing",m)}catch(m){console.error("Error fetching warehouse data:",m)}};se(()=>{c()});const Q=m=>m?m.split(" ").map(r=>r.charAt(0).toUpperCase()+r.slice(1).toLowerCase()).join(" "):"",$=()=>{Loading.show(),v.push("/admin/warehouse").finally(()=>{Loading.hide()})};return(m,r)=>(f(),P(Fe,{padding:""},{default:a(()=>[l("div",Ea,[l("div",Ha,[l("div",null,[e(T,{outline:"",flat:"",icon:"arrow_back",to:"/admin/warehouse",onClick:$}),e(me)]),l("div",null,[e(K,{name:"factory"}),y(" "+V(Q(n.value)),1)])]),l("div",Oa,[l("div",Ya,[e(Ce,{modelValue:b.value,"onUpdate:modelValue":r[0]||(r[0]=i=>b.value=i),dense:"",class:"bg-grey-2 text-grey-7 tabs-as-cards","active-color":"red-6","indicator-color":"transparent",align:"justify"},{default:a(()=>[e(J,{name:"warehouseRawMaterials",label:"Warehouse Raw Materials"}),e(J,{name:"branchRawMaterials",label:"Branch Raw Materials"}),e(J,{name:"transactions",label:"Transactions"})]),_:1},8,["modelValue"])]),e(F,{class:"q-mt-sm"},{default:a(()=>[e(Me,{modelValue:b.value,"onUpdate:modelValue":r[1]||(r[1]=i=>b.value=i),animated:""},{default:a(()=>[e(X,{name:"warehouseRawMaterials"},{default:a(()=>[e(ba)]),_:1}),e(X,{name:"branchRawMaterials"},{default:a(()=>[e(Wa)]),_:1}),e(X,{name:"transactions"},{default:a(()=>[e(Ka)]),_:1})]),_:1},8,["modelValue"])]),_:1})])])]),_:1}))}};var It=ee(Ga,[["__scopeId","data-v-c5b3b33a"]]);export{It as default};
