import{Q as K}from"./QBadge.95890374.js";import{n as v,g as O,t as se,z as ne,o as h,a2 as C,a as e,M as V,w as t,Q as T,I,ad as W,a0 as ee,J as s,K as D,c as B,L as H,bb as re,$ as S,a3 as A,a4 as ie,_ as F,bc as de,aI as ae,a1 as te,N as ve,O as X,R as Y,H as fe,u as ge,aH as be,P as oe}from"./index.9c9d4c4e.js";import{Q as ye}from"./QPage.4805e931.js";import{Q as ue}from"./QSpace.11673f40.js";import{Q as J,a as ce}from"./QItem.25f2db32.js";import{Q as me}from"./QList.2add8ee9.js";import{Q as G}from"./QSelect.5f429e83.js";import{C as j}from"./ClosePopup.e8ca0b3e.js";import{u as Z}from"./branch.be5b2d55.js";import{u as le}from"./warehouse.d66be320.js";import{u as pe}from"./employee.a7a45c94.js";import{_ as M}from"./plugin-vue_export-helper.21dcd24c.js";import{Q as we}from"./QSpinnerDots.33b6df48.js";import{Q as P,a as qe}from"./QTable.679dace5.js";import{Q as he}from"./QTooltip.d589079b.js";import"./QItemLabel.fcc7aeb9.js";import"./QMenu.d0f52efd.js";import"./selection.18f52089.js";import"./use-virtual-scroll.823d2c0d.js";import"./rtl.276c3f1b.js";import"./axios.fd4410eb.js";import"./QVirtualScroll.8b16815e.js";const xe=p=>(X("data-v-79b75f23"),p=p(),Y(),p),$e=xe(()=>s("div",{class:"text-h5 q-mr-md"},"\u{1F3EA} Add New Branch",-1)),Ce={class:"q-mt-lg q-animated q-animate-bounce"},Ve={class:"q-mt-lg q-animated q-animate-bounce"},ke={class:"q-mt-lg q-animated q-animate-bounce"},Be={key:0,class:"custom-list z-top"},Se={class:"q-mt-lg q-animated q-animate-bounce"},Qe={class:"row q-mt-lg q-gutter-x-sm justify-between"},De={class:"col-6 q-animated q-animate-bounce"},Ne={class:"col-5 q-animated q-animate-bounce"},Ee={__name:"BranchesCreateComponent",setup(p){const k=pe(),f=v(!1),E=Z(),x=()=>{f.value=!0},$=le(),_=v([]),n=v([]),q=v(!1),y=["Open","Open soon","Close"],Q=v(!1),b=v(null),w=v(null),N=v(!1),L=O(()=>k.employee),z=async()=>{w.value.trim()&&(Q.value=!0,await k.searchCertainEmployee(w.value),Q.value=!1,N.value=!0)},a=u=>{console.log("Selected Employee:",u),l.employee_id=u.id,l.employee_name=`${u.firstname} ${u.middlename?u.middlename.charAt(0)+".":""} ${u.lastname}`,w.value=`${u.firstname} ${u.middlename?u.middlename.charAt(0)+".":""} ${u.lastname}`,N.value=!1,console.log("Filled addNewBranchForm Data:",l)},l=se({name:"",location:"",employee_id:"",employee_name:"",phone:"",status:""});ne(async()=>{q.value=!0;try{const u=await $.fetchWarehouses();_.value=$.warehouses.map(m=>({label:m.name,value:m.id})),n.value=_.value}catch(u){console.error("Error fetching warehouse data:",u)}finally{q.value=!1}});const r=(u,m)=>{m(()=>{const o=u.toLowerCase();n.value=u===""?_.value:_.value.filter(g=>g.label.toLowerCase().includes(o))})},d=async()=>{var u,m,o;try{q.value=!0;const g={...l,warehouse_id:((u=b.value)==null?void 0:u.value)||null};console.log("brabrbbar",g);const R=await E.createBranches(g);console.log(R),f.value=!1,c()}catch(g){console.error("Error creating branch:",g);const R=((o=(m=g.response)==null?void 0:m.data)==null?void 0:o.message)||g.message||"Failed to create branch. Please try again.";f.value=!0,ve.create({color:"negative",icon:"warning",message:R})}finally{q.value=!1}},c=()=>{l.name="",l.location="",l.employee_id="",l.employee_name="",w.value=null,b.value=null,l.phone="",l.status=""};return(u,m)=>(h(),C(A,null,[e(V,{class:"text-dark q-pa-sm",outline:"",dense:"",elevated:"",icon:"add_circle",label:"Add Store Branch",onClick:x,style:{"background-color":"#ef4444"}}),e(te,{modelValue:f.value,"onUpdate:modelValue":m[7]||(m[7]=o=>f.value=o),persistent:"","transition-show":"jump-up","transition-hide":"jump-down"},{default:t(()=>[e(T,{class:"my-card q-pa-none",style:{width:"420px","border-radius":"16px","box-shadow":"0 12px 24px rgba(0, 0, 0, 0.2)"}},{default:t(()=>[e(I,{class:"row items-center q-px-md q-py-sm bg-gradient text-white"},{default:t(()=>[$e,e(ue),W(e(V,{icon:"close",flat:"",dense:"",round:""},null,512),[[j]])]),_:1}),e(ee,{class:"separator-gradient"}),e(I,{class:"q-px-xl q-pt-none q-pb-lg"},{default:t(()=>[s("div",Ce,[e(D,{class:"text-capitalize",modelValue:l.name,"onUpdate:modelValue":m[0]||(m[0]=o=>l.name=o),outlined:"",dense:"",label:"Branch Name",rules:[o=>o&&o.length>0||"Name is required"]},null,8,["modelValue","rules"])]),s("div",Ve,[e(D,{class:"text-capitalize",modelValue:l.location,"onUpdate:modelValue":m[1]||(m[1]=o=>l.location=o),outlined:"",dense:"",label:"Location",rules:[o=>o&&o.length>0||"Label is required"]},null,8,["modelValue","rules"])]),s("div",ke,[s("div",null,[e(D,{modelValue:w.value,"onUpdate:modelValue":[m[2]||(m[2]=o=>w.value=o),z],label:"Search Employee",outlined:"",dense:"",debounce:"500",placeholder:"Enter name or position",onFocus:m[3]||(m[3]=o=>N.value=!0)},{append:t(()=>[Q.value?(h(),B(re,{key:1,color:"grey",size:"sm"})):(h(),B(H,{key:0,name:"search"}))]),default:t(()=>[N.value&&w.value?(h(),C("div",Be,[e(T,null,{default:t(()=>[e(me,{separator:""},{default:t(()=>{var o;return[(o=L.value)!=null&&o.length?(h(!0),C(A,{key:1},ie(L.value,g=>(h(),B(J,{onClick:R=>a(g),key:g.id,clickable:""},{default:t(()=>[e(ce,null,{default:t(()=>[S(F(`${g.firstname} ${g.middlename?g.middlename.charAt(0)+".":""} ${g.lastname}`),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128)):(h(),B(J,{key:0},{default:t(()=>[S(" No Employee Record ")]),_:1}))]}),_:1})]),_:1})])):de("",!0)]),_:1},8,["modelValue"])])]),s("div",Se,[e(G,{modelValue:b.value,"onUpdate:modelValue":m[4]||(m[4]=o=>b.value=o),clearable:"","use-input":"","input-debounce":"0",options:n.value,"hide-dropdown-icon":"","stack-label":"",outlined:"",dense:"",label:"Warehouse",onFilter:r,behavior:"menu"},null,8,["modelValue","options"])]),s("div",Qe,[s("div",De,[e(D,{modelValue:l.phone,"onUpdate:modelValue":m[5]||(m[5]=o=>l.phone=o),outlined:"",dense:"",mask:"(+63) ### - ### - ####",placeholder:"(+63) ### - ### - ####",label:"Phone Number",rules:[o=>o&&o.length>0||"Phone number is required"]},null,8,["modelValue","rules"])]),s("div",Ne,[e(G,{modelValue:l.status,"onUpdate:modelValue":m[6]||(m[6]=o=>l.status=o),outlined:"",dense:"",label:"Status",options:y,"hide-dropdown-icon":"",behavior:"menu",rules:[o=>o&&o.length>0||"Status is required"]},null,8,["modelValue","rules"])])])]),_:1}),e(ae,{class:"row q-px-lg q-py-sm q-pt-none",align:"right"},{default:t(()=>[W(e(V,{class:"glossy",color:"grey-9",label:"Dismiss"},null,512),[[j]]),e(V,{class:"glossy",color:"teal",label:"Create",onClick:d,loading:q.value},null,8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};var Fe=M(Ee,[["__scopeId","data-v-79b75f23"]]);const U=p=>(X("data-v-098866d0"),p=p(),Y(),p),Ie=U(()=>s("div",{class:"text-h5 q-mr-md"},"\u{1F3EA} Edit Branch",-1)),Ue={class:"q-mt-lg q-animated q-animate-bounce"},Le=U(()=>s("div",null,"Name of Branch",-1)),Pe={class:"q-mt-lg q-animated q-animate-bounce"},Ae=U(()=>s("div",null,"Location",-1)),ze={class:"q-mt-lg q-animated q-animate-bounce"},Oe=U(()=>s("div",null,"Person In-charge",-1)),Te={key:0,class:"custom-list z-top"},We={class:"q-mt-lg q-animated q-animate-bounce"},je=U(()=>s("div",null,"Under Warehouse",-1)),Me={class:"row q-gutter-x-sm justify-between q-mt-sm"},Re={class:"col-6 q-animated q-animate-bounce"},Ke=U(()=>s("div",null,"Phone Number",-1)),He={class:"col-5 q-animated q-animate-bounce"},Je=U(()=>s("div",null,"Status",-1)),Ge={__name:"BranchesEditComponent",props:["edit"],setup(p){const k=pe(),f=Z(),E=le(),x=O(()=>E.warehouses),$=p,_=v(!1);v([]);let n=$.edit.row;const q=["Open","Open soon","Close"],y=v(null),Q=v(!1),b=v(!1),w=O(()=>k.employee),N=async()=>{y.value.trim()&&(Q.value=!0,await k.searchCertainEmployee(y.value),Q.value=!1,b.value=!0)},L=r=>{console.log("Selected Employee:",r),a.employee_id=r.id,a.employee_name=`${r.firstname} ${r.middlename?r.middlename.charAt(0)+".":""} ${r.lastname}`,y.value=`${r.firstname} ${r.middlename?r.middlename.charAt(0)+".":""} ${r.lastname}`,b.value=!1,console.log("Filled editBranchesForm Data:",a)},z=()=>{var r,d;console.log("Edit Row Data:",n),b.value=!1,a.name=n.name,a.location=n.location,a.employee_id=n.employee_id,a.employee_name=n.employees?l(n.employees):"No Person in Charge",y.value=n.employees?l(n.employees):"No Person in Charge",a.warehouse_id=n!=null&&n.warehouse_id?n.warehouse_id:(r=n==null?void 0:n.warehouse)!=null&&r.id?(d=n==null?void 0:n.warehouse)==null?void 0:d.id:"",a.phone=n.phone,a.status=n.status,_.value=!0,console.log("Edit Data:",a)},a=se({name:"",location:"",person_incharge:"",employee_id:"",employee_name:"",warehouse_id:null,phone:"",status:null}),l=r=>{const d=o=>o?o.charAt(0).toUpperCase()+o.slice(1).toLowerCase():"",c=r.firstname?d(r.firstname):"No Firstname",u=r.middlename?d(r.middlename).charAt(0)+".":"",m=r.lastname?d(r.lastname):"No Lastname";return`${c} ${u} ${m}`},i=async()=>{console.log("editRow.id",n.id),console.log("editBranchesForm",a);try{await f.updateBranches(n.id,a),_.value=!1}catch(r){console.error("Error updating branch:",r)}};return(r,d)=>(h(),C(A,null,[e(V,{onClick:z,color:"positive",icon:"edit",size:"sm",flat:"",round:"",dense:""},{default:t(()=>[e(he,{class:"bg-positive",delay:200},{default:t(()=>[S("Edit")]),_:1})]),_:1}),e(te,{modelValue:_.value,"onUpdate:modelValue":d[7]||(d[7]=c=>_.value=c),persistent:"","transition-show":"jump-up","transition-hide":"jump-down"},{default:t(()=>[e(T,{class:"my-card q-pa-none",style:{width:"420px","border-radius":"16px","box-shadow":"0 12px 24px rgba(0, 0, 0, 0.2)"}},{default:t(()=>[e(I,{class:"row items-center q-px-md q-py-sm bg-gradient text-white"},{default:t(()=>[Ie,e(ue),W(e(V,{icon:"close",flat:"",dense:"",round:""},null,512),[[j]])]),_:1}),e(ee,{class:"separator-gradient"}),e(I,{class:"q-px-xl q-pt-none q-pb-lg"},{default:t(()=>[s("div",Ue,[Le,e(D,{modelValue:a.name,"onUpdate:modelValue":d[0]||(d[0]=c=>a.name=c),outlined:"",dense:""},null,8,["modelValue"])]),s("div",Pe,[Ae,e(D,{modelValue:a.location,"onUpdate:modelValue":d[1]||(d[1]=c=>a.location=c),outlined:"",dense:""},null,8,["modelValue"])]),s("div",ze,[Oe,s("div",null,[e(D,{modelValue:y.value,"onUpdate:modelValue":[d[2]||(d[2]=c=>y.value=c),N],label:"Search Employee",outlined:"",dense:"",debounce:"500",placeholder:"Enter name or position",onFocus:d[3]||(d[3]=c=>b.value=!0)},{append:t(()=>[Q.value?(h(),B(re,{key:1,color:"grey",size:"sm"})):(h(),B(H,{key:0,name:"search"}))]),default:t(()=>[b.value&&y.value?(h(),C("div",Te,[e(T,null,{default:t(()=>[e(me,{separator:""},{default:t(()=>{var c;return[(c=w.value)!=null&&c.length?(h(!0),C(A,{key:1},ie(w.value,u=>(h(),B(J,{onClick:m=>L(u),key:u.id,clickable:""},{default:t(()=>[e(ce,null,{default:t(()=>[S(F(`${u.firstname} ${u.middlename?u.middlename.charAt(0)+".":""} ${u.lastname}`),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128)):(h(),B(J,{key:0},{default:t(()=>[S(" No Employee Record ")]),_:1}))]}),_:1})]),_:1})])):de("",!0)]),_:1},8,["modelValue"])])]),s("div",We,[je,e(G,{modelValue:a.warehouse_id,"onUpdate:modelValue":d[4]||(d[4]=c=>a.warehouse_id=c),"use-input":"","input-debounce":"0",options:x.value,"stack-label":"",outlined:"",dense:"","emit-value":"","map-options":"","option-label":"name","option-value":"id"},null,8,["modelValue","options"])]),s("div",Me,[s("div",Re,[Ke,e(D,{modelValue:a.phone,"onUpdate:modelValue":d[5]||(d[5]=c=>a.phone=c),outlined:"",dense:"",mask:"(+63) ### - ### - ####",placeholder:"(+63) ### - ### - ####",rules:[c=>c&&c.length>0]},null,8,["modelValue","rules"])]),s("div",He,[Je,e(G,{modelValue:a.status,"onUpdate:modelValue":d[6]||(d[6]=c=>a.status=c),outlined:"",dense:"",options:q},null,8,["modelValue"])])])]),_:1}),e(ae,{class:"row q-px-lg q-py-sm q-pt-none",align:"right"},{default:t(()=>[W(e(V,{class:"glossy",color:"grey-9",label:"Dismiss"},null,512),[[j]]),e(V,{class:"glossy",color:"teal",label:"Save",onClick:i})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};var Xe=M(Ge,[["__scopeId","data-v-098866d0"]]);const _e=p=>(X("data-v-c7365158"),p=p(),Y(),p),Ye=_e(()=>s("div",{class:"text-h5 q-mb-xs"},"Confirm Deletion",-1)),Ze=_e(()=>s("p",{class:"text-body2 q-mb-none"}," Are you sure you want to delete this item? This action cannot be undone. ",-1)),ea={__name:"BranchesDeleteComponent",props:["delete"],setup(p){const k=Z(),f=v(!1),E=()=>{f.value=!0},x=p,$=async()=>{try{await k.deleteBranches(x.delete.row.id)}catch(_){console.error(_.message)}f.value=!1};return(_,n)=>(h(),C(A,null,[e(V,{onClick:E,color:"negative",icon:"delete",size:"sm",flat:"",round:"",dense:""},{default:t(()=>[e(he,{class:"bg-negative",delay:200},{default:t(()=>[S("Delete")]),_:1})]),_:1}),e(te,{modelValue:f.value,"onUpdate:modelValue":n[0]||(n[0]=q=>f.value=q)},{default:t(()=>[e(T,{class:"q-pa-md q-rounded q-elevate-2 bg-white text-grey-9"},{default:t(()=>[e(I,{class:"q-pt-none q-pb-sm"},{default:t(()=>[Ye,Ze]),_:1}),e(ee,{class:"q-mb-md"}),e(ae,{align:"right",class:"q-pt-none"},{default:t(()=>[W(e(V,{flat:"",dense:"",label:"Cancel",color:"primary",class:"q-mr-sm"},null,512),[[j]]),e(V,{dense:"",label:"Delete",color:"negative",onClick:$,class:"q-btn-rounded q-px-lg"})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};var aa=M(ea,[["__scopeId","data-v-c7365158"]]);const ta=p=>(X("data-v-48ca339d"),p=p(),Y(),p),la={key:0,class:"spinner-wrapper"},oa={key:1},sa={key:0,class:"data-error"},na=ta(()=>s("div",{class:"q-ml-sm text-h6"},"No data available",-1)),ra=["onClick"],ia={class:"row justify-center q-gutter-x-md"},da={__name:"BranchesTableComponent",setup(p){const k=fe(),f=Z(),E=le(),x=v(""),$=O(()=>f.branches);console.log("branchesRow",$.value);const _=v(!0),n=v(!1),q=v({rowsPerPage:0}),y=O(()=>{if(!x.value)return $.value;const a=x.value.toLowerCase();return $.value.filter(l=>{var d;const i=l.name?l.name.toLowerCase():"",r=(d=l==null?void 0:l.warehouse)!=null&&d.name?l.warehouse.name.toLowerCase():"";return i.includes(a)||r.includes(a)})});ne(async()=>{await E.fetchWarehouses(),await Q()});const Q=async()=>{_.value=!0;try{const a=await f.fetchBranches();console.log("branches data",a),n.value=$.value.length===0}catch{n.value=!0}finally{_.value=!1}};ge(x,async a=>{_.value=!0,await new Promise(l=>setTimeout(l,1e3)),_.value=!1,n.value=y.value.length===0});const b=a=>a?a.split(" ").map(l=>l.charAt(0).toUpperCase()+l.slice(1).toLowerCase()).join(" "):"",w=a=>{const l=c=>c?c.charAt(0).toUpperCase()+c.slice(1).toLowerCase():"",i=a.firstname?l(a.firstname):"No Firstname",r=a.middlename?l(a.middlename).charAt(0)+".":"",d=a.lastname?l(a.lastname):"No Lastname";return`${i} ${r} ${d}`},N=[{name:"branch_name",label:"Name of Branch",align:"left",field:a=>a.name,format:a=>`${a}`,sortable:!0},{name:"warehouse",label:"Warehouse",align:"left",field:a=>{var l;return a!=null&&a.warehouse?(l=a.warehouse)==null?void 0:l.name:"No warehouse "},sortable:!0},{name:"location",label:"Location",align:"left",field:"location"},{name:"personIncharge",label:"Person In-charge",align:"left",field:a=>w(a)},{name:"phone",label:"Phone",align:"center",field:"phone"},{name:"status",label:"Status",align:"center",field:"status"},{name:"action",label:"Action",align:"center",field:"action"}],L=a=>{switch(a){case"Open":return"info";case"Open soon":return"warning";case"Close":return"accent";default:return"grey"}},z=async a=>{oe.show();try{await k.push({name:"BranchDetail",params:{branch_id:a.id}})}finally{oe.hide()}};return(a,l)=>(h(),C(A,null,[s("div",null,[e(D,{class:"q-pb-lg q-pl-sm",modelValue:x.value,"onUpdate:modelValue":l[0]||(l[0]=i=>x.value=i),outlined:"",placeholder:"Search",debounced:"1000",style:{width:"500px","max-width":"1500px","min-width":"100px"},flat:"",dense:"",rounded:""},{append:t(()=>[e(H,{name:"search"})]),_:1},8,["modelValue"])]),_.value?(h(),C("div",la,[e(we,{size:"50px",color:"primary"})])):(h(),C("div",oa,[y.value.length===0?(h(),C("div",sa,[e(H,{name:"warning",color:"warning",size:"4em"}),na])):(h(),B(qe,{key:1,class:"table-container elegant-container sticky-header","virtual-scroll-sticky-size-start":48,flat:"",style:{height:"400px"},columns:N,rows:y.value,"row-key":"name","virtual-scroll":"",pagination:q.value,"onUpdate:pagination":l[1]||(l[1]=i=>q.value=i),"rows-per-page-options":[0],"hide-bottom":""},{"body-cell-branch_name":t(i=>[e(P,{key:"name",props:i},{default:t(()=>[s("a",{onClick:be(r=>z(i.row),["prevent"]),class:"branch-link"},F(b(i.row.name)),9,ra)]),_:2},1032,["props"])]),"body-cell-warehouse":t(i=>[e(P,{props:i},{default:t(()=>{var r;return[S(F(b((r=i.row.warehouse)==null?void 0:r.name)),1)]}),_:2},1032,["props"])]),"body-cell-location":t(i=>[e(P,{props:i},{default:t(()=>[S(F(b(i.row.location)),1)]),_:2},1032,["props"])]),"body-cell-status":t(i=>[e(P,{key:"name",props:i},{default:t(()=>[e(K,{outline:"",color:L(i.row.status)},{default:t(()=>[S(F(i.row.status),1)]),_:2},1032,["color"])]),_:2},1032,["props"])]),"body-cell-personIncharge":t(i=>[e(P,{props:i},{default:t(()=>[S(F(w(i.row.employees)),1)]),_:2},1032,["props"])]),"body-cell-action":t(i=>[e(P,{props:i},{default:t(()=>[s("div",ia,[e(Xe,{edit:i},null,8,["edit"]),e(aa,{delete:i},null,8,["delete"])])]),_:2},1032,["props"])]),_:1},8,["rows","pagination"]))]))],64))}};var ua=M(da,[["__scopeId","data-v-48ca339d"]]);const ca={class:"text-h6 text-dark"},ma={class:"q-gutter-x-sm"},pa={__name:"BranchesPage",setup(p){return(k,f)=>(h(),B(ye,{class:"elegant-container",flat:""},{default:t(()=>[e(I,{class:"row justify-between"},{default:t(()=>[s("div",ca,[s("div",ma,[e(K,{outline:"",label:"Open",color:"info"}),e(K,{outline:"",label:"Open Soon",color:"warning"}),e(K,{outline:"",label:"Close",color:"accent"})])]),s("div",null,[e(Fe)])]),_:1}),e(I,null,{default:t(()=>[s("div",null,[e(ua)])]),_:1})]),_:1}))}};var Ua=M(pa,[["__scopeId","data-v-d75e8df2"]]);export{Ua as default};
