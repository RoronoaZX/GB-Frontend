import{r as M,c as L,t as ye,o as c,a3 as V,J as i,f as t,M as U,w as a,Q as X,I as R,ae as Z,K as x,L as G,e as I,a0 as y,a4 as j,a5 as De,$ as k,bd as ce,aJ as ne,a2 as re,O as te,R as le,bf as g,a1 as ke,z as pe,u as xe,bb as J,aK as ve}from"./index.5e9ef5e9.js";import{Q as oe}from"./QChip.4cd41c14.js";import{a as Se,Q as $}from"./QTable.40cf4237.js";import{Q as H}from"./QTooltip.ee01c5ce.js";import{Q as me}from"./QSelect.2ed57bcd.js";import{Q as B}from"./QPopupEdit.2a4a73b0.js";import{Q as be}from"./QDate.ee572c84.js";import{Q as W}from"./QBadge.c451b4dd.js";import{Q as $e}from"./QSpinnerIos.54cdbd2c.js";import{Q as Ue}from"./QInnerLoading.3445d1f4.js";import{u as ie}from"./dtr.7d9a397a.js";import{Q as we}from"./QSpace.278fd9c1.js";import{a as ge,b as qe}from"./QMenu.38fb84fd.js";import{Q as Oe}from"./QList.a8a05495.js";import{C as ee}from"./ClosePopup.8f084a37.js";import{u as Ie}from"./employee.f2f39e2b.js";/* empty css                                                                    */import{_ as ae}from"./plugin-vue_export-helper.21dcd24c.js";import"./QVirtualScroll.2a6d222d.js";import"./use-virtual-scroll.4cc6acf6.js";import"./rtl.276c3f1b.js";import"./position-engine.a102cac3.js";import"./selection.00203619.js";import"./use-render-cache.3aae9b27.js";import"./date.44d26a05.js";import"./axios.baad181c.js";const Ae=p=>(te("data-v-663a67ba"),p=p(),le(),p),Ce=Ae(()=>i("div",{class:"text-h5 q-mr-md"},"\u{1F554} Add Over Time",-1)),Ne={class:"q-gutter-md"},Me={class:"q-mb-lg"},Re={key:0,class:"custom-list z-top"},Be={class:"q-gutter-md q-my-lg"},We={class:"q-mt-xl q-gutter-y-md"},Ee={class:"row justify-between"},He={class:"row justify-between"},Qe={__name:"OvertimeButton",setup(p){const d=ie(),S=Ie(),D=M(""),f=L(()=>S.employees),m=async()=>{D.value.trim()&&await S.searchEmployee(D.value)},C=M(!1),O=()=>{C.value=!0},h=T=>/^(0[1-9]|1[0-2]):[0-5][0-9] (AM|PM)$/i.test(T)||"Invalid time format",v=T=>{b.employee_id=T.id,b.employee_name=`${T.firstname} ${T.middlename?T.middlename.charAt(0)+".":""} ${T.lastname}`,b.position=T.position,D.value=""},b=ye({employee_id:"",employee_name:"",position:"",regularDateIN:"",dateIn:"",dateOut:"",timeIn:"",timeOut:""}),F=T=>{const n=N=>N?N.charAt(0).toUpperCase()+N.slice(1).toLowerCase():"",u=T.firstname?n(T.firstname):"No Firstname",_=T.middlename?n(T.middlename).charAt(0)+".":"",w=T.lastname?n(T.lastname):"No Lastname";return`${u} ${_} ${w}`},Q=async()=>{const T=`${b.dateIn} ${b.timeIn}`,n=`${b.dateOut} ${b.timeOut}`,u={...b,overtime_in:T,overtime_out:n};await d.saveOvertime(u),console.log("overtime dATA",u)};return(T,n)=>(c(),V(j,null,[i("div",null,[t(U,{padding:"sm md",label:"Add Over Time",icon:"add_circle",size:"md",class:"gradient-btn text-white",onClick:O})]),i("div",null,[t(re,{modelValue:C.value,"onUpdate:modelValue":n[8]||(n[8]=u=>C.value=u),"full-height":"",persistent:"",position:"right","backdrop-filter":"blur(4px) saturate(150%)"},{default:a(()=>[t(X,{style:{width:"500px","max-width":"100vw"}},{default:a(()=>[t(R,{class:"row items-center q-px-md q-py-sm gradient-btn text-white"},{default:a(()=>[Ce,t(we),Z(t(U,{icon:"arrow_forward_ios",flat:"",dense:"",round:""},null,512),[[ee]])]),_:1}),t(R,null,{default:a(()=>[i("div",Ne,[i("div",Me,[t(x,{modelValue:D.value,"onUpdate:modelValue":[n[0]||(n[0]=u=>D.value=u),m],label:"Search Employee",outlined:"",dense:"",debounce:"500",placeholder:"Enter name"},{append:a(()=>[t(G,{name:"search"})]),default:a(()=>[D.value?(c(),V("div",Re,[t(X,null,{default:a(()=>[t(Oe,{separator:""},{default:a(()=>{var u;return[(u=f.value)!=null&&u.length?(c(!0),V(j,{key:1},De(f.value,_=>(c(),I(ge,{onClick:w=>v(_),key:_.id,clickable:""},{default:a(()=>[t(qe,null,{default:a(()=>[y(k(F(_)),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128)):(c(),I(ge,{key:0},{default:a(()=>[y(" No Employee Record ")]),_:1}))]}),_:1})]),_:1})])):ce("",!0)]),_:1},8,["modelValue"])]),i("div",null,[i("div",Be,[t(x,{modelValue:b.employee_name,"onUpdate:modelValue":n[1]||(n[1]=u=>b.employee_name=u),outlined:"",dense:"",readonly:"",label:"Name"},null,8,["modelValue"]),t(x,{modelValue:b.position,"onUpdate:modelValue":n[2]||(n[2]=u=>b.position=u),outlined:"",dense:"",readonly:"",label:"Position"},null,8,["modelValue"])])])])]),_:1}),t(R,null,{default:a(()=>[t(x,{modelValue:b.regularDateIN,"onUpdate:modelValue":n[3]||(n[3]=u=>b.regularDateIN=u),outlined:"",dense:"",label:"Regular Date IN",type:"date"},null,8,["modelValue"])]),_:1}),t(R,null,{default:a(()=>[i("div",We,[i("div",Ee,[i("div",null,[t(x,{modelValue:b.dateIn,"onUpdate:modelValue":n[4]||(n[4]=u=>b.dateIn=u),outlined:"",dense:"",label:"Date IN",type:"date",style:{width:"170px"}},null,8,["modelValue"])]),i("div",null,[t(x,{modelValue:b.timeIn,"onUpdate:modelValue":n[5]||(n[5]=u=>b.timeIn=u),label:"Time IN",dense:"",mask:"##:## AA",outlined:"",rules:h,hint:"Format: hh:mm AM/PM"},null,8,["modelValue"])])]),i("div",He,[i("div",null,[t(x,{modelValue:b.dateOut,"onUpdate:modelValue":n[6]||(n[6]=u=>b.dateOut=u),outlined:"",dense:"",label:"Date OUT",type:"date",style:{width:"170px"}},null,8,["modelValue"])]),i("div",null,[t(x,{modelValue:b.timeOut,"onUpdate:modelValue":n[7]||(n[7]=u=>b.timeOut=u),label:"Time OUT",dense:"",mask:"##:## AA",outlined:"",rules:h,hint:"Format: hh:mm AM/PM"},null,8,["modelValue"])])])])]),_:1}),t(R,null,{default:a(()=>[t(ne,{class:"q-mt-md"},{default:a(()=>[t(U,{size:"md",padding:"xs md",label:"save","icon-right":"send",class:"gradient-btn text-white",onClick:Q})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])],64))}};var Pe=ae(Qe,[["__scopeId","data-v-663a67ba"]]);const E=p=>(te("data-v-f6a9ed94"),p=p(),le(),p),ze=E(()=>i("div",{class:"text-h5 q-mr-md"},"\u{1F554} Edit Time",-1)),Fe={class:"row justify-between"},Le={class:"q-mt-lg q-gutter-md"},je={class:"row justify-between"},Ke=E(()=>i("div",null,"Time IN",-1)),Ye=E(()=>i("div",null,"Time OUT",-1)),Je={class:"row justify-between"},Ge=E(()=>i("div",null,"Lunch Break Start",-1)),Xe=E(()=>i("div",null,"Lunch Break End",-1)),Ze={class:"row justify-between"},et=E(()=>i("div",null,"Break Start",-1)),tt=E(()=>i("div",null,"Break End",-1)),lt={class:"row justify-between"},at=E(()=>i("div",null,"Over Time Start",-1)),ot=E(()=>i("div",null,"Over Time End",-1)),nt={__name:"EditDTR",props:["edit"],setup(p){const S=p.edit.row,D=M(),f=O=>{const h=Q=>Q?Q.charAt(0).toUpperCase()+Q.slice(1).toLowerCase():"",v=O.firstname?h(O.firstname):"No Firstname",b=O.middlename?h(O.middlename).charAt(0)+".":"",F=O.lastname?h(O.lastname):"No Lastname";return`${v} ${b} ${F}`.trim()},m=ye({time_in:"",time_out:"",lunch_break_start:"",lunch_break_end:"",break_start:"",break_end:"",over_start:"",over_end:""}),C=()=>{Object.assign(m,S),D.value=!0};return(O,h)=>(c(),V(j,null,[t(U,{color:"positive",icon:"edit",size:"sm",flat:"",round:"",dense:"",onClick:C},{default:a(()=>[t(H,{class:"bg-positive",delay:200},{default:a(()=>[y("Edit")]),_:1})]),_:1}),t(re,{modelValue:D.value,"onUpdate:modelValue":h[8]||(h[8]=v=>D.value=v)},{default:a(()=>[t(X,{style:{width:"550px","max-width":"80vw"}},{default:a(()=>[t(R,{class:"row items-center q-px-md q-py-sm gradient-btn text-white"},{default:a(()=>[ze,t(we),Z(t(U,{icon:"close",flat:"",dense:"",round:""},null,512),[[ee]])]),_:1}),t(R,null,{default:a(()=>[i("div",Fe,[i("div",null,"Name: "+k(f(g(S).employee)),1),i("div",null," Position: "+k(g(S).employee.position),1)]),i("div",Le,[i("div",je,[i("div",null,[Ke,t(x,{outlined:"",dense:"",modelValue:m.time_in,"onUpdate:modelValue":h[0]||(h[0]=v=>m.time_in=v)},null,8,["modelValue"])]),i("div",null,[Ye,t(x,{outlined:"",dense:"",modelValue:m.time_out,"onUpdate:modelValue":h[1]||(h[1]=v=>m.time_out=v)},null,8,["modelValue"])])]),i("div",Je,[i("div",null,[Ge,t(x,{outlined:"",dense:"",modelValue:m.lunch_break_start,"onUpdate:modelValue":h[2]||(h[2]=v=>m.lunch_break_start=v)},null,8,["modelValue"])]),i("div",null,[Xe,t(x,{outlined:"",dense:"",modelValue:m.lunch_break_end,"onUpdate:modelValue":h[3]||(h[3]=v=>m.lunch_break_end=v)},null,8,["modelValue"])])]),i("div",Ze,[i("div",null,[et,t(x,{outlined:"",dense:"",modelValue:m.break_start,"onUpdate:modelValue":h[4]||(h[4]=v=>m.break_start=v)},null,8,["modelValue"])]),i("div",null,[tt,t(x,{outlined:"",dense:"",modelValue:m.break_end,"onUpdate:modelValue":h[5]||(h[5]=v=>m.break_end=v)},null,8,["modelValue"])])]),i("div",lt,[i("div",null,[at,t(x,{outlined:"",dense:"",modelValue:m.over_start,"onUpdate:modelValue":h[6]||(h[6]=v=>m.over_start=v)},null,8,["modelValue"])]),i("div",null,[ot,t(x,{outlined:"",dense:"",modelValue:m.over_end,"onUpdate:modelValue":h[7]||(h[7]=v=>m.over_end=v)},null,8,["modelValue"])])])])]),_:1}),t(ne,{class:"row q-ma-md",align:"right"},{default:a(()=>[Z(t(U,{class:"btn-cancel glossy",color:"negative",label:"Cancel"},null,512),[[ee]]),t(U,{class:"btn-create glossy",color:"positive",label:"Save"})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};var rt=ae(nt,[["__scopeId","data-v-f6a9ed94"]]);const it=p=>(te("data-v-798ca487"),p=p(),le(),p),st=it(()=>i("div",{class:"text-h5 q-mb-md"},"Decline Overtime",-1)),ut={class:"q-pa-md"},dt={__name:"DeclineOTButton",props:["decline"],setup(p){const d=p,S=ie();console.log("decline",d.decline);const D=L(()=>S.user);console.log("userDatafromDeclineButton",D.value);const f=M(!1),m=M(""),C=async()=>{f.value=!0},O=async()=>{try{await S.declineOvertime({id:d.decline.id,declined_by:D.value.employee.id,reason:m.value}),f.value=!1}catch(h){console.error("Error declining overtime:",h)}};return(h,v)=>(c(),V(j,null,[t(U,{dense:"",outline:"",color:"red",icon:"close",size:"sm",onClick:C}),t(re,{modelValue:f.value,"onUpdate:modelValue":v[1]||(v[1]=b=>f.value=b),"backdrop-filter":"blur(4px) saturate(150%) brightness(60%)"},{default:a(()=>[t(X,{style:{"max-width":"400px",width:"100%"}},{default:a(()=>[t(R,{class:"q-pa-md q-rounded q-elevate-2 bg-white text-grey-9"},{default:a(()=>[st,i("div",ut,[t(x,{modelValue:m.value,"onUpdate:modelValue":v[0]||(v[0]=b=>m.value=b),filled:"",type:"textarea",placeholder:"Reason"},null,8,["modelValue"])])]),_:1}),t(ke,{class:"q-mb-md"}),t(R,null,{default:a(()=>[t(ne,{align:"right",class:"q-pt-none"},{default:a(()=>[Z(t(U,{flat:"",dense:"",label:"Cancel",color:"primary",class:"q-mr-sm"},null,512),[[ee]]),t(U,{dense:"",label:"Decline",color:"negative",disable:!m.value,onClick:O,class:"q-btn-rounded q-px-lg"},null,8,["disable"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};var mt=ae(dt,[["__scopeId","data-v-798ca487"]]);const _e=p=>(te("data-v-cceeabd0"),p=p(),le(),p),ct={class:"row q-px-xm"},_t=_e(()=>i("div",null,"Approve",-1)),ft=_e(()=>i("div",{class:"text-h5 q-mb-md"},"Approve Overtime",-1)),ht=_e(()=>i("p",{class:"text-body2 q-mb-none"}," Are you sure you want to approve overtime? This action cannot be undone. ",-1)),pt={__name:"ApproveOTButton",props:["approve"],setup(p){const d=p;console.log("approve",d.approve);const S=ie(),D=L(()=>S.user);console.log("userDatafromApprovebutton",D.value);const f=M(!1),m=()=>{f.value=!0},C=async()=>{console.log("Approving overtime for ID:",d.approve.id),await S.approveOvertime({id:d.approve.id,approved_by:D.value.employee.id}),f.value=!1};return(O,h)=>(c(),V(j,null,[t(U,{unelevated:"",dense:"",color:"dark",size:"sm","no-caps":"",onClick:m},{default:a(()=>[i("div",ct,[t(G,{left:"",size:"1.5em",name:"check"}),_t])]),_:1}),t(re,{modelValue:f.value,"onUpdate:modelValue":h[0]||(h[0]=v=>f.value=v),"backdrop-filter":"blur(4px) saturate(150%) brightness(60%)"},{default:a(()=>[t(X,null,{default:a(()=>[t(R,{class:"q-pa-md q-rounded q-elevate-2 bg-white text-grey-9"},{default:a(()=>[ft,ht]),_:1}),t(ke,{class:"q-mb-md"}),t(R,null,{default:a(()=>[t(ne,{align:"right",class:"q-pt-none"},{default:a(()=>[Z(t(U,{flat:"",dense:"",label:"Cancel",color:"primary",class:"q-mr-sm"},null,512),[[ee]]),t(U,{dense:"",label:"Approve",color:"dark",onClick:C,class:"q-btn-rounded q-px-lg"})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};var vt=ae(pt,[["__scopeId","data-v-cceeabd0"]]);function bt(){const p=n=>n?n.charAt(0).toUpperCase()+n.slice(1).toLowerCase():"",d=n=>{const u=n!=null&&n.firstname?p(n.firstname):"- ",_=n!=null&&n.middlename?p(n.middlename).charAt(0)+".":"-",w=n!=null&&n.lastname?p(n.lastname):" -";return`${u} ${_} ${w}`.trim()},S=n=>{if(!n)return" - - -";const u=new Date(n);return isNaN(u.getTime())?" - - -":u.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})},D=n=>{if(!n)return" - - -";const u=new Date(n);if(isNaN(u.getTime()))return" - - -";let _=u.getHours();const w=u.getMinutes().toString().padStart(2,"0"),N=_>=12?"PM":"AM";return _=_%12,_=_||12,`${_}:${w} ${N}`},f=(n,u)=>{if(!n||!u)return{hours:0,minutes:0};const _=new Date(n),w=new Date(u);if(isNaN(_.getTime())||isNaN(w.getTime()))return{hours:0,minutes:0};const N=w-_,P=Math.floor(N/(1e3*60)),K=Math.floor(P/60),z=P%60;return{hours:K,minutes:z}};return{capitalize:p,formatFullname:d,formatDate:S,formatTime:D,calculateTotalWorkingHours:f,calculateTotalOvertimeHours:(n,u)=>{if(!n||!u)return{hours:0,minutes:0};const _=new Date(n),w=new Date(u);if(isNaN(_.getTime())||isNaN(w.getTime()))return{hours:0,minutes:0};const N=w-_,P=Math.floor(N/(1e3*60)),K=Math.floor(P/60),z=P%60;return{hours:K,minutes:z}},getLunchBreakColor:(n,u)=>{const{hours:_,minutes:w}=f(n,u);return _>1||w>0?"green-7":"blue-grey-9"},getLunchBreakIcon:(n,u)=>{const{hours:_,minutes:w}=f(n,u);return _>1||w>0?"check_circle":"access_time"},getBreakColor:(n,u)=>{const{hours:_,minutes:w}=f(n,u);return _>0||w>15?"pink-13":"green-7"},getBreakHoursIcon:(n,u)=>{const{hours:_,minutes:w}=f(n,u);return _>0||w>15?"access_time":"check_circle"},getWorkHoursColor:(n,u)=>{const{hours:_,minutes:w}=f(n,u);return _>9||_===9&&w>0?"blue-grey-9":_>=8?"green-7":"pink-13"},getWorkHoursIcon:(n,u)=>{const{hours:_,minutes:w}=f(n,u);return _>=9||_===9&&w>0?"alarm_on":_>=8?"check_circle":"access_time"},getBadgePositionColor:n=>{switch(n){case"Super Admin":return"blue-10";case"Admin":return"purple-10";case"Supervisor":return"teal-7";case"Scaler":return"green-8";case"Lamesador":return"orange-5";case"Hornero":return"red-6";case"Baker":return"brown";case"Cake Maker":return"brown-4";case"Cashier":return"green-5";case"Sales Clerk":return"blue-5";case"Utility":return"grey-7";case"Not Yet Assigned":return"grey-4";default:return"grey-4"}},truncateText:(n,u)=>n?n.length>u?n.slice(0,u)+"...":n:""}}const fe=p=>(te("data-v-7d58853c"),p=p(),le(),p),gt={class:"row justify-between q-my-md",align:"right"},yt={class:"q-pa-md",style:{"min-width":"300px","max-width":"400px"}},kt=fe(()=>i("div",{class:"text-h6 text-primary text-center q-mb-sm"}," Edit Where IN ",-1)),wt={class:"text-subtitle2 q-mb-sm"},Vt={class:"row justify-end q-mt-md"},Tt={class:"q-pa-md",style:{"min-width":"300px","max-width":"400px"}},Dt=fe(()=>i("div",{class:"text-h6 text-primary text-center q-mb-sm"}," Edit Where OUT ",-1)),xt={class:"text-subtitle2 q-mb-sm"},St={class:"row justify-end q-mt-md"},$t={class:"q-pa-md",style:{"min-width":"300px","max-width":"400px"}},Ut=fe(()=>i("div",{class:"text-h6 text-primary text-center q-mb-sm"}," Edit Shift Status ",-1)),qt={class:"text-subtitle2 q-mb-sm"},Ot={class:"row justify-end q-mt-md"},It={key:0},At={key:1},Ct={key:0},Nt={key:1},Mt={key:1},Rt={key:1},Bt={key:1},Wt={key:1},Et={key:1},Ht={key:1},Qt={key:1},Pt={key:1},zt={key:1},Ft={key:2},Lt={key:3,class:"q-gutter-x-sm"},jt={key:0},Kt={key:1},Yt={key:0},Jt={key:1},Gt={class:"row justify-center q-gutter-x-md"},Xt={__name:"AttendanceTable",setup(p){const d=bt(),S=M({page:1,rowsPerPage:0,rowsNumber:0}),D=M(""),f=M(!1),m=ie(),C=L(()=>m.dtrs),O=L(()=>m.branchWithWarehouses),h=M([]);M(""),pe(async()=>{await z()});const v=o=>/^(0[1-9]|1[0-2]):([0-5][0-9]) (AM|PM)$/.test(o)||"Time format must be HH:MM AM/PM (e.g., 01:00 AM)",b=async(o,r)=>{console.log("updateEmployeeScheduleIn composables",o,r),f.value=!0;try{const e={id:o.id,schedule_in:r};console.log("employeeScheduleIn",e),await m.updateDtrScheduleIn(e)}catch(e){console.log("error",e)}finally{f.value=!1}},F=async(o,r)=>{console.log("updateEmployeeScheduleOut composables",o,r),f.value=!0;try{const e={id:o.id,schedule_out:r};console.log("employeeScheduleOut",e),await m.updateDtrSheduleOut(e)}catch(e){console.log(e)}finally{f.value=!1}};pe(async()=>{try{const o=await m.getBranchWithWarehouses()}catch(o){console.log("error",o)}});const T=L(()=>O.value.data.map(o=>{var r;return{label:o.name,value:(r=o.devices[0])==null?void 0:r.uuid}})),n=async(o,r)=>{console.log("updateDTRWhereIN composables",o,r),f.value=!0;try{const e={id:o.id,device_uuid_in:r};await m.updateDTRWhereIN(e);const l=T.value.find(s=>s.value===r);l&&(o.device_in_reference_name=l.label)}catch(e){console.log("error",e)}finally{f.value=!1}},u=async(o,r)=>{console.log("updateDTRWhereOUT composables",o,r),f.value=!0;try{const e={id:o.id,device_uuid_out:r};await m.updateDTRWhereOUT(e);const l=T.value.find(s=>s.value===r);l&&(o.device_out_reference_name=l.label)}catch(e){console.log("error",e)}finally{f.value=!1}},_=async(o,r)=>{console.log("updateDTRShiftStatus composables",o,r),f.value=!0;try{const e={id:o.id,shift_status:r};await m.updateDTRShiftStatus(e),o.shift_status=r}catch(e){console.log("error",e)}finally{f.value=!1}},w=async(o,r,e)=>{console.log("updateDTRTimeINDateOnly composables",o,r,e);let l;if(o.time_in&&e==="date"){const s=new Date(o.time_in),q=new Date(r);s.setFullYear(q.getFullYear()),s.setMonth(q.getMonth()),s.setDate(q.getDate()),l=s.toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0}),l=l.replace(/^(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)/,"$1.")}else l=r;console.log("Updating row with new time_in:",l);try{const s={id:o.id,time_in:l},q=await m.updateDTRDateIN(s)}catch(s){console.log("error",s)}o.time_in=l},N=async(o,r,e)=>{console.log("updateDTRTimeOnly composables",o,r,e);let l;if(o.time_in&&e==="time"){const s=o.time_in.split(",").slice(0,2).join(","),[q,Y]=r.split(":");let A=parseInt(q,10);const se=Y.padStart(2,"0"),ue=A>=12?"PM":"AM";A===0?A=12:A>12&&(A-=12);const de=`${A}:${se} ${ue}`;l=`${s}, ${de}`}else l=r;console.log("Updating row with new time_in:",l);try{const s={id:o.id,time_in:l};await m.updateDTRTimeIN(s),o.time_in=l}catch(s){console.error("Error updating DTR:",s)}},P=async(o,r,e)=>{console.log("updateDTRTimeOUTDateOnly composables",o,r,e);let l;if(o.time_out&&e==="date"){const s=new Date(o.time_out),q=new Date(r);s.setFullYear(q.getFullYear()),s.setMonth(q.getMonth()),s.setDate(q.getDate()),l=s.toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0}),l=l.replace(/^(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)/,"$1.")}else l=r;console.log("Updating row with new time_out:",l);try{const s={id:o.id,time_out:l},q=await m.updateDTRDateOUT(s)}catch(s){console.log("error",s)}o.time_out=l},K=async(o,r,e)=>{console.log("updateDTRTimeOutOnly composables",o,r,e);let l;if(o.time_out&&e==="time"){const s=o.time_out.split(",").slice(0,2).join(","),[q,Y]=r.split(":");let A=parseInt(q,10);const se=Y.padStart(2,0),ue=A>=12?"PM":"AM";A===0?A=12:A>12&&(A-=12);const de=`${A}:${se} ${ue}`;l=`${s}, ${de}`}else l=r;console.log("Updating row with new time_out:",l);try{const s={id:o.id,time_out:l};await m.updateDTRTimeOUT(s),o.time_out=l}catch(s){console.error("Error updating DTR:",s)}},z=async(o=0,r=5,e="")=>{try{f.value=!0,await m.fetchDTR(o,r,e);const{data:l,current_page:s,per_page:q,total:Y}=C.value;h.value=l,console.log("dtrRows.value",h.value),S.value={page:s,rowsPerPage:q,rowsNumber:Y}}catch(l){console.error("Error fetching DTR data:",l)}finally{f.value=!1}},he=o=>{const r=o||"Regular Day";return r==="Half Day"?{label:r,color:"orange"}:r==="Regular Day"?{label:r,color:"green"}:{label:r,color:"grey-4"}},Ve=[{name:"name",required:!0,label:"Name",align:"left",field:o=>d.formatFullname(o.employee),style:"position: sticky; left: 0; background: white; z-index: 1;",headerStyle:"position: sticky; left: 0; background: white; z-index: 2;"},{name:"position",required:!0,label:"Position",align:"center",field:o=>{var r;return((r=o.employee)==null?void 0:r.position)||"N/A"}},{name:"where_in",required:!0,label:"Where IN",align:"center",field:o=>o.device_in_reference_name||"N/A"},{name:"where_out",required:!0,label:"Where OUT",align:"center",field:o=>o.device_out_reference_name||"N/A"},{name:"shift_status",required:!0,label:"Shift Status",align:"center",field:o=>o.shift_status||"Regular Day",format:o=>{const r=o||"Regular Day";let e="grey-4";return r==="Half Day"?e="orange":r==="Regular Day"&&(e="green"),`<q-chip color="${e}" text-color="white" dense>${r}</q-chip>`},sortable:!0},{name:"date_in",required:!0,label:"Date In",align:"center",field:"time_in",format:d.formatDate},{name:"date_out",required:!0,label:"Date Out",align:"center",field:"time_out",format:d.formatDate},{name:"time_in",required:!0,label:"Time In",align:"center",field:"time_in"},{name:"time_out",required:!0,label:"Time Out",align:"center",field:"time_out",format:d.formatTime},{name:"lunch_break_start",required:!0,label:"Lunch Break Start",align:"center",field:"lunch_break_start",format:d.formatTime},{name:"lunch_break_end",required:!0,label:"Lunch Break End",align:"center",field:"lunch_break_end",format:d.formatTime},{name:"break_start",required:!0,label:"Break Start",align:"center",field:"break_start",format:d.formatTime},{name:"break_end",required:!0,label:"Break End",align:"center",field:"break_end",format:d.formatTime},{name:"break",required:!0,label:"Total Break",align:"center",field:o=>{const{hours:r,minutes:e}=d.calculateTotalWorkingHours(o.break_start,o.break_end);return`${r}h ${e}m`}},{name:"lunch_break",required:!0,label:"Total Lunch Break",align:"center",field:o=>{const{hours:r,minutes:e}=d.calculateTotalWorkingHours(o.lunch_break_start,o.lunch_break_end);return`${r}h ${e}m`}},{name:"total_working_hours",required:!0,label:"Work Hours",align:"center",field:o=>{const{hours:r,minutes:e}=d.calculateTotalWorkingHours(o.time_in,o.time_out);return`${r}h ${e}m`}},{name:"overtime_start",required:!0,label:"Overtime Start",align:"center",field:"overtime_start",format:d.formatTime},{name:"overtime_end",required:!0,label:"Overtime End",align:"center",field:"overtime_end",format:d.formatTime},{name:"total_overtime",required:!0,label:"OT Total Hours",align:"center",field:o=>{const{hours:r,minutes:e}=d.calculateTotalOvertimeHours(o.overtime_start,o.overtime_end);return`${r}h ${e}m`}},{name:"overtime_reason",required:!0,label:"Overtime Reason",align:"justify",field:"overtime_reason",format:o=>o||" - - - "},{name:"declined_reason",label:"Declined Reason",field:"declined_reason",format:o=>o||" - - - ",sortable:!1},{name:"ot_status",label:"OT Status",align:"center",field:o=>o.ot_status,sortable:!1},{name:"approved_by",label:"Approved By",align:"center",field:o=>d.formatFullname(o.approvedBy),sortable:!1},{name:"schedule_in",label:"Schedule In",align:"center",field:o=>o.schedule_in},{name:"schedule_out",label:"Schedule Out",align:"center",field:o=>o.schedule_out}],Te=o=>{z(o.pagination.page,o.pagination.rowsPerPage,o.filter)};return xe(D,async o=>{S.value.page=1,await z(S.value.page,S.value.rowsPerPage,o)}),(o,r)=>(c(),V(j,null,[i("div",gt,[i("div",null,[t(Pe)]),t(x,{modelValue:D.value,"onUpdate:modelValue":r[0]||(r[0]=e=>D.value=e),outlined:"",dense:"",flat:"",label:"Search",debounce:"300",style:{width:"300px"}},null,8,["modelValue"])]),i("div",null,[t(Se,{rows:h.value,columns:Ve,"row-key":"time_in",pagination:S.value,"onUpdate:pagination":r[1]||(r[1]=e=>S.value=e),"rows-per-page-options":[3,5,10,0],loading:f.value,filter:D.value,onRequest:Te},{"body-cell-position":a(e=>[t($,{props:e},{default:a(()=>{var l,s;return[t(oe,{outline:"",square:"","text-color":g(d).getBadgePositionColor((l=e.row.employee)==null?void 0:l.position),color:g(d).getBadgePositionColor((s=e.row.employee)==null?void 0:s.position),class:"q-ma-xs",size:"sm"},{default:a(()=>{var q;return[y(k(((q=e.row.employee)==null?void 0:q.position)||"N/A"),1)]}),_:2},1032,["text-color","color"])]}),_:2},1032,["props"])]),"body-cell-where_in":a(e=>[t($,{props:e,class:"cursor-pointer"},{default:a(()=>[i("span",null,[y(k(e.row.device_in_reference_name||"N/A")+" ",1),t(H,{class:"bg-blue-grey-8"},{default:a(()=>[y("Edit Where IN")]),_:1})]),t(B,{modelValue:e.row.device_in_reference_name,"onUpdate:modelValue":[l=>e.row.device_in_reference_name=l,l=>n(e.row,l)]},{default:a(l=>[i("div",yt,[kt,i("div",wt," Name: "+k(g(d).formatFullname(e.row.employee)),1),t(me,{modelValue:l.value,"onUpdate:modelValue":[s=>l.value=s,s=>l.value=s],options:T.value,autofucos:"","option-label":"label","option-value":"value","emit-value":"","map-options":"",outlined:"",dense:"",counter:"",behavior:"menu","model-value":l.value,onKeyup:J(l.set,["enter"])},null,8,["modelValue","onUpdate:modelValue","options","model-value","onKeyup"]),i("div",Vt,[t(U,{flat:"",label:"Close",color:"primary",onClick:l.cancel},null,8,["onClick"]),t(U,{flat:"",label:"Save",color:"primary",onClick:l.set},null,8,["onClick"])])])]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1032,["props"])]),"body-cell-where_out":a(e=>[t($,{props:e,class:"cursor-pointer"},{default:a(()=>[i("span",null,[y(k(e.row.device_out_reference_name||"N/A")+" ",1),t(H,null,{default:a(()=>[y("Edit Where OUT")]),_:1})]),t(B,{modelValue:e.row.device_out_reference_name,"onUpdate:modelValue":[l=>e.row.device_out_reference_name=l,l=>u(e.row,l)]},{default:a(l=>[i("div",Tt,[Dt,i("div",xt," Name: "+k(g(d).formatFullname(e.row.employee)),1),t(me,{modelValue:l.value,"onUpdate:modelValue":[s=>l.value=s,s=>l.value=s],options:T.value,autofucos:"","option-label":"label","option-value":"value","emit-value":"","map-options":"",outlined:"",dense:"",counter:"",behavior:"menu","model-value":l.value,onKeyup:J(l.set,["enter"])},null,8,["modelValue","onUpdate:modelValue","options","model-value","onKeyup"]),i("div",St,[t(U,{flat:"",label:"Close",color:"primary",onClick:l.cancel},null,8,["onClick"]),t(U,{flat:"",label:"Save",color:"primary",onClick:l.set},null,8,["onClick"])])])]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1032,["props"])]),"body-cell-shift_status":a(e=>[t($,{props:e,class:"cursor-pointer"},{default:a(()=>[t(oe,{color:he(e.row.shift_status).color,"text-color":"white",dense:""},{default:a(()=>[y(k(he(e.row.shift_status).label)+" ",1),t(H,null,{default:a(()=>[y(" Edit Shift Status ")]),_:1})]),_:2},1032,["color"]),t(B,{modelValue:e.row.shiftStatus,"onUpdate:modelValue":[l=>e.row.shiftStatus=l,l=>_(e.row,l)]},{default:a(l=>[i("div",$t,[Ut,i("div",qt," Name: "+k(g(d).formatFullname(e.row.employee)),1),t(me,{modelValue:l.value,"onUpdate:modelValue":s=>l.value=s,options:[{label:"Regular Day",value:"Regular Day"},{label:"Half Day",value:"Half Day"}],"option-label":"label","option-value":"value","emit-value":"","map-options":"",autofocus:"",outlined:"",dense:"",counter:"",behavior:"menu","model-value":l.value,onKeyup:J(l.set,["enter"])},null,8,["modelValue","onUpdate:modelValue","model-value","onKeyup"]),i("div",Ot,[t(U,{flat:"",label:"Close",color:"primary",onClick:l.cancel},null,8,["onClick"]),t(U,{flat:"",label:"Save",color:"primary",onClick:l.set},null,8,["onClick"])])])]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1032,["props"])]),"body-cell-date_in":a(e=>[t($,{props:e},{default:a(()=>[e.row.time_in?(c(),V("span",It,k(g(d).formatDate(e.row.time_in)),1)):(c(),V("span",At," - - - ")),t(B,{modelValue:e.row.time_in,"onUpdate:modelValue":[l=>e.row.time_in=l,l=>w(e.row,l,"date")],buttons:"",persistent:""},{default:a(l=>[t(be,{modelValue:l.value,"onUpdate:modelValue":s=>l.value=s,mask:"MMM. DD, YYYY, hh:mm A","today-btn":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1032,["props"])]),"body-cell-date_out":a(e=>[t($,{props:e},{default:a(()=>[e.row.time_out?(c(),V("span",Ct,k(g(d).formatDate(e.row.time_out)),1)):(c(),V("span",Nt," - - - ")),t(B,{modelValue:e.row.time_out,"onUpdate:modelValue":[l=>e.row.time_out=l,l=>P(e.row,l,"date")],buttons:"",persistent:""},{default:a(l=>[t(be,{modelValue:l.value,"onUpdate:modelValue":s=>l.value=s,mask:"MMM. DD, YYYY, hh:mm A","today-btn":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1032,["props"])]),"body-cell-time_in":a(e=>[t($,{props:e},{default:a(()=>[e.row.time_in?(c(),I(W,{key:0,outline:"",color:"positive"},{default:a(()=>[y(k(g(d).formatTime(e.row.time_in)),1)]),_:2},1024)):(c(),V("span",Mt," - - - ")),t(B,{modelValue:e.row.time_in,"onUpdate:modelValue":l=>e.row.time_in=l,buttons:"",persistent:"",onSave:l=>N(e.row,l,"time")},{default:a(l=>[t(x,{modelValue:l.value,"onUpdate:modelValue":s=>l.value=s,type:"time",filled:"",hint:"Edit Time"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["modelValue","onUpdate:modelValue","onSave"])]),_:2},1032,["props"])]),"body-cell-time_out":a(e=>[t($,{props:e},{default:a(()=>[e.row.time_out?(c(),I(W,{key:0,outline:"",color:"purple-12"},{default:a(()=>[y(k(g(d).formatTime(e.row.time_out)),1)]),_:2},1024)):(c(),V("span",Rt," - - - ")),t(B,{modelValue:e.row.time_out,"onUpdate:modelValue":l=>e.row.time_out=l,buttons:"",persistent:"",onSave:l=>K(e.row,l,"time")},{default:a(l=>[t(x,{modelValue:l.value,"onUpdate:modelValue":s=>l.value=s,type:"time",filled:"",hint:"Edit Time"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["modelValue","onUpdate:modelValue","onSave"])]),_:2},1032,["props"])]),"body-cell-lunch_break_start":a(e=>[t($,{props:e},{default:a(()=>[e.row.lunch_break_start?(c(),I(W,{key:0,outline:"",color:"amber-7"},{default:a(()=>[y(k(g(d).formatTime(e.row.lunch_break_start)),1)]),_:2},1024)):(c(),V("span",Bt," - - - "))]),_:2},1032,["props"])]),"body-cell-lunch_break_end":a(e=>[t($,{props:e},{default:a(()=>[e.row.lunch_break_end?(c(),I(W,{key:0,outline:"",color:"amber-4"},{default:a(()=>[y(k(g(d).formatTime(e.row.lunch_break_end)),1)]),_:2},1024)):(c(),V("span",Wt," - - - "))]),_:2},1032,["props"])]),"body-cell-break_start":a(e=>[t($,{props:e},{default:a(()=>[e.row.break_start?(c(),I(W,{key:0,outline:"",color:"blue-7"},{default:a(()=>[y(k(g(d).formatTime(e.row.break_start)),1)]),_:2},1024)):(c(),V("span",Et," - - - "))]),_:2},1032,["props"])]),"body-cell-break_end":a(e=>[t($,{props:e},{default:a(()=>[e.row.break_end?(c(),I(W,{key:0,outline:"",color:"blue-4"},{default:a(()=>[y(k(g(d).formatTime(e.row.break_end)),1)]),_:2},1024)):(c(),V("span",Ht," - - - "))]),_:2},1032,["props"])]),"body-cell-break":a(e=>[t($,{props:e},{default:a(()=>[e.row.break_start&&e.row.break_end?(c(),I(W,{key:0,outline:"",color:g(d).getBreakColor(e.row.break_start,e.row.break_end),class:"q-ma-xs",size:"md"},{default:a(()=>[t(G,{name:g(d).getBreakHoursIcon(e.row.break_start,e.row.break_end),size:"xs",class:"q-mr-xs"},null,8,["name"]),y(" "+k(`${g(d).calculateTotalWorkingHours(e.row.break_start,e.row.break_end).hours} Hrs : ${g(d).calculateTotalWorkingHours(e.row.break_start,e.row.break_end).minutes} Min`),1)]),_:2},1032,["color"])):(c(),V("span",Qt," - - - "))]),_:2},1032,["props"])]),"body-cell-lunch_break":a(e=>[t($,{props:e},{default:a(()=>[e.row.lunch_break_start&&e.row.lunch_break_end?(c(),I(W,{key:0,outline:"",color:g(d).getLunchBreakColor(e.row.lunch_break_start,e.row.lunch_break_end),class:"q-ma-xs",size:"md"},{default:a(()=>[t(G,{name:g(d).getLunchBreakIcon(e.row.lunch_break_start,e.row.lunch_break_end),size:"xs",class:"q-mr-xs"},null,8,["name"]),y(" "+k(`${g(d).calculateTotalWorkingHours(e.row.lunch_break_start,e.row.lunch_break_end).hours} Hrs : ${g(d).calculateTotalWorkingHours(e.row.lunch_break_start,e.row.lunch_break_end).minutes} Min`),1)]),_:2},1032,["color"])):(c(),V("span",Pt," - - - "))]),_:2},1032,["props"])]),"body-cell-total_working_hours":a(e=>[t($,{props:e},{default:a(()=>[e.row.time_in&&e.row.time_out?(c(),I(W,{key:0,outline:"",color:g(d).getWorkHoursColor(e.row.time_in,e.row.time_out),class:"q-ma-xs",size:"md"},{default:a(()=>[t(G,{name:g(d).getWorkHoursIcon(e.row.time_in,e.row.time_out),size:"xs",class:"q-mr-xs"},null,8,["name"]),y(" "+k(`${g(d).calculateTotalWorkingHours(e.row.time_in,e.row.time_out).hours} Hrs : ${g(d).calculateTotalWorkingHours(e.row.time_in,e.row.time_out).minutes} Min`),1)]),_:2},1032,["color"])):(c(),V("span",zt," - - - "))]),_:2},1032,["props"])]),"body-cell-ot_status":a(e=>[t($,{props:e,class:"row"},{default:a(()=>[e.row.ot_status==="approved"?(c(),I(oe,{key:0,size:"sm",color:"green-1","text-color":"green-8",rounded:"",icon:"check_circle",label:g(d).capitalize(e.row.ot_status)},null,8,["label"])):e.row.ot_status==="declined"?(c(),I(oe,{key:1,size:"sm",color:"red-2","text-color":"red-14",rounded:"",icon:"cancel",label:g(d).capitalize(e.row.ot_status)},null,8,["label"])):e.row.ot_status?(c(),V("div",Lt,[t(mt,{decline:e.row},null,8,["decline"]),t(vt,{approve:e.row},null,8,["approve"])])):(c(),V("span",Ft," - - - "))]),_:2},1032,["props"])]),"body-cell-overtime_reason":a(e=>[t($,{props:e},{default:a(()=>[e.row.overtime_reason?(c(),V("span",jt,[y(k(g(d).truncateText(e.row.overtime_reason,15))+" ",1),e.row.overtime_reason.length>15?(c(),I(H,{key:0,class:"bg-blue-grey-10 text-white text-subtitle1",offset:[10,10]},{default:a(()=>[y(k(e.row.overtime_reason),1)]),_:2},1024)):ce("",!0)])):(c(),V("span",Kt," - - - "))]),_:2},1032,["props"])]),"body-cell-declined_reason":a(e=>[t($,{props:e},{default:a(()=>[e.row.declined_reason?(c(),V("span",Yt,[y(k(g(d).truncateText(e.row.declined_reason,15))+" ",1),e.row.declined_reason.length>15?(c(),I(H,{key:0,class:"bg-blue-grey-10 text-white text-subtitle1",offset:[10,10]},{default:a(()=>[y(k(e.row.declined_reason),1)]),_:2},1024)):ce("",!0)])):(c(),V("span",Jt," - - - "))]),_:2},1032,["props"])]),"body-cell-schedule_in":a(e=>[t($,{props:e},{default:a(()=>[i("div",{class:ve({"editable-cell":e.row.schedule_in})},[y(k(e.row.schedule_in||"N/A")+" ",1),t(H,{class:"bg-blue-grey-8",offset:[10,10]},{default:a(()=>[y(" Edit Schedule In ")]),_:1})],2),t(B,{"onUpdate:modelValue":[l=>b(e.row,l),l=>e.row.schedule_in=l],modelValue:e.row.schedule_in,buttons:"",title:"Edit Employee Schedule In"},{default:a(l=>[t(x,{modelValue:l.value,"onUpdate:modelValue":[s=>l.value=s,s=>l.value=s],"model-value":l.value,dense:"",autofocus:"",mask:"##:## AA",rules:[v],hint:"Format: 01:00 AM/PM",onKeyup:J(l.set,["enter"])},null,8,["modelValue","onUpdate:modelValue","model-value","rules","onKeyup"])]),_:2},1032,["onUpdate:modelValue","modelValue"])]),_:2},1032,["props"])]),"body-cell-schedule_out":a(e=>[t($,{props:e},{default:a(()=>[i("div",{class:ve({"editable-cell":e.row.schedule_out})},[y(k(e.row.schedule_out||"N/A")+" ",1),t(H,{class:"bg-blue-grey-8",offset:[10,10]},{default:a(()=>[y(" Edit Schedule Out ")]),_:1})],2),t(B,{"onUpdate:modelValue":[l=>F(e.row,l),l=>e.row.schedule_out=l],modelValue:e.row.schedule_out,buttons:"",title:"Edit Employee Schedule Out"},{default:a(l=>[t(x,{modelValue:l.value,"onUpdate:modelValue":[s=>l.value=s,s=>l.value=s],"model-value":l.value,dense:"",autofocus:"",mask:"##:## AA",rules:[v],hint:"Format: 01:00 AM/PM",onKeyup:J(l.set,["enter"])},null,8,["modelValue","onUpdate:modelValue","model-value","rules","onKeyup"])]),_:2},1032,["onUpdate:modelValue","modelValue"])]),_:2},1032,["props"])]),"body-cell-action":a(e=>[t($,{props:e},{default:a(()=>[i("div",Gt,[t(rt,{edit:e},null,8,["edit"])])]),_:2},1032,["props"])]),loading:a(()=>[t(Ue,{showing:""},{default:a(()=>[t($e,{size:"50px",color:"grey-10"})]),_:1})]),_:1},8,["rows","pagination","loading","filter"])])],64))}};var Dl=ae(Xt,[["__scopeId","data-v-7d58853c"]]);export{Dl as default};
