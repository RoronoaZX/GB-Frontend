import{c as C,o as d,a3 as m,J as e,f as s,w as r,e as Q,Q as O,I as L,L as H,$ as c,M as T,a1 as Z,a4 as $,a5 as V,O as J,R as G,r as W,t as ee,u as A,a0 as R,K as z,bd as X,bc as te,N as ae,H as se}from"./index.eedf7558.js";import{Q as le}from"./QSpace.ce8f324a.js";import{Q as M}from"./QExpansionItem.8493bc97.js";import{Q as oe}from"./QVirtualScroll.4104de62.js";import{u as j}from"./baker-report.216460c8.js";import{_ as P}from"./plugin-vue_export-helper.21dcd24c.js";import{Q as I,b as U}from"./use-virtual-scroll.991bef9f.js";import{Q as Y,a as D,b as F}from"./QList.2f8233c6.js";import{u as re}from"./branch-recipe.d8348239.js";import"./QSlideTransition.28c3d4fd.js";import"./axios.1a06d932.js";const N=g=>(J("data-v-05142882"),g=g(),G(),g),ne=N(()=>e("div",{class:"text-h6",align:"center"},"Report List",-1)),ie={class:"q-pa-md row wrap justify-center"},de={class:"row justify-between q-gutter-x-md"},ce={class:"row items-center"},ue={class:"text-subtitle1 q-ml-sm"},_e={class:"content-section"},pe={class:"q-mt-xs row justify-between"},me=N(()=>e("div",null,"Kilo",-1)),ve={class:"q-mt-xs row justify-between"},he=N(()=>e("div",null,"Short",-1)),ge={class:"q-mt-xs row justify-between"},ye=N(()=>e("div",null,"Over",-1)),be={class:"q-mt-xs row justify-between"},fe=N(()=>e("div",null,"Actual Target",-1)),xe={class:"q-pl-md"},we={class:"row justify-between"},ke={class:"q-pl-md"},qe={class:"row justify-between"},Re={align:"right"},Ce={__name:"ReportListComponent",setup(g){const p=j(),u=C(()=>p.reports);console.log("bakers report:",u.value);const f=v=>{p.removeReport(v)},i=v=>v?v.split(" ").map(t=>t.charAt(0).toUpperCase()+t.slice(1).toLowerCase()).join(" "):"",x=async()=>{p.createReports()};return(v,t)=>(d(),m($,null,[ne,e("div",ie,[s(oe,{items:u.value,"scroll-target":"body","virtual-scroll-horizontal":"",class:"my-virtual-scroll"},{default:r(({item:h,index:y})=>[(d(),Q(O,{flat:"",bordered:"",class:"q-gutter-sm my-card",key:y},{default:r(()=>[s(L,null,{default:r(()=>[e("div",de,[e("div",ce,[s(H,{name:"assignment",color:"primary"}),e("div",ue,c(i(h.recipe_name))+" - "+c(h.recipe_category),1)]),e("div",null,[s(T,{flat:"",round:"",icon:"close",onClick:b=>f(y),class:"text-negative close-btn"},null,8,["onClick"])])])]),_:2},1024),s(Z),s(L,null,{default:r(()=>[e("div",_e,[e("div",pe,[me,e("div",null,c(h.kilo)+" kgs",1)]),e("div",ve,[he,e("div",null,c(h.short)+" pcs",1)]),e("div",ge,[ye,e("div",null,c(h.over)+" pcs",1)]),e("div",be,[fe,e("div",null,c(h.actual_target)+" pcs",1)]),(d(),Q(M,{key:"breads-"+y,label:"Breads",dense:"",class:""},{default:r(()=>[e("ul",xe,[(d(!0),m($,null,V(h.breads,(b,k)=>(d(),m("li",{key:"bread-"+k,class:"q-my-sm"},[e("div",we,[e("div",null,c(b.bread_name),1),e("div",null,c(b.bread_production),1)])]))),128))])]),_:2},1024)),(d(),Q(M,{key:"ingredients-"+y,label:"Ingredients",dense:"",class:""},{default:r(()=>[e("ul",ke,[(d(!0),m($,null,V(h.ingredients,(b,k)=>(d(),m("li",{key:"ingredient-"+k,class:"q-my-sm"},[e("div",qe,[e("div",null,c(b.code),1),e("div",null,c(b.quantity)+" "+c(b.unit),1)])]))),128))])]),_:2},1024))])]),_:2},1024)]),_:2},1024))]),_:1},8,["items"])]),e("div",Re,[s(T,{color:"red-6",icon:"edit",label:"Create",onClick:x})])],64))}};var Qe=P(Ce,[["__scopeId","data-v-05142882"]]);const E=g=>(J("data-v-62bac0de"),g=g(),G(),g),$e={class:"row justify-center"},Se={class:"text-h6 q-ma-sm"},Ie={class:"row q-gutter-sm"},Le={class:"row q-mt-sm q-gutter-sm"},Fe={class:"q-mb-md"},Ve=E(()=>e("div",{class:"q-mt-sm"},"Kilo",-1)),je={class:"q-mt-md q-gutter-md"},Ne={key:0},Be=E(()=>e("div",{class:"q-mt-sm"},null,-1)),Ae=E(()=>e("div",{class:"text-h6 q-mt-sm",align:"center"},"Ingredients List",-1)),Te={class:"q-mt-lg"},ze={class:"ingredient-quantity"},Ue={class:"ingredient-quantity"},De={__name:"ReportRecipeInputComponent",setup(g){const p=j(),u=C(()=>p.user),f=W(!1),i=C(()=>p.recipes);console.log("erwe:",i.value);const x=C(()=>{var n,o,_,w;const a=(o=(n=i.value)==null?void 0:n.name)!=null?o:"Recipe Name",l=(w=(_=i.value)==null?void 0:_.category)!=null?w:"Category";return`${a} - ${l}`}),v=a=>a?a.split(" ").map(l=>l.charAt(0).toUpperCase()+l.slice(1).toLowerCase()).join(" "):"",t=ee({user_id:null,branch_id:null,branch_recipe_id:null,recipe_name:"",recipe_category:"",kilo:0,short:0,over:0,target:0,actual_target:0,breads:[]}),h=()=>{var n;const a=parseFloat(t.kilo),l=parseFloat((n=i.value)==null?void 0:n.target);if(!isNaN(a)&&!isNaN(l)){const o=a*l;t.actual_target=Math.ceil(o)}else t.actual_target=0},y=()=>{const a=t.breads.reduce((n,o)=>n+(parseFloat(o.value)||0),0),l=t.actual_target;a===l?(t.short=0,t.over=0):a>l?(t.over=a-l,t.short=0):a<l&&(t.short=l-a,t.over=0)},b=()=>{var a,l;i.value="",x.value="",t.recipe_name="",t.kilo="",t.short=0,t.over=0,t.target=0,t.actual_target=0,t.breads=((l=(a=i.value)==null?void 0:a.bread_groups)==null?void 0:l.map(n=>({id:n.product_id,bread_name:n.bread_name,value:""})))||[]},k=()=>{console.log("Report datasss:",t),f.value=!0,setTimeout(async()=>{var a,l,n,o,_,w,K;try{t.user_id=((a=u.value)==null?void 0:a.data.id)||"",t.branch_id=((n=(l=u.value)==null?void 0:l.device)==null?void 0:n.reference_id)||"",t.branch_recipe_id=((o=i.value)==null?void 0:o.id)||"",t.recipe_name=((_=i.value)==null?void 0:_.name)||"",t.target=((w=i.value)==null?void 0:w.target)||"",t.recipe_category=((K=i.value)==null?void 0:K.category)||"";const B={user_id:t.user_id,branch_id:t.branch_id,branch_recipe_id:t.branch_recipe_id,recipe_name:t.recipe_name,recipe_category:t.recipe_category,status:"pending",kilo:t.kilo,short:t.short,over:t.over,target:t.target,actual_target:t.actual_target,breads:t.breads.map(q=>({bread_id:q.id,bread_name:q.bread_name,bread_production:parseInt(q.value,10)||0})),ingredients:S.value.map(q=>({ingredients_id:q.raw_materials_id,code:q.code,quantity:q.multipliedQuantity,unit:q.unit}))};console.log("reportssss dATA:",B),p.setReport(B),console.log("Report data set to store:",p.reports),ae.create({message:`${x.value} added to list`,type:"positive",position:"center",timeout:500}),b(),p.recipes={}}catch(B){console.error("Error generating report:",B)}finally{f.value=!1}},1e3)},S=C(()=>{var l;const a=parseFloat(t.kilo)||0;return(((l=i.value)==null?void 0:l.ingredients)||[]).map(n=>{const o=parseFloat(n.quantity)||0,_=a*o,w=_%1===0?_:parseFloat(_.toFixed(2));return{...n,multipliedQuantity:w}})});return A(()=>t.kilo,()=>{h(),y()}),A(()=>{var a;return(a=i.value)==null?void 0:a.ingredients},()=>{y()},{deep:!0}),A(()=>t.breads.map(a=>a.value),y,{deep:!0}),A(()=>{var a;return(a=i.value)==null?void 0:a.bread_groups},()=>{var a;t.breads=Array.isArray((a=i.value)==null?void 0:a.bread_groups)?i.value.bread_groups.map(l=>({id:l.product_id,bread_name:l.bread_name,value:""})):[],y()}),(a,l)=>{var n;return d(),m("div",$e,[e("div",null,[e("div",null,[e("div",Se,c(v(x.value)),1)]),e("div",Ie,[e("div",null,[R(" Target Pcs "),e("div",null,[s(I,{readonly:"",outlined:"",type:"number",dense:"",label:((n=i.value)==null?void 0:n.target)||0,style:{width:"100px","max-width":"300px","min-width":"50px"}},null,8,["label"])])]),e("div",null,[R(" Actual Target "),e("div",null,[s(I,{readonly:"",outlined:"",dense:"",label:t.actual_target,style:{width:"100px","max-width":"300px","min-width":"50px"}},null,8,["label"])])])]),e("div",Le,[e("div",null,[R(" Short "),e("div",null,[s(I,{readonly:"",outlined:"",type:"number",dense:"",label:t.short,style:{width:"100px","max-width":"300px","min-width":"50px"}},null,8,["label"])])]),e("div",null,[R(" Over "),e("div",null,[s(I,{readonly:"",outlined:"",dense:"",label:t.over,style:{width:"100px","max-width":"300px","min-width":"50px"}},null,8,["label"])])])]),e("div",Fe,[Ve,e("div",null,[s(z,{outlined:"",dense:"",modelValue:t.kilo,"onUpdate:modelValue":l[0]||(l[0]=o=>t.kilo=o),type:"number",placeholder:"kgs",style:{width:"210px","max-width":"300px","min-width":"50px"}},null,8,["modelValue"])])]),e("div",je,[t.breads.length?(d(),m("div",Ne,[(d(!0),m($,null,V(t.breads,(o,_)=>(d(),m("div",{key:o.id,class:"q-my-md"},[e("div",null,[e("div",null,c(o.bread_name),1),e("div",null,[s(z,{outlined:"",modelValue:t.breads[_].value,"onUpdate:modelValue":w=>t.breads[_].value=w,dense:"",type:"number",placeholder:"Pcs",style:{width:"210px","max-width":"300px","min-width":"50px"}},null,8,["modelValue","onUpdate:modelValue"])])])]))),128))])):X("",!0)]),Be,s(T,{outline:"",dense:"",size:"md",icon:"add",label:"Report",class:"text-purple",loading:f.value,onClick:k},{isLoading:r(()=>[s(te,{size:"20px"})]),_:1},8,["loading"])]),e("div",null,[Ae,e("div",Te,[s(I,{readonly:"",outlined:"",style:{width:"400px","max-width":"450px","min-width":"100px"}},{control:r(()=>[s(Y,{dense:"",separator:""},{default:r(()=>[(d(!0),m($,null,V(S.value,(o,_)=>(d(),Q(D,{key:_,class:"q-pa-xs justify-between"},{default:r(()=>[s(F,null,{default:r(()=>[s(U,{class:"ingredient-name"},{default:r(()=>[R(c(o.code),1)]),_:2},1024)]),_:2},1024),s(F,{side:"",class:"text-right"},{default:r(()=>[e("div",ze,c(o.multipliedQuantity),1)]),_:2},1024),s(F,{side:"",class:"text-right"},{default:r(()=>[e("div",Ue,c(o.unit),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})])])])}}};var Oe=P(De,[["__scopeId","data-v-62bac0de"]]);const Pe={key:0,class:"custom-list z-top"},Ee={__name:"ReportSearchComponent",setup(g){var k,S;const p=j(),u=W(""),f=j(),i=re(),x=C(()=>f.user);console.log("erw:",x.value);const v=C(()=>i.branchRecipe),t=((S=(k=x.value)==null?void 0:k.employee)==null?void 0:S.branch_id)||"";console.log("branch_id",t);const h=async()=>{i.searchBranchRecipe(u.value,t),console.log("searchQuery.value",u.value),console.log("branch_id",t)},y=a=>{console.log("branch recipe",a),p.setRecipe(a),u.value=""},b=a=>a?a.split(" ").map(l=>l.charAt(0).toUpperCase()+l.slice(1).toLowerCase()).join(" "):"";return console.log("recipessss",v.value),(a,l)=>(d(),Q(z,{modelValue:u.value,"onUpdate:modelValue":[l[0]||(l[0]=n=>u.value=n),h],debounce:"1000",outlined:"",rounded:"",placeholder:"Search product",dense:""},{append:r(()=>[e("div",null,[s(H,{name:"search"})])]),default:r(()=>[u.value?(d(),m("div",Pe,[s(O,null,{default:r(()=>[s(Y,{separator:""},{default:r(()=>{var n;return[(n=v.value)!=null&&n.length?(d(!0),m($,{key:1},V(v.value,o=>(d(),Q(D,{onClick:_=>y(o),key:o.id,clickable:""},{default:r(()=>[s(F,null,{default:r(()=>[s(U,null,{default:r(()=>[R(c(b(o==null?void 0:o.name)),1)]),_:2},1024)]),_:2},1024),s(F,null,{default:r(()=>[s(U,{side:""},{default:r(()=>[R(c(o==null?void 0:o.category),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128)):(d(),Q(D,{key:0},{default:r(()=>[R(" No record found. ")]),_:1}))]}),_:1})]),_:1})])):X("",!0)]),_:1},8,["modelValue"]))}};var Ke=P(Ee,[["__scopeId","data-v-46470c74"]]);const Me={class:"text-h6 text-dark row justify-between"},He=e("div",null," Bakers Report ",-1),Je={class:"q-gutter-y-md"},Ge={class:"q-gutter-y-md"},nt={__name:"ReportIdCreatePage",setup(g){const p=se(),u=j(),f=C(()=>u.recipes);console.log("report",f);const i=()=>{u.clearData(),p.push("/branch/baker/report")};return(x,v)=>(d(),m("div",null,[s(O,{flat:""},{default:r(()=>[s(L,null,{default:r(()=>[e("div",Me,[e("div",null,[s(T,{outline:"",flat:"",icon:"arrow_back",onClick:i})]),s(le),He])]),_:1}),s(L,null,{default:r(()=>[e("div",null,[s(Ke)]),e("div",Je,[e("div",null,[s(Oe)])])]),_:1}),s(L,null,{default:r(()=>[e("div",Ge,[e("div",null,[s(Qe)])])]),_:1})]),_:1})]))}};export{nt as default};
