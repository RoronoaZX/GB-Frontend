import{bd as B,c as $,r as g,t as de,o as u,a2 as w,f as e,M,w as l,Q as V,I as R,ad as A,J as o,K as C,L as D,e as N,$ as Q,a3 as T,a4 as j,_ as I,bc as ce,aI as H,a1 as E,a0 as me,N as X,O as Y,R as Z,z as ee,u as ae,aJ as te,ba as _e,H as pe}from"./index.9d8a2862.js";import{Q as le}from"./QSpace.2ec39cac.js";import{a as L,Q as we,b as fe,c as z}from"./QTabPanels.4a67c227.js";import{Q as ge}from"./QPage.b4159adb.js";import{Q as S}from"./QBadge.b168257f.js";import{Q as he}from"./QSpinnerDots.c0e88b23.js";import{Q as se}from"./QTooltip.96f1dff6.js";import{Q as ve}from"./QPopupEdit.9c99ff7a.js";import{Q as U,a as oe}from"./QTable.3f2a8e26.js";import{Q as ye,a as O,b as be}from"./QList.c91e5dee.js";import{b as xe}from"./use-virtual-scroll.bcafb64a.js";import{C as K}from"./ClosePopup.ce00533c.js";import"./branch-product.b2535f84.js";import{u as G}from"./warehouse-rawMaterials.a9344947.js";import{u as qe}from"./raw-material.43816e5a.js";import{_ as J}from"./plugin-vue_export-helper.21dcd24c.js";import{api as re}from"./axios.bf475e87.js";import{Q as F}from"./QSkeleton.0b5ea31e.js";import{u as ne}from"./warehouse.079360b1.js";import"./QResizeObserver.9a5af8aa.js";import"./use-panel.501e5f2a.js";import"./touch.9135741d.js";import"./selection.1cf8d0b6.js";import"./QMenu.31bacc67.js";import"./QVirtualScroll.d7deea5a.js";import"./QSelect.3f174eab.js";import"./QChip.0faaa0c4.js";import"./product.d4ea890e.js";const ke=o("div",{class:"text-h6"},"Create Warehouse Raw Materials",-1),Me={class:"q-mb-lg"},Re={key:0,class:"custom-list z-top"},Ve=o("div",null,"Raw Materials Code",-1),$e=o("div",null,"Raw Materials Name",-1),Qe=o("div",null,"Category",-1),Ce=o("div",null,"Quantity",-1),Ie={__name:"RawMaterialsCreate",setup(h){const q=B(),f=qe(),y=$(()=>f.rawMaterials),i=G(),m=g(""),_=async()=>{f.searchRawMaterials(m.value)},v=$(()=>r.total_quantity!==""),p=g(!1),b=()=>{p.value=!0},x=()=>{k(),p.value=!1},c=n=>{r.raw_material_id=n.id,r.raw_materials_name=n.name,r.raw_materials_code=n.code,r.category=n.category,r.unit=n.unit,m.value=""},r=de({raw_material_id:"",raw_materials_name:"",raw_materials_code:"",total_quantity:"",category:"",unit:"",warehouse_id:q.params.warehouse_id}),k=()=>{r.raw_material_id="",r.raw_materials_name="",r.raw_materials_code="",r.total_quantity="",r.raw_material_id="",r.category="",r.unit=""},W=async()=>{try{const{product_name:n,...a}=r;await i.createWarehouseRawMaterials(a),console.log("data to send",a),p.value=!1}catch(n){console.log(n)}};return(n,a)=>(u(),w(T,null,[e(M,{outline:"",class:"text-dark q-pa-sm",dense:"",elevated:"",icon:"add_circle",label:"Create Warehouse Raw Material",onClick:b,style:{background:"#f43f5e"}}),e(E,{modelValue:p.value,"onUpdate:modelValue":a[5]||(a[5]=t=>p.value=t),persistent:""},{default:l(()=>[e(V,{class:"my-card",style:{width:"400px","max-width":"500px","min-width":"100px"}},{default:l(()=>[e(R,{class:"row items-center text-white",style:{"background-color":"#ef4444"}},{default:l(()=>[ke,e(le),A(e(M,{icon:"close",flat:"",dense:"",round:""},null,512),[[K]])]),_:1}),e(R,{class:"q-ma-md q-gutter-y-sm"},{default:l(()=>[o("div",Me,[e(C,{modelValue:m.value,"onUpdate:modelValue":[a[0]||(a[0]=t=>m.value=t),_],debounce:"1000",outlined:"",rounded:"",placeholder:"Search Raw Materials",dense:""},{append:l(()=>[o("div",null,[e(D,{name:"search"})])]),default:l(()=>[m.value?(u(),w("div",Re,[e(V,null,{default:l(()=>[e(ye,{separator:""},{default:l(()=>{var t;return[(t=y.value)!=null&&t.length?(u(!0),w(T,{key:1},j(y.value,s=>(u(),N(O,{onClick:d=>c(s),key:s.id,clickable:""},{default:l(()=>[e(be,null,{default:l(()=>[e(xe,null,{default:l(()=>[Q(I(s.name),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128)):(u(),N(O,{key:0},{default:l(()=>[Q(" No record found. ")]),_:1}))]}),_:1})]),_:1})])):ce("",!0)]),_:1},8,["modelValue"])]),o("div",null,[Ve,e(C,{modelValue:r.raw_materials_code,"onUpdate:modelValue":a[1]||(a[1]=t=>r.raw_materials_code=t),readonly:"",dense:"",outlined:""},null,8,["modelValue"])]),o("div",null,[$e,e(C,{modelValue:r.raw_materials_name,"onUpdate:modelValue":a[2]||(a[2]=t=>r.raw_materials_name=t),readonly:"",dense:"",outlined:""},null,8,["modelValue"])]),o("div",null,[Qe,e(C,{modelValue:r.category,"onUpdate:modelValue":a[3]||(a[3]=t=>r.category=t),readonly:"",dense:"",outlined:""},null,8,["modelValue"])]),o("div",null,[Ce,e(C,{modelValue:r.total_quantity,"onUpdate:modelValue":a[4]||(a[4]=t=>r.total_quantity=t),type:"number",outlined:"",suffix:r.unit||"",dense:"",rules:[t=>t&&t.length>0||"Total quantity is required"]},null,8,["modelValue","suffix","rules"])])]),_:1}),e(H,{class:"row q-ma-md",align:"right"},{default:l(()=>[e(M,{class:"glossy",color:"grey-9",label:"Dismiss",onClick:x}),e(M,{class:"glossy",color:"teal",label:"Create",onClick:W,disable:!v.value},null,8,["disable"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};const ie=h=>(Y("data-v-46834346"),h=h(),Z(),h),Se=ie(()=>o("div",{class:"text-h5 q-mb-xs"},"Confirm Deletion",-1)),Te=ie(()=>o("p",{class:"text-body2 q-mb-none"}," Are you sure you want to delete this item? This action cannot be undone. ",-1)),We={__name:"RawMaterialsTableDelete",props:["delete"],setup(h){const q=G(),f=h,y=async()=>{console.log("clickkkd");try{await q.deleteWarehouseRawMaterials(f.delete.row.id),X.create({type:"negative",icon:"warning",message:`Raw Materials ${f.delete.row.name}  successfully deleted`,timeout:1e3,position:"top"}),i.value=!1}catch(_){console.error(_.message)}},i=g(!1),m=()=>{i.value=!0};return(_,v)=>(u(),w(T,null,[e(M,{onClick:m,color:"negative",icon:"delete",size:"sm",flat:"",round:"",dense:"",align:"center"},{default:l(()=>[e(se,{class:"bg-negative",delay:200},{default:l(()=>[Q("Delete")]),_:1})]),_:1}),e(E,{modelValue:i.value,"onUpdate:modelValue":v[0]||(v[0]=p=>i.value=p)},{default:l(()=>[e(V,null,{default:l(()=>[e(R,{class:"q-pa-md q-rounded q-elevate-2 bg-white text-grey-9"},{default:l(()=>[Se,Te]),_:1}),e(me,{class:"q-mb-md"}),e(R,null,{default:l(()=>[e(H,{align:"right",class:"q-pt-none"},{default:l(()=>[A(e(M,{flat:"",dense:"",label:"Cancel",color:"primary",class:"q-mr-sm"},null,512),[[K]]),e(M,{dense:"",label:"Delete",color:"negative",onClick:y,class:"q-btn-rounded q-px-lg"})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};var De=J(We,[["__scopeId","data-v-46834346"]]);const ue=h=>(Y("data-v-ee036924"),h=h(),Z(),h),Ne={class:"row justify-between"},Ue={class:"q-my-sm"},Be={key:0,class:"spinner-wrapper"},Pe={key:1},Le={key:0,class:"data-error"},ze=ue(()=>o("div",{class:"q-ml-sm text-h6"},"No data available",-1)),Fe=ue(()=>o("div",{class:"text-white"},"Edit Available Stocks",-1)),je={class:"row justify-center q-gutter-x-md"},Ae={__name:"RawMaterialsTable",setup(h){const f=B().params.warehouse_id,y=G(),i=g(""),m=g(!0),_=g([]),v=g(!1),p=g({rowsPerPage:0}),b=$(()=>y.warehouseRawMaterials),x=$(()=>i.value?b.value.filter(a=>a.name.toLowerCase().includes(i.value.toLowerCase())):b.value);ee(async()=>{console.log("props.warehouseId in onMounted:",f),f&&await c(f)});const c=async a=>{try{m.value=!0;const t=await y.fetchWarehouseRawMaterials(a);b.value=t,b.value.length||(v.value=!0),console.log("Warehouse Raw Materials",b.value)}catch(t){console.log("Error fetching branch product:",t),v.value=!0}finally{m.value=!1}};async function r(a,t){try{const s=await re.put("/api/update-warehouse-rawMaterials/"+a.id,{total_quantity:parseInt(t)});if(s.status===200){const d=_.value.findIndex(P=>P.id==a.id);_.value[d]=parseInt(t),X.create({type:"positive",message:s.data.message,timout:1e3,position:"top"})}}catch(s){console.error("Error updating price:",s)}}ae(i,async a=>{m.value=!0,await new Promise(t=>setTimeout(t,1e3)),m.value=!1,v.value=x.value.length===0});const k=a=>{const t=a.total_quantity,s=a.raw_materials.unit;if(console.log("unit test",s),s==="Grams"&&t<1e3)return"bg-red";let d;return t>=1e3?d=t/1e3:d=t,d<5?d<=2?"bg-red":(d<=3,"bg-warning"):"bg-positive"},W=a=>{const t=a.total_quantity,s=a.raw_materials.unit;if(t>1e3){const d=(t/1e3).toFixed(2);return d.endsWith(".00")?`${Math.round(t/1e3)} kilos`:`${d} kilos`}else return t>1?`${t} ${s}`:`${t} ${s}`},n=[{name:"code",label:"Raw Materials Code",align:"center",field:a=>{var t,s;return(s=(t=a==null?void 0:a.raw_materials)==null?void 0:t.code)!=null?s:"No Code"},format:a=>`${a}`,sortable:!0},{name:"name",label:"Raw Materials Name",align:"center",field:a=>{var t,s;return(s=(t=a==null?void 0:a.raw_materials)==null?void 0:t.name)!=null?s:"No Code"},format:a=>`${a}`,sortable:!0},{name:"total_quantity",label:"Available Stocks",align:"center",field:"total_quantity",sortable:!0},{name:"action",label:"Action",align:"center",sortable:!0}];return(a,t)=>(u(),w(T,null,[o("div",Ne,[o("div",null,[e(C,{class:"q-pb-lg q-pl-md",modelValue:i.value,"onUpdate:modelValue":t[0]||(t[0]=s=>i.value=s),outlined:"",placeholder:"Search",debounce:"1000",style:{width:"450px","max-width":"5000px","min-width":"100px"},flat:"",dense:"",rounded:""},{append:l(()=>[e(D,{name:"search"})]),_:1},8,["modelValue"])]),o("div",Ue,[e(Ie)])]),m.value?(u(),w("div",Be,[e(he,{size:"50px",color:"primary"})])):(u(),w("div",Pe,[x.value.length===0?(u(),w("div",Le,[e(D,{name:"warning",color:"warning",size:"4em"}),ze])):(u(),N(oe,{key:1,class:"table-container sticky-header",filter:i.value,"virtual-scroll-sticky-size-start":48,flat:"",columns:n,rows:x.value,"row-key":"name","virtual-scroll":"",pagination:p.value,"onUpdate:pagination":t[1]||(t[1]=s=>p.value=s),"rows-per-page-options":[0],"hide-bottom":"",style:{height:"340px"}},{"body-cell-total_quantity":l(s=>[e(U,{props:s},{default:l(()=>[e(S,{square:"",class:te(["text-white cursor-pointer",k(s.row)])},{default:l(()=>[Q(I(W(s.row))+" ",1),e(se,{class:"bg-blue-grey-8",offset:[10,10]},{default:l(()=>[Fe]),_:1}),e(ve,{"onUpdate:modelValue":[d=>r(s.row,d),d=>s.row.total_quantity=d],modelValue:s.row.total_quantity,"auto-save":""},{default:l(d=>[e(C,{modelValue:d.value,"onUpdate:modelValue":P=>d.value=P,dense:"",suffix:s.row.raw_materials.unit,mask:"########",autofocus:"",counter:"",onKeyup:_e(d.set,["enter"])},null,8,["modelValue","onUpdate:modelValue","suffix","onKeyup"])]),_:2},1032,["onUpdate:modelValue","modelValue"])]),_:2},1032,["class"])]),_:2},1032,["props"])]),"body-cell-action":l(s=>[e(U,{props:s},{default:l(()=>[o("div",je,[e(De,{delete:s},null,8,["delete"])])]),_:2},1032,["props"])]),_:1},8,["filter","rows","pagination"]))]))],64))}};var Ee=J(Ae,[["__scopeId","data-v-ee036924"]]);const Ke={class:"q-gutter-sm"},Ge={class:"q-gutter-x-sm"},Je={__name:"WarehouseRawMaterialsPage",setup(h){return(q,f)=>(u(),w("div",Ke,[o("div",Ge,[e(S,{label:"Good",class:"text-white",color:"positive"}),e(S,{label:"Warning",class:"text-white",color:"warning"}),e(S,{label:"Danger",class:"text-white",color:"red"})]),o("div",null,[e(Ee)])]))}},Oe={class:"q-pa-md elegant-container"},He={key:0,class:"skeleton-wrapper row q-col-gutter-md"},Xe={key:1,class:"data-error"},Ye=o("div",null,"No data available",-1),Ze={key:2,class:"q-pa-md row q-col-gutter-md"},ea=o("img",{src:"https://cdn.quasar.dev/img/mountains.jpg"},null,-1),aa={class:"q-mt-lg"},ta={class:"text-h6 text-weight-medium elegant-name text-capitalize"},la={class:"row justify-between"},sa={class:"text-h6"},oa=o("div",{class:"text-subtitle2"},"Raw Materials Reports:",-1),ra={__name:"BranchCard",setup(h){const q=B(),f=ne(),y=$(()=>f.warehouseBranchReports),i=g(!1),m=$(()=>q.params.warehouse_id||null),_=g(!1),v=g(!1),p=g({reports:[]}),b=n=>{const a=n.quantity;if(n.raw_material.unit==="Grams"&&a<1e3)return"bg-red";let s;return a>=1e3?s=a/1e3:s=a,s<5?s<=2?"bg-red":(s<=3,"bg-warning"):"bg-positive"},x=n=>n?n.split(" ").map(a=>a.charAt(0).toUpperCase()+a.slice(1).toLowerCase()).join(" "):"",c=n=>{switch(n){case"Ingredients":return"teal";case"Packaging Materials":return"brown-6";default:return"grey"}},r=n=>{const a=n.quantity,t=n.raw_material.unit;if(a>1e3){const s=(a/1e3).toFixed(2);return s.endsWith(".00")?`${Math.round(a/1e3)} kilos`:`${s} kilos`}else return a>1?`${a} ${t}`:`${a} ${t}`},k=g([{name:"raw_material",label:"Raw Materials Name",align:"left",field:n=>{var a;return((a=n.raw_material)==null?void 0:a.name)||"No record"}},{name:"code",label:"Code",align:"left",field:n=>{var a;return((a=n.raw_material)==null?void 0:a.code)||"No record"}},{name:"category",label:"Category",align:"left",field:n=>{var a;return((a=n.raw_material)==null?void 0:a.category)||"No record"}},{name:"total_quantity",label:"Available Stocks",align:"center",field:"total_quantity"}]),W=n=>{p.value=n,v.value=!0};return ae(m,async n=>{if(n)try{i.value=!0,await f.fetchWarehouseByBranchID(n),_.value=y.value.length===0}catch(a){console.error("Error fetching warehouse data:",a),_.value=!0}finally{i.value=!1}},{immediate:!0}),(n,a)=>(u(),w("div",Oe,[i.value?(u(),w("div",He,[(u(),w(T,null,j(8,t=>o("div",{class:"col-xs-12 col-sm-6 col-md-4 col-lg-3",key:t},[e(V,{class:"user-card skeleton-card"},{default:l(()=>[e(F,{height:"200px",class:"q-mb-md"}),e(R,{class:"text-center"},{default:l(()=>[e(F,{type:"text",width:"60%",class:"q-mt-lg"}),e(F,{type:"text",width:"40%",class:"q-mt-sm"})]),_:1})]),_:1})])),64))])):_.value?(u(),w("div",Xe,[e(D,{name:"error",size:"50px",color:"negative"}),Ye])):(u(),w("div",Ze,[(u(!0),w(T,null,j(y.value,t=>(u(),w("div",{key:t.branch_id,class:"col-xs-12 col-sm-6 col-md-4 col-lg-3"},[e(V,{class:"user-card",onClick:s=>W(t)},{default:l(()=>[ea,e(R,{class:"text-center"},{default:l(()=>[o("div",aa,[o("div",ta,I(x(t.branch_name)),1)])]),_:2},1024)]),_:2},1032,["onClick"])]))),128))])),e(E,{modelValue:v.value,"onUpdate:modelValue":a[1]||(a[1]=t=>v.value=t),persistent:""},{default:l(()=>[e(V,null,{default:l(()=>[e(R,null,{default:l(()=>[o("div",null,[o("div",la,[o("div",sa,I(x(p.value.branch_name)),1),o("div",null,[A(e(M,{round:"",dense:"",flat:"",icon:"close"},null,512),[[K]])])])]),oa]),_:1}),e(R,null,{default:l(()=>[e(oe,{rows:p.value.reports,columns:k.value,"row-key":"id",flat:"",bordered:"","virtual-scroll":"",pagination:n.pagination,"onUpdate:pagination":a[0]||(a[0]=t=>n.pagination=t),"rows-per-page-options":[0],"hide-bottom":"",class:"q-mt-md"},{"body-cell-total_quantity":l(t=>[e(U,{props:t},{default:l(()=>[e(S,{square:"",class:te(["text-white cursor-pointer",b(t.row)])},{default:l(()=>[Q(I(r(t.row)),1)]),_:2},1032,["class"])]),_:2},1032,["props"])]),"body-cell-category":l(t=>[e(U,{key:"name",props:t},{default:l(()=>[e(S,{color:c(t.row.raw_material.category)},{default:l(()=>[Q(I(t.row.raw_material.category),1)]),_:2},1032,["color"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","pagination"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}};const na={class:"elegant-container q-gutter-md"},ia={class:"text-h6 row justify-between"},ua={class:"q-gutter-sm"},da={class:"tab-container"},ca={__name:"WarehouseIdPage",setup(h){const q=B(),f=pe(),y=ne(),i=g("");$(()=>y.warehouse);const m=$(()=>q.params.warehouse_id||"Unknown Warehouse"),_=g("warehouseRawMaterials"),v=async c=>(await re.get(`/api/warehouse/${c}`)).data,p=async()=>{try{const c=await v(m.value);c&&c.name?i.value=c.name:console.error("Warehouse name data is missing",c)}catch(c){console.error("Error fetching warehouse data:",c)}};ee(()=>{p()});const b=c=>c?c.split(" ").map(r=>r.charAt(0).toUpperCase()+r.slice(1).toLowerCase()).join(" "):"",x=()=>{Loading.show(),f.push("/admin/warehouse").finally(()=>{Loading.hide()})};return(c,r)=>(u(),N(ge,{padding:""},{default:l(()=>[o("div",na,[o("div",ia,[o("div",null,[e(M,{outline:"",flat:"",icon:"arrow_back",to:"/admin/warehouse",onClick:x}),e(le)]),o("div",null,[e(D,{name:"factory"}),Q(" "+I(b(i.value)),1)])]),o("div",ua,[o("div",da,[e(we,{modelValue:_.value,"onUpdate:modelValue":r[0]||(r[0]=k=>_.value=k),dense:"",class:"bg-grey-2 text-grey-7 tabs-as-cards","active-color":"red-6","indicator-color":"transparent",align:"justify"},{default:l(()=>[e(L,{name:"warehouseRawMaterials",label:"Warehouse Raw Materials"}),e(L,{name:"branchRawMaterials",label:"Branch Raw Materials"}),e(L,{name:"transactions",label:"Transactions"})]),_:1},8,["modelValue"])]),e(V,{class:"q-mt-sm"},{default:l(()=>[e(fe,{modelValue:_.value,"onUpdate:modelValue":r[1]||(r[1]=k=>_.value=k),animated:""},{default:l(()=>[e(z,{name:"warehouseRawMaterials"},{default:l(()=>[e(Je)]),_:1}),e(z,{name:"branchRawMaterials"},{default:l(()=>[e(ra)]),_:1}),e(z,{name:"transactions"},{default:l(()=>[e(V,null,{default:l(()=>[Q(" This is transactions ")]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})])])]),_:1}))}};var La=J(ca,[["__scopeId","data-v-04142da6"]]);export{La as default};
