import{r as o,c as Q,H as V,o as P,e as L,w as r,Q as M,f as t,I as v,J as i,K as h,L as C,M as B,P as b,N as y,O as N,R as A}from"./index.624b9ec7.js";import{Q as E}from"./QForm.e66ac659.js";import{_ as K}from"./GB_LOGO.b766a815.js";import{u as R}from"./use-quasar.9a87b0d0.js";import{api as U}from"./axios.09143b80.js";import{_ as $}from"./plugin-vue_export-helper.21dcd24c.js";const w=d=>(N("data-v-1af846ed"),d=d(),A(),d),j=w(()=>i("div",{class:"text-h5 text-red-6 q-mb-sm"},[i("img",{src:K,class:"logo"})],-1)),D=w(()=>i("div",{class:"text-caption text-grey-8 q-mb-sm"},"Please log in to continue.",-1)),F={class:"q-gutter-y-sm"},H={class:"q-my-md text-center"},J={__name:"LoginPage",setup(d){const x=o("91c61eefafeaedb3e9cf16507aa391148fab7d8a42c155e4c51d0a1bedb9d12c"),n=o(!0),c=o(""),u=o(""),I=o(!1),S=Q(()=>c.value!==""&&u.value!=="");R();const l=V(),_=o(""),k=async()=>{var p,a;b.show();try{const e=await U.post("/api/login",{uuid:x.value,email:c.value,password:u.value});console.log("user123:",e.data),localStorage.setItem("activeMenuItem","dashboard"),localStorage.setItem("token",e.data.token),localStorage.setItem("role",e.data.role),localStorage.setItem("uuid",e.data.device.uuid),localStorage.setItem("reference_id",e.data.device.reference_id);const m=e.data.device,q=m.designation==="branch"?"branch_id":"warehouse_id";localStorage.setItem(q,m.reference_id);const s=e.data.role,g=localStorage.getItem("activeMenuItem");if(s==="Admin"||s==="Super Admin"){let f;g?(f=`/admin/${g}`,_.value=g):(f="/admin/dashboard",localStorage.setItem("activeMenuItem","dashboard"),_.value="dashboard"),await l.push(f),y.create({type:"positive",message:e.data.message||"Login successful!",setTimeout:5e3})}else s==="Baker"?await l.push("/branch/baker"):s==="Cake Maker"?await l.push("/branch/cake_maker/raw_materials"):s==="Cashier"?await l.push("/branch/sales_lady/products"):s==="Scaler"&&await l.push("/warehouse")}catch(e){console.error("Error during login:",e);const m=((a=(p=e.response)==null?void 0:p.data)==null?void 0:a.message)||"Login failed. Incorrect email & password.";y.create({type:"negative",message:m})}finally{b.hide()}};return(p,a)=>(P(),L(M,{class:"my-card q-pa-md q-ma-lg",style:{width:"430px","max-width":"90%",height:"500px","border-radius":"16px","box-shadow":"0 4px 12px rgba(0, 0, 0, 0.1)",display:"flex","flex-direction":"column","justify-content":"space-between"}},{default:r(()=>[t(v,{class:"q-pa-sm text-center"},{default:r(()=>[j,D]),_:1}),t(v,{class:"q-mt-sm flex-grow-1"},{default:r(()=>[t(E,{onSubmit:k},{default:r(()=>[i("div",F,[t(h,{modelValue:c.value,"onUpdate:modelValue":a[0]||(a[0]=e=>c.value=e),outlined:"",placeholder:"Email",dense:"",autofocus:"",required:"",class:"input-dynamic"},null,8,["modelValue"]),t(h,{modelValue:u.value,"onUpdate:modelValue":a[2]||(a[2]=e=>u.value=e),outlined:"",placeholder:"Password",type:n.value?"password":"text",dense:"",required:"",class:"input-dynamic"},{append:r(()=>[t(C,{name:n.value?"visibility_off":"visibility",onClick:a[1]||(a[1]=e=>n.value=!n.value),class:"cursor-pointer",style:{color:"#9e9e9e"}},null,8,["name"])]),_:1},8,["modelValue","type"])]),i("div",H,[t(B,{type:"submit",color:"red-6",label:"Login",class:"q-mt-sm",dense:"",loading:I.value,disable:!S.value,style:{width:"100%","max-width":"350px","border-radius":"8px"}},null,8,["loading","disable"])])]),_:1})]),_:1})]),_:1}))}};var Y=$(J,[["__scopeId","data-v-1af846ed"]]);export{Y as default};
