import{r as R,c as I,o as m,a2 as x,f as o,M as b,w as s,Q as V,I as f,J as e,$ as c,_ as n,a3 as F,a4 as q,bc as U,a1 as N,K as z,aI as O,ad as j,O as E,R as K,z as J,u as G,e as k,L as T,bb as H}from"./index.88c59fb9.js";import{Q as W}from"./QBadge.2a1e4c49.js";import{Q as X}from"./QScrollArea.79ea8c9c.js";import{Q as Z}from"./QPage.62c718c9.js";import{u as P}from"./baker-report.97308b41.js";import{q as M}from"./date.3fb9dcdb.js";import{C as ee}from"./ClosePopup.a360f3d6.js";import{u as te}from"./use-quasar.3e556158.js";import{_ as ae}from"./plugin-vue_export-helper.21dcd24c.js";import"./QResizeObserver.88575a80.js";import"./QScrollObserver.c64bea12.js";import"./TouchPan.aea09bfd.js";import"./touch.9135741d.js";import"./selection.20c4750a.js";import"./axios.770ad044.js";const d=l=>(E("data-v-1f9542cc"),l=l(),K(),l),oe=d(()=>e("div",{class:"report-title"},"Report Details",-1)),re={class:"invoice-header"},se=d(()=>e("strong",null,"Date:",-1)),le=d(()=>e("strong",null,"Branch:",-1)),ne={class:"invoice-body"},ie=d(()=>e("strong",null,"Baker:",-1)),ce=d(()=>e("strong",null,"Recipe:",-1)),de=d(()=>e("strong",null,"Status:",-1)),ue=d(()=>e("strong",null,"Kilo:",-1)),me=d(()=>e("strong",null,"Over:",-1)),pe=d(()=>e("strong",null,"Short:",-1)),fe=d(()=>e("strong",null,"Actual Target:",-1)),_e={key:0,class:"invoice-section"},ve=d(()=>e("div",{class:"section-title"},"Breads",-1)),he={class:"bread-name"},ge={class:"bread-production"},ye=d(()=>e("div",{class:"text-h6"},"Decline Report",-1)),be={__name:"BakersReportView",props:{report:{type:Object,required:!0}},setup(l){const p=l,g=R(!1),C=()=>{g.value=!0},u=te(),_=P(),v=R(!1),y=R(""),w=()=>{v.value=!0},h=r=>r.charAt(0).toUpperCase()+r.slice(1).toLowerCase(),Q=r=>{const t=D=>D?D.charAt(0).toUpperCase()+D.slice(1).toLowerCase():"",a=r.firstname?t(r.firstname):"No Firstname",i=r.middlename?t(r.middlename).charAt(0)+".":"",Y=r.lastname?t(r.lastname):"No Lastname";return`${a} ${i} ${Y}`},L=r=>M.formatDate(r,"MMMM D, YYYY hh:mm A"),B=I(()=>p.report.bread_bakers_reports.filter(r=>r.bread_production>0)),S=async()=>{try{const r=await _.confirmReport(p.report.id);console.log("Report confirmed:",r),u.notify({type:"positive",message:"Report confirmed successfully"}),v.value=!1}catch{u.notify({type:"negative",message:"Failed to confirm report"})}},$=async()=>{try{if(!y.value.trim()){u.notify({type:"negative",message:"Remark cannot be empty"});return}await _.declineReport(p.report.id,y.value),u.notify({type:"positive",message:"Report declined successfully"}),v.value=!1,g.value=!1}catch{u.notify({type:"negative",message:"Failed to decline report"})}};return(r,t)=>(m(),x(F,null,[o(b,{color:"accent",icon:"visibility",size:"md",flat:"",round:"",dense:"",onClick:w}),o(N,{modelValue:v.value,"onUpdate:modelValue":t[1]||(t[1]=a=>v.value=a),class:"report-dialog"},{default:s(()=>[o(V,{class:"report-card"},{default:s(()=>[o(f,{class:"report-header"},{default:s(()=>[oe,o(b,{class:"close-btn",color:"grey-8",flat:"",round:"",dense:"",icon:"close",onClick:t[0]||(t[0]=a=>v.value=!1)})]),_:1}),o(f,{class:"report-info"},{default:s(()=>[e("div",re,[e("div",null,[se,c(" "+n(L(l.report.created_at)),1)]),e("div",null,[le,c(" "+n(h(l.report.branch.name)),1)])]),e("div",ne,[e("div",null,[ie,c(" "+n(Q(l.report.user.employee)),1)]),e("div",null,[ce,c(" "+n(h(l.report.branch_recipe.recipe.name)),1)]),e("div",null,[de,c(" "+n(h(l.report.status)),1)]),e("div",null,[ue,c(" "+n(l.report.kilo),1)]),e("div",null,[me,c(" "+n(l.report.over),1)]),e("div",null,[pe,c(" "+n(l.report.short),1)]),e("div",null,[fe,c(" "+n(l.report.actual_target),1)])]),B.value.length?(m(),x("div",_e,[ve,e("ul",null,[(m(!0),x(F,null,q(B.value,a=>(m(),x("li",{key:a.id},[e("span",he,n(a.bread.name)+" -",1),e("span",ge,n(a.bread_production)+" pcs",1)]))),128))])])):U("",!0)]),_:1}),o(f,{class:"report-actions q-gutter-sm",align:"right"},{default:s(()=>[o(b,{color:"negative",label:"Decline",onClick:C,class:"action-btn"}),o(b,{color:"positive",label:"Confirm",onClick:S,class:"action-btn"})]),_:1})]),_:1})]),_:1},8,["modelValue"]),o(N,{modelValue:g.value,"onUpdate:modelValue":t[3]||(t[3]=a=>g.value=a)},{default:s(()=>[o(V,null,{default:s(()=>[o(f,null,{default:s(()=>[ye]),_:1}),o(f,null,{default:s(()=>[o(z,{modelValue:y.value,"onUpdate:modelValue":t[2]||(t[2]=a=>y.value=a),placeholder:"Enter your remark",label:"Remark",type:"textarea",filled:"","lazy-rules":"",rules:[a=>!!a||"Remark is required"]},null,8,["modelValue","rules"])]),_:1}),o(O,{align:"right"},{default:s(()=>[j(o(b,{flat:"",label:"Cancel",color:"primary"},null,512),[[ee]]),o(b,{flat:"",label:"Confirm",color:"negative",onClick:$})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};var ke=ae(be,[["__scopeId","data-v-1f9542cc"]]);const Re={class:"q-gutter-md"},Ce={class:"q-gutter-md q-ma-md"},De={class:"row justify-between"},xe={class:"text-subtitle1"},Ve={class:"text-subtitle1"},we={class:"text-h6"},Be={__name:"BakersReportCard",setup(l){var $,r;const p=P(),C=((r=($=I(()=>p.user).value)==null?void 0:$.device)==null?void 0:r.branch_id)||"",u=R(""),_=R(!1),v=R(!1);J(async()=>{console.log("props.userID in onMounted:",C),C&&await y(C)});const y=async t=>{_.value=!0,await p.fetchDoughReports(t),_.value=!1},w=t=>t.charAt(0).toUpperCase()+t.slice(1).toLowerCase();G(u,async t=>{_.value=!0,await new Promise(a=>setTimeout(a,1e3)),_.value=!1});const h=I(()=>{if(!u.value)return p.reports;const t=u.value.toLowerCase();return p.reports.filter(a=>a.branch_recipe.recipe.name&&a.branch_recipe.recipe.name.toLowerCase().includes(t)||a.created_at&&M.formatDate(a.created_at,"MMMM D, YYYY").toLowerCase().includes(t)||a.branch_recipe.recipe.category&&a.branch_recipe.recipe.category.toLowerCase().includes(t))});console.log("baekr reports",h.value);const Q=t=>M.formatDate(t,"MMMM D, YYYY"),L=t=>M.formatDate(t,"hh:mm A"),B=t=>{const a=A=>A?A.charAt(0).toUpperCase()+A.slice(1).toLowerCase():"",i=t.firstname?a(t.firstname):"No Firstname",Y=t.middlename?a(t.middlename).charAt(0)+".":"",D=t.lastname?a(t.lastname):"No Lastname";return`${i} ${Y} ${D}`},S=t=>{switch(t){case"pending":return"orange";case"declined":return"negative";case"confirmed":return"green";default:return"grey"}};return(t,a)=>(m(),k(Z,{padding:""},{default:s(()=>[e("div",Re,[e("div",null,[o(z,{rounded:"",outlined:"",dense:"",debounce:"300",modelValue:u.value,"onUpdate:modelValue":a[0]||(a[0]=i=>u.value=i),placeholder:"Search",style:{width:"500px","max-width":"1500px","min-width":"100px"}},{append:s(()=>[_.value?(m(),k(H,{key:1})):(m(),k(T,{key:0,name:"search"}))]),_:1},8,["modelValue"])]),o(X,{style:{height:"450px","max-width":"1500px"}},{default:s(()=>[e("div",Ce,[(m(!0),x(F,null,q(h.value,i=>(m(),k(V,{key:i.id},{default:s(()=>[o(f,null,{default:s(()=>[e("div",De,[e("div",null,[e("div",xe,n(Q(i.created_at)),1),e("div",Ve,n(L(i.created_at)),1)]),e("div",we,n(B(i.user.employee))+" - "+n(w(i.branch_recipe.recipe.name)),1),e("div",null,[o(W,{outlined:"",color:S(i.status)},{default:s(()=>[c(n(w(i.status)),1)]),_:2},1032,["color"])]),e("div",null,[o(ke,{report:i},null,8,["report"])])])]),_:2},1024)]),_:2},1024))),128))])]),_:1}),v.value&&h.value.length===0?(m(),k(V,{key:0},{default:s(()=>[o(f,{class:"text-h6 text-center"},{default:s(()=>[c("No reports found.")]),_:1})]),_:1})):U("",!0)])]),_:1}))}},$e={class:"text-h6 text-white"},je={__name:"BakersReportPage",setup(l){return(p,g)=>(m(),k(V,{flat:""},{default:s(()=>[o(f,{style:{"background-color":"#ef4444"}},{default:s(()=>[e("div",$e,[o(T,{name:"fa-solid fa-layer-group"}),c(" Bakers Report ")])]),_:1}),o(f,null,{default:s(()=>[e("div",null,[o(Be)])]),_:1})]),_:1}))}};export{je as default};
