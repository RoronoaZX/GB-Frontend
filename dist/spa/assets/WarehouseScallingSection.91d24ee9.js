import{c as N,o as r,a3 as Q,J as t,f as e,w as a,e as I,Q as D,I as M,L as T,$ as x,M as F,a1 as le,a4 as W,a5 as A,a0 as p,O,R as P,r as h,t as de,ae as E,K as j,bd as ae,aJ as _e,a2 as se,aK as me,u as pe,z as fe}from"./index.ee7b3a2d.js";import{a as oe,Q as K}from"./QTable.d23cddc8.js";import{Q as ne}from"./QTooltip.af9967ce.js";import{a as z,b as q,Q as te}from"./QList.23337283.js";import{b as B}from"./use-virtual-scroll.a89d96cc.js";import{C as G}from"./ClosePopup.30d1645d.js";import{u as L}from"./warehouse-rawMaterials.afe68e2f.js";import{Q as he}from"./QExpansionItem.5122582c.js";import{Q as ve}from"./QVirtualScroll.1c77cada.js";import{_ as J}from"./plugin-vue_export-helper.21dcd24c.js";import{Q as ge}from"./QBadge.563c90ca.js";import"./QSelect.510061f5.js";import"./QChip.abfccff9.js";import"./QMenu.f7d04f49.js";import"./selection.ffd4636d.js";import"./axios.b81b080d.js";import"./raw-material.d2efb958.js";import"./QSlideTransition.f7636593.js";const re=i=>(O("data-v-536e9288"),i=i(),P(),i),we=re(()=>t("div",{class:"text-h6",align:"center"},"Report List",-1)),be={class:"q-pa-md row wrap justify-center"},ye={class:"row justify-between q-gutter-x-md"},xe={class:"row items-center"},Se={class:"text-subtitle1 q-ml-sm"},ke={class:"q-mt-xs row justify-between"},$e=re(()=>t("div",null,"Kilos",-1)),Re={__name:"RawMaterialsCard",setup(i){const u=L(),c=N(()=>u.warehouseRawMaterialsReport),v=l=>{u.removeReport(l)},b=l=>{const n=Number(l);if(n>=1e3){const d=n/1e3;return`${d%1===0?d.toFixed(0):d.toFixed(2)} Kgs`}else return`${n%1===0?n.toFixed(0):n.toFixed(2)} g`},S=l=>l?l.split(" ").map(n=>n.charAt(0).toUpperCase()+n.slice(1).toLowerCase()).join(" "):"";return(l,n)=>(r(),Q(W,null,[we,t("div",be,[e(ve,{items:c.value,"scroll-target":"body","virtual-scroll-horizontal":"",class:"my-virtual-scroll"},{default:a(({item:d,index:k})=>[(r(),I(D,{flat:"",bordered:"",class:"q-gutter-sm my-card",key:k},{default:a(()=>[e(M,null,{default:a(()=>[t("div",ye,[t("div",xe,[e(T,{name:"assignment",color:"primary"}),t("div",Se,x(S(d.recipeName)+" - "+d.recipe_category),1)]),t("div",null,[e(F,{flat:"",round:"",icon:"close",onClick:$=>v(k),class:"text-negative close-btn"},null,8,["onClick"])])])]),_:2},1024),e(le),e(M,{class:"content-section"},{default:a(()=>[t("div",ke,[$e,t("div",null,x(d.kilo)+" kgs",1)]),(r(),I(he,{key:"ingredients-"+k,label:"Ingredients",dense:""},{default:a(()=>[(r(!0),Q(W,null,A(d.ingredients,($,R)=>(r(),I(z,{key:"ingedient-"+R},{default:a(()=>[e(q,null,{default:a(()=>[e(B,null,{default:a(()=>[p(x($.ingredient_name),1)]),_:2},1024)]),_:2},1024),e(q,{side:""},{default:a(()=>[e(B,null,{default:a(()=>[p(x(b($.quantity)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:2},1024))]),_:2},1024)]),_:2},1024))]),_:1},8,["items"])])],64))}};var Qe=J(Re,[["__scopeId","data-v-536e9288"]]);const Me=i=>(O("data-v-9d0f70a4"),i=i(),P(),i),Ce={class:"text-h6 text-white"},qe={class:"text-white"},Ie={class:"text-h6"},Ve={class:"q-mb-md"},Te={key:0,class:"custom-list z-top"},Be={key:0},Fe={class:"row justify-between"},Ne={class:"col-3"},We={class:"text-subtitle1 q-ml-sm"},ze={class:"q-mt-md"},De={class:"q-mt-sm"},Ue={class:"col-7"},je=Me(()=>t("div",{align:"center"},"Ingredients List",-1)),Le={__name:"WarehouseScallingTableAction",props:{branch:Object},setup(i){var X,Y,Z,ee;const u=L(),c=N(()=>u.user);console.log("userData",c.value);const v=((Y=(X=c.value)==null?void 0:X.data)==null?void 0:Y.employee_id)||"";console.log("employee_id",v);const b=((ee=(Z=c.value)==null?void 0:Z.employee)==null?void 0:ee.warehouse_id)||"";console.log("warehouse_id",b);const S=N(()=>u.branchRecipe),l=h([]),n=h(""),d=h(""),k=h(""),$=i,R=$.branch.id,C=h(!0);console.log("branchsss",$.branch);const V=async()=>{console.log("searchQuery.value",s.value),console.log("branch_id",R),u.searchBranchRecipe(s.value,R)},g=h(),o=()=>{g.value=!0},s=h(""),w=f=>{console.log("data",f),s.value="",d.value=f.recipe_id,n.value=f.name,k.value=f.category,l.value=f.ingredients},_=de({kilo:""}),H=N(()=>!_.kilo||_.kilo<=0?l.value:l.value.map(f=>({...f,quantity:(f.quantity*_.kilo).toFixed(2)}))),ie=f=>{const y=Number(f);if(y>=1e3){const m=y/1e3;return`${m%1===0?m.toFixed(0):m.toFixed(2)} kgs`}else return`${y%1===0?y.toFixed(0):y.toFixed(2)} g`},ue=async()=>{const f={warehouse_id:b,employee_id:v,branch_id:R,kilo:_.kilo,recipe_id:d.value,recipeName:n.value,recipe_category:k.value,ingredients:H.value,status:"pending"};await u.setReport(f),console.log("scaledIngredients",f),_.kilo="",d.value="",n.value="",k.value="",l.value=[]},ce=async()=>{await u.saveWarehouseRawMaterialsReport()};return(f,y)=>(r(),Q(W,null,[e(F,{color:"accent",icon:"scale",size:"md",flat:"",round:"",dense:"",onClick:o},{default:a(()=>[e(ne,{class:"bg-accent",delay:200},{default:a(()=>[p("Scale")]),_:1})]),_:1}),e(se,{modelValue:g.value,"onUpdate:modelValue":y[2]||(y[2]=m=>g.value=m),maximized:C.value,"transition-show":"slide-up","transition-hide":"slide-down"},{default:a(()=>[e(D,{class:"my-card"},{default:a(()=>[e(M,{class:"row justify-between",style:{"background-color":"#ef4444"}},{default:a(()=>[t("div",Ce,[e(T,{name:"fa-solid fa-store"}),p(" "+x(i.branch.name),1)]),t("div",qe,[E(e(F,{flat:"",round:"",dense:"",icon:"close"},null,512),[[G]])])]),_:1}),e(M,null,{default:a(()=>[t("div",Ie,[p(" Scaling "),e(T,{name:"scale"})])]),_:1}),e(M,null,{default:a(()=>[t("div",Ve,[e(j,{modelValue:s.value,"onUpdate:modelValue":[y[0]||(y[0]=m=>s.value=m),V],placeholder:"Search Recipe...",debounce:"1000",outlined:"",dense:""},{append:a(()=>[t("div",null,[e(T,{name:"search"})])]),default:a(()=>[s.value?(r(),Q("div",Te,[e(D,null,{default:a(()=>[e(te,{separator:""},{default:a(()=>{var m;return[(m=S.value)!=null&&m.length?(r(!0),Q(W,{key:1},A(S.value,U=>(r(),I(z,{key:U.id,clickable:"",onClick:la=>w(U)},{default:a(()=>[e(q,null,{default:a(()=>[e(B,null,{default:a(()=>[p(x(U.name),1)]),_:2},1024)]),_:2},1024),e(q,null,{default:a(()=>[e(B,{side:""},{default:a(()=>[p(x(U.category),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128)):(r(),I(z,{key:0},{default:a(()=>[p(" No Record Found ")]),_:1}))]}),_:1})]),_:1})])):ae("",!0)]),_:1},8,["modelValue"])]),n.value&&l.value?(r(),Q("div",Be,[t("div",Fe,[t("div",Ne,[t("div",We,x(n.value),1),t("div",ze,[e(j,{modelValue:_.kilo,"onUpdate:modelValue":y[1]||(y[1]=m=>_.kilo=m),type:"number",outlined:"",label:"Kilo",dense:""},null,8,["modelValue"])]),t("div",De,[e(F,{padding:"sm lg",size:"sm",outline:"",dense:"",icon:"add",color:"purple",onClick:ue})])]),t("div",Ue,[je,t("div",null,[e(te,{dense:"",separator:"",class:"box"},{default:a(()=>[e(z,null,{default:a(()=>[e(q,null,{default:a(()=>[e(B,{class:"text-overline"},{default:a(()=>[p("Raw Materials Name")]),_:1})]),_:1}),e(q),e(q,{side:""},{default:a(()=>[e(B,{class:"text-overline"},{default:a(()=>[p("Quantity")]),_:1})]),_:1})]),_:1}),(r(!0),Q(W,null,A(H.value,m=>(r(),I(z,{key:m.id},{default:a(()=>[e(q,null,{default:a(()=>[e(B,null,{default:a(()=>[p(x(m.ingredient_name),1)]),_:2},1024)]),_:2},1024),e(q),e(q,{side:""},{default:a(()=>[e(B,null,{default:a(()=>[p(x(ie(m.quantity)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})])])])])):ae("",!0)]),_:1}),e(M,null,{default:a(()=>[e(Qe)]),_:1}),e(le),e(_e,{class:"row q-ma-md",align:"right"},{default:a(()=>[E(e(F,{class:"glossy",color:"grey-9",label:"Cancel"},null,512),[[G]]),e(F,{class:"glossy",color:"teal",label:"Create",onClick:ce})]),_:1})]),_:1})]),_:1},8,["modelValue","maximized"])],64))}};var Ae=J(Le,[["__scopeId","data-v-9d0f70a4"]]);const Ee={__name:"WarehouseScallingSearchEngine",emits:["update-search"],setup(i,{emit:u}){const c=h(""),v=u,b=()=>{console.log("Emitting search term:",c.value),v("update-search",c.value)};return(S,l)=>(r(),I(j,{modelValue:c.value,"onUpdate:modelValue":[l[0]||(l[0]=n=>c.value=n),b],rounded:"",outlined:"",dense:"",debounce:"300",placeholder:"Search...",class:"q-mb-md"},{prepend:a(()=>[t("div",null,[e(T,{name:"search"})])]),_:1},8,["modelValue"]))}};const Ke=i=>(O("data-v-58368f56"),i=i(),P(),i),Ge={class:"text-h6 text-white"},Oe={class:"text-white"},Pe={key:0,class:"q-gutter-x-md data-error"},Je=Ke(()=>t("div",null,"No data",-1)),He={key:1},Xe={__name:"WarehouseScallinGTableRawMaterialsStatus",props:{branch:Object},setup(i){const u=L(),c=N(()=>u.branchRawMaterials),v=h(""),b=i,S=h({rowsPerPage:0}),l=h(),n=b.branch.id,d=async o=>{await u.fetchBranchRawMaterials(o)},k=()=>{d(n),l.value=!0},$=o=>{console.log("Received search term in parent:",o),v.value=o.toLowerCase()},R=N(()=>c.value.filter(o=>o.ingredients.name.toLowerCase().includes(v.value))),C=o=>{const s=o.total_quantity;if(o.ingredients.unit==="Grams"&&s<1e3)return"bg-red";let _;return s>=1e3?_=s/1e3:_=s,_<5?_<=2?"bg-red":(_<=3,"bg-warning"):"bg-positive"},V=o=>{const s=o.total_quantity,w=o.ingredients.unit;if(s>1e3){const _=(s/1e3).toFixed(2);return _.endsWith(".00")?`${Math.round(s/1e3)} kilos`:`${_} kilos`}else return s>1?`${s} ${w}`:`${s} ${w}`},g=[{name:"name",required:!0,label:"Name",align:"left",field:o=>o.ingredients.name,format:o=>`${o}`},{name:"total_quantity",required:!0,label:"Available Stocks",align:"left",field:o=>o.total_quantity,format:o=>`${o}`}];return(o,s)=>(r(),Q(W,null,[e(F,{color:"info",icon:"visibility",size:"md",flat:"",round:"",dense:"",onClick:k},{default:a(()=>[e(ne,{class:"bg-info",delay:200},{default:a(()=>[p("View")]),_:1})]),_:1}),e(se,{modelValue:l.value,"onUpdate:modelValue":s[1]||(s[1]=w=>l.value=w),"full-width":""},{default:a(()=>[e(D,{class:"my-card"},{default:a(()=>[e(M,{class:"row justify-between",style:{"background-color":"#ef4444"}},{default:a(()=>[t("div",Ge,[e(T,{name:"fa-solid fa-store"}),p(" "+x(b.branch.name),1)]),t("div",Oe,[E(e(F,{flat:"",round:"",dense:"",icon:"close"},null,512),[[G]])])]),_:1}),e(M,null,{default:a(()=>[e(Ee,{onUpdateSearch:$})]),_:1}),e(M,null,{default:a(()=>[R.value.length===0?(r(),Q("div",Pe,[e(T,{name:"warning",color:"warning",size:"4em"}),Je])):(r(),Q("div",He,[e(oe,{rows:R.value,columns:g,class:"table-container sticky-header",flat:"",dense:"","virtual-scroll":"",pagination:S.value,"onUpdate:pagination":s[0]||(s[0]=w=>S.value=w),"rows-per-page-options":[0],"hide-bottom":"",style:{height:"340px"}},{"body-cell-total_quantity":a(w=>[e(K,{props:w},{default:a(()=>[e(ge,{square:"",class:me(["text-white cursor-pointer",C(w.row)])},{default:a(()=>[p(x(V(w.row)),1)]),_:2},1032,["class"])]),_:2},1032,["props"])]),_:1},8,["rows","pagination"])]))]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};var Ye=J(Xe,[["__scopeId","data-v-58368f56"]]);const Ze={class:"row justify-center q-gutter-x-md"},ea={class:"row justify-center q-gutter-x-md"},aa={__name:"WarehouseScallingTable",setup(i){var $,R;const u=h(""),c=h(!1),v=L(),b=N(()=>v.user);console.log("userData",b.value);const S=((R=($=b.value)==null?void 0:$.device)==null?void 0:R.reference_id)||"";console.log("warehouseId",S);const l=N(()=>v.branch),n=h(!1);pe(u,()=>{c.value=!0,setTimeout(()=>{c.value=!1})}),fe(async()=>{await d(S)});const d=async C=>{const V=await v.fetchBranchUnderWarehouse(C);console.log("response",V),l.value=V,console.log("branchUnderWarehouseRows",l.value),l.value||(n.value=!0)},k=[{name:"name",label:"Branch Name",align:"center",field:C=>C.name,format:C=>`${C}`,sortable:!0},{name:"rawMaterialsStatus",label:"Raw Materials Status",align:"center",field:"rawMaterialsStatus"},{name:"action",label:"Action",align:"center"}];return(C,V)=>(r(),Q(W,null,[t("div",null,[e(j,{rounded:"",outlined:"",dense:"",debounce:"300",modelValue:u.value,"onUpdate:modelValue":V[0]||(V[0]=g=>u.value=g),placeholder:"Search",style:{width:"500px","max-width":"1500px","min-width":"100px"}},{append:a(()=>[c.value?(r(),I(T,{key:1,thickness:2,color:"teal",size:"1em"})):(r(),I(T,{key:0,name:"search"}))]),_:1},8,["modelValue"])]),t("div",null,[e(oe,{filter:u.value,flat:"",columns:k,rows:l.value,"row-key":"name"},{"body-cell-rawMaterialsStatus":a(g=>[e(K,{props:g},{default:a(()=>[t("div",Ze,[e(Ye,{branch:g.row},null,8,["branch"])])]),_:2},1032,["props"])]),"body-cell-action":a(g=>[e(K,{props:g},{default:a(()=>[t("div",ea,[e(Ae,{branch:g.row},null,8,["branch"])])]),_:2},1032,["props"])]),_:1},8,["filter","rows"])])],64))}},ta=t("div",{class:"text-h6"},"Scaling Section",-1),xa={__name:"WarehouseScallingSection",setup(i){return(u,c)=>(r(),I(D,{flat:""},{default:a(()=>[e(M,null,{default:a(()=>[ta]),_:1}),e(M,null,{default:a(()=>[t("div",null,[e(aa)])]),_:1})]),_:1}))}};export{xa as default};
