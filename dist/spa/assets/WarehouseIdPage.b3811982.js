import{be as G,c as P,r as R,t as Te,o as g,a3 as Q,f as e,M as D,w as a,Q as z,I as B,ae as ue,J as o,K as W,L as K,e as N,a0 as y,a4 as U,a5 as H,$,bd as xe,aJ as de,a2 as X,O as Z,R as ee,a1 as Ne,N as J,P as be,z as ce,u as me,aK as Re,bb as Ue,bf as te,H as Fe}from"./index.7640e4cf.js";import{Q as pe}from"./QSpace.0007135a.js";import{Q as Ce,a as le,b as Me,c as oe}from"./QTabPanels.e06014d2.js";import{Q as Le}from"./QPage.88a071ab.js";import{Q as j}from"./QBadge.a3bd3eb6.js";import{Q as ze}from"./QSpinnerDots.29ccc382.js";import{Q as qe}from"./QTooltip.02333757.js";import{Q as We}from"./QPopupEdit.f7202da8.js";import{Q as O,a as _e}from"./QTable.00529ccc.js";import{Q as re,a as A,b as S}from"./QList.23e25756.js";import{Q as I}from"./rtl.1813a5ba.js";import{C as ge}from"./ClosePopup.7ab7b337.js";import"./branch-product.ad8c74c9.js";import{u as se}from"./warehouse-rawMaterials.8a7fbd03.js";import{u as ke}from"./raw-material.cb73eeea.js";import{_ as E}from"./plugin-vue_export-helper.21dcd24c.js";import{api as $e}from"./axios.eaed252d.js";import{Q as ie}from"./QSkeleton.50f32deb.js";import{u as Qe}from"./use-quasar.c78d29c5.js";import{u as Ve}from"./warehouse.d8e53a13.js";import{u as Se}from"./use-dialog-plugin-component.e30b51a0.js";import{Q as Ae}from"./QSpinnerGears.456cd2f3.js";import{Q as je}from"./QInnerLoading.a35b79e2.js";import{u as Ie}from"./premix.10b8c08c.js";import{q as Ke}from"./date.f6d3b06d.js";import{Q as Ee,a as He}from"./QStepper.fd4b94f2.js";import{u as Oe}from"./baker-report.d295eeda.js";import"./QResizeObserver.f2a12e2f.js";import"./use-panel.a9ced4f2.js";import"./touch.9135741d.js";import"./selection.21d0b633.js";import"./QMenu.106ae137.js";import"./QVirtualScroll.37625985.js";import"./use-virtual-scroll.47f9879f.js";import"./QSelect.b9e84c2a.js";import"./QChip.e4b8526a.js";import"./product.5f24c554.js";import"./QSlideTransition.01fbeeab.js";const ae=r=>(Z("data-v-e1e644a2"),r=r(),ee(),r),Ge=ae(()=>o("div",{class:"text-h6"},"Create Warehouse Raw Materials",-1)),Ye={class:"q-mb-lg"},Je={key:0,class:"custom-list z-top"},Xe=ae(()=>o("div",null,"Raw Materials Code",-1)),Ze=ae(()=>o("div",null,"Raw Materials Name",-1)),ea=ae(()=>o("div",null,"Category",-1)),aa=ae(()=>o("div",null,"Quantity",-1)),ta={__name:"RawMaterialsCreate",setup(r){const V=G(),x=ke(),v=P(()=>x.rawMaterials),n=se(),u=R(""),w=async()=>{x.searchRawMaterials(u.value)},C=P(()=>s.total_quantity!==""),d=R(!1),b=()=>{d.value=!0},k=()=>{f(),d.value=!1},m=q=>{s.raw_material_id=q.id,s.raw_materials_name=q.name,s.raw_materials_code=q.code,s.category=q.category,s.unit=q.unit,u.value=""},s=Te({raw_material_id:"",raw_materials_name:"",raw_materials_code:"",total_quantity:"",category:"",unit:"",warehouse_id:V.params.warehouse_id}),f=()=>{s.raw_material_id="",s.raw_materials_name="",s.raw_materials_code="",s.total_quantity="",s.raw_material_id="",s.category="",s.unit=""},M=async()=>{try{const{product_name:q,...l}=s;await n.createWarehouseRawMaterials(l),console.log("data to send",l),d.value=!1}catch(q){console.log(q)}};return(q,l)=>(g(),Q(U,null,[e(D,{class:"bg-gradient text-white q-pa-sm",icon:"add_circle",label:"Create One",onClick:b}),e(X,{modelValue:d.value,"onUpdate:modelValue":l[5]||(l[5]=t=>d.value=t),persistent:""},{default:a(()=>[e(z,{class:"my-card",style:{width:"400px","max-width":"500px","min-width":"100px"}},{default:a(()=>[e(B,{class:"row items-center text-white bg-gradient"},{default:a(()=>[Ge,e(pe),ue(e(D,{icon:"close",flat:"",dense:"",round:""},null,512),[[ge]])]),_:1}),e(B,{class:"q-ma-md q-gutter-y-sm"},{default:a(()=>[o("div",Ye,[e(W,{modelValue:u.value,"onUpdate:modelValue":[l[0]||(l[0]=t=>u.value=t),w],debounce:"1000",outlined:"",rounded:"",placeholder:"Search Raw Materials",dense:""},{append:a(()=>[o("div",null,[e(K,{name:"search"})])]),default:a(()=>[u.value?(g(),Q("div",Je,[e(z,null,{default:a(()=>[e(re,{separator:""},{default:a(()=>{var t;return[(t=v.value)!=null&&t.length?(g(!0),Q(U,{key:1},H(v.value,i=>(g(),N(A,{onClick:p=>m(i),key:i.id,clickable:""},{default:a(()=>[e(S,null,{default:a(()=>[e(I,null,{default:a(()=>[y($(i.name),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128)):(g(),N(A,{key:0},{default:a(()=>[y(" No record found. ")]),_:1}))]}),_:1})]),_:1})])):xe("",!0)]),_:1},8,["modelValue"])]),o("div",null,[Xe,e(W,{modelValue:s.raw_materials_code,"onUpdate:modelValue":l[1]||(l[1]=t=>s.raw_materials_code=t),readonly:"",dense:"",outlined:""},null,8,["modelValue"])]),o("div",null,[Ze,e(W,{modelValue:s.raw_materials_name,"onUpdate:modelValue":l[2]||(l[2]=t=>s.raw_materials_name=t),readonly:"",dense:"",outlined:""},null,8,["modelValue"])]),o("div",null,[ea,e(W,{modelValue:s.category,"onUpdate:modelValue":l[3]||(l[3]=t=>s.category=t),readonly:"",dense:"",outlined:""},null,8,["modelValue"])]),o("div",null,[aa,e(W,{modelValue:s.total_quantity,"onUpdate:modelValue":l[4]||(l[4]=t=>s.total_quantity=t),type:"number",outlined:"",suffix:s.unit||"",dense:"",rules:[t=>t&&t.length>0||"Total quantity is required"]},null,8,["modelValue","suffix","rules"])])]),_:1}),e(de,{class:"row q-ma-md",align:"right"},{default:a(()=>[e(D,{class:"glossy",color:"grey-9",label:"Dismiss",onClick:k}),e(D,{class:"glossy",color:"teal",label:"Create",onClick:M,disable:!C.value},null,8,["disable"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};var la=E(ta,[["__scopeId","data-v-e1e644a2"]]);const Pe=r=>(Z("data-v-7969abbc"),r=r(),ee(),r),oa=Pe(()=>o("div",{class:"text-h5 q-mb-xs"},"Confirm Deletion",-1)),ra=Pe(()=>o("p",{class:"text-body2 q-mb-none"}," Are you sure you want to delete this item? This action cannot be undone. ",-1)),sa={__name:"RawMaterialsTableDelete",props:["delete"],setup(r){const V=se(),x=r,v=async()=>{console.log("clickkkd");try{await V.deleteWarehouseRawMaterials(x.delete.row.id),J.create({type:"negative",icon:"warning",message:`Raw Materials ${x.delete.row.name}  successfully deleted`,timeout:1e3,position:"top"}),n.value=!1}catch(w){console.error(w.message)}},n=R(!1),u=()=>{n.value=!0};return(w,C)=>(g(),Q(U,null,[e(D,{onClick:u,color:"negative",icon:"delete",size:"sm",flat:"",round:"",dense:"",align:"center"},{default:a(()=>[e(qe,{class:"bg-negative",delay:200},{default:a(()=>[y("Delete")]),_:1})]),_:1}),e(X,{modelValue:n.value,"onUpdate:modelValue":C[0]||(C[0]=d=>n.value=d)},{default:a(()=>[e(z,null,{default:a(()=>[e(B,{class:"q-pa-md q-rounded q-elevate-2 bg-white text-grey-9"},{default:a(()=>[oa,ra]),_:1}),e(Ne,{class:"q-mb-md"}),e(B,null,{default:a(()=>[e(de,{align:"right",class:"q-pt-none"},{default:a(()=>[ue(e(D,{flat:"",dense:"",label:"Cancel",color:"primary",class:"q-mr-sm"},null,512),[[ge]]),e(D,{dense:"",label:"Delete",color:"negative",onClick:v,class:"q-btn-rounded q-px-lg"})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};var na=E(sa,[["__scopeId","data-v-7969abbc"]]);const ia=r=>(Z("data-v-656550b2"),r=r(),ee(),r),ua=ia(()=>o("div",{class:"text-h6"},"Create Warehouse Raw Materials",-1)),da={__name:"RawMaterialsCreateAll",setup(r){const V=R(!1),x=async()=>{V.value=!0},v=G(),n=ke(),u=P(()=>n.rawMaterials);console.log("rawMaterialsData",u.value);const w=se(),C=async()=>{if(be.show(),await n.fetchRawMaterials(),!n.rawMaterials.length){J.create({type:"warning",message:"No raw materials found!"});return}be.hide()},d=()=>{n.rawMaterials=[],V.value=!1},b=async()=>{try{const k=u.value.map(m=>({raw_material_id:m.id,total_quantity:0,warehouse_id:v.params.warehouse_id}));await w.createMultipleWarehouseRawMaterials(k),console.log("materialsToSave",k),J.create({type:"positive",message:"All raw materials added to warehouse!"}),d()}catch(k){console.error("Error adding all raw materials:",k),J.create({type:"negative",message:"Failed to add all raw materials!"})}};return(k,m)=>(g(),Q("div",null,[e(D,{class:"bg-gradient text-white q-pa-sm",icon:"add_circle",label:"Create All",onClick:x}),e(X,{modelValue:V.value,"onUpdate:modelValue":m[0]||(m[0]=s=>V.value=s)},{default:a(()=>[e(z,{style:{width:"700px","max-width":"80vw"}},{default:a(()=>[e(B,{class:"row items-center text-white bg-gradient"},{default:a(()=>[ua,e(pe),ue(e(D,{icon:"close",flat:"",dense:"",round:""},null,512),[[ge]])]),_:1}),e(B,null,{default:a(()=>[e(D,{class:"bg-gradient text-white q-pa-sm",icon:"add_circle",label:"Fetch All",onClick:C})]),_:1}),e(B,null,{default:a(()=>[e(re,{dense:"",separator:"",class:"box"},{default:a(()=>[e(A,null,{default:a(()=>[e(S,null,{default:a(()=>[e(I,{class:"text-overline"},{default:a(()=>[y(" Code")]),_:1})]),_:1}),e(S,null,{default:a(()=>[e(I,{class:"text-overline"},{default:a(()=>[y(" Name")]),_:1})]),_:1}),e(S,null,{default:a(()=>[e(I,{class:"text-overline"},{default:a(()=>[y(" Category")]),_:1})]),_:1}),e(S,{side:""},{default:a(()=>[e(I,{class:"text-overline"},{default:a(()=>[y("Unit")]),_:1})]),_:1})]),_:1}),(g(!0),Q(U,null,H(u.value,(s,f)=>(g(),N(A,{key:f},{default:a(()=>[e(S,null,{default:a(()=>[e(I,{class:"text-subtitle1"},{default:a(()=>[y($(s.code),1)]),_:2},1024)]),_:2},1024),e(S,null,{default:a(()=>[e(I,{class:"text-subtitle1",align:"left"},{default:a(()=>[y($(s.name),1)]),_:2},1024)]),_:2},1024),e(S,null,{default:a(()=>[e(I,{class:"text-subtitle1"},{default:a(()=>[y($(s.category),1)]),_:2},1024)]),_:2},1024),e(S,{side:""},{default:a(()=>[e(I,{class:"text-subtitle1"},{default:a(()=>[y($(s.unit),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}),e(de,{class:"row q-ma-md",align:"right"},{default:a(()=>[e(D,{class:"glossy",color:"grey-9",label:"Dismiss",onClick:d}),e(D,{class:"glossy",color:"teal",label:"Create",onClick:b})]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}};var ca=E(da,[["__scopeId","data-v-656550b2"]]);const De=r=>(Z("data-v-33b05e1b"),r=r(),ee(),r),ma={class:"row justify-between"},pa={class:"row q-gutter-x-sm"},_a={key:0,class:"spinner-wrapper"},ga={key:1},fa={key:0,class:"data-error"},va=De(()=>o("div",{class:"q-ml-sm text-h6"},"No data available",-1)),ha=De(()=>o("div",{class:"text-white"},"Edit Available Stocks",-1)),wa={class:"row justify-center q-gutter-x-md"},ya={__name:"RawMaterialsTable",setup(r){const x=G().params.warehouse_id,v=se(),n=R(""),u=R(!0),w=R([]),C=R(!1),d=R({rowsPerPage:0}),b=P(()=>v.warehouseRawMaterials),k=P(()=>n.value?b.value.filter(l=>l.name.toLowerCase().includes(n.value.toLowerCase())):b.value);ce(async()=>{console.log("props.warehouseId in onMounted:",x),x&&await m(x)});const m=async l=>{try{u.value=!0;const t=await v.fetchWarehouseRawMaterials(l);b.value=t,b.value.length||(C.value=!0),console.log("Warehouse Raw Materials",b.value)}catch(t){console.log("Error fetching branch product:",t),C.value=!0}finally{u.value=!1}};async function s(l,t){try{const i=await $e.put("/api/update-warehouse-rawMaterials/"+l.id,{total_quantity:parseInt(t)});if(i.status===200){const p=w.value.findIndex(T=>T.id==l.id);w.value[p]=parseInt(t),J.create({type:"positive",message:i.data.message,timout:1e3,position:"top"})}}catch(i){console.error("Error updating price:",i)}}me(n,async l=>{u.value=!0,await new Promise(t=>setTimeout(t,1e3)),u.value=!1,C.value=k.value.length===0});const f=l=>{const t=l.total_quantity,i=l.raw_materials.unit;if(console.log("unit test",i),i==="Grams"&&t<1e3)return"bg-red";let p;return t>=1e3?p=t/1e3:p=t,p<5?p<=2?"bg-red":(p<=3,"bg-warning"):"bg-positive"},M=l=>{var T;const t=Number(l==null?void 0:l.total_quantity)||0,i=((T=l==null?void 0:l.raw_materials)==null?void 0:T.unit)||"units";console.log("totalQuantity:",t),console.log("unit:",i);const p=F=>{const L=Number(F);return Number.isInteger(L)?L:L.toFixed(2)};if(t>1e3){const F=t/1e3;if(F>=25){const L=F/25;return`${p(L)} sacks`}return`${p(F)} kilos`}return`${p(t)} ${i}`},q=[{name:"code",label:"Raw Materials Code",align:"center",field:l=>{var t,i;return(i=(t=l==null?void 0:l.raw_materials)==null?void 0:t.code)!=null?i:"No Code"},format:l=>`${l}`,sortable:!0},{name:"name",label:"Raw Materials Name",align:"center",field:l=>{var t,i;return(i=(t=l==null?void 0:l.raw_materials)==null?void 0:t.name)!=null?i:"No Code"},format:l=>`${l}`,sortable:!0},{name:"total_quantity",label:"Available Stocks",align:"center",field:"total_quantity",sortable:!0},{name:"action",label:"Action",align:"center",sortable:!0}];return(l,t)=>(g(),Q(U,null,[o("div",ma,[o("div",null,[e(W,{class:"q-pb-lg q-pl-md",modelValue:n.value,"onUpdate:modelValue":t[0]||(t[0]=i=>n.value=i),outlined:"",placeholder:"Search",debounce:"1000",style:{width:"450px","max-width":"5000px","min-width":"100px"},flat:"",dense:"",rounded:""},{append:a(()=>[e(K,{name:"search"})]),_:1},8,["modelValue"])]),o("div",pa,[o("div",null,[e(la)]),o("div",null,[e(ca)])])]),u.value?(g(),Q("div",_a,[e(ze,{size:"50px",color:"primary"})])):(g(),Q("div",ga,[k.value.length===0?(g(),Q("div",fa,[e(K,{name:"warning",color:"warning",size:"4em"}),va])):(g(),N(_e,{key:1,class:"table-container sticky-header",filter:n.value,flat:"",columns:q,rows:k.value,"row-key":"name",pagination:d.value,"onUpdate:pagination":t[1]||(t[1]=i=>d.value=i),"rows-per-page-options":[0],"hide-bottom":"",style:{height:"375px"}},{"body-cell-total_quantity":a(i=>[e(O,{props:i},{default:a(()=>[e(j,{square:"",class:Re(["text-white cursor-pointer",f(i.row)])},{default:a(()=>[y($(M(i.row))+" ",1),e(qe,{class:"bg-blue-grey-8",offset:[10,10]},{default:a(()=>[ha]),_:1}),e(We,{"onUpdate:modelValue":[p=>s(i.row,p),p=>i.row.total_quantity=p],modelValue:i.row.total_quantity,"auto-save":""},{default:a(p=>[e(W,{modelValue:p.value,"onUpdate:modelValue":T=>p.value=T,dense:"",suffix:i.row.raw_materials.unit,mask:"########",autofocus:"",counter:"",onKeyup:Ue(p.set,["enter"])},null,8,["modelValue","onUpdate:modelValue","suffix","onKeyup"])]),_:2},1032,["onUpdate:modelValue","modelValue"])]),_:2},1032,["class"])]),_:2},1032,["props"])]),"body-cell-action":a(i=>[e(O,{props:i},{default:a(()=>[o("div",wa,[e(na,{delete:i},null,8,["delete"])])]),_:2},1032,["props"])]),_:1},8,["filter","rows","pagination"]))]))],64))}};var ba=E(ya,[["__scopeId","data-v-33b05e1b"]]);const xa={class:"q-gutter-sm"},Ra={class:"q-gutter-x-sm"},Ca={__name:"WarehouseRawMaterialsPage",setup(r){return(V,x)=>(g(),Q("div",xa,[o("div",Ra,[e(j,{label:"Good",class:"text-white",color:"positive"}),e(j,{label:"Warning",class:"text-white",color:"warning"}),e(j,{label:"Danger",class:"text-white",color:"red"})]),o("div",null,[e(ba)])]))}},Ma={__name:"BranchRawMaterials",props:{branchReport:Object,getRawMaterialBadgeColor:Function,getBadgeCategoryColor:Function,formatTotalQuantity:Function,capitalizeFirstLetter:Function},setup(r){Se(),console.log("branchReportss",r.branchReport),R(!1),R(!0);const x=R([{name:"raw_material",label:"Raw Materials Name",align:"left",field:v=>{var n;return((n=v.raw_material)==null?void 0:n.name)||"No record"}},{name:"code",label:"Code",align:"left",field:v=>{var n;return((n=v.raw_material)==null?void 0:n.code)||"No record"}},{name:"category",label:"Category",align:"left",field:v=>{var n;return((n=v.raw_material)==null?void 0:n.category)||"No record"}},{name:"total_quantity",label:"Available Stocks",align:"center",field:"total_quantity"}]);return(v,n)=>(g(),N(_e,{rows:r.branchReport.reports,columns:x.value,"row-key":"id",flat:"",bordered:"",pagination:v.pagination,"onUpdate:pagination":n[0]||(n[0]=u=>v.pagination=u),"rows-per-page-options":[0],"hide-bottom":"",class:"q-mt-md sticky-header3",style:{height:"450px"}},{"body-cell-total_quantity":a(u=>[e(O,{props:u},{default:a(()=>[e(j,{square:"",class:Re(["text-white cursor-pointer",r.getRawMaterialBadgeColor(u.row)])},{default:a(()=>[y($(r.formatTotalQuantity(u.row)),1)]),_:2},1032,["class"])]),_:2},1032,["props"])]),"body-cell-category":a(u=>[e(O,{key:"name",props:u},{default:a(()=>[e(j,{color:r.getBadgeCategoryColor(u.row.raw_material.category)},{default:a(()=>[y($(u.row.raw_material.category),1)]),_:2},1032,["color"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","pagination"]))}},qa={class:"row justify-between"},ka={class:"text-h6"},$a=o("div",{class:"text-h6",align:"center"},"Premix",-1),Qa=o("div",{class:"text-h6",align:"center"},"Ingredients List",-1),Va={class:"text-grey-7 q-mt-xs"},Sa=o("div",{class:"text-h6 text-weight-regular"}," Do you want to receive the premix? ",-1),Ia={__name:"TransactionView",props:{report:{type:Object,required:!0}},emits:["update-history"],setup(r,{emit:V}){var fe,ve,he,we,ye;const x=Oe(),v=P(()=>x.user);console.log("userData in RawMaterialsTable:",v.value);const n=((ve=(fe=v.value)==null?void 0:fe.data)==null?void 0:ve.employee_id)||"";console.log("employeeId in PremixPage:",n);const u=Ie();P(()=>u.branchPremix),Qe();const w=R(!1),C=R(!1),d=r;console.log("props",d.report);const b=d.report.branch_premix.branch_id;console.log("branchId",b);const k=()=>{w.value=!0},m=_=>{const c=h=>h?h.charAt(0).toUpperCase()+h.slice(1).toLowerCase():"";return`${c(_.firstname||"No Firstname")} ${_.middlename?c(_.middlename).charAt(0)+".":""} ${c(_.lastname||"No Lastname")}`},s=[{label:"Pending",value:"pending"},{label:"Declined",value:"declined"},{label:"Confirmed",value:"confirmed"},{label:"Process",value:"process"},{label:"Completed",value:"completed"},{label:"To Deliver",value:"to deliver"},{label:"To Receive",value:"to receive"},{label:"Received",value:"received"}],f=P(()=>{var _;return(_=d.report.history)!=null&&_.length?s.filter(c=>d.report.history.some(h=>h.status===c.value)):[]}),M=_=>{const c=d.report.history.find(h=>h.status===_);return c?_==="received"?`Received by: ${m(c.employee)}`:_==="pending"?`Requested by: ${m(c.employee)}`:`Handled by: ${m(c.employee)}`:"No handler"},q=_=>{const c=Number(_);return isNaN(c)?"":(c%1===0,c.toString())},l=(_,c)=>{if(c==="Pcs")return`${_} pcs`;if(c==="Grams"){if(_>=1e3){let h=_/1e3;return`${h%1===0?h.toString():h.toString().replace(/^0+/,"")} kgs`}return`${_} g`}return`${_} ${c}`},t=((ye=(we=(he=d.report)==null?void 0:he.branch_premix)==null?void 0:we.branch_recipe)==null?void 0:ye.ingredient_groups)||"Undefined";console.log("ingrdientsData",t);const i=P(()=>t.map(_=>{const c=parseFloat(_.quantity)*parseFloat(d.report.quantity);return{..._,totalQuantity:c,formattedQuantity:l(c,_.ingredient.unit)}}));console.log("report to proceed",d.report);const p=P(()=>{var _,c;return((c=(_=d.report.history)==null?void 0:_[d.report.history.length-1])==null?void 0:c.status)||null});console.log("lastStatus",p.value);const T=P(()=>f.value.findIndex(_=>_.value===p.value)+1),F=_=>{var c;return(c=d.report.history)==null?void 0:c.some(h=>h.status===_)},L=_=>({pending:"warning",declined:"red-6",confirmed:"green",process:"primary",completed:"dark","to deliver":"brown-9","to receive":"amber-10",received:"secondary"})[_]||"grey",ne=async()=>{const _={request_premix_id:d.report.id,branch_premix_id:d.report.branch_premix_id,branch_id:d.report.branch_premix.branch_id,employee_id:n,status:"receive",notes:"Received Premix",quantity:d.report.quantity,warehouse_id:d.report.warehouse_id,ingredients:i.value.map(c=>({ingredients_id:c.ingredient.id,total_quantity:c.totalQuantity,unit:c.ingredient.unit}))};console.log("payload",_),await u.receivePremix(_),await u.fetchRequestBranchPremix(b),w.value=!1};return(_,c)=>(g(),Q(U,null,[o("div",null,[e(D,{color:"accent",icon:"visibility",size:"md",flat:"",round:"",dense:"",onClick:k})]),e(X,{modelValue:w.value,"onUpdate:modelValue":c[2]||(c[2]=h=>w.value=h)},{default:a(()=>[e(z,{style:{width:"700px","max-width":"80vw"}},{default:a(()=>[e(B,null,{default:a(()=>[o("div",qa,[o("div",ka,$(r.report.name),1),e(D,{class:"close-btn",color:"grey-8",flat:"",round:"",dense:"",icon:"close",onClick:c[0]||(c[0]=h=>w.value=!1)})])]),_:1}),e(B,null,{default:a(()=>[o("div",null,"Baker: "+$(m(r.report.employee)),1),o("div",null," Branch: "+$(r.report.branch_premix.branch_recipe.branch.name),1),o("div",null,[y(" Status: "),e(j,{color:L(r.report.status),outlined:""},{default:a(()=>[y($(r.report.status),1)]),_:1},8,["color"])])]),_:1}),e(B,{class:"q-gutter-y-md"},{default:a(()=>[o("div",null,[$a,e(re,{dense:"",separator:"",class:"box"},{default:a(()=>[e(A,null,{default:a(()=>[e(S,null,{default:a(()=>[e(I,{class:"text-overline"},{default:a(()=>[y("Premix Name")]),_:1})]),_:1}),e(S,{side:""},{default:a(()=>[e(I,{class:"text-overline"},{default:a(()=>[y("Request Quantity / kgs")]),_:1})]),_:1})]),_:1}),e(A,null,{default:a(()=>[e(S,null,{default:a(()=>[e(I,{class:"text-h6"},{default:a(()=>[y($(r.report.name),1)]),_:1})]),_:1}),e(S,{side:""},{default:a(()=>[e(I,{class:"text-h6"},{default:a(()=>[y($(q(r.report.quantity)),1)]),_:1})]),_:1})]),_:1})]),_:1})]),o("div",null,[Qa,e(re,{dense:"",separator:"",class:"box"},{default:a(()=>[e(A,null,{default:a(()=>[e(S,null,{default:a(()=>[e(I,{class:"text-overline"},{default:a(()=>[y(" Code")]),_:1})]),_:1}),e(S,null,{default:a(()=>[e(I,{class:"text-overline"},{default:a(()=>[y(" Name")]),_:1})]),_:1}),e(S,{side:""},{default:a(()=>[e(I,{class:"text-overline"},{default:a(()=>[y("Quantity")]),_:1})]),_:1})]),_:1}),(g(!0),Q(U,null,H(te(t),(h,Y)=>(g(),N(A,{key:Y},{default:a(()=>[e(S,null,{default:a(()=>[e(I,{class:"text-subtitle1"},{default:a(()=>[y($(h.ingredient.code),1)]),_:2},1024)]),_:2},1024),e(S,null,{default:a(()=>[e(I,{class:"text-subtitle1",align:"left"},{default:a(()=>[y($(h.ingredient.name),1)]),_:2},1024)]),_:2},1024),e(S,{side:""},{default:a(()=>[e(I,{class:"text-subtitle1"},{default:a(()=>[y($(l(h.quantity*r.report.quantity,h.ingredient.unit)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})])]),_:1}),e(Ee,{modelValue:T.value,"onUpdate:modelValue":c[1]||(c[1]=h=>T.value=h),animated:"",class:"q-pa-lg"},{default:a(()=>[(g(!0),Q(U,null,H(f.value,(h,Y)=>(g(),N(He,{key:Y,name:Y+1,title:h.label,color:L(h.value),done:F(h.value),icon:F(h.value)?"check":"radio_button_unchecked",class:"custom-step"},{default:a(()=>[o("div",Va,$(M(h.value)),1)]),_:2},1032,["name","title","color","done","icon"]))),128))]),_:1},8,["modelValue"]),p.value==="to receive"?(g(),N(B,{key:0,class:"text-center q-gutter-md"},{default:a(()=>[Sa,e(D,{color:"amber-10",label:"Yes",icon:"check",onClick:ne,loading:C.value},null,8,["loading"])]),_:1})):xe("",!0)]),_:1})]),_:1},8,["modelValue"])],64))}};const Pa={__name:"BranchTransaction",props:{branchId:Object},setup(r){const V=G();P(()=>V.params.warehouse_id||null);const x=Ie(),v=P(()=>x.branchPremix);console.log("premixDatas",v.value);const n=R([]),u=R(""),w=R(!0),C=r,d=R(!1),b=R({page:1,rowsPerPage:0,rowsNumber:0}),k=C.branchId,m=async(t,i=0,p=5)=>{try{d.value=!0,await x.fetchRequestBranchPremix(t,i,p),console.log("Fetch premix data",v.value);const{data:T,current_page:F,per_page:L,total:ne}=v.value;n.value=T,b.value.page=F,console.log("pagination.value.page",b.value.page),b.value.rowsPerPage=L,console.log("pagination.value.rowsPerPage",b.value.rowsPerPage),b.value.rowsNumber=ne,console.log("pagination.value.rowsNumber",b.value.rowsNumber)}catch(T){console.log("error",T)}finally{d.value=!1}};ce(async()=>{k&&await m(k),console.log("premixdatas",v.value)});const s=t=>{m(k,t.pagination.page,t.pagination.rowsPerPage)};me(u,()=>{w.value=!0,setTimeout(()=>{w.value=!1})});const f=t=>Ke.formatDate(t,"MMM D, YYYY - hh:mm A"),M=t=>t.charAt(0).toUpperCase()+t.slice(1).toLowerCase(),q=t=>{switch(t){case"pending":return"warning";case"declined":return"red-6";case"confirmed":return"green";case"process":return"primary";case"completed":return"dark";case"to deliver":return"brown-9";case"to receive":return"amber-10";case"received":return"secondary";default:return"grey"}},l=[{name:"name",label:"Transactions Name",align:"left",field:t=>t.name,format:t=>`${t}`,sortable:!0},{name:"date",align:"center",label:"Created Date",field:"created_at",format:t=>f(t),sortable:!0},{name:"updated_at",align:"center",label:"Updated Date",field:"updated_at",format:t=>f(t),sortable:!0},{name:"status",align:"center",label:"Status",field:"status",sortable:!0},{name:"view",align:"right",label:"View",field:"view",sortable:!0}];return(t,i)=>(g(),Q(U,null,[o("div",null,[e(W,{rounded:"",outlined:"",dense:"",debounce:"300",modelValue:u.value,"onUpdate:modelValue":i[0]||(i[0]=p=>u.value=p),placeholder:"Search",style:{width:"500px","max-width":"1500px","min-width":"100px"}},{append:a(()=>[w.value?(g(),N(K,{key:1,thickness:2,color:"teal",size:"1em"})):(g(),N(K,{key:0,name:"search"}))]),_:1},8,["modelValue"])]),o("div",null,[e(_e,{bordered:"",class:"q-mt-md",flat:"",columns:l,rows:n.value,pagination:b.value,"onUpdate:pagination":i[1]||(i[1]=p=>b.value=p),"rows-per-page-options":[5,7,10,0],"row-key":"id",onRequest:s,loading:d.value},{"body-cell-status":a(p=>[e(O,{props:p},{default:a(()=>[e(j,{outlined:"",color:q(p.row.status)},{default:a(()=>[y($(M(p.row.status)),1)]),_:2},1032,["color"])]),_:2},1032,["props"])]),"body-cell-view":a(p=>[e(O,{props:p},{default:a(()=>[o("div",null,[e(Ia,{report:p.row,onUpdateHistory:t.updateReportHistory},null,8,["report","onUpdateHistory"])])]),_:2},1032,["props"])]),loading:a(()=>[e(je,{showing:""},{default:a(()=>[e(Ae,{size:"50px",color:"grey-9"})]),_:1})]),_:1},8,["rows","pagination","loading"])])],64))}};var Da=E(Pa,[["__scopeId","data-v-af4e416e"]]);const Ba={class:"row justify-between"},Ta={class:"text-h6"},Na={__name:"DialogPage",props:{branchReport:Object,capitalizeFirstLetter:Function,getRawMaterialBadgeColor:Function,getBadgeCategoryColor:Function,formatTotalQuantity:Function},setup(r){const{dialogRef:V,onDialogHide:x,onDialogOK:v,onDialogCancel:n}=Se(),w=r.branchReport.branch_id,C=R("branchRawMaterials"),d=R(!1),b=R(!0);return(k,m)=>(g(),N(X,{ref_key:"dialogRef",ref:V,onHide:te(x),modelValue:d.value,"onUpdate:modelValue":m[2]||(m[2]=s=>d.value=s),maximized:b.value,"transition-show":"slide-up","transition-hide":"slide-down"},{default:a(()=>[e(z,null,{default:a(()=>[e(B,null,{default:a(()=>[o("div",Ba,[o("div",Ta,$(`${r.capitalizeFirstLetter(r.branchReport.branch_name)}  Branch`),1),o("div",null,[e(D,{round:"",dense:"",flat:"",icon:"close",onClick:te(n)},null,8,["onClick"])])]),o("div",null,[e(Ce,{modelValue:C.value,"onUpdate:modelValue":m[0]||(m[0]=s=>C.value=s),align:"justify","narrow-indicator":"",class:"q-mb-lg"},{default:a(()=>[e(le,{class:"text-purple",name:"branchRawMaterials",label:"Branch Raw Materials"}),e(le,{class:"text-orange",name:"branchPremixTransactions",label:"Branch Premix Transactions"})]),_:1},8,["modelValue"]),o("div",null,[e(Me,{modelValue:C.value,"onUpdate:modelValue":m[1]||(m[1]=s=>C.value=s),animated:"","transition-prev":"scale","transition-next":"scale"},{default:a(()=>[e(oe,{name:"branchRawMaterials"},{default:a(()=>[e(Ma,{branchReport:r.branchReport,getRawMaterialBadgeColor:r.getRawMaterialBadgeColor,getBadgeCategoryColor:r.getBadgeCategoryColor,formatTotalQuantity:r.formatTotalQuantity,capitalizeFirstLetter:r.capitalizeFirstLetter},null,8,["branchReport","getRawMaterialBadgeColor","getBadgeCategoryColor","formatTotalQuantity","capitalizeFirstLetter"])]),_:1}),e(oe,{name:"branchPremixTransactions"},{default:a(()=>[e(Da,{branchId:te(w)},null,8,["branchId"])]),_:1})]),_:1},8,["modelValue"])])])]),_:1})]),_:1})]),_:1},8,["onHide","modelValue","maximized"]))}};const Be=r=>(Z("data-v-8e017a4c"),r=r(),ee(),r),Ua={class:"q-pa-md elegant-container"},Fa={key:0,class:"skeleton-wrapper row q-col-gutter-md"},La={key:1,class:"data-error"},za=Be(()=>o("div",null,"No data available",-1)),Wa={key:2,class:"q-pa-md row q-col-gutter-md"},Aa=Be(()=>o("img",{src:"https://cdn.quasar.dev/img/mountains.jpg"},null,-1)),ja={class:"q-mt-lg"},Ka={class:"text-h6 text-weight-medium elegant-name text-capitalize"},Ea={__name:"BranchCard",props:["branchRawMaterialsReport"],setup(r){const V=G(),x=Ve(),v=Qe(),n=P(()=>x.warehouseBranchReports),u=R(!1),w=P(()=>V.params.warehouse_id||null),C=R(!1),d=f=>{v.dialog({component:Na,componentProps:{branchReport:f,getRawMaterialBadgeColor:b,getBadgeCategoryColor:m,formatTotalQuantity:s,capitalizeFirstLetter:k}})},b=f=>{const M=f.quantity;if(f.raw_material.unit==="Grams"&&M<1e3)return"bg-red";let l;return M>=1e3?l=M/1e3:l=M,l<5?l<=2?"bg-red":(l<=3,"bg-warning"):"bg-positive"},k=f=>f?f.split(" ").map(M=>M.charAt(0).toUpperCase()+M.slice(1).toLowerCase()).join(" "):"",m=f=>{switch(f){case"Ingredients":return"teal";case"Packaging Materials":return"brown-6";default:return"grey"}},s=f=>{const M=f.quantity,q=f.raw_material.unit;if(M>1e3){const l=(M/1e3).toFixed(2);return l.endsWith(".00")?`${Math.round(M/1e3)} kilos`:`${l} kilos`}else return M>1?`${M} ${q}`:`${M} ${q}`};return me(w,async f=>{if(f)try{u.value=!0,await x.fetchWarehouseByBranchID(f),C.value=n.value.length===0}catch(M){console.error("Error fetching warehouse data:",M),C.value=!0}finally{u.value=!1}},{immediate:!0}),(f,M)=>(g(),Q("div",Ua,[u.value?(g(),Q("div",Fa,[(g(),Q(U,null,H(8,q=>o("div",{class:"col-xs-12 col-sm-6 col-md-4 col-lg-3",key:q},[e(z,{class:"user-card skeleton-card"},{default:a(()=>[e(ie,{height:"200px",class:"q-mb-md"}),e(B,{class:"text-center"},{default:a(()=>[e(ie,{type:"text",width:"60%",class:"q-mt-lg"}),e(ie,{type:"text",width:"40%",class:"q-mt-sm"})]),_:1})]),_:1})])),64))])):C.value?(g(),Q("div",La,[e(K,{name:"error",size:"50px",color:"negative"}),za])):(g(),Q("div",Wa,[(g(!0),Q(U,null,H(n.value,q=>(g(),Q("div",{key:q.branch_id,class:"col-xs-12 col-sm-6 col-md-4 col-lg-3"},[e(z,{class:"user-card",onClick:l=>d(q)},{default:a(()=>[Aa,e(B,{class:"text-center"},{default:a(()=>[o("div",ja,[o("div",Ka,$(k(q.branch_name)),1)])]),_:2},1024)]),_:2},1032,["onClick"])]))),128))]))]))}};var Ha=E(Ea,[["__scopeId","data-v-8e017a4c"]]);const Oa={class:"elegant-container q-gutter-md"},Ga={class:"text-h6 row justify-between"},Ya={class:"q-gutter-sm"},Ja={class:"tab-container"},Xa={__name:"WarehouseIdPage",setup(r){const V=G(),x=Fe(),v=Ve(),n=R("");P(()=>v.warehouse);const u=P(()=>V.params.warehouse_id||"Unknown Warehouse"),w=R("warehouseRawMaterials"),C=async m=>(await $e.get(`/api/warehouse/${m}`)).data,d=async()=>{try{const m=await C(u.value);m&&m.name?n.value=m.name:console.error("Warehouse name data is missing",m)}catch(m){console.error("Error fetching warehouse data:",m)}};ce(()=>{d()});const b=m=>m?m.split(" ").map(s=>s.charAt(0).toUpperCase()+s.slice(1).toLowerCase()).join(" "):"",k=()=>{Loading.show(),x.push("/admin/warehouse").finally(()=>{Loading.hide()})};return(m,s)=>(g(),N(Le,{padding:""},{default:a(()=>[o("div",Oa,[o("div",Ga,[o("div",null,[e(D,{outline:"",flat:"",icon:"arrow_back",to:"/admin/warehouse",onClick:k}),e(pe)]),o("div",null,[e(K,{name:"factory"}),y(" "+$(b(n.value)),1)])]),o("div",Ya,[o("div",Ja,[e(Ce,{modelValue:w.value,"onUpdate:modelValue":s[0]||(s[0]=f=>w.value=f),dense:"",class:"bg-grey-2 text-grey-7 tabs-as-cards","active-color":"red-6","indicator-color":"transparent",align:"justify"},{default:a(()=>[e(le,{name:"warehouseRawMaterials",label:"Warehouse Raw Materials"}),e(le,{name:"branchRawMaterials",label:"Branch Raw Materials"})]),_:1},8,["modelValue"])]),e(z,{class:"q-mt-sm"},{default:a(()=>[e(Me,{modelValue:w.value,"onUpdate:modelValue":s[1]||(s[1]=f=>w.value=f),animated:""},{default:a(()=>[e(oe,{name:"warehouseRawMaterials"},{default:a(()=>[e(Ca)]),_:1}),e(oe,{name:"branchRawMaterials"},{default:a(()=>[e(Ha)]),_:1})]),_:1},8,["modelValue"])]),_:1})])])]),_:1}))}};var Nt=E(Xa,[["__scopeId","data-v-560de15d"]]);export{Nt as default};
