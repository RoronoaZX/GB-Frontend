import{b as f,P as l}from"./index.6a2e76bf.js";import{api as m}from"./axios.eb07d1a5.js";import{u as d}from"./baker-report.baef49e1.js";import{u as n}from"./sales-report.b781c1fe.js";import{u as g}from"./supervisor.cfc8e9f2.js";var I=f(async({router:i})=>{i.beforeEach(async(a,S,e)=>{var t;const u=localStorage.getItem("token"),s=localStorage.getItem("role");if(l.value=!0,u)try{const r=d(),c=n(),p=g(),o=await m.get("/api/profile");console.log("user:",o.data),r.setUser(o.data),c.setUser(o.data),p.setUser(o.data),a.path==="/"?s==="Admin"?e("/admin/dashboard"):s==="Baker"?e("/branch/baker"):s==="Cashier"?e("/branch/sales_lady/products"):e():e()}catch(r){console.error("Error fetching user profile:",((t=r.response)==null?void 0:t.data)||r.message),localStorage.removeItem("token"),localStorage.removeItem("role"),a.path!=="/"?e("/"):e()}finally{}else a.path!=="/"?e("/"):e();l.value=!1})});export{I as default};
